(()=>{var e={27:(e,t,n)=>{var r,a;r=function(){var e={172351395:{name:"EBML",type:"Container"},646:{name:"EBMLVersion",type:"Uint"},759:{name:"EBMLReadVersion",type:"Uint"},754:{name:"EBMLMaxIDLength",type:"Uint"},755:{name:"EBMLMaxSizeLength",type:"Uint"},642:{name:"DocType",type:"String"},647:{name:"DocTypeVersion",type:"Uint"},645:{name:"DocTypeReadVersion",type:"Uint"},108:{name:"Void",type:"Binary"},63:{name:"CRC-32",type:"Binary"},190023271:{name:"SignatureSlot",type:"Container"},16010:{name:"SignatureAlgo",type:"Uint"},16026:{name:"SignatureHash",type:"Uint"},16037:{name:"SignaturePublicKey",type:"Binary"},16053:{name:"Signature",type:"Binary"},15963:{name:"SignatureElements",type:"Container"},15995:{name:"SignatureElementList",type:"Container"},9522:{name:"SignedElement",type:"Binary"},139690087:{name:"Segment",type:"Container"},21863284:{name:"SeekHead",type:"Container"},3515:{name:"Seek",type:"Container"},5035:{name:"SeekID",type:"Binary"},5036:{name:"SeekPosition",type:"Uint"},88713574:{name:"Info",type:"Container"},13220:{name:"SegmentUID",type:"Binary"},13188:{name:"SegmentFilename",type:"String"},1882403:{name:"PrevUID",type:"Binary"},1868715:{name:"PrevFilename",type:"String"},2013475:{name:"NextUID",type:"Binary"},1999803:{name:"NextFilename",type:"String"},1092:{name:"SegmentFamily",type:"Binary"},10532:{name:"ChapterTranslate",type:"Container"},10748:{name:"ChapterTranslateEditionUID",type:"Uint"},10687:{name:"ChapterTranslateCodec",type:"Uint"},10661:{name:"ChapterTranslateID",type:"Binary"},710577:{name:"TimecodeScale",type:"Uint"},1161:{name:"Duration",type:"Float"},1121:{name:"DateUTC",type:"Date"},15273:{name:"Title",type:"String"},3456:{name:"MuxingApp",type:"String"},5953:{name:"WritingApp",type:"String"},103:{name:"Timecode",type:"Uint"},6228:{name:"SilentTracks",type:"Container"},6359:{name:"SilentTrackNumber",type:"Uint"},39:{name:"Position",type:"Uint"},43:{name:"PrevSize",type:"Uint"},35:{name:"SimpleBlock",type:"Binary"},32:{name:"BlockGroup",type:"Container"},33:{name:"Block",type:"Binary"},34:{name:"BlockVirtual",type:"Binary"},13729:{name:"BlockAdditions",type:"Container"},38:{name:"BlockMore",type:"Container"},110:{name:"BlockAddID",type:"Uint"},37:{name:"BlockAdditional",type:"Binary"},27:{name:"BlockDuration",type:"Uint"},122:{name:"ReferencePriority",type:"Uint"},123:{name:"ReferenceBlock",type:"Int"},125:{name:"ReferenceVirtual",type:"Int"},36:{name:"CodecState",type:"Binary"},13730:{name:"DiscardPadding",type:"Int"},14:{name:"Slices",type:"Container"},104:{name:"TimeSlice",type:"Container"},76:{name:"LaceNumber",type:"Uint"},77:{name:"FrameNumber",type:"Uint"},75:{name:"BlockAdditionID",type:"Uint"},78:{name:"Delay",type:"Uint"},79:{name:"SliceDuration",type:"Uint"},72:{name:"ReferenceFrame",type:"Container"},73:{name:"ReferenceOffset",type:"Uint"},74:{name:"ReferenceTimeCode",type:"Uint"},47:{name:"EncryptedBlock",type:"Binary"},106212971:{name:"Tracks",type:"Container"},46:{name:"TrackEntry",type:"Container"},87:{name:"TrackNumber",type:"Uint"},13253:{name:"TrackUID",type:"Uint"},3:{name:"TrackType",type:"Uint"},57:{name:"FlagEnabled",type:"Uint"},8:{name:"FlagDefault",type:"Uint"},5546:{name:"FlagForced",type:"Uint"},28:{name:"FlagLacing",type:"Uint"},11751:{name:"MinCache",type:"Uint"},11768:{name:"MaxCache",type:"Uint"},254851:{name:"DefaultDuration",type:"Uint"},216698:{name:"DefaultDecodedFieldDuration",type:"Uint"},209231:{name:"TrackTimecodeScale",type:"Float"},4991:{name:"TrackOffset",type:"Int"},5614:{name:"MaxBlockAdditionID",type:"Uint"},4974:{name:"Name",type:"String"},177564:{name:"Language",type:"String"},6:{name:"CodecID",type:"String"},9122:{name:"CodecPrivate",type:"Binary"},362120:{name:"CodecName",type:"String"},13382:{name:"AttachmentLink",type:"Uint"},1742487:{name:"CodecSettings",type:"String"},1785920:{name:"CodecInfoURL",type:"String"},438848:{name:"CodecDownloadURL",type:"String"},42:{name:"CodecDecodeAll",type:"Uint"},12203:{name:"TrackOverlay",type:"Uint"},5802:{name:"CodecDelay",type:"Uint"},5819:{name:"SeekPreRoll",type:"Uint"},9764:{name:"TrackTranslate",type:"Container"},9980:{name:"TrackTranslateEditionUID",type:"Uint"},9919:{name:"TrackTranslateCodec",type:"Uint"},9893:{name:"TrackTranslateTrackID",type:"Binary"},96:{name:"Video",type:"Container"},26:{name:"FlagInterlaced",type:"Uint"},5048:{name:"StereoMode",type:"Uint"},5056:{name:"AlphaMode",type:"Uint"},5049:{name:"OldStereoMode",type:"Uint"},48:{name:"PixelWidth",type:"Uint"},58:{name:"PixelHeight",type:"Uint"},5290:{name:"PixelCropBottom",type:"Uint"},5307:{name:"PixelCropTop",type:"Uint"},5324:{name:"PixelCropLeft",type:"Uint"},5341:{name:"PixelCropRight",type:"Uint"},5296:{name:"DisplayWidth",type:"Uint"},5306:{name:"DisplayHeight",type:"Uint"},5298:{name:"DisplayUnit",type:"Uint"},5299:{name:"AspectRatioType",type:"Uint"},963876:{name:"ColourSpace",type:"Binary"},1029411:{name:"GammaValue",type:"Float"},230371:{name:"FrameRate",type:"Float"},97:{name:"Audio",type:"Container"},53:{name:"SamplingFrequency",type:"Float"},14517:{name:"OutputSamplingFrequency",type:"Float"},31:{name:"Channels",type:"Uint"},15739:{name:"ChannelPositions",type:"Binary"},8804:{name:"BitDepth",type:"Uint"},98:{name:"TrackOperation",type:"Container"},99:{name:"TrackCombinePlanes",type:"Container"},100:{name:"TrackPlane",type:"Container"},101:{name:"TrackPlaneUID",type:"Uint"},102:{name:"TrackPlaneType",type:"Uint"},105:{name:"TrackJoinBlocks",type:"Container"},109:{name:"TrackJoinUID",type:"Uint"},64:{name:"TrickTrackUID",type:"Uint"},65:{name:"TrickTrackSegmentUID",type:"Binary"},70:{name:"TrickTrackFlag",type:"Uint"},71:{name:"TrickMasterTrackUID",type:"Uint"},68:{name:"TrickMasterTrackSegmentUID",type:"Binary"},11648:{name:"ContentEncodings",type:"Container"},8768:{name:"ContentEncoding",type:"Container"},4145:{name:"ContentEncodingOrder",type:"Uint"},4146:{name:"ContentEncodingScope",type:"Uint"},4147:{name:"ContentEncodingType",type:"Uint"},4148:{name:"ContentCompression",type:"Container"},596:{name:"ContentCompAlgo",type:"Uint"},597:{name:"ContentCompSettings",type:"Binary"},4149:{name:"ContentEncryption",type:"Container"},2017:{name:"ContentEncAlgo",type:"Uint"},2018:{name:"ContentEncKeyID",type:"Binary"},2019:{name:"ContentSignature",type:"Binary"},2020:{name:"ContentSigKeyID",type:"Binary"},2021:{name:"ContentSigAlgo",type:"Uint"},2022:{name:"ContentSigHashAlgo",type:"Uint"},206814059:{name:"Cues",type:"Container"},59:{name:"CuePoint",type:"Container"},51:{name:"CueTime",type:"Uint"},55:{name:"CueTrackPositions",type:"Container"},119:{name:"CueTrack",type:"Uint"},113:{name:"CueClusterPosition",type:"Uint"},112:{name:"CueRelativePosition",type:"Uint"},50:{name:"CueDuration",type:"Uint"},4984:{name:"CueBlockNumber",type:"Uint"},106:{name:"CueCodecState",type:"Uint"},91:{name:"CueReference",type:"Container"},22:{name:"CueRefTime",type:"Uint"},23:{name:"CueRefCluster",type:"Uint"},4959:{name:"CueRefNumber",type:"Uint"},107:{name:"CueRefCodecState",type:"Uint"},155296873:{name:"Attachments",type:"Container"},8615:{name:"AttachedFile",type:"Container"},1662:{name:"FileDescription",type:"String"},1646:{name:"FileName",type:"String"},1632:{name:"FileMimeType",type:"String"},1628:{name:"FileData",type:"Binary"},1710:{name:"FileUID",type:"Uint"},1653:{name:"FileReferral",type:"Binary"},1633:{name:"FileUsedStartTime",type:"Uint"},1634:{name:"FileUsedEndTime",type:"Uint"},4433776:{name:"Chapters",type:"Container"},1465:{name:"EditionEntry",type:"Container"},1468:{name:"EditionUID",type:"Uint"},1469:{name:"EditionFlagHidden",type:"Uint"},1499:{name:"EditionFlagDefault",type:"Uint"},1501:{name:"EditionFlagOrdered",type:"Uint"},54:{name:"ChapterAtom",type:"Container"},13252:{name:"ChapterUID",type:"Uint"},5716:{name:"ChapterStringUID",type:"String"},17:{name:"ChapterTimeStart",type:"Uint"},18:{name:"ChapterTimeEnd",type:"Uint"},24:{name:"ChapterFlagHidden",type:"Uint"},1432:{name:"ChapterFlagEnabled",type:"Uint"},11879:{name:"ChapterSegmentUID",type:"Binary"},11964:{name:"ChapterSegmentEditionUID",type:"Uint"},9155:{name:"ChapterPhysicalEquiv",type:"Uint"},15:{name:"ChapterTrack",type:"Container"},9:{name:"ChapterTrackNumber",type:"Uint"},0:{name:"ChapterDisplay",type:"Container"},5:{name:"ChapString",type:"String"},892:{name:"ChapLanguage",type:"String"},894:{name:"ChapCountry",type:"String"},10564:{name:"ChapProcess",type:"Container"},10581:{name:"ChapProcessCodecID",type:"Uint"},1293:{name:"ChapProcessPrivate",type:"Binary"},10513:{name:"ChapProcessCommand",type:"Container"},10530:{name:"ChapProcessTime",type:"Uint"},10547:{name:"ChapProcessData",type:"Binary"},39109479:{name:"Tags",type:"Container"},13171:{name:"Tag",type:"Container"},9152:{name:"Targets",type:"Container"},10442:{name:"TargetTypeValue",type:"Uint"},9162:{name:"TargetType",type:"String"},9157:{name:"TagTrackUID",type:"Uint"},9161:{name:"TagEditionUID",type:"Uint"},9156:{name:"TagChapterUID",type:"Uint"},9158:{name:"TagAttachmentUID",type:"Uint"},10184:{name:"SimpleTag",type:"Container"},1443:{name:"TagName",type:"String"},1146:{name:"TagLanguage",type:"String"},1156:{name:"TagDefault",type:"Uint"},1159:{name:"TagString",type:"String"},1157:{name:"TagBinary",type:"Binary"}};function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e}function n(e,t){this.name=e||"Unknown",this.type=t||"Unknown"}function r(e,t){n.call(this,e,t||"Uint")}function a(e){return e.length%2==1?"0"+e:e}function i(e,t){n.call(this,e,t||"Float")}function o(e,t){n.call(this,e,t||"Container")}function s(e){o.call(this,"File","File"),this.setSource(e)}function l(e,t,n,r){if("object"==typeof n&&(r=n,n=void 0),!n)return new Promise((function(n){l(e,t,n,r)}));try{var a=new FileReader;a.onloadend=function(){try{var i=new s(new Uint8Array(a.result));i.fixDuration(t,r)&&(e=i.toBlob(e.type))}catch(e){}n(e)},a.readAsArrayBuffer(e)}catch(t){n(e)}}return n.prototype.updateBySource=function(){},n.prototype.setSource=function(e){this.source=e,this.updateBySource()},n.prototype.updateByData=function(){},n.prototype.setData=function(e){this.data=e,this.updateByData()},t(r,n),r.prototype.updateBySource=function(){this.data="";for(var e=0;e<this.source.length;e++){var t=this.source[e].toString(16);this.data+=a(t)}},r.prototype.updateByData=function(){var e=this.data.length/2;this.source=new Uint8Array(e);for(var t=0;t<e;t++){var n=this.data.substr(2*t,2);this.source[t]=parseInt(n,16)}},r.prototype.getValue=function(){return parseInt(this.data,16)},r.prototype.setValue=function(e){this.setData(a(e.toString(16)))},t(i,n),i.prototype.getFloatArrayType=function(){return this.source&&4===this.source.length?Float32Array:Float64Array},i.prototype.updateBySource=function(){var e=this.source.reverse(),t=new(this.getFloatArrayType())(e.buffer);this.data=t[0]},i.prototype.updateByData=function(){var e=new(this.getFloatArrayType())([this.data]),t=new Uint8Array(e.buffer);this.source=t.reverse()},i.prototype.getValue=function(){return this.data},i.prototype.setValue=function(e){this.setData(e)},t(o,n),o.prototype.readByte=function(){return this.source[this.offset++]},o.prototype.readUint=function(){for(var e=this.readByte(),t=8-e.toString(2).length,n=e-(1<<7-t),r=0;r<t;r++)n*=256,n+=this.readByte();return n},o.prototype.updateBySource=function(){for(this.data=[],this.offset=0;this.offset<this.source.length;this.offset=s){var t=this.readUint(),a=this.readUint(),s=Math.min(this.offset+a,this.source.length),l=this.source.slice(this.offset,s),c=e[t]||{name:"Unknown",type:"Unknown"},u=n;switch(c.type){case"Container":u=o;break;case"Uint":u=r;break;case"Float":u=i}var h=new u(c.name,c.type);h.setSource(l),this.data.push({id:t,idHex:t.toString(16),data:h})}},o.prototype.writeUint=function(e,t){for(var n=1,r=128;e>=r&&n<8;n++,r*=128);if(!t)for(var a=r+e,i=n-1;i>=0;i--){var o=a%256;this.source[this.offset+i]=o,a=(a-o)/256}this.offset+=n},o.prototype.writeSections=function(e){this.offset=0;for(var t=0;t<this.data.length;t++){var n=this.data[t],r=n.data.source,a=r.length;this.writeUint(n.id,e),this.writeUint(a,e),e||this.source.set(r,this.offset),this.offset+=a}return this.offset},o.prototype.updateByData=function(){var e=this.writeSections("draft");this.source=new Uint8Array(e),this.writeSections()},o.prototype.getSectionById=function(e){for(var t=0;t<this.data.length;t++){var n=this.data[t];if(n.id===e)return n.data}return null},t(s,o),s.prototype.fixDuration=function(e,t){var n=t&&t.logger;void 0===n?n=function(e){console.log(e)}:n||(n=function(){});var r=this.getSectionById(139690087);if(!r)return n("[fix-webm-duration] Segment section is missing"),!1;var a=r.getSectionById(88713574);if(!a)return n("[fix-webm-duration] Info section is missing"),!1;var o=a.getSectionById(710577);if(!o)return n("[fix-webm-duration] TimecodeScale section is missing"),!1;var s=a.getSectionById(1161);if(s){if(!(s.getValue()<=0))return n("[fix-webm-duration] Duration section is present"),!1;n("[fix-webm-duration] Duration section is present, but the value is empty"),s.setValue(e)}else n("[fix-webm-duration] Duration section is missing"),(s=new i("Duration","Float")).setValue(e),a.data.push({id:1161,data:s});return o.setValue(1e6),a.updateByData(),r.updateByData(),this.updateByData(),!0},s.prototype.toBlob=function(e){return new Blob([this.source.buffer],{type:e||"video/webm"})},l.default=l,l},void 0===(a="function"==typeof r?r.call(t,n,t,e):r)||(e.exports=a)}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0,(()=>{"use strict";const e=React;var t=n.n(e);const r=ReactDOM;var a=n.n(r);const i=ReactIntl,o=JSON.parse('{"de":{"action_block_contact":"Kontakt blockieren","action_cancel":"Abbrechen","action_clear_messages":"Nachrichten leeren","action_delete_messages":"Nachrichten für alle löschen","action_leave_chat":"Unterhaltung verlassen","action_report_chat":"Unterhaltung melden","archived_contacts":"Archivierte Kontakte ({count})","badge_danger":"Verdächtig","badge_owner":"Besitzer","badge_staff":"Verwaltung","badge_verified":"Verifiziert","badge_you":"Sie","block_contact_warning":"Möchten Sie diesen Kontakt wirklich blockieren?","blocked_contacts_link":"Blockierte Kontakte ({count})","button_add_another":"Hinzufügen","button_add_members":"Mitglieder hinzufügen","button_cancel":"Abbrechen","button_confirm":"Bestätigen","button_create":"Erstellen","button_delete_account":"Konto löschen","button_edit":"Bearbeiten","button_logout":"Abmelden","button_ok":"OK","button_reset":"Zurücksetzen","button_send_request":"Anfrage senden","button_sign_in":"Anmelden","button_sign_up":"Anmelden","button_subscribe":"Abbonieren","button_update":"Aktualisieren","cannot_initiate_file_upload":"Datei kann nicht hochgeladen werden.","channel":"Sender","channel_prompt":"Dies ist ein Sender","chat_invitation":"Sie sind eingeladen, an einem neuen Chat teilzunehmen. Was möchten Sie tun?","chat_invitation_accept":"Akzeptieren","chat_invitation_block":"Blockieren","chat_invitation_ignore":"Ignorieren","clear_messages_warning":"Sind Sie sicher, dass Sie diese Unterhaltung für alle leeren wollen? Das kann nicht rückgängig gemacht werden.","code_doesnot_match":"Code stimmt nicht überein","contacts_not_found":"Sie haben keine Unterhaltungen<br />¯∖_(ツ)_/¯","contacts_not_found_short":"Keine Kontakte für \'\'{query}\'\'","credential_email_prompt":"E-Mail Adresse für Registrierung","delete_account":"Konto löschen","delete_account_warning":"Möchten Sie das Konto wirklich löschen? Das kann nicht rückgängig gemacht werden","delete_messages_warning":"Sind Sie sicher, dass Sie diese Unterhaltung für alle löschen wollen? Das kann nicht rückgängig gemacht werden.","deleted_content":"Inhalt gelöscht","download_action":"herunterladen","drafty_attachment":"Dateianhang","drafty_form":"Formular:","drafty_image":"Bild","email_dative":"E-Mail","email_prompt":"E-Mail, z.B. lisam@beispiel.de","enable_peers_messaging":"Aktivieren","enter_confirmation_code_prompt":"Geben Sie den Bestätigungscode ein, der per {method} geschickt wurde:","error_invalid_id":"ungültige ID","file_attachment_too_large":"Die Dateigröße {size} überschreitet das Limit von {limit}.","forgot_password_link":"Passwort vergessen?","full_name_prompt":"Vollständiger Name, z.B. Lisa Musterfrau","granted_permissions":"Erteilt","group_has_no_members":"Keine Mitglieder","group_user_id_prompt":"Gruppe oder Benutzer ID","image_caption_prompt":"Bildunterschrift","invalid_content":"ungültiger Inhalt","invalid_security_token":"Ungültiger Sicherheitsschlüssel","label_client":"Client:","label_content_type":"Inhaltsart:","label_default_access_mode":"Standard Zugriffsmodus:","label_file_name":"Dateiname:","label_group_members":"Gruppenmitglieder:","label_incognito_mode":"inkognito-Modus:","label_message_sound":"Benachrichtigungston:","label_muting_topic":"Stumm geschaltet:","label_other_user":"Andere","label_password":"Passwort","label_permissions":"Berechtigungen:","label_private":"Privater Kommentar","label_push_notifications":"Benachrichtigungsmeldungen:","label_push_notifications_disabled":"Benachrichtigungsmeldungen (erfordert HTTPS):","label_reset_password":"Passwort per E-Mail wiederherstellen:","label_sdk":"SDK:","label_server":"Server:","label_server_address":"Server Adresse:","label_server_to_use":"Server verwenden:","label_size":"Größe:","label_topic_name":"Name","label_user_contacts":"Kontakte:","label_user_id":"ID:","label_wire_transport":"Übertragung per Kabel:","label_you":"Sie:","label_your_name":"Ihr Name","label_your_permissions":"Ihre Berechtigungen:","last_seen_timestamp":"Zuletzt gesehen","leave_chat_warning":"Möchten Sie diese Unterhaltung wirklich verlassen?","link_contact_us":"Kontakt","link_privacy_policy":"Datenschutzerklärung","link_terms_of_service":"Nutzungsbedingungen","login_prompt":"Anmelden","menu_item_archive_topic":"Archivieren","menu_item_block":"Blockieren","menu_item_clear_messages":"Nachrichten leeren","menu_item_clear_messages_for_all":"Für alle leeren","menu_item_delete":"Löschen","menu_item_delete_for_all":"Für alle löschen","menu_item_delete_topic":"Entfernen","menu_item_edit_permissions":"Berechtigungen ändern","menu_item_info":"Info","menu_item_member_delete":"Entfernen","menu_item_mute":"Unterhaltung stumm schalten","menu_item_restore_topic":"Wiederherstellen","menu_item_send_retry":"Wiederholen","menu_item_unblock":"Blockierung aufheben","menu_item_unmute":"Stumm schalten beenden","message_sending":"wird gesendet...","message_sending_failed":"fehlgeschlagen","messages_not_readable":"Neue Nachrichten können nicht gelesen werden","messaging_disabled_prompt":"Nachrichtenübermittlung deaktiviert","more_online_members":"+{overflow} mehr","new_message_prompt":"Neue Nachricht","new_password_placeholder":"Geben Sie ein neues Passwort ein","no_connection":"Keine Verbindung","no_contacts":"Sie haben keine Kontakte :-(","numeric_confirmation_code_prompt":"Nur zahlen","online_now":"jetzt online","password_prompt":"Passwort","password_unchanged_prompt":"unverändert","peers_messaging_disabled":"Gruppennachrichten sind deaktiviert","permission_admin":"Bestätigen ({val})","permission_delete":"Entfernen ({val})","permission_join":"Beitreten ({val})","permission_owner":"Besitzer ({val})","permission_pres":"Benachrichtigt werden ({val})","permission_read":"Lesen ({val})","permission_share":"Teilen ({val})","permission_write":"Schreiben ({val})","phone_dative":"Telefon","private_editing_placeholder":"Nur für Sie sichtbar","push_init_failed":"Initialisierung von Push-Benachrichtigungen fehlgeschlagen","reconnect_countdown":"Getrennt. Wiederverbinden in {seconds}…","reconnect_now":"Jetzt probieren","reload_update":"Neu laden","report_chat_warning":"Möchten Sie diese Unterhaltung wirklich blockieren und melden?","requested_permissions":"Angefordert","save_attachment":"Speichern","search_for_contacts":"Nutzen Sie die Suche um Kontakte zu finden","search_no_results":"Die Suche hatte keine Ergebnisse","search_placeholder":"Liste: email:lisa@beispiel.de, tel:17025550003...","sidepanel_title_acc_notifications":"Benachrichtigungen","sidepanel_title_acc_support":"Unterstützung","sidepanel_title_account_settings":"Konto-Einstellungen","sidepanel_title_archive":"Archivierte Unterhaltungen","sidepanel_title_blocked":"Blockierte Unterhaltungen","sidepanel_title_cred":"Anmeldeinformationen bestätigen","sidepanel_title_login":"Anmelden","sidepanel_title_newtpk":"Neue Unterhaltung starten","sidepanel_title_register":"Konto erstellen","sidepanel_title_reset":"Passwort zurücksetzen","sidepanel_title_settings":"Einstellungen","stay_logged_in":"Angemeldet bleiben","tabtitle_find_user":"Suchen","tabtitle_group_by_id":"nach ID","tabtitle_new_group":"Neue Gruppe","tags_editor_no_tags":"Schlagworte hinzufügen","tags_not_found":"Keine Schlagworte definiert. Erstellen Sie welche.","title_all_contacts":"Alle Kontakte","title_group_members":"Gruppenmitglieder","panel_title_info":"Info","title_manage_tags":"Verwalten","title_not_found":"Nicht gefunden","title_permissions":"Berechtigungen","title_tag_manager":"Schlagworte (Nutzer entdecken)","topic_block_warning":"Möchten Sie diese Unterhaltung wirklich blockieren?","topic_delete_warning":"Möchten Sie diese Unterhaltung wirklich löschen?","topic_name_editing_placeholder":"Freiform Name der Gruppe","unnamed_topic":"Unbenannt","update_available":"Aktualisierung verfügbar.","upload_finishing":"wird abgeschlossen...","user_not_found":"Nicht gefunden","validate_credential_action":"bestätigen","description_editing_placeholder":"Beschreibung (optional)","label_description":"Beschreibung","button_security":"Sicherheit","panel_title_general":"Allgemein","panel_title_security":"Sicherheit","panel_title_crop":"Zum Anpassen ziehen","panel_title_members":"Mitglieder","permissions_anonymous":"Anonym","permissions_authenticated":"Authentifiziert","topic_delete":"Chat löschen","permissions_user":"Benutzerberechtigungen","password_reset_email_sent":"Eine E-Mail wurde an {email} gesendet. Folgen Sie den Anweisungen in der E-Mail, um Ihr Passwort zurückzusetzen.","label_unarchive_topic":"Archiviert:","menu_item_reply":"Antwort","menu_item_forward":"Nach vorne","forward_to":"Weiterleiten","forward_to_search_placeholder":"Kontakte durchsuchen","label_new_password":"Neues Kennwort","drafty_unknown":"Nicht unterstützt","calls_incoming":"Eingehender Anruf","calls_outgoing":"Ausgehender Anruf","calls_you_label":"Du","menu_item_video_call":"Videoanruf","already_in_call":"Du redest schon!","call_cancelled":"abgebrochen","call_missed":"verpasster","call_declined":"abgelehnt","call_disconnected":"getrennt","label_use_secure_connection":"Verwenden Sie eine sichere Verbindung","phone_or_email_prompt":"Telefonnummer oder E-Mail","cred_confirmed_successfully":"Erfolgreich bestätigt"},"en":{"action_block_contact":"Block Contact","action_cancel":"cancel","action_clear_messages":"Clear Messages","action_delete_messages":"Clear Messages for All","action_leave_chat":"Leave Conversation","action_report_chat":"Report Conversation","archived_contacts":"Archived contacts ({count})","badge_danger":"Untrustworthy","badge_owner":"owner","badge_staff":"Staff-managed","badge_verified":"Verified/official","badge_you":"you","block_contact_warning":"Are you sure you want to block this contact?","blocked_contacts_link":"Blocked contacts ({count})","button_add_another":"Add another","button_add_members":"Add members","button_cancel":"Cancel","button_confirm":"Confirm","button_create":"Create","button_delete_account":"Delete account","button_edit":"Edit","button_logout":"Logout","button_ok":"OK","button_reset":"Reset","button_send_request":"Send request","button_sign_in":"Sign in","button_sign_up":"Sign up","button_subscribe":"Subscribe","button_update":"Update","cannot_initiate_file_upload":"Cannot initiate file upload.","channel":"channel","channel_prompt":"This is a channel","chat_invitation":"You are invited to start a new chat. What would you like to do?","chat_invitation_accept":"Accept","chat_invitation_block":"Block","chat_invitation_ignore":"Ignore","clear_messages_warning":"Are you sure you want to clear all messages? It cannot be undone.","code_doesnot_match":"Code does not match","contacts_not_found":"You have no chats<br />¯∖_(ツ)_/¯","contacts_not_found_short":"No contacts match \'\'{query}\'\'","credential_email_prompt":"Your registration email","delete_account":"Delete account","delete_account_warning":"Are you sure you want to delete your account? It cannot be undone.","delete_messages_warning":"Are you sure you want to delete all messages for everyone? It cannot be undone.","deleted_content":"content deleted","download_action":"download","drafty_attachment":"Attachment","drafty_form":"Form:","drafty_image":"Picture","email_dative":"email","email_prompt":"Email, e.g. jdoe@example.com","enable_peers_messaging":"Enable","enter_confirmation_code_prompt":"Enter confirmation code sent to you by {method}:","error_invalid_id":"Invalid ID","file_attachment_too_large":"The file size {size} exceeds the {limit} limit.","forgot_password_link":"Forgot password?","full_name_prompt":"Full name, e.g. John Doe","granted_permissions":"Granted","group_has_no_members":"No members","group_user_id_prompt":"Group or User ID","image_caption_prompt":"Image caption","invalid_content":"invalid content","invalid_security_token":"Invalid security token","label_client":"Client:","label_content_type":"Content type:","label_default_access_mode":"Default access mode:","label_file_name":"File name:","label_group_members":"Group members:","label_incognito_mode":"Incognito mode:","label_message_sound":"Message sound:","label_muting_topic":"Muted:","label_other_user":"Other","label_password":"Password","label_permissions":"Permissions:","label_private":"Private comment","label_push_notifications":"Notification alerts:","label_push_notifications_disabled":"Notification alerts (requires HTTPS):","label_reset_password":"Send a password reset email:","label_sdk":"SDK:","label_server":"Server:","label_server_address":"Server address:","label_server_to_use":"Server to use:","label_size":"Size:","label_topic_name":"Name","label_user_contacts":"Contacts:","label_user_id":"ID:","label_wire_transport":"Wire transport:","label_you":"You:","label_your_name":"Your name","label_your_permissions":"Your permissions:","last_seen_timestamp":"Last seen","leave_chat_warning":"Are you sure you want to leave this conversation?","link_contact_us":"Contact Us","link_privacy_policy":"Privacy Policy","link_terms_of_service":"Terms of Service","login_prompt":"Login","menu_item_archive_topic":"Archive","menu_item_block":"Block","menu_item_clear_messages":"Clear messages","menu_item_clear_messages_for_all":"Clear for All","menu_item_delete":"Delete","menu_item_delete_for_all":"Delete for All","menu_item_delete_topic":"Delete","menu_item_edit_permissions":"Edit permissions","menu_item_info":"Info","menu_item_member_delete":"Remove","menu_item_mute":"Mute","menu_item_reply":"Reply","menu_item_restore_topic":"Restore","menu_item_send_retry":"Retry","menu_item_unblock":"Unblock","menu_item_unmute":"Unmute","message_sending":"sending...","message_sending_failed":"failed","messages_not_readable":"no access to messages","messaging_disabled_prompt":"Messaging disabled","more_online_members":"+{overflow} more","new_message_prompt":"New message","new_password_placeholder":"Enter new password","no_connection":"No connection","no_contacts":"You have no contacts :-(","numeric_confirmation_code_prompt":"Numbers only","online_now":"online now","password_prompt":"Password","password_unchanged_prompt":"Unchanged","peers_messaging_disabled":"Peer\'s messaging is disabled.","permission_admin":"Approve ({val})","permission_delete":"Delete ({val})","permission_join":"Join ({val})","permission_owner":"Owner ({val})","permission_pres":"Get notified ({val})","permission_read":"Read ({val})","permission_share":"Share ({val})","permission_write":"Write ({val})","phone_dative":"phone","private_editing_placeholder":"Visible to you only","push_init_failed":"Failed to initialize push notifications","reconnect_countdown":"Disconnected. Reconnecting in {seconds}…","reconnect_now":"Try now","reload_update":"Reload","report_chat_warning":"Are you sure you want to block and report this conversation?","requested_permissions":"Requested","save_attachment":"save","search_for_contacts":"Use search to find contacts","search_no_results":"Search returned no results","search_placeholder":"List like email:alice@example.com, tel:17025550003...","sidepanel_title_acc_notifications":"Notifications","sidepanel_title_acc_support":"Support","sidepanel_title_account_settings":"Account Settings","sidepanel_title_archive":"Archived Chats","sidepanel_title_blocked":"Blocked Chats","sidepanel_title_cred":"Confirm Credentials","sidepanel_title_login":"Sign In","sidepanel_title_newtpk":"Start New Chat","sidepanel_title_register":"Create Account","sidepanel_title_reset":"Reset Password","sidepanel_title_settings":"Settings","stay_logged_in":"Stay logged in","tabtitle_find_user":"find","tabtitle_group_by_id":"by id","tabtitle_new_group":"new group","tags_editor_no_tags":"Add some tags","tags_not_found":"No tags defined. Add some.","title_all_contacts":"All Contacts","title_group_members":"Group Members","title_manage_tags":"Manage","title_not_found":"Not found","title_permissions":"Permissions","title_tag_manager":"Tags (search & discovery)","topic_block_warning":"Are you sure you want to block this conversation?","topic_delete_warning":"Are you sure you want to delete this conversation?","topic_name_editing_placeholder":"Freeform name of the group","unnamed_topic":"Unnamed","update_available":"Update available.","upload_finishing":"finishing...","user_not_found":"Not found","validate_credential_action":"confirm","description_editing_placeholder":"Optional description","label_description":"Description","button_security":"Security","panel_title_crop":"Drag to Adjust","panel_title_general":"General","panel_title_members":"Members","panel_title_security":"Security","panel_title_info":"Info","permissions_anonymous":"Anonymous","permissions_authenticated":"Authenticated","topic_delete":"Delete Conversation","permissions_user":"User\'s Permissions","password_reset_email_sent":"An email has been sent to {email}. Follow the directions in the email to reset your password.","label_unarchive_topic":"Archived:","menu_item_forward":"Forward","forward_to":"Forward to","forward_to_search_placeholder":"Search contacts","label_new_password":"New password","drafty_unknown":"Unsupported","calls_incoming":"Incoming call","calls_outgoing":"Outgoing call","calls_you_label":"You","menu_item_video_call":"Video call","already_in_call":"You already in an ongoing call!","call_cancelled":"cancelled","call_missed":"missed","call_declined":"declined","call_disconnected":"disconnected","label_use_secure_connection":"Use secure connection","phone_or_email_prompt":"Phone number or email","cred_confirmed_successfully":"Confirmed successfully"},"es":{"action_block_contact":"Bloquear contacto","action_cancel":"cancelar","action_clear_messages":"Borrar mensajes","action_delete_messages":"Borrar mensajes para todos","action_leave_chat":"Dejar conversación","action_report_chat":"Reportar conversación","archived_contacts":"Contactos archivados ({count})","badge_danger":"Suspicaz","badge_owner":"propietario","badge_staff":"Administración","badge_verified":"Verificado","badge_you":"tú","block_contact_warning":"¿Estás seguro de que quieres bloquear a este contacto?","blocked_contacts_link":"Contactos bloqueados ({count})","button_add_another":"Añadir contacto","button_add_members":"Añadir miembros","button_cancel":"Cancelar","button_confirm":"Confirmar","button_create":"Crear","button_delete_account":"Eliminar cuenta","button_edit":"Editar","button_logout":"Cerrar sesión","button_ok":"OK","button_reset":"Restablecer","button_send_request":"Enviar petición","button_sign_in":"Entrar","button_sign_up":"Regístrate","button_subscribe":"Suscribirse","button_update":"Actualizar","cannot_initiate_file_upload":"No se pudo iniciar la carga del archivo.","channel":"canal","channel_prompt":"Este es un canal","chat_invitation":"Estás invitado a participar en un nuevo chat. ¿Qué te gustaría hacer?","chat_invitation_accept":"Aceptar","chat_invitation_block":"Bloquear","chat_invitation_ignore":"Ignorar","clear_messages_warning":"¿Estás seguro de que quieres eliminar todos los mensajes? Esta acción es irreversible.","code_doesnot_match":"El código no coincide","contacts_not_found":"No tienes chats<br />¯∖_(ツ)_/¯","contacts_not_found_short":"Ningún contacto coincide con \'\'{query}\'\'","credential_email_prompt":"Tu correo electrónico de registro","delete_account":"Eliminar cuenta","delete_account_warning":"¿Estás seguro de que deseas eliminar permanentemente tu cuenta? Esta acción es irreversible.","delete_messages_warning":"¿Estás seguro de que quieres eliminar todos los mensajes para todos? Esta acción es irreversible.","deleted_content":"este mensaje fue eliminado","download_action":"descargar","drafty_attachment":"Archivo","drafty_form":"Formulario:","drafty_image":"Imagen","email_dative":"correo electrónico","email_prompt":"Correo electrónico, p.ej. juan@example.com","enable_peers_messaging":"Habilitar","enter_confirmation_code_prompt":"Introduzca el código de confirmación enviado a tu {method}:","error_invalid_id":"ID inválido","file_attachment_too_large":"El tamaño del archivo {size} excede el límite de {limit}.","forgot_password_link":"¿Olvidaste tu contraseña?","full_name_prompt":"Nombre completo, p.ej. Juan González Hernández","granted_permissions":"Otorgados","group_has_no_members":"No hay miembros","group_user_id_prompt":"ID del grupo o usuario","image_caption_prompt":"Añade un comentario","invalid_content":"contenido inválido","invalid_security_token":"Token de seguridad inválido","label_client":"Cliente:","label_content_type":"Tipo de contenido:","label_default_access_mode":"Modo de acceso predeterminado:","label_file_name":"Nombre del archivo:","label_group_members":"Miembros del grupo:","label_incognito_mode":"Modo incógnito:","label_message_sound":"Sonido de mensaje:","label_muting_topic":"Silenciado:","label_other_user":"Otros","label_password":"Contraseña","label_permissions":"Permisos:","label_private":"Comentario privado","label_push_notifications":"Alertas de notificaciones:","label_push_notifications_disabled":"Alertas de notificaciones (requiere HTTPS):","label_reset_password":"Enviar un correo electrónico de restablecimiento de contraseña:","label_sdk":"SDK:","label_server":"Servidor:","label_server_address":"Dirección del servidor:","label_server_to_use":"Servidor para usar:","label_size":"Tamaño:","label_topic_name":"Nombre del tema","label_user_contacts":"Contactos:","label_user_id":"ID:","label_wire_transport":"Transporte de alambre:","label_you":"Tú:","label_your_name":"Tu nombre","label_your_permissions":"Tus permisos:","last_seen_timestamp":"Últ. vez","leave_chat_warning":"¿Estás seguro de que quieres dejar esta conversación?","link_contact_us":"Contáctanos","link_privacy_policy":"Política de privacidad","link_terms_of_service":"Términos de uso","login_prompt":"Nombre de usuario","menu_item_archive_topic":"Archivar","menu_item_block":"Bloquear","menu_item_clear_messages":"Borrar mensajes","menu_item_clear_messages_for_all":"Borrar para todos","menu_item_delete":"Eliminar","menu_item_delete_for_all":"Eliminar para todos","menu_item_delete_topic":"Eliminar","menu_item_edit_permissions":"Editar permisos","menu_item_info":"Información","menu_item_member_delete":"Eliminar","menu_item_mute":"Silenciar","menu_item_restore_topic":"Restaurar","menu_item_send_retry":"Inténtalo de nuevo","menu_item_unblock":"Desbloquear","menu_item_unmute":"Anular el silencio","message_sending":"enviando...","message_sending_failed":"no se pudo enviar el mensaje","messages_not_readable":"sin acceso a mensajes","messaging_disabled_prompt":"El envío de mensajes está deshabilitado","more_online_members":"+{overflow} más","new_message_prompt":"Nuevo mensaje","new_password_placeholder":"Introduzca una nueva contraseña","no_connection":"Sin conexión","no_contacts":"No tienes contactos :-(","numeric_confirmation_code_prompt":"Sólo números","online_now":"en línea","password_prompt":"Contraseña","password_unchanged_prompt":"Sin cambios","peers_messaging_disabled":"La mensajería Peer está deshabilitada.","permission_admin":"Approbar ({val})","permission_delete":"Eliminar ({val})","permission_join":"Unirse ({val})","permission_owner":"Propietario ({val})","permission_pres":"Ser notificado ({val})","permission_read":"Leer ({val})","permission_share":"Compartir ({val})","permission_write":"Escribir ({val})","phone_dative":"teléfono","private_editing_placeholder":"Sólo visible para tí","push_init_failed":"Error al inicializar las notificaciones push","reconnect_countdown":"Desconectado. Reconectando en {seconds}…","reconnect_now":"Reintentar","reload_update":"Recargar","report_chat_warning":"¿Estás seguro de que quieres bloquear y reportar a esta conversación?","requested_permissions":"Solicitados","save_attachment":"guardar","search_for_contacts":"Usa la búsqueda para encontrar contactos","search_no_results":"La búsqueda no arrojó resultados","search_placeholder":"Ej. email:alice@example.com, tel:17025550003...","sidepanel_title_acc_notifications":"Notificaciones","sidepanel_title_acc_support":"Soporte","sidepanel_title_account_settings":"Ajustes de la cuenta","sidepanel_title_archive":"Chats archivados","sidepanel_title_blocked":"Chats bloqueados","sidepanel_title_cred":"Confirmar credenciales","sidepanel_title_login":"Iniciar sesión","sidepanel_title_newtpk":"Iniciar un nuevo chat","sidepanel_title_register":"Crear cuenta","sidepanel_title_reset":"Restablecer contraseña","sidepanel_title_settings":"Ajustes","stay_logged_in":"Permanecer conectado","tabtitle_find_user":"encontrar","tabtitle_group_by_id":"por ID","tabtitle_new_group":"nuevo grupo","tags_editor_no_tags":"Añadir etiquetas","tags_not_found":"No hay etiquetas definidas. Añade unas.","title_all_contacts":"Todos los contactos","title_group_members":"Miembros del grupo","title_manage_tags":"Gestionar","title_not_found":"No encontrado","title_permissions":"Permisos","title_tag_manager":"Etiquetas (descubrimiento de usuarios)","topic_block_warning":"¿Estás seguro de que quieres bloquear esta conversación","topic_delete_warning":"¿Estás seguro de que quieres eliminar esta conversación?","topic_name_editing_placeholder":"Nombre del grupo","unnamed_topic":"Sin nombre","update_available":"Actualización disponible.","upload_finishing":"terminando...","user_not_found":"Usuario no encontrado","validate_credential_action":"confirmar","description_editing_placeholder":"Descripción (opcional)","label_description":"Descripción","button_security":"Seguridad","panel_title_crop":"Arrastra para ajustar","panel_title_general":"General","panel_title_members":"Miembros","panel_title_security":"Seguridad","panel_title_info":"Información","permissions_anonymous":"Anónimo","permissions_authenticated":"Autenticado","topic_delete":"Eliminar chat","permissions_user":"Permisos del usuario","password_reset_email_sent":"Se ha enviado un correo electrónico a {email}. Siga las instrucciones del correo electrónico para restablecer su contraseña.","label_unarchive_topic":"Archivado:","menu_item_reply":"Respuesta","menu_item_forward":"Reenviar","forward_to":"Reenviar a","forward_to_search_placeholder":"Buscar contactos","label_new_password":"Nueva contraseña","drafty_unknown":"No soportado","calls_incoming":"Llamada entrante","calls_outgoing":"Llamada saliente","calls_you_label":"Tú","menu_item_video_call":"Videollamada","already_in_call":"¡Ya estás hablando!","call_cancelled":"cancelada","call_missed":"perdida","call_declined":"rechazada","call_disconnected":"desconectada","label_use_secure_connection":"Usar conexión segura","phone_or_email_prompt":"Número de teléfono o correo electrónico","cred_confirmed_successfully":"Confirmado con éxito"},"fr":{"action_block_contact":"Bloquer le Contact","action_cancel":"annuler","action_clear_messages":"Effacer les Messages","action_delete_messages":"Effacer les Messages pour Tous","action_leave_chat":"Quitter la Conversation","action_report_chat":"Signaler la Conversation","archived_contacts":"Contacts archivés ({count})","badge_danger":"Non fiable","badge_owner":"propriétaire","badge_staff":"Géré par le Staff","badge_verified":"Vérifié / Officiel","badge_you":"vous","block_contact_warning":"Êtes-vous sûr de bloquer le contact ?","blocked_contacts_link":"Contacts bloqués ({count})","button_add_another":"Ajouter un autre","button_add_members":"Ajouter des membres","button_cancel":"Annuler","button_confirm":"Confirmer","button_create":"Créer","button_delete_account":"Supprimer le compte","button_edit":"Modifier","button_logout":"Déconnexion","button_ok":"OK","button_reset":"Remettre à Zéro","button_send_request":"Envoyer une demande","button_sign_in":"Connexion","button_sign_up":"Créer un compte","button_subscribe":"S\'abonner","button_update":"Mettre à jour","cannot_initiate_file_upload":"Impossible de démarrer l\'envoi.","channel":"canal","channel_prompt":"C\'est un canal","chat_invitation":"Vous êtes invité à démarrer une conversation. Que voulez vous faire ?","chat_invitation_accept":"Accepter","chat_invitation_block":"Bloquer","chat_invitation_ignore":"Ignorer","clear_messages_warning":"Êtes-vous sûr de vouloir effacer tous les messages ? Aucun retour possible.","code_doesnot_match":"Le code ne correspond pas","contacts_not_found":"Vous n\'avez aucune conversation<br />¯∖_(ツ)_/¯","contacts_not_found_short":"Aucun contact ne correspond à \'\'{query}\'\'","credential_email_prompt":"Votre email d\'enregistrement","delete_account":"Supprimer le compte","delete_account_warning":"Êtes-vous sûr de vouloir supprimer votre compte ? Aucun retour possible.","delete_messages_warning":"Êtes-vous sûr de vouloir supprimer tous les messages pour tous ? Aucun retour possible.","deleted_content":"contenu supprimé","download_action":"télécharger","drafty_attachment":"Pièce(s) jointe(s)","drafty_form":"Formulaire:","drafty_image":"Image","email_dative":"email","email_prompt":"Email, par exemple jdoe@exemple.com","enable_peers_messaging":"Activer","enter_confirmation_code_prompt":"Entrez le code de confirmation envoyé par {method}:","error_invalid_id":"Identifiant invalide","file_attachment_too_large":"Le fichier de taille {size} dépasse la limite de {limit}.","forgot_password_link":"Mot de passe oublié ?","full_name_prompt":"Nom complet, par exemple John Doe","granted_permissions":"Accordé","group_has_no_members":"Aucun membre","group_user_id_prompt":"Identifiant d\'utilisateur ou de groupe","image_caption_prompt":"Description de l\'image","invalid_content":"contenu invalide","invalid_security_token":"Token de sécurité invalide","label_client":"Client :","label_content_type":"Type de contenu :","label_default_access_mode":"Mode d\'accès par défaut :","label_file_name":"Nom du fichier :","label_group_members":"Membres du groupe :","label_incognito_mode":"Mode incognito :","label_message_sound":"Son du message :","label_muting_topic":"Mué :","label_other_user":"Autre","label_password":"Mot de passe","label_permissions":"Permissions :","label_private":"Commentaire privé","label_push_notifications":"Notifications :","label_push_notifications_disabled":"Notifications (requière HTTPS):","label_reset_password":"Envoyer un mail de remise à zéro de mot de passe :","label_sdk":"SDK :","label_server":"Serveur :","label_server_address":"Adresse du serveur :","label_server_to_use":"Serveur à utiliser :","label_size":"Taille :","label_topic_name":"Nom","label_user_contacts":"Contacts :","label_user_id":"ID :","label_wire_transport":"Transport par cable :","label_you":"Vous :","label_your_name":"Votre nom","label_your_permissions":"Vos permissions :","last_seen_timestamp":"Vu pour la dernière fois","leave_chat_warning":"Êtes-vous sûr de vouloir quitter cette conversation ?","link_contact_us":"Contactez Nous","link_privacy_policy":"Politique de confidentialité","link_terms_of_service":"Conditions d\'utilisation","login_prompt":"Connexion","menu_item_archive_topic":"Archiver","menu_item_block":"Bloquer","menu_item_clear_messages":"Effacer les messages","menu_item_clear_messages_for_all":"Effacer pour Tous","menu_item_delete":"Supprimer","menu_item_delete_for_all":"Supprimer pour Tous","menu_item_delete_topic":"Supprimer","menu_item_edit_permissions":"Modifier les permissions","menu_item_info":"Informations","menu_item_member_delete":"Supprimer","menu_item_mute":"Rendre muer","menu_item_reply":"Répondre","menu_item_restore_topic":"Restorer","menu_item_send_retry":"Réessayer","menu_item_unblock":"Débloquer","menu_item_unmute":"Recevoir à nouveau","message_sending":"envoi en cours...","message_sending_failed":"échoué","messages_not_readable":"aucun accès aux messages","messaging_disabled_prompt":"Discussion désactivée","more_online_members":"+{overflow} de plus","new_message_prompt":"Nouveau message","new_password_placeholder":"Entrez un nouveau mot de passe","no_connection":"Aucune connexion","no_contacts":"Vous n\'avez pas de contacts :-(","numeric_confirmation_code_prompt":"Nombres seulement","online_now":"en ligne","password_prompt":"Mot de passe","password_unchanged_prompt":"Non changé","peers_messaging_disabled":"La messagerie point à point est désactivée.","permission_admin":"Approver ({val})","permission_delete":"Supprimer ({val})","permission_join":"Rejoindre ({val})","permission_owner":"Propriétaire ({val})","permission_pres":"Recevoir une notification ({val})","permission_read":"Lire ({val})","permission_share":"Partager ({val})","permission_write":"Ecrire ({val})","phone_dative":"téléphone","private_editing_placeholder":"Visible par vous seulement","push_init_failed":"Impossible d\'initialiser les notifications push","reconnect_countdown":"Déconnecté. Reconnexion dans {seconds}…","reconnect_now":"Essayer maintenant","reload_update":"Recharger","report_chat_warning":"Êtes-vous sûr de vouloir bloquer et signaler cette conversation ?","requested_permissions":"Demandé","save_attachment":"sauvegarder","search_for_contacts":"Utilisez la recherche pour trouver des contacts","search_no_results":"La recherche n\'a donné aucun résultat","search_placeholder":"Liste comme email:alice@exemple.com, tel:17025550003...","sidepanel_title_acc_notifications":"Notifications","sidepanel_title_acc_support":"Support","sidepanel_title_account_settings":"Paramètres du compte","sidepanel_title_archive":"Conversations Archivées","sidepanel_title_blocked":"Conversations Bloquées","sidepanel_title_cred":"Confirmer les identifiants","sidepanel_title_login":"Se Connecter","sidepanel_title_newtpk":"Démarrer une nouvelle Conversation","sidepanel_title_register":"Créer un compte","sidepanel_title_reset":"Remettre à Zéro le Mot de Passe","sidepanel_title_settings":"Paramètres","stay_logged_in":"Rester connecté","tabtitle_find_user":"trouver","tabtitle_group_by_id":"par identifiant","tabtitle_new_group":"nouveau groupe","tags_editor_no_tags":"Ajouter des étiquettes","tags_not_found":"Aucune étiquette définie. Ajoutez en.","title_all_contacts":"Tous les Contacts","title_group_members":"Membres du Groupe","title_manage_tags":"Gérer","title_not_found":"Pas trouvé","title_permissions":"Permissions","title_tag_manager":"Etiquettes (recherche & découverte)","topic_block_warning":"Êtes-vous sûr de vouloir bloquer cette conversation ?","topic_delete_warning":"Êtes-vous sûr de vouloir supprimer cette conversation ?","topic_name_editing_placeholder":"Nom libre du groupe","unnamed_topic":"Non nommé","update_available":"Mise à jour disponible.","upload_finishing":"fin...","user_not_found":"Pas trouvé","validate_credential_action":"confirmer","description_editing_placeholder":"Description facultative","label_description":"Description","button_security":"Sécurité","panel_title_crop":"Déplacez pour ajuster","panel_title_general":"Général","panel_title_members":"Membres","panel_title_security":"Sécurité","panel_title_info":"Informations","permissions_anonymous":"Anonyme","permissions_authenticated":"Authentifié","topic_delete":"Supprimer la Conversation","permissions_user":"Permissions d\'Utilisateur","password_reset_email_sent":"Un email a été envoyé à {email}. Suivez les instructions du mail pour remettre à zéro votre mot de passe.","label_unarchive_topic":"Archivé:","menu_item_forward":"Transférer","forward_to":"Transférer à","forward_to_search_placeholder":"Rechercher des contacts","label_new_password":"Nouveau mot de passe","drafty_unknown":"Non supporté","already_in_call":"Vous êtes déjà dans un appel en cours!","call_cancelled":"annulé","call_declined":"refusé","call_missed":"manqué","calls_incoming":"Appel entrant","calls_outgoing":"Appel sortant","calls_you_label":"Tu","menu_item_video_call":"Appel vidéo","call_disconnected":"débranché","label_use_secure_connection":"Utiliser une connexion sécurisée","phone_or_email_prompt":"Numéro de téléphone ou email","cred_confirmed_successfully":"Confirmé avec succès"},"ko":{"action_block_contact":"연락차단","action_cancel":"취소","action_clear_messages":"메시지지우기","action_delete_messages":"모든메시지지우기","action_leave_chat":"대화나누기","action_report_chat":"대화기록","archived_contacts":"보관된연락처({수})","badge_danger":"의심 많은","badge_owner":"소유자","badge_staff":"직원 관리하에","badge_verified":"확인 됨","badge_you":"당신","block_contact_warning":"이연락처를차단하시겠습니까?","blocked_contacts_link":"차단된연락처({수})","button_add_another":"다른항목추가","button_add_members":"회원추가","button_cancel":"취소","button_confirm":"확인","button_create":"작성","button_delete_account":"계정삭제","button_edit":"편집","button_logout":"로그아웃","button_ok":"OK","button_reset":"재설정","button_send_request":"요청보내기","button_sign_in":"로그인","button_sign_up":"가입","button_subscribe":"구독","button_update":"업데이트","cannot_initiate_file_upload":"파일업로드를시작할수없습니다.","channel":"채널","channel_prompt":"이 채널입니다","chat_invitation":"새로운대화를시작하도록초대되었습니다.무엇을하시겠습니까?","chat_invitation_accept":"수락","chat_invitation_block":"차단","chat_invitation_ignore":"무시","clear_messages_warning":"모든메시지를지우시겠습니까?실행취소할수없습니다.","code_doesnot_match":"코드가일치하지않습니다","contacts_not_found":"채팅이없습니다<br/>¯∖_(ツ)_/¯","contacts_not_found_short":"\'{문의}\'와일치하는연락처가없습니다.","credential_email_prompt":"등록이메일","delete_account":"계정삭제","delete_account_warning":"계정을삭제하시겠습니까?실행취소할수없습니다.","delete_messages_warning":"모든사람의모든메시지를삭제하시겠습니까?실행취소할수없습니다.","deleted_content":"내용이 삭제되었습니다","download_action":"다운로드","drafty_attachment":"부착","drafty_form":"형태:","drafty_image":"이미지","email_dative":"이메일","email_prompt":"이메일(예:hong@example.com)","enable_peers_messaging":"활성화","enter_confirmation_code_prompt":"{방법}으로보낸확인코드를입력하십시오:","error_invalid_id":"잘못된ID","file_attachment_too_large":"파일크기{크기}이(가){제한}제한을초과합니다.","forgot_password_link":"비밀번호를잊으셨습니까?","full_name_prompt":"전체이름(예:홍길동)","granted_permissions":"승낙하다","group_has_no_members":"회원없음","group_user_id_prompt":"그룹또는사용자ID","image_caption_prompt":"이미지설명","invalid_content":"잘못된내용","invalid_security_token":"유효하지않은보안토큰","label_client":"클라이언트: ","label_content_type":"컨텐츠유형: ","label_default_access_mode":"기본액세스모드: ","label_file_name":"파일이름: ","label_group_members":"그룹회원: ","label_incognito_mode":"시크릿모드: ","label_message_sound":"메시지소리: ","label_muting_topic":"음소거: ","label_other_user":"기타","label_password":"비밀번호","label_permissions":"권한: ","label_private":"개인코멘트","label_push_notifications":"통지경보: ","label_push_notifications_disabled":"통지경보(HTTPS필요): ","label_reset_password":"비밀번호재설정이메일보내기: ","label_sdk":"SDK:","label_server":"서버: ","label_server_address":"서버주소: ","label_server_to_use":"사용할서버:","label_size":"크기: ","label_topic_name":"이름","label_user_contacts":"연락처: ","label_user_id":"ID:","label_wire_transport":"와이어수송:","label_you":"당신: ","label_your_name":"이름","label_your_permissions":"권한: ","last_seen_timestamp":"마지막으로본","leave_chat_warning":"이대화를나가시겠습니까?","link_contact_us":"문의처","link_privacy_policy":"개인정보보호정책","link_terms_of_service":"서비스약관","login_prompt":"로그인","menu_item_archive_topic":"보관","menu_item_block":"차단","menu_item_clear_messages":"메시지지우기","menu_item_clear_messages_for_all":"모두지우기","menu_item_delete":"삭제","menu_item_delete_for_all":"모두삭제","menu_item_delete_topic":"삭제","menu_item_edit_permissions":"편집권한","menu_item_info":"정보","menu_item_member_delete":"제거","menu_item_mute":"음소거","menu_item_restore_topic":"복원","menu_item_send_retry":"다시시도","menu_item_unblock":"차단해제","menu_item_unmute":"음소거해제","message_sending":"보내기...","message_sending_failed":"실패","messages_not_readable":"메시지에 액세스 할 수 없습니다","messaging_disabled_prompt":"메시지비활성화","more_online_members":"+{넘침}더보기","new_message_prompt":"새메시지","new_password_placeholder":"새비밀번호입력","no_connection":"연결없음","no_contacts":"연락처가없습니다 (._.)","numeric_confirmation_code_prompt":"숫자만","online_now":"현재접속중","password_prompt":"비밀번호","password_unchanged_prompt":"변경되지않음","peers_messaging_disabled":"동료의메시지가비활성화되었습니다.","permission_admin":"승인({val})","permission_delete":"삭제({val})","permission_join":"참여({val})","permission_owner":"소유자({val})","permission_pres":"알림받기({val})","permission_read":"읽기({val})","permission_share":"공유({val})","permission_write":"쓰기({val})","phone_dative":"전화","private_editing_placeholder":"나만볼수있습니다","push_init_failed":"푸시알림을초기화하지못했습니다","reconnect_countdown":"연결이끊어졌습니다.다시연결하는중{초}…","reconnect_now":"지금시도","reload_update":"재로드","report_chat_warning":"이대화를차단하고기록하시겠습니까?","requested_permissions":"요청","save_attachment":"저장","search_for_contacts":"검색을사용하여연락처찾기","search_no_results":"검색결과가없습니다","search_placeholder":"email:alice@example.com,tel:17025550003...와같은목록","sidepanel_title_acc_notifications":"알림","sidepanel_title_acc_support":"지원","sidepanel_title_account_settings":"계정설정","sidepanel_title_archive":"보관된채팅","sidepanel_title_blocked":"차단된채팅","sidepanel_title_cred":"자격증명확인","sidepanel_title_login":"로그인","sidepanel_title_newtpk":"새채팅시작","sidepanel_title_register":"계정만들기","sidepanel_title_reset":"비밀번호재설정","sidepanel_title_settings":"설정","stay_logged_in":"로그인상태유지","tabtitle_find_user":"찾기","tabtitle_group_by_id":"id로","tabtitle_new_group":"새그룹","tags_editor_no_tags":"일부태그추가","tags_not_found":"태그가정의되지않았습니다.일부를추가하십시오.","title_all_contacts":"모든연락처","title_group_members":"그룹구성원","title_manage_tags":"관리","title_not_found":"찾을수없음","title_permissions":"권한","title_tag_manager":"태그(사용자검색)","topic_block_warning":"이대화를차단하시겠습니까?","topic_delete_warning":"이대화를삭제하시겠습니까?","topic_name_editing_placeholder":"그룹의자유형이름","unnamed_topic":"이름없는","update_available":"업데이트가능.","upload_finishing":"마무리...","user_not_found":"찾을수없음","validate_credential_action":"확인","description_editing_placeholder":"설명(선택 사항)","label_description":"설명","button_security":"보안","panel_title_crop":"드래그하여 조정","panel_title_general":"일반","panel_title_members":"구성원","panel_title_security":"보안","panel_title_info":"정보","permissions_anonymous":"익명","permissions_authenticated":"인증됨","topic_delete":"채팅 삭제","permissions_user":"사용자 권한","password_reset_email_sent":"이메일이 {email}(으)로 전송되었습니다. 이메일의 지침에 따라 비밀번호를 재설정하세요.","label_unarchive_topic":"보관됨:","menu_item_reply":"회신하다","menu_item_forward":"리디렉션","forward_to":"메시지를 리디렉션","forward_to_search_placeholder":"연락처 검색","label_new_password":"새 비밀번호","drafty_unknown":"지원되지 않음","calls_incoming":"수신 전화","calls_outgoing":"발신 전화","calls_you_label":"너","menu_item_video_call":"영상 통화","already_in_call":"당신은 이미 말하고 있습니다!","call_cancelled":"취소 된","call_missed":"부재중","call_declined":"통화 거부","call_disconnected":"연결 끊김","label_use_secure_connection":"보안 연결 사용","phone_or_email_prompt":"전화번호 또는 이메일","cred_confirmed_successfully":"성공적으로 확인됨"},"ro":{"action_block_contact":"Blochează contact","action_cancel":"anulează","action_clear_messages":"Șterge mesajele","action_delete_messages":"Șterge toate mesajele","action_leave_chat":"Ieși din conversație","action_report_chat":"Raportează conversația","archived_contacts":"Contacte arhivate ({count})","badge_danger":"Suspicios","badge_owner":"owner","badge_staff":"Administrare","badge_verified":"Verificat","badge_you":"tu","block_contact_warning":"Ești sigur că dorești să blochezi acest contact?","blocked_contacts_link":"Contact blocate ({count})","button_add_another":"Adaugă","button_add_members":"Adaugă persoane","button_cancel":"Anulează","button_confirm":"Confirmă","button_create":"Creează","button_delete_account":"Șterge cont","button_edit":"Editează","button_logout":"Deconectare","button_ok":"OK","button_reset":"Resetează","button_send_request":"Trimite cerere","button_sign_in":"Conectează-te","button_sign_up":"Creează cont","button_subscribe":"Subscribe","button_update":"Actualizează","cannot_initiate_file_upload":"Nu se poate face încărcarea.","channel":"canal","channel_prompt":"Acesta este un canal","chat_invitation":"Ai primit invitație într-o conversație. Accepți?","chat_invitation_accept":"Da, accept","chat_invitation_block":"Blochează","chat_invitation_ignore":"Ignoră","clear_messages_warning":"Ești sigur că dorești să ștergi mesajele? Acestea nu pot fi recuperate.","code_doesnot_match":"Codul furnizat nu este valid","contacts_not_found":"Nu ai contacte salvate<br />¯∖_(ツ)_/¯","contacts_not_found_short":"Niciun contact găsit după criteriile \'\'{query}\'\'","credential_email_prompt":"Adresa de e-mail","delete_account":"Șterge contul","delete_account_warning":"Ești sigur că dorești să ștergi contul? Acesta nu va putea fi recuperat.","delete_messages_warning":"Ești sigur că dorești să șterge mesajele din toate conversațiile? Acestea nu pot fi recuperate.","deleted_content":"conținut șters","download_action":"download","drafty_attachment":"Atasament","drafty_form":"Formă:","drafty_image":"Imagine","email_dative":"email","email_prompt":"Adresa de e-mail","enable_peers_messaging":"Activează","enter_confirmation_code_prompt":"Introu codul de confirmare trimis pe {method}:","error_invalid_id":"ID Invalid","file_attachment_too_large":"Dimensiunea fișiterului {size} depășește limita de {limit}.","forgot_password_link":"Ți-ai uitat parola?","full_name_prompt":"Numele tău","granted_permissions":"Oferite","group_has_no_members":"În acest grup nu se află persoane","group_user_id_prompt":"Grup sau user ID","image_caption_prompt":"Titlul imaginii","invalid_content":"conținut invalid","invalid_security_token":"Codul de securitate este invalid","label_client":"Client:","label_content_type":"Tip conținut:","label_default_access_mode":"Default access mode:","label_file_name":"Nume fișier:","label_group_members":"Membrii grupului:","label_incognito_mode":"Mod incognito:","label_message_sound":"Sunet de mesaj:","label_muting_topic":"Mod silențios (muted):","label_other_user":"Altele","label_password":"Parola","label_permissions":"Permisiuni:","label_private":"Comentariu privat","label_push_notifications":"Alerte de notificare:","label_push_notifications_disabled":"Alerte de notificare (necesită HTTPS):","label_reset_password":"Resetează parola:","label_sdk":"SDK:","label_server":"Server:","label_server_address":"Adresa serverului:","label_server_to_use":"Server de utilizat:","label_size":"Size:","label_topic_name":"Nume","label_user_contacts":"Contacte:","label_user_id":"ID:","label_wire_transport":"Transportul legat:","label_you":"Tu:","label_your_name":"Numele tău","label_your_permissions":"Permisiuniile tale:","last_seen_timestamp":"Văzut ultima dată","leave_chat_warning":"Ești sigur că dorești să ieși din conersație?","link_contact_us":"Contactează-ne","link_privacy_policy":"Politica de Confidențialitate","link_terms_of_service":"Termenii Serviciului","login_prompt":"Conectează-te","menu_item_archive_topic":"Arhivează","menu_item_block":"Blochează","menu_item_clear_messages":"Șterge mesajele","menu_item_clear_messages_for_all":"Ștergele pe toate","menu_item_delete":"Șterge","menu_item_delete_for_all":"Ștergele pe toate","menu_item_delete_topic":"Șterge","menu_item_edit_permissions":"Editează permisiuni","menu_item_info":"Info","menu_item_member_delete":"Șterge persoană","menu_item_mute":"Mute","menu_item_restore_topic":"Restabili","menu_item_send_retry":"Reîncearcă","menu_item_unblock":"Deblochează","menu_item_unmute":"Unmute","message_sending":"se trimite...","message_sending_failed":"eroare","messages_not_readable":"Mesajele nu pot fi citite","messaging_disabled_prompt":"Mesageria este dezactivată","more_online_members":"+{overflow} mai mult","new_message_prompt":"Mesaj nou","new_password_placeholder":"Introdu parolă","no_connection":"Nu există conexiune","no_contacts":"Nu ai contacte adăugate :-(","numeric_confirmation_code_prompt":"Doar cifre","online_now":"online acum","password_prompt":"Parola","password_unchanged_prompt":"Neschimbată","peers_messaging_disabled":"Mesageria de tip Peer este dezactivată.","permission_admin":"Aprobare ({val})","permission_delete":"Ștergere ({val})","permission_join":"Participare ({val})","permission_owner":"Deținător ({val})","permission_pres":"Notificare ({val})","permission_read":"Citire ({val})","permission_share":"Distribuire ({val})","permission_write":"Scriere ({val})","phone_dative":"telefon","private_editing_placeholder":"Vizibil doar ție","push_init_failed":"Nu s-a reușit inițializarea tip push notifications","reconnect_countdown":"Deconectat. Se încearcă conectarea în {seconds}…","reconnect_now":"Încearcă din nou","reload_update":"Reîncarcă","report_chat_warning":"Ești sigur că dorești să blochezi și să raportezi această conversație?","requested_permissions":"Necesare","save_attachment":"salvează","search_for_contacts":"Caută în contacte","search_no_results":"Nu s-au găsit rezultate","search_placeholder":"Caută după e-mail sau număr telefon...","sidepanel_title_acc_notifications":"Notificări","sidepanel_title_acc_support":"Ajutor","sidepanel_title_account_settings":"Setările Contului","sidepanel_title_archive":"Conversații Arhivate","sidepanel_title_blocked":"Conversații Blocate","sidepanel_title_cred":"Confirmă credențiale","sidepanel_title_login":"Conectează-te","sidepanel_title_newtpk":"Creeză un nou Chat","sidepanel_title_register":"Creează Cont","sidepanel_title_reset":"Resetează Parola","sidepanel_title_settings":"Setări","stay_logged_in":"Rămâi conectat","tabtitle_find_user":"caută","tabtitle_group_by_id":"după id","tabtitle_new_group":"grup nou","tags_editor_no_tags":"Adaugă tag-uri","tags_not_found":"Niciun tag definit. Adaugă.","title_all_contacts":"Toate Contactele","title_group_members":"Persoanele din grup","title_manage_tags":"Administrează","title_not_found":"Nu a fost găsit","title_permissions":"Permisiuni","title_tag_manager":"Tag-uri (user discovery)","topic_block_warning":"Ești sigur că dorești să blochezi această conversație?","topic_delete_warning":"Ești sigur că dorești să șterge această conversație?","topic_name_editing_placeholder":"Numele grupului","unnamed_topic":"Nedenumit","update_available":"Actualizare disponibilă.","upload_finishing":"se încarcă...","user_not_found":"Utilizatorul nu a fost găsit","validate_credential_action":"confirmă","description_editing_placeholder":"Descriere (opțional)","label_description":"Descriere","button_security":"Securitate","panel_title_crop":"Trageți pentru a ajusta","panel_title_general":"Generale","panel_title_members":"Membri","panel_title_security":"Securitate","panel_title_info":"Info","permissions_anonymous":"Anonim","permissions_authenticated":"Autentificat","topic_delete":"Ștergeți Chat","permissions_user":"Permisiunile utilizatorului","password_reset_email_sent":"Un e-mail a fost trimis către {email}. Urmați instrucțiunile din e-mail pentru a vă reseta parola.","label_unarchive_topic":"Arhivat:","menu_item_reply":"A raspunde","menu_item_forward":"Redirecţiona","forward_to":"Redirecționați către","forward_to_search_placeholder":"Căutați contacte","label_new_password":"Parolă Nouă","drafty_unknown":"Neacceptat","calls_incoming":"Apel primit","calls_outgoing":"Apel efectuat","calls_you_label":"Tu","menu_item_video_call":"Apel video","already_in_call":"Deja vorbesti!","call_cancelled":"anulat","call_missed":"pierdut","call_declined":"refuzat","call_disconnected":"deconectat","label_use_secure_connection":"Utilizați conexiune securizată","phone_or_email_prompt":"Număr de telefon sau e-mail","cred_confirmed_successfully":"Confirmat cu succes"},"ru":{"action_block_contact":"Заблокировать контакт","action_cancel":"отменить","action_clear_messages":"Удалить сообщения","action_delete_messages":"Удалить сообщения","action_leave_chat":"Уйти из чата","action_report_chat":"Сообщить о нарушении","archived_contacts":"Чаты в архиве ({count})","badge_danger":"Подозрительный","badge_owner":"влад.","badge_staff":"Администрация","badge_verified":"Верифицированный","badge_you":"вы","block_contact_warning":"Вы действительно заблокировать этот контакт?","blocked_contacts_link":"Заблокированные ({count})","button_add_another":"Добавить","button_add_members":"Добавить","button_cancel":"Отменить","button_confirm":"Подтвердить","button_create":"Создать","button_delete_account":"Удалить аккаунт","button_edit":"Изменить","button_logout":"Выйти","button_ok":"OK","button_reset":"Изменить","button_send_request":"Отправить","button_sign_in":"Войти","button_sign_up":"Создать аккаунт","button_subscribe":"Подписаться","button_update":"Применить","cannot_initiate_file_upload":"Ошибка загрузки файла.","channel":"канал","channel_prompt":"Создать канал","chat_invitation":"Вас пригласили начать новый чат. Как вы хотите поступить?","chat_invitation_accept":"Принять","chat_invitation_block":"Заблокировать","chat_invitation_ignore":"Игнорировать","clear_messages_warning":"Вы действительно хотите удалить все сообщения в чате? Их будет невозможно восстановить.","code_doesnot_match":"Код не совпадает","contacts_not_found":"Чатов нет<br />¯∖_(ツ)_/¯","contacts_not_found_short":"Нет контактов для запроса \'\'{query}\'\'","credential_email_prompt":"Регистрационный емейл","delete_account":"Удалить аккаунт","delete_account_warning":"Вы уверены, что ходите удалить свой аккаунт? Его невозможно будет восстановить.","delete_messages_warning":"Вы действительно хотите удалить все сообщения?","deleted_content":"удалено","download_action":"скачать","drafty_attachment":"Аттачмент","drafty_form":"Форма:","drafty_image":"Картинка","email_dative":"емейлу","email_prompt":"Email, напр. ivan@example.com","enable_peers_messaging":"Разблокировать.","enter_confirmation_code_prompt":"Код подтверждения, полученный по {method}:","error_invalid_id":"Неверный ID","file_attachment_too_large":"Размер файла {size} превышает {limit} лимит.","forgot_password_link":"Напомнить пароль","full_name_prompt":"Полное имя, напр. Иван Петров","granted_permissions":"Получены","group_has_no_members":"Нет участников","group_user_id_prompt":"ID чата или пользователя","image_caption_prompt":"Подпись к фото","invalid_content":"сообщение не читается","invalid_security_token":"Токен некорректен","label_client":"Клиент:","label_content_type":"Тип:","label_default_access_mode":"Доступ по умолчанию:","label_file_name":"Имя файла:","label_group_members":"Участники чата:","label_incognito_mode":"Режим инкогнито:","label_message_sound":"Звук нового сообщения:","label_muting_topic":"Без уведомлений","label_other_user":"Второй","label_password":"Пароль","label_permissions":"Права доступа:","label_private":"Комментарий","label_push_notifications":"Уведомления:","label_push_notifications_disabled":"Уведомления (требуют HTTPS):","label_reset_password":"Отправить емейл для смены пароля:","label_sdk":"SDK:","label_server":"Сервер:","label_server_address":"Адрес сервера:","label_server_to_use":"Использовать сервер:","label_size":"Размер:","label_topic_name":"Название","label_user_contacts":"Конакты:","label_user_id":"ID:","label_wire_transport":"Соединение:","label_you":"Вы:","label_your_name":"Ваше имя","label_your_permissions":"Ваши права доступа:","last_seen_timestamp":"Был активен","leave_chat_warning":"Вы действительно хотите покинуть этот чат?","link_contact_us":"Связаться с нами","link_privacy_policy":"Политика конфиденциальности","link_terms_of_service":"Условия сервиса","login_prompt":"Логин","menu_item_archive_topic":"В архив","menu_item_block":"Заблокировать","menu_item_clear_messages":"Удалить сообщения","menu_item_clear_messages_for_all":"Удалить для всех","menu_item_delete":"Удалить","menu_item_delete_for_all":"Удалить для всех","menu_item_delete_topic":"Удалить чат","menu_item_edit_permissions":"Права доступа","menu_item_info":"Информация","menu_item_member_delete":"Отписать","menu_item_mute":"Не уведомлять","menu_item_restore_topic":"Разархивировать","menu_item_send_retry":"Отправить заново","menu_item_unblock":"Разблокировать","menu_item_unmute":"Уведомлять","message_sending":"в пути...","message_sending_failed":"ошибка","messages_not_readable":"нет доступа к сообщениям","messaging_disabled_prompt":"Отправка недоступна","more_online_members":"+еще {overflow}","new_message_prompt":"Новое сообщение","new_password_placeholder":"Введите новый пароль","no_connection":"Нет связи","no_contacts":"Ничего нет :-(","numeric_confirmation_code_prompt":"Только цифры","online_now":"онлайн","password_prompt":"Пароль","password_unchanged_prompt":"Не изменен","peers_messaging_disabled":"Чат заблокирован у корреспондента.","permission_admin":"Подтверждать ({val})","permission_delete":"Удалять ({val})","permission_join":"Подписываться ({val})","permission_owner":"Владелец ({val})","permission_pres":"Уведомлять ({val})","permission_read":"Читать ({val})","permission_share":"Приглашать ({val})","permission_write":"Писать ({val})","phone_dative":"телефону","private_editing_placeholder":"Виден только вам","push_init_failed":"Ошибка инициализации пуш уведомлений","reconnect_countdown":"Нет связи. Подключение через {seconds}…","reconnect_now":"Подключить сейчас.","reload_update":"Обновить","report_chat_warning":"Вы действительно хотите сообщить о нарушении и заблокировать этот чат?","requested_permissions":"Требуются","save_attachment":"сохранить","search_for_contacts":"Поиск контактов","search_no_results":"Ничего не найдено","search_placeholder":"Список, напр. email:alice@example.com, tel:+17025550003...","sidepanel_title_acc_notifications":"Уведомления","sidepanel_title_acc_support":"Поддержка","sidepanel_title_account_settings":"Настройки аккаунта","sidepanel_title_archive":"Архив чатов","sidepanel_title_blocked":"Заблокированные чаты","sidepanel_title_cred":"Подтвердить","sidepanel_title_login":"Авторизация","sidepanel_title_newtpk":"Новый чат","sidepanel_title_register":"Зарегистрироваться","sidepanel_title_reset":"Сменить пароль","sidepanel_title_settings":"Настройки","stay_logged_in":"Запомнить","tabtitle_find_user":"найти","tabtitle_group_by_id":"по id","tabtitle_new_group":"создать","tags_editor_no_tags":"Добавьте теги","tags_not_found":"Тегов нет. Добавьте","title_all_contacts":"Все контакты","title_group_members":"Участники","title_manage_tags":"Редактировать","title_not_found":"Не найден","title_permissions":"Права доступа","title_tag_manager":"Теги для поиска","topic_block_warning":"Вы действительно хотите заблокировать этот чат?","topic_delete_warning":"Вы действительно хотите удалить этот чат?","topic_name_editing_placeholder":"Название чата","unnamed_topic":"Без названия","update_available":"Есть новая версия приложения.","upload_finishing":"завершение...","user_not_found":"Не найден","validate_credential_action":"подтвердить","description_editing_placeholder":"Описание (не обязательно)","label_description":"Описание","button_security":"Безопасность","panel_title_crop":"Обрезать картинку","panel_title_general":"Общие настройки","panel_title_members":"Участники","panel_title_security":"Безопасность","panel_title_info":"Подробности","permissions_anonymous":"Анонимный","permissions_authenticated":"Авторизованный","topic_delete":"Удалить чат","permissions_user":"Права доступа","password_reset_email_sent":"Сообщение было отправлено на адрес {email}. Следуйте инструкциям в сообщении, чтобы изменить пароль.","label_unarchive_topic":"Архивирован:","menu_item_reply":"Ответить","menu_item_forward":"Переслать","forward_to":"Переслать","forward_to_search_placeholder":"Поиск контактов","label_new_password":"Новый пароль","drafty_unknown":"Не поддерживается","calls_incoming":"Входящий звонок","calls_outgoing":"Исходящий звонок","calls_you_label":"Вы","menu_item_video_call":"Видеозвонок","already_in_call":"Вы уже звоните кому-то!","call_cancelled":"отменен","call_missed":"пропущен","call_declined":"отклонен","call_disconnected":"разъединен","label_use_secure_connection":"Безопасное соединение","phone_or_email_prompt":"Телефон или емейл","cred_confirmed_successfully":"Подтверждено успешно"},"zh-TW":{"action_block_contact":"封鎖聯絡人","action_cancel":"取消","action_clear_messages":"清除訊息","action_delete_messages":"為所有人清除訊息","action_leave_chat":"離開對話","action_report_chat":"檢舉對話","archived_contacts":"已封存的聯絡人 ({count})","badge_danger":"不可信","badge_owner":"擁有者","badge_staff":"員工管理","badge_verified":"已驗證/官方","badge_you":"您","block_contact_warning":"您確定要封鎖此聯絡人嗎？","blocked_contacts_link":"已封鎖的聯絡人 ({count})","button_add_another":"新增其他人","button_add_members":"新增成員","button_cancel":"取消","button_confirm":"確認","button_create":"建立","button_delete_account":"刪除帳號","button_edit":"編輯","button_logout":"登出","button_ok":"OK","button_reset":"重設","button_send_request":"傳送要求","button_sign_in":"登入","button_sign_up":"註冊","button_subscribe":"訂閱","button_update":"更新","cannot_initiate_file_upload":"無法為檔案上傳初始化。","channel":"頻道","channel_prompt":"這是頻道","chat_invitation":"您已被邀請開始新對話。您接下來要做什麼呢？","chat_invitation_accept":"接受","chat_invitation_block":"封鎖","chat_invitation_ignore":"忽略","clear_messages_warning":"您確定要清除所有訊息嗎？此操作無法復原。","code_doesnot_match":"代碼不相符","contacts_not_found":"您沒有任何對話<br />¯∖_(ツ)_/¯","contacts_not_found_short":"沒有符合 \'\'{query}\'\' 的聯絡人","credential_email_prompt":"您的註冊電子郵件地址","delete_account":"刪除帳號","delete_account_warning":"您確定要刪除您的帳戶嗎？此操作無法撤消。","delete_messages_warning":"您確定要為所有人刪除所有訊息嗎？此操作無法復原。","deleted_content":"內容已被刪除","download_action":"下載","drafty_attachment":"附加檔案","drafty_form":"表單：","drafty_image":"圖片","email_dative":"電子郵件地址","email_prompt":"電子郵件地址，例如：jdoe@example.com","enable_peers_messaging":"啟用","enter_confirmation_code_prompt":"輸入透過 {method} 傳送給您的確認碼：","error_invalid_id":"ID 無效","file_attachment_too_large":"檔案大小 {size} 超出 {limit} 限制。","forgot_password_link":"忘記密碼？","full_name_prompt":"全名，例如：王小明","granted_permissions":"已授權","group_has_no_members":"無成員","group_user_id_prompt":"群組或使用者 ID","image_caption_prompt":"圖片說明","invalid_content":"內容無效","invalid_security_token":"安全權杖無效","label_client":"客戶端：","label_content_type":"類型：","label_default_access_mode":"預設存取模式：","label_file_name":"檔名：","label_group_members":"群組成員：","label_incognito_mode":"無痕模式：","label_message_sound":"訊息提示聲：","label_muting_topic":"靜音：","label_other_user":"其他","label_password":"密碼","label_permissions":"權限：","label_private":"私人留言","label_push_notifications":"通知：","label_push_notifications_disabled":"通知 (需要 HTTPS)：","label_reset_password":"傳送重設密碼郵件：","label_sdk":"SDK：","label_server":"伺服器：","label_server_address":"伺服器位址：","label_server_to_use":"使用的伺服器：","label_size":"大小：","label_topic_name":"名稱","label_user_contacts":"聯絡人：","label_user_id":"ID：","label_wire_transport":"Wire transport：","label_you":"您：","label_your_name":"您的名字","label_your_permissions":"您的權限：","last_seen_timestamp":"最後上線","leave_chat_warning":"您確定要離開此對話嗎？","link_contact_us":"聯絡我們","link_privacy_policy":"隱私權政策","link_terms_of_service":"服務條款","login_prompt":"登入","menu_item_archive_topic":"封存","menu_item_block":"封鎖","menu_item_clear_messages":"清除訊息","menu_item_clear_messages_for_all":"為所有人清除訊息","menu_item_delete":"刪除","menu_item_delete_for_all":"為所有人刪除","menu_item_delete_topic":"刪除","menu_item_edit_permissions":"編輯權限","menu_item_info":"Info","menu_item_member_delete":"移除","menu_item_mute":"靜音","menu_item_restore_topic":"恢復","menu_item_send_retry":"重試","menu_item_unblock":"解除封鎖","menu_item_unmute":"解除靜音","message_sending":"正在傳送...","message_sending_failed":"失敗","messages_not_readable":"沒有存取訊息的權限","messaging_disabled_prompt":"停用訊息","more_online_members":"+{overflow}","new_message_prompt":"新訊息","new_password_placeholder":"輸入新的密碼","no_connection":"無連線","no_contacts":"您沒有任何聯絡人 :-(","numeric_confirmation_code_prompt":"僅數字","online_now":"上線中","password_prompt":"密碼","password_unchanged_prompt":"未修改","peers_messaging_disabled":"Peer 已停用訊息。","permission_admin":"核可 ({val})","permission_delete":"刪除 ({val})","permission_join":"加入 ({val})","permission_owner":"擁有者 ({val})","permission_pres":"收到通知 ({val})","permission_read":"讀取 ({val})","permission_share":"分享 ({val})","permission_write":"撰寫 ({val})","phone_dative":"phone","private_editing_placeholder":"僅您可見","push_init_failed":"初始化通知失敗。","reconnect_countdown":"已斷線。將在 {seconds} 秒後重新連線…","reconnect_now":"現在重試","reload_update":"重新載入","report_chat_warning":"您確定要封鎖並檢舉此對話嗎？","requested_permissions":"重新請求","save_attachment":"儲存","search_for_contacts":"使用搜尋來尋找聯絡人","search_no_results":"搜尋無結果","search_placeholder":"例如 email:alice@example.com, tel:17025550003... 的清單","sidepanel_title_acc_notifications":"通知","sidepanel_title_acc_support":"支援","sidepanel_title_account_settings":"帳號設定","sidepanel_title_archive":"已封存的對話","sidepanel_title_blocked":"已封鎖的對話","sidepanel_title_cred":"確認認證","sidepanel_title_login":"登入","sidepanel_title_newtpk":"開始新對話","sidepanel_title_register":"建立帳號","sidepanel_title_reset":"重設密碼","sidepanel_title_settings":"設定","stay_logged_in":"保持登入","tabtitle_find_user":"尋找","tabtitle_group_by_id":"以 id","tabtitle_new_group":"新群組","tags_editor_no_tags":"新增一些標籤","tags_not_found":"未定義任何標籤。請新增一些標籤。","title_all_contacts":"所有聯絡人","title_group_members":"群組成員","title_manage_tags":"管理","title_not_found":"找不到","title_permissions":"權限","title_tag_manager":"標籤 (使用者探索)","topic_block_warning":"您確定要封鎖此對話嗎？","topic_delete_warning":"您確定要刪除此對話嗎？","topic_name_editing_placeholder":"群組的任意名稱","unnamed_topic":"未命名","update_available":"有可用的更新。","upload_finishing":"正在完成...","user_not_found":"找不到","validate_credential_action":"確認","description_editing_placeholder":"說明（可選）","label_description":"說明","button_security":"安全性","panel_title_crop":"拖動調整","panel_title_general":"一般","panel_title_members":"成員","panel_title_security":"安全性","panel_title_info":"資訊","permissions_anonymous":"匿名","permissions_authenticated":"已認證","topic_delete":"刪除聊天","permissions_user":"用戶權限","password_reset_email_sent":"一封電子郵件已發送至 {email}。按照電子郵件中的說明重置密碼。","label_unarchive_topic":"存檔聊天：","menu_item_reply":"回答","menu_item_forward":"重定向","forward_to":"重定向消息","forward_to_search_placeholder":"搜索聯繫人","label_new_password":"新密碼","drafty_unknown":"不支持","calls_incoming":"來電","calls_outgoing":"撥出電話","calls_you_label":"你","menu_item_video_call":"視頻電話","already_in_call":"你已經在說話了！","call_cancelled":"取消","call_missed":"未接","call_declined":"被拒","call_disconnected":"斷開連接","label_use_secure_connection":"使用安全連接","phone_or_email_prompt":"電話號碼或電子郵件","cred_confirmed_successfully":"確認成功"},"zh":{"action_block_contact":"屏蔽联系人","action_cancel":"取消","action_clear_messages":"删除讯息","action_delete_messages":"删除所有帖子","action_leave_chat":"离开","action_report_chat":"检举垃圾邮件","archived_contacts":"已归档联系人 ({count})","badge_danger":"可疑的","badge_owner":"所有者","badge_staff":"在员工管理下","badge_verified":"值得信赖","badge_you":"你","block_contact_warning":"您确定要阻止此联系人吗？","blocked_contacts_link":"封锁的联络人 ({count})","button_add_another":"加上另一个","button_add_members":"添加成员","button_cancel":"取消","button_confirm":"确认","button_create":"创建","button_delete_account":"删除帐户","button_edit":"编辑","button_logout":"登出","button_ok":"好","button_reset":"重置","button_send_request":"发送请求","button_sign_in":"登录","button_sign_up":"注册","button_subscribe":"订阅","button_update":"更新","cannot_initiate_file_upload":"无法初始化文件上传。","channel":"频道","channel_prompt":"这是一个频道","chat_invitation":"你受邀开始新会话。你想怎么做？","chat_invitation_accept":"接受","chat_invitation_block":"屏蔽","chat_invitation_ignore":"忽略","clear_messages_warning":"您确定要清除所有消息吗？无法撤消。","code_doesnot_match":"代码不匹配","contacts_not_found":"你尚无会话<br />¯∖_(ツ)_/¯","contacts_not_found_short":"无联系人匹配\'\'{query}\'\'","credential_email_prompt":"你的注册邮箱","delete_account":"删除帐户","delete_account_warning":"您确定要删除您的帐户吗？无法撤消。","delete_messages_warning":"您确定要删除所有消息吗？无法撤消。","deleted_content":"内容已删除","download_action":"下载","drafty_attachment":"附件","drafty_form":"形式：","drafty_image":"图像","email_dative":"电子邮件","email_prompt":"电子邮件，例如 zhang@example.com","enable_peers_messaging":"启用","enter_confirmation_code_prompt":"输入通过{method}发送的验证码：","error_invalid_id":"无效 ID","file_attachment_too_large":"文件大小 {size} 超过 {limit} 限制。","forgot_password_link":"忘记密码？","full_name_prompt":"全名，例如张伟","granted_permissions":"已授予","group_has_no_members":"无成员","group_user_id_prompt":"群组或用户 ID","image_caption_prompt":"图片标题","invalid_content":"无效内容","invalid_security_token":"无效的安全令牌","label_client":"客户端：","label_content_type":"内容类型：","label_default_access_mode":"蓦然访问模式：","label_file_name":"文件名：","label_group_members":"群组成员：","label_incognito_mode":"无痕模式：","label_message_sound":"消息提示音：","label_muting_topic":"已静音：","label_other_user":"其他","label_password":"密码","label_permissions":"权限：","label_private":"私人评论","label_push_notifications":"通知提醒：","label_push_notifications_disabled":"通知提醒（需要 HTTPS）：","label_reset_password":"发送密码重置邮件：","label_sdk":"开发包：","label_server":"服务器：","label_server_address":"服务器地址：","label_server_to_use":"使用的服务器：","label_size":"大小：","label_topic_name":"名称","label_user_contacts":"往来：","label_user_id":"地址：","label_wire_transport":"线路传输：","label_you":"你：","label_your_name":"你的姓名","label_your_permissions":"你的权限：","last_seen_timestamp":"最后可见","leave_chat_warning":"您确定要退出此对话吗？","link_contact_us":"联系我们","link_privacy_policy":"隐私政策","link_terms_of_service":"条款和条件","login_prompt":"登录","menu_item_archive_topic":"归档","menu_item_block":"屏蔽","menu_item_clear_messages":"清空消息","menu_item_clear_messages_for_all":"全部清除","menu_item_delete":"删除","menu_item_delete_for_all":"全部删除","menu_item_delete_topic":"删除","menu_item_edit_permissions":"编辑权限","menu_item_info":"信息","menu_item_member_delete":"移除","menu_item_mute":"静音","menu_item_restore_topic":"从存档中恢复","menu_item_send_retry":"重试","menu_item_unblock":"取消屏蔽","menu_item_unmute":"取消静音","message_sending":"正在发送...","message_sending_failed":"发送失败","messages_not_readable":"无消息访问权限","messaging_disabled_prompt":"消息已禁用","more_online_members":"还有{overflow}个","new_message_prompt":"新消息","new_password_placeholder":"输入新密码","no_connection":"无连接","no_contacts":"你尚无联系人 (._.)","numeric_confirmation_code_prompt":"仅数字","online_now":"在线","password_prompt":"密码","password_unchanged_prompt":"未改变","peers_messaging_disabled":"成员间消息已禁用。","permission_admin":"批准 ({val})","permission_delete":"删除 ({val})","permission_join":"加入 ({val})","permission_owner":"所有者 ({val})","permission_pres":"获取通知 ({val})","permission_read":"读取 ({val})","permission_share":"分享 ({val})","permission_write":"写入 ({val})","phone_dative":"电话","private_editing_placeholder":"仅自己可见","push_init_failed":"初始化推送通知失败","reconnect_countdown":"连接已断开。{seconds} 秒后重新连接…","reconnect_now":"立即尝试","reload_update":"重新载入","report_chat_warning":"您确定要停止并报告此对话吗？","requested_permissions":"已请求","save_attachment":"保存","search_for_contacts":"使用搜索寻找联系人","search_no_results":"搜索返回任何结果","search_placeholder":"列表如 email:alice@example.com, tel:+17025550003...","sidepanel_title_acc_notifications":"通知","sidepanel_title_acc_support":"支持","sidepanel_title_account_settings":"帐号设定","sidepanel_title_archive":"已存档会话","sidepanel_title_blocked":"被阻止的聊天","sidepanel_title_cred":"确认凭据","sidepanel_title_login":"登录","sidepanel_title_newtpk":"开始新会话","sidepanel_title_register":"创建账户","sidepanel_title_reset":"重置密码","sidepanel_title_settings":"设置","stay_logged_in":"保持登录","tabtitle_find_user":"搜索","tabtitle_group_by_id":"通过 id","tabtitle_new_group":"新群组","tags_editor_no_tags":"添加一些标签","tags_not_found":"尚未定义标签。添加一些。","title_all_contacts":"全部联系人","title_group_members":"群组成员","title_manage_tags":"管理标签","title_not_found":"无法找到","title_permissions":"权限","title_tag_manager":"标签（用户发现）","topic_block_warning":"您确定要阻止此对话吗？","topic_delete_warning":"您确定要删除此对话吗？","topic_name_editing_placeholder":"群组自由格式名称","unnamed_topic":"未命名","update_available":"更新可用。","upload_finishing":"正在结束...","user_not_found":"未找到","validate_credential_action":"确认","description_editing_placeholder":"说明（可选）","label_description":"说明","button_security":"安全","panel_title_crop":"拖动调整","panel_title_general":"常用设定","panel_title_members":"成员","panel_title_security":"安全","panel_title_info":"信息","permissions_anonymous":"匿名","permissions_authenticated":"已认证","topic_delete":"删除聊天","permissions_user":"用户权限","password_reset_email_sent":"一封电子邮件已发送至 {email}。按照电子邮件中的说明重置密码。","label_unarchive_topic":"存档：","menu_item_reply":"回复","menu_item_forward":"重定向","forward_to":"重定向消息","forward_to_search_placeholder":"搜索联系人","label_new_password":"新密码","drafty_unknown":"不支持","calls_incoming":"来电","calls_outgoing":"拨出电话","calls_you_label":"你","menu_item_video_call":"视频电话","already_in_call":"你已经在说话了！","call_cancelled":"取消","call_missed":"未接","call_declined":"被拒","call_disconnected":"断开连接","label_use_secure_connection":"使用安全连接","phone_or_email_prompt":"电话号码或电子邮件","cred_confirmed_successfully":"确认成功"}}'),s=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let a=e.charCodeAt(r);a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):55296==(64512&a)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++r)),t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t},l={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const a=e[t],i=t+1<e.length,o=i?e[t+1]:0,s=t+2<e.length,l=s?e[t+2]:0,c=a>>2,u=(3&a)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;s||(d=64,i||(h=64)),r.push(n[c],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(s(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const a=e[n++];if(a<128)t[r++]=String.fromCharCode(a);else if(a>191&&a<224){const i=e[n++];t[r++]=String.fromCharCode((31&a)<<6|63&i)}else if(a>239&&a<365){const i=((7&a)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))}else{const i=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&a)<<12|(63&i)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const a=n[e.charAt(t++)],i=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const s=t<e.length?n[e.charAt(t)]:64;if(++t,null==a||null==i||null==o||null==s)throw Error();const l=a<<2|i>>4;if(r.push(l),64!==o){const e=i<<4&240|o>>2;if(r.push(e),64!==s){const e=o<<6&192|s;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},c=function(e){return function(e){const t=s(e);return l.encodeByteArray(t,!0)}(e).replace(/\./g,"")},u=function(e){try{return l.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function h(){return"object"==typeof indexedDB}function d(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{var e;t((null===(e=a.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}const p=()=>function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,m=()=>{try{return p()||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&u(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}};class _{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}class g extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,f.prototype.create)}}class f{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,a=this.errors[e],i=a?function(e,t){return e.replace(y,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(a,n):"Error",o=`${this.serviceName}: ${i} (${r}).`;return new g(r,o,n)}}const y=/\{\$([^}]+)}/g;function v(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const a of n){if(!r.includes(a))return!1;const n=e[a],i=t[a];if(b(n)&&b(i)){if(!v(n,i))return!1}else if(n!==i)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function b(e){return null!==e&&"object"==typeof e}function x(e){return e&&e._delegate?e._delegate:e}class w{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const T="[DEFAULT]";class C{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new _;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:T})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e="[DEFAULT]"){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e="[DEFAULT]"){return this.instances.has(e)}getOptions(e="[DEFAULT]"){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(e)&&t.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),a=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;a.add(e),this.onInitCallbacks.set(r,a);const i=this.instances.get(r);return i&&e(i,r),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===T?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e="[DEFAULT]"){return this.component?this.component.multipleInstances?e:T:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class E{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new C(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const A=[];var S;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(S||(S={}));const D={debug:S.DEBUG,verbose:S.VERBOSE,info:S.INFO,warn:S.WARN,error:S.ERROR,silent:S.SILENT},R=S.INFO,N={[S.DEBUG]:"log",[S.VERBOSE]:"log",[S.INFO]:"info",[S.WARN]:"warn",[S.ERROR]:"error"},M=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),a=N[t];if(!a)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[a](`[${r}]  ${e.name}:`,...n)};let O,k;const I=new WeakMap,P=new WeakMap,L=new WeakMap,B=new WeakMap,F=new WeakMap;let H={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return P.get(e);if("objectStoreNames"===t)return e.objectStoreNames||L.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return V(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function q(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(k||(k=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(W(this),t),V(I.get(this))}:function(...t){return V(e.apply(W(this),t))}:function(t,...n){const r=e.call(W(this),t,...n);return L.set(r,t.sort?t.sort():[t]),V(r)}}function U(e){return"function"==typeof e?q(e):(e instanceof IDBTransaction&&function(e){if(P.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)}));P.set(e,t)}(e),t=e,(O||(O=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,H):e);var t}function V(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{t(V(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&I.set(t,e)})).catch((()=>{})),F.set(t,e),t}(e);if(B.has(e))return B.get(e);const t=U(e);return t!==e&&(B.set(e,t),F.set(t,e)),t}const W=e=>F.get(e);function z(e,t,{blocked:n,upgrade:r,blocking:a,terminated:i}={}){const o=indexedDB.open(e,t),s=V(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(V(o.result),e.oldVersion,e.newVersion,V(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),s.then((e=>{i&&e.addEventListener("close",(()=>i())),a&&e.addEventListener("versionchange",(()=>a()))})).catch((()=>{})),s}function Y(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(()=>t())),V(n).then((()=>{}))}const G=["get","getKey","getAll","getAllKeys","count"],X=["put","add","delete","clear"],$=new Map;function j(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if($.get(t))return $.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,a=X.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!G.includes(n))return;const i=async function(e,...t){const i=this.transaction(e,a?"readwrite":"readonly");let o=i.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),a&&i.done]))[0]};return $.set(t,i),i}H=(e=>({...e,get:(t,n,r)=>j(t,n)||e.get(t,n,r),has:(t,n)=>!!j(t,n)||e.has(t,n)}))(H);class K{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Z="@firebase/app",Q="0.8.4",J=new class{constructor(e){this.name=e,this._logLevel=R,this._logHandler=M,this._userLogHandler=null,A.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in S))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?D[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,S.DEBUG,...e),this._logHandler(this,S.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,S.VERBOSE,...e),this._logHandler(this,S.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,S.INFO,...e),this._logHandler(this,S.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,S.WARN,...e),this._logHandler(this,S.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,S.ERROR,...e),this._logHandler(this,S.ERROR,...e)}}("@firebase/app"),ee="[DEFAULT]",te={[Z]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},ne=new Map,re=new Map;function ae(e,t){try{e.container.addComponent(t)}catch(n){J.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function ie(e){const t=e.name;if(re.has(t))return J.debug(`There were multiple attempts to register component ${t}.`),!1;re.set(t,e);for(const t of ne.values())ae(t,e);return!0}function oe(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const se=new f("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class le{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new w("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw se.create("app-deleted",{appName:this._name})}}function ce(e,t={}){let n=e;if("object"!=typeof t){t={name:t}}const r=Object.assign({name:ee,automaticDataCollectionEnabled:!1},t),a=r.name;if("string"!=typeof a||!a)throw se.create("bad-app-name",{appName:String(a)});var i;if(n||(n=null===(i=m())||void 0===i?void 0:i.config),!n)throw se.create("no-options");const o=ne.get(a);if(o){if(v(n,o.options)&&v(r,o.config))return o;throw se.create("duplicate-app",{appName:a})}const s=new E(a);for(const e of re.values())s.addComponent(e);const l=new le(n,r,s);return ne.set(a,l),l}function ue(e,t,n){var r;let a=null!==(r=te[e])&&void 0!==r?r:e;n&&(a+=`-${n}`);const i=a.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const e=[`Unable to register library "${a}" with version "${t}":`];return i&&e.push(`library name "${a}" contains illegal characters (whitespace or "/")`),i&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void J.warn(e.join(" "))}ie(new w(`${a}-version`,(()=>({library:a,version:t})),"VERSION"))}const he="firebase-heartbeat-store";let de=null;function pe(){return de||(de=z("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(he)}}).catch((e=>{throw se.create("idb-open",{originalErrorMessage:e.message})}))),de}async function me(e,t){var n;try{const n=(await pe()).transaction(he,"readwrite"),r=n.objectStore(he);return await r.put(t,_e(e)),n.done}catch(e){if(e instanceof g)J.warn(e.message);else{const t=se.create("idb-set",{originalErrorMessage:null===(n=e)||void 0===n?void 0:n.message});J.warn(t.message)}}}function _e(e){return`${e.name}!${e.options.appId}`}class ge{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ye(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=fe();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=fe(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let r=e.slice();for(const a of e){const e=n.find((e=>e.agent===a.agent));if(e){if(e.dates.push(a.date),ve(n)>t){e.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),ve(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=c(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function fe(){return(new Date).toISOString().substring(0,10)}class ye{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!h()&&d().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){return await async function(e){var t;try{return(await pe()).transaction(he).objectStore(he).get(_e(e))}catch(e){if(e instanceof g)J.warn(e.message);else{const n=se.create("idb-get",{originalErrorMessage:null===(t=e)||void 0===t?void 0:t.message});J.warn(n.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return me(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return me(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function ve(e){return c(JSON.stringify({version:2,heartbeats:e})).length}var be;be="",ie(new w("platform-logger",(e=>new K(e)),"PRIVATE")),ie(new w("heartbeat",(e=>new ge(e)),"PRIVATE")),ue(Z,Q,be),ue(Z,Q,"esm2017"),ue("fire-js","");ue("firebase","9.14.0","app");const xe="@firebase/installations",we="0.5.16",Ce=1e4,Ee="w:0.5.16",Ae="FIS_v2",Se=36e5,De=new f("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Re(e){return e instanceof g&&e.code.includes("request-failed")}function Ne({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function Me(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function Oe(e,t){const n=(await t.json()).error;return De.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function ke({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function Ie(e,{refreshToken:t}){const n=ke(e);return n.append("Authorization",function(e){return`FIS_v2 ${e}`}(t)),n}async function Pe(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Le(e){return new Promise((t=>{setTimeout(t,e)}))}const Be=/^[cdef][\w-]{21}$/;function Fe(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var t}(e);return Be.test(t)?t:""}catch(e){return""}}function He(e){return`${e.appName}!${e.appId}`}const qe=new Map;function Ue(e,t){const n=He(e);Ve(n,t),function(e,t){const n=ze();n&&n.postMessage({key:e,fid:t});Ye()}(n,t)}function Ve(e,t){const n=qe.get(e);if(n)for(const e of n)e(t)}let We=null;function ze(){return!We&&"BroadcastChannel"in self&&(We=new BroadcastChannel("[Firebase] FID Change"),We.onmessage=e=>{Ve(e.data.key,e.data.fid)}),We}function Ye(){0===qe.size&&We&&(We.close(),We=null)}const Ge="firebase-installations-store";let Xe=null;function $e(){return Xe||(Xe=z("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Ge)}})),Xe}async function je(e,t){const n=He(e),r=(await $e()).transaction(Ge,"readwrite"),a=r.objectStore(Ge),i=await a.get(n);return await a.put(t,n),await r.done,i&&i.fid===t.fid||Ue(e,t.fid),t}async function Ke(e){const t=He(e),n=(await $e()).transaction(Ge,"readwrite");await n.objectStore(Ge).delete(t),await n.done}async function Ze(e,t){const n=He(e),r=(await $e()).transaction(Ge,"readwrite"),a=r.objectStore(Ge),i=await a.get(n),o=t(i);return void 0===o?await a.delete(n):await a.put(o,n),await r.done,!o||i&&i.fid===o.fid||Ue(e,o.fid),o}async function Qe(e){let t;const n=await Ze(e.appConfig,(n=>{const r=function(e){return tt(e||{fid:Fe(),registrationStatus:0})}(n),a=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(De.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const r=Ne(e),a=ke(e),i=t.getImmediate({optional:!0});if(i){const e=await i.getHeartbeatsHeader();e&&a.append("x-firebase-client",e)}const o={fid:n,authVersion:Ae,appId:e.appId,sdkVersion:Ee},s={method:"POST",headers:a,body:JSON.stringify(o)},l=await Pe((()=>fetch(r,s)));if(l.ok){const e=await l.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:Me(e.authToken)}}throw await Oe("Create Installation",l)}(e,t);return je(e.appConfig,n)}catch(n){throw Re(n)&&409===n.customData.serverCode?await Ke(e.appConfig):await je(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Je(e)}:{installationEntry:t}}(e,r);return t=a.registrationPromise,a.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function Je(e){let t=await et(e.appConfig);for(;1===t.registrationStatus;)await Le(100),t=await et(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await Qe(e);return n||t}return t}function et(e){return Ze(e,(e=>{if(!e)throw De.create("installation-not-found");return tt(e)}))}function tt(e){return 1===(t=e).registrationStatus&&t.registrationTime+Ce<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function nt({appConfig:e,heartbeatServiceProvider:t},n){const r=function(e,{fid:t}){return`${Ne(e)}/${t}/authTokens:generate`}(e,n),a=Ie(e,n),i=t.getImmediate({optional:!0});if(i){const e=await i.getHeartbeatsHeader();e&&a.append("x-firebase-client",e)}const o={installation:{sdkVersion:Ee,appId:e.appId}},s={method:"POST",headers:a,body:JSON.stringify(o)},l=await Pe((()=>fetch(r,s)));if(l.ok){return Me(await l.json())}throw await Oe("Generate Auth Token",l)}async function rt(e,t=!1){let n;const r=await Ze(e.appConfig,(r=>{if(!it(r))throw De.create("not-registered");const a=r.authToken;if(!t&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+Se}(e)}(a))return r;if(1===a.requestStatus)return n=async function(e,t){let n=await at(e.appConfig);for(;1===n.authToken.requestStatus;)await Le(100),n=await at(e.appConfig);const r=n.authToken;return 0===r.requestStatus?rt(e,t):r}(e,t),r;{if(!navigator.onLine)throw De.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return n=async function(e,t){try{const n=await nt(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await je(e.appConfig,r),n}catch(n){if(!Re(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await je(e.appConfig,n)}else await Ke(e.appConfig);throw n}}(e,t),t}}));return n?await n:r.authToken}function at(e){return Ze(e,(e=>{if(!it(e))throw De.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+Ce<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n}))}function it(e){return void 0!==e&&2===e.registrationStatus}async function ot(e,t=!1){const n=e;await async function(e){const{registrationPromise:t}=await Qe(e);t&&await t}(n);return(await rt(n,t)).token}function st(e){return De.create("missing-app-config-values",{valueName:e})}const lt="installations",ct=e=>{const t=oe(e.getProvider("app").getImmediate(),lt).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await Qe(t);return r?r.catch(console.error):rt(t).catch(console.error),n.fid}(t),getToken:e=>ot(t,e)}};ie(new w(lt,(e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw st("App Configuration");if(!e.name)throw st("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw st(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:oe(t,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),ie(new w("installations-internal",ct,"PRIVATE")),ue(xe,we),ue(xe,we,"esm2017");const ut="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",ht="google.c.a.c_id";var dt,pt;function mt(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function _t(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let e=0;e<n.length;++e)r[e]=n.charCodeAt(e);return r}!function(e){e[e.DATA_MESSAGE=1]="DATA_MESSAGE",e[e.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"}(dt||(dt={})),function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(pt||(pt={}));const gt="fcm_token_details_db",ft="fcm_token_object_Store";const yt="firebase-messaging-store";let vt=null;function bt(){return vt||(vt=z("firebase-messaging-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(yt)}})),vt}async function xt(e){const t=Tt(e),n=await bt(),r=await n.transaction(yt).objectStore(yt).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB){const e=(await indexedDB.databases()).map((e=>e.name));if(!e.includes(gt))return null}let t=null;return(await z(gt,5,{upgrade:async(n,r,a,i)=>{var o;if(r<2)return;if(!n.objectStoreNames.contains(ft))return;const s=i.objectStore(ft),l=await s.index("fcmSenderId").get(e);if(await s.clear(),l)if(2===r){const e=l;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(o=e.createTime)&&void 0!==o?o:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"==typeof e.vapidKey?e.vapidKey:mt(e.vapidKey)}}}else if(3===r){const e=l;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:mt(e.auth),p256dh:mt(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:mt(e.vapidKey)}}}else if(4===r){const e=l;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:mt(e.auth),p256dh:mt(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:mt(e.vapidKey)}}}}})).close(),await Y(gt),await Y("fcm_vapid_details_db"),await Y("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await wt(e,t),t}}async function wt(e,t){const n=Tt(e),r=(await bt()).transaction(yt,"readwrite");return await r.objectStore(yt).put(t,n),await r.done,t}function Tt({appConfig:e}){return e.appId}const Ct=new f("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});async function Et(e,t){var n;const r={method:"DELETE",headers:await St(e)};try{const n=await fetch(`${At(e.appConfig)}/${t}`,r),a=await n.json();if(a.error){const e=a.error.message;throw Ct.create("token-unsubscribe-failed",{errorInfo:e})}}catch(e){throw Ct.create("token-unsubscribe-failed",{errorInfo:null===(n=e)||void 0===n?void 0:n.toString()})}}function At({projectId:e}){return`https://fcmregistrations.googleapis.com/v1/projects/${e}/registrations`}async function St({appConfig:e,installations:t}){const n=await t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function Dt({p256dh:e,auth:t,endpoint:n,vapidKey:r}){const a={web:{endpoint:n,auth:t,p256dh:e}};return r!==ut&&(a.web.applicationPubKey=r),a}async function Rt(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:_t(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:mt(t.getKey("auth")),p256dh:mt(t.getKey("p256dh"))},r=await xt(e.firebaseDependencies);if(r){if(function(e,t){const n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,a=t.auth===e.auth,i=t.p256dh===e.p256dh;return n&&r&&a&&i}(r.subscriptionOptions,n))return Date.now()>=r.createTime+6048e5?async function(e,t){try{const n=await async function(e,t){var n;const r=await St(e),a=Dt(t.subscriptionOptions),i={method:"PATCH",headers:r,body:JSON.stringify(a)};let o;try{const n=await fetch(`${At(e.appConfig)}/${t.token}`,i);o=await n.json()}catch(e){throw Ct.create("token-update-failed",{errorInfo:null===(n=e)||void 0===n?void 0:n.toString()})}if(o.error){const e=o.error.message;throw Ct.create("token-update-failed",{errorInfo:e})}if(!o.token)throw Ct.create("token-update-no-token");return o.token}(e.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:n,createTime:Date.now()});return await wt(e.firebaseDependencies,r),n}catch(t){throw await Nt(e),t}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await Et(e.firebaseDependencies,r.token)}catch(e){console.warn(e)}return Mt(e.firebaseDependencies,n)}return Mt(e.firebaseDependencies,n)}async function Nt(e){const t=await xt(e.firebaseDependencies);t&&(await Et(e.firebaseDependencies,t.token),await async function(e){const t=Tt(e),n=(await bt()).transaction(yt,"readwrite");await n.objectStore(yt).delete(t),await n.done}(e.firebaseDependencies));const n=await e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}async function Mt(e,t){const n=await async function(e,t){var n;const r=await St(e),a=Dt(t),i={method:"POST",headers:r,body:JSON.stringify(a)};let o;try{const t=await fetch(At(e.appConfig),i);o=await t.json()}catch(e){throw Ct.create("token-subscribe-failed",{errorInfo:null===(n=e)||void 0===n?void 0:n.toString()})}if(o.error){const e=o.error.message;throw Ct.create("token-subscribe-failed",{errorInfo:e})}if(!o.token)throw Ct.create("token-subscribe-no-token");return o.token}(e,t),r={token:n,createTime:Date.now(),subscriptionOptions:t};return await wt(e,r),r.token}function Ot(e){const t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const a=t.notification.image;a&&(e.notification.image=a);const i=t.notification.icon;i&&(e.notification.icon=i)}(t,e),function(e,t){if(!t.data)return;e.data=t.data}(t,e),function(e,t){var n,r,a,i,o;if(!t.fcmOptions&&!(null===(n=t.notification)||void 0===n?void 0:n.click_action))return;e.fcmOptions={};const s=null!==(a=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==a?a:null===(i=t.notification)||void 0===i?void 0:i.click_action;s&&(e.fcmOptions.link=s);const l=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;l&&(e.fcmOptions.analyticsLabel=l)}(t,e),t}function kt(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function It(e){return Ct.create("missing-app-config-values",{valueName:e})}kt("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),kt("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Pt{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=function(e){if(!e||!e.options)throw It("App Configuration Object");if(!e.name)throw It("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const e of t)if(!n[e])throw It(e);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}async function Lt(e){var t;try{e.swRegistration=await navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}),e.swRegistration.update().catch((()=>{}))}catch(e){throw Ct.create("failed-service-worker-registration",{browserErrorMessage:null===(t=e)||void 0===t?void 0:t.message})}}async function Bt(e,t){if(!navigator)throw Ct.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw Ct.create("permission-blocked");return await async function(e,t){t?e.vapidKey=t:e.vapidKey||(e.vapidKey=ut)}(e,null==t?void 0:t.vapidKey),await async function(e,t){if(t||e.swRegistration||await Lt(e),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw Ct.create("invalid-sw-registration");e.swRegistration=t}}(e,null==t?void 0:t.serviceWorkerRegistration),Rt(e)}async function Ft(e,t,n){const r=function(e){switch(e){case pt.NOTIFICATION_CLICKED:return"notification_open";case pt.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t);(await e.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n["google.c.a.c_id"],message_name:n["google.c.a.c_l"],message_time:n["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)})}async function Ht(e,t){const n=t.data;if(!n.isFirebaseMessaging)return;e.onMessageHandler&&n.messageType===pt.PUSH_RECEIVED&&("function"==typeof e.onMessageHandler?e.onMessageHandler(Ot(n)):e.onMessageHandler.next(Ot(n)));const r=n.data;var a;"object"==typeof(a=r)&&a&&ht in a&&"1"===r["google.c.a.e"]&&await Ft(e,n.messageType,r)}const qt="@firebase/messaging",Ut="0.11.0",Vt=e=>{const t=e.getProvider("messaging").getImmediate();return{getToken:e=>Bt(t,e)}};async function Wt(){try{await d()}catch(e){return!1}return"undefined"!=typeof window&&h()&&!("undefined"==typeof navigator||!navigator.cookieEnabled)&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function zt(e=function(e="[DEFAULT]"){const t=ne.get(e);if(!t&&e===ee)return ce();if(!t)throw se.create("no-app",{appName:e});return t}()){return Wt().then((e=>{if(!e)throw Ct.create("unsupported-browser")}),(e=>{throw Ct.create("indexed-db-unsupported")})),oe(x(e),"messaging").getImmediate()}async function Yt(e,t){return Bt(e=x(e),t)}function Gt(e){return async function(e){if(!navigator)throw Ct.create("only-available-in-window");return e.swRegistration||await Lt(e),Nt(e)}(e=x(e))}function Xt(e,t){return function(e,t){if(!navigator)throw Ct.create("only-available-in-window");return e.onMessageHandler=t,()=>{e.onMessageHandler=null}}(e=x(e),t)}ie(new w("messaging",(e=>{const t=new Pt(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",(e=>Ht(t,e))),t}),"PUBLIC")),ie(new w("messaging-internal",Vt,"PRIVATE")),ue(qt,Ut),ue(qt,Ut,"esm2017");const $t=Tinode;class jt extends t().PureComponent{render(){return this.props.visible?t().createElement("div",{className:"alert-container"},t().createElement("div",{className:"alert"},t().createElement("div",{className:"title"},this.props.title),t().createElement("div",{className:"content"},this.props.content),t().createElement("div",{className:"dialog-buttons"},this.props.onReject?t().createElement("button",{className:"outline",onClick:this.props.onReject},this.props.reject||t().createElement(i.FormattedMessage,{id:"button_cancel",defaultMessage:[{type:0,value:"Cancel"}]})):null,t().createElement("button",{className:"primary",onClick:this.props.onConfirm},this.props.confirm||t().createElement(i.FormattedMessage,{id:"button_ok",defaultMessage:[{type:0,value:"OK"}]}))))):null}}const Kt="0.20.1",Zt="TinodeWeb/0.20.1",Qt={hosted:"web.tinode.co",local:"localhost:8444"},Jt=Qt.hosted,en=3e3,tn="JRWPS",nn=13,rn=384,an=262144,on=1<<23,sn=36,ln=60,cn=360,un=(0,i.defineMessages)({info:{id:"menu_item_info",defaultMessage:[{type:0,value:"Info"}]},clear_messages:{id:"menu_item_clear_messages",defaultMessage:[{type:0,value:"Clear messages"}]},clear_for_all:{id:"menu_item_clear_messages_for_all",defaultMessage:[{type:0,value:"Clear for All"}]},delete:{id:"menu_item_delete",defaultMessage:[{type:0,value:"Delete"}]},delete_for_all:{id:"menu_item_delete_for_all",defaultMessage:[{type:0,value:"Delete for All"}]},send_retry:{id:"menu_item_send_retry",defaultMessage:[{type:0,value:"Retry"}]},mute:{id:"menu_item_mute",defaultMessage:[{type:0,value:"Mute"}]},unmute:{id:"menu_item_unmute",defaultMessage:[{type:0,value:"Unmute"}]},reply:{id:"menu_item_reply",defaultMessage:[{type:0,value:"Reply"}]},forward:{id:"menu_item_forward",defaultMessage:[{type:0,value:"Forward"}]},topic_delete:{id:"menu_item_delete_topic",defaultMessage:[{type:0,value:"Delete"}]},topic_delete_warning:{id:"topic_delete_warning",defaultMessage:[{type:0,value:"Are you sure you want to delete this conversation? It cannot be undone."}]},delete_messages_warning:{id:"delete_messages_warning",defaultMessage:[{type:0,value:"Are you sure you want to delete all messages for everyone? It cannot be undone."}]},unblock:{id:"menu_item_unblock",defaultMessage:[{type:0,value:"Unblock"}]},block:{id:"menu_item_block",defaultMessage:[{type:0,value:"Block"}]},topic_block_warning:{id:"topic_block_warning",defaultMessage:[{type:0,value:"Are you sure you want to block this conversation?"}]},member_delete:{id:"menu_item_member_delete",defaultMessage:[{type:0,value:"Remove"}]},archive:{id:"menu_item_archive_topic",defaultMessage:[{type:0,value:"Archive"}]},unarchive:{id:"menu_item_restore_topic",defaultMessage:[{type:0,value:"Restore"}]},edit_permissions:{id:"menu_item_edit_permissions",defaultMessage:[{type:0,value:"Edit permissions"}]},clear_messages_warning:{id:"clear_messages_warning",defaultMessage:[{type:0,value:"Are you sure you want to clear all messages? It cannot be undone."}]}});class hn extends t().Component{constructor(e){super(e),this.selfRef=t().createRef();const{formatMessage:n}=e.intl;this.handlePageClick=this.handlePageClick.bind(this),this.handleEscapeKey=this.handleEscapeKey.bind(this),this.handleClick=this.handleClick.bind(this),this.MenuItems={topic_info:{id:"topic_info",title:n(un.info),handler:null},messages_clear:{id:"messages_clear",title:n(un.clear_messages),handler:(t,r)=>e.onShowAlert(n(un.clear_messages),n(un.clear_messages_warning),(e=>{this.deleteMessages(!0,!1,t,r)}),null,!0,null)},messages_clear_hard:{id:"messages_clear_hard",title:n(un.clear_for_all),handler:(t,r)=>e.onShowAlert(n(un.clear_for_all),n(un.delete_messages_warning),(e=>this.deleteMessages(!0,!0,t,r)),null,!0,null)},message_delete:{id:"message_delete",title:n(un.delete),handler:(e,t)=>this.deleteMessages(!1,!1,e,t)},message_delete_hard:{id:"message_delete_hard",title:n(un.delete_for_all),handler:(e,t)=>this.deleteMessages(!1,!0,e,t)},menu_item_send_retry:{id:"menu_item_send_retry",title:n(un.send_retry),handler:(e,t)=>this.retryMessage(e,t)},menu_item_reply:{id:"menu_item_reply",title:n(un.reply),handler:(e,t)=>this.replyToMessage(e,t)},menu_item_forward:{id:"menu_item_forward",title:n(un.forward),handler:()=>{}},topic_unmute:{id:"topic_unmute",title:n(un.unmute),handler:this.topicPermissionSetter.bind(this,"+P")},topic_mute:{id:"topic_mute",title:n(un.mute),handler:this.topicPermissionSetter.bind(this,"-P")},topic_unblock:{id:"topic_unblock",title:n(un.unblock),handler:this.topicPermissionSetter.bind(this,"+JP")},topic_block:{id:"topic_block",title:n(un.block),handler:(t,r)=>e.onShowAlert(n(un.block),n(un.topic_block_warning),(()=>this.topicPermissionSetter("-JP",t,r).then((e=>(this.props.onTopicRemoved(t.topicName),e)))),null,!0,null)},topic_delete:{id:"topic_delete",title:n(un.topic_delete),handler:(t,r)=>e.onShowAlert(n(un.topic_delete),n(un.topic_delete_warning),(()=>{const e=this.props.tinode.getTopic(t.topicName);if(e)return e.delTopic(!0).catch((e=>{r&&r(e.message,"err")}));console.warn("Topic not found: ",t.topicName)}),null,!0,null)},topic_archive:{id:"topic_archive",title:n(un.archive),handler:(e,t)=>{const n=this.props.tinode.getTopic(e.topicName);if(n)return n.archive(!0).catch((e=>{t&&t(e.message,"err")}));console.warn("Topic not found: ",e.topicName)}},topic_restore:{id:"topic_restore",title:n(un.unarchive),handler:(e,t)=>{const n=this.props.tinode.getTopic(e.topicName);if(n)return n.archive(!1).catch((e=>{t&&t(e.message,"err")}));console.warn("Topic not found: ",e.topicName)}},permissions:{id:"permissions",title:n(un.edit_permissions),handler:null},member_delete:{id:"member_delete",title:n(un.member_delete),handler:(e,t)=>{const n=this.props.tinode.getTopic(e.topicName);if(n&&e.user)return n.delSubscription(e.user).catch((e=>{t&&t(e.message,"err")}));console.warn("Topic or user not found: '"+e.topicName+"', '"+e.user+"'")}},member_mute:{id:"member_mute",title:n(un.mute),handler:this.topicPermissionSetter.bind(this,"-P")},member_unmute:{id:"member_unmute",title:n(un.unmute),handler:this.topicPermissionSetter.bind(this,"+P")},member_block:{id:"member_block",title:n(un.block),handler:this.topicPermissionSetter.bind(this,"-JP")},member_unblock:{id:"member_unblock",title:n(un.unblock),handler:this.topicPermissionSetter.bind(this,"+JP")}}}componentDidMount(){document.addEventListener("mousedown",this.handlePageClick,!1),document.addEventListener("keyup",this.handleEscapeKey,!1)}componentWillUnmount(){document.removeEventListener("mousedown",this.handlePageClick,!1),document.removeEventListener("keyup",this.handleEscapeKey,!1)}handlePageClick(e){this.selfRef.current.contains(e.target)||(e.preventDefault(),e.stopPropagation(),this.props.hide())}handleEscapeKey(e){27===e.keyCode&&this.props.hide()}handleClick(e){e.preventDefault(),e.stopPropagation(),this.props.hide();let t=this.props.items[e.currentTarget.dataset.id];"string"==typeof t&&(t=this.MenuItems[t]),t?this.props.onAction(t.id,t.handler(this.props.params,this.props.onError),this.props.params):console.error("Invalid menu item ID",e.currentTarget.dataset.id)}deleteMessages(e,t,n,r){const a=this.props.tinode.getTopic(n.topicName);if(!a)return void console.warn("Topic not found: ",n.topicName);if(!e&&a.cancelSend(n.seq))return;return(e?a.delMessagesAll(t):a.delMessagesList([n.seq],t)).catch((e=>{r&&r(e.message,"err")}))}retryMessage(e,t){const n=this.props.tinode.getTopic(e.topicName);if(!n||!n.flushMessage(e.seq))return;const r=n.createMessage(e.content,!1);return n.publishDraft(r).catch((e=>{t&&t(e.message,"err")}))}topicPermissionSetter(e,t,n){const r=this.props.tinode.getTopic(t.topicName);if(!r)return void console.warn("Topic not found",t.topicName);let a=r.updateMode(t.user,e);return n&&(a=a.catch((e=>{n(e.message,"err")}))),a}replyToMessage(e,t){e.pickReply(e.seq,e.content,e.userFrom,e.userName,t)}render(){const e=[];let n=0;this.props.items.map((r=>{"string"==typeof r&&(r=this.MenuItems[r]),r&&r.title&&e.push("-"==r.title?t().createElement("li",{className:"separator",key:n}):t().createElement("li",{onClick:this.handleClick,"data-id":n,key:n},r.title)),n++}));const r=nn*(.7+2.5*e.length),a={left:(this.props.bounds.right-this.props.clickAt.x<156?this.props.clickAt.x-this.props.bounds.left-156:this.props.clickAt.x-this.props.bounds.left)+"px",top:(this.props.bounds.bottom-this.props.clickAt.y<r?this.props.clickAt.y-this.props.bounds.top-r:this.props.clickAt.y-this.props.bounds.top)+"px"};return t().createElement("ul",{className:"menu",style:a,ref:this.selfRef},e)}}const dn=(0,i.injectIntl)(hn),pn={muted:"notifications_off",banned:"block",staff:"verified_user"};class mn extends t().PureComponent{render(){let e=null;return this.props.badges&&this.props.badges.length>0?(e=[],this.props.badges.map((n=>{const r=n.color?" "+n.color:"";n.icon?e.push(t().createElement("i",{className:"material-icons as-badge"+r,key:n.key||n.icon},pn[n.icon]||n.icon)):e.push(t().createElement("span",{className:"badge"+r,key:n.key||n.name},n.name))})),t().createElement(t().Fragment,null,e)):null}}function _n(e,t){let n=0|Math.floor(e/60),r=0|Math.floor(n/60);(t||r>0)&&(n=n<10?`0${n}`:n);let a=e%60|0;return a=a<10?`0${a}`:a,0==r?`${n}:${a}`:`${r}:${n}:${a}`}function gn(e){if(!e||0==e)return"0 Bytes";const t=["Bytes","KB","MB","GB","TB","PB"],n=Math.min(0|Math.floor(Math.log2(e)/10),t.length-1),r=e/Math.pow(1024,n),a=n>0?r<3?2:r<30?1:0:0;return r.toFixed(a)+" "+t[n]}function fn(e,t){return"string"!=typeof e?e:e.length>t?e.slice(0,t/2-1)+"…"+e.slice(1-t/2):e}function yn(e,t,n){return(t?"lt-":"dk-")+(n?"fg-":"bg-")+(r=e,Math.abs(function(e){let t=0;e=""+e;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}(r))%16);var r}function vn(e){const t=document.getElementById("shortcut-icon"),n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("link");r.type="image/png",r.id="shortcut-icon",r.rel="shortcut icon",r.href="img/logo32x32"+(e>0?"a":"")+".png",t&&n.removeChild(t),n.appendChild(r),document.title=(e>0?"("+e+") ":"")+"Tinode"}function bn(e,t,n,r){let a=null;if((e=e&&e.trim())&&(a={fn:e}),"string"==typeof(r=r&&r.trim())&&(a=a||{},a.note=r||$t.Tinode.DEL_CHAR),t){a=a||{};let e=n;const r=/^data:(image\/[-a-z0-9+.]+)?(;base64)?,/i.exec(t);r?(e=r[1],a.photo={data:t.substring(t.indexOf(",")+1),ref:$t.Tinode.DEL_CHAR}):a.photo={data:$t.Tinode.DEL_CHAR,ref:t},a.photo.type=(e||"image/jpeg").substring("image/".length)}return a}function xn(e,t){if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t))return!1;if(e.length!=t.length)return!1;e.sort(),t.sort();for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function wn(e,t){if("string"!=typeof e)return e;if(e=e.replace(/[^\x20-\x7E]/gim,"").trim(),!/^([a-z][a-z0-9+.-]*:|\/\/)/i.test(e))return e;if(/^blob:http/.test(e))return e;const n=Array.isArray(t)?t.join("|"):"http|https";return new RegExp("^(("+n+"):|//)","i").test(e)?e:null}function Tn(e,t){if(!e)return null;const n=wn(e);if(n)return n;return new RegExp(`data:${t}/[a-z0-9.-]+;base64,`,"i").test(e.trim())?e:null}function Cn(e){switch(e){case $t.Tinode.MESSAGE_STATUS_SENDING:return{name:"access_time"};case $t.Tinode.MESSAGE_STATUS_FAILED:return{name:"warning",color:"danger-color"};case $t.Tinode.MESSAGE_STATUS_SENT:return{name:"done"};case $t.Tinode.MESSAGE_STATUS_RECEIVED:return{name:"done_all"};case $t.Tinode.MESSAGE_STATUS_READ:return{name:"done_all",color:"blue"}}return null}function En(e){let t=!1;return{promise:e instanceof Error?Promise.reject(e):new Promise(((n,r)=>{e.then((e=>t?r({isCanceled:!0}):n(e)),(e=>r(t?{isCanceled:!0}:e)))})),cancel(){t=!0}}}function An(e,t){return e&&e.substring(0,t)}class Sn extends t().PureComponent{render(){let e;if(!0===this.props.avatar){const n=$t.Tinode.isGroupTopicName(this.props.topic),r=yn(this.props.topic,n);if(this.props.topic&&this.props.title&&this.props.title.trim()){const n=this.props.title.trim().charAt(0),a="lettertile "+r+(this.props.deleted?" disabled":"");e=t().createElement("div",{className:a},t().createElement("div",null,n))}else{const a="material-icons "+r+(this.props.deleted?" disabled":"");e=n?t().createElement("i",{className:a},"group"):t().createElement("i",{className:a},"person")}}else if(this.props.avatar){const n=this.props.tinode.authorizeURL(Tn(this.props.avatar,"image")),r="avatar"+(this.props.deleted?" deleted":"");e=t().createElement("img",{className:r,alt:"avatar",src:n,onError:e=>{e.target.onerror=null,e.target.src="../img/broken_image.png"}})}else e=null;return e}}class Dn extends t().PureComponent{render(){return this.props.count>0?t().createElement("span",{className:"unread"},this.props.count>9?"9+":this.props.count):null}}const Rn=["image/jpeg","image/gif","image/png","image/svg","image/svg+xml"],Nn=["jpg","gif","png","svg","svg"];function Mn(e){if(e&&"object"==typeof e){if(e.ref)return e.ref;if(e.data&&e.type){return"data:"+(e.type.startsWith("image/")?e.type:"image/"+e.type)+";base64,"+e.data}}return null}function On(e,t,n,r,a){if(t|=0,n|=0,r|=0,(e|=0)<=0||t<=0||n<=0||r<=0)return null;a&&(n=r=Math.min(n,r));const i=Math.min(Math.min(e,n)/e,Math.min(t,r)/t),o={dstWidth:e*i|0,dstHeight:t*i|0};return a?(o.dstWidth=o.dstHeight=Math.min(o.dstWidth,o.dstHeight),o.srcWidth=o.srcHeight=Math.min(e,t),o.xoffset=(e-o.srcWidth)/2|0,o.yoffset=(t-o.srcWidth)/2|0):(o.xoffset=o.yoffset=0,o.srcWidth=e,o.srcHeight=t),o}function kn(e,t){const n=Rn.indexOf(t);if(n<0||!e)return e;const r=Nn[n],a=e.lastIndexOf(".");return a>=0&&(e=e.substring(0,a)),e+"."+r}function In(e,t,n,r,a){return new Promise(((i,o)=>{const s=new Image;s.crossOrigin="Anonymous",s.onerror=function(e){o(new Error("Image format unrecognized"))},s.onload=async function(){URL.revokeObjectURL(s.src);const l=On(s.width,s.height,t,n,a);if(!l)return void o(new Error("Invalid image"));let c=document.createElement("canvas");c.width=l.dstWidth,c.height=l.dstHeight;let u=c.getContext("2d");u.imageSmoothingEnabled=!0,u.drawImage(s,l.xoffset,l.yoffset,l.srcWidth,l.srcHeight,0,0,l.dstWidth,l.dstHeight);const h=Rn.includes(e.type)?e.type:"image/jpeg";let d=await new Promise((e=>c.toBlob(e,h)));if(d){for(;r>0&&d.length>r;)l.dstWidth=.70710678118*l.dstWidth|0,l.dstHeight=.70710678118*l.dstHeight|0,c.width=l.dstWidth,c.height=l.dstHeight,u=c.getContext("2d"),u.clearRect(0,0,c.width,c.height),u.drawImage(s,l.xoffset,l.yoffset,l.srcWidth,l.srcHeight,0,0,l.dstWidth,l.dstHeight),d=await new Promise((e=>c.toBlob(e,h)));c=null,i({mime:h,blob:d,width:l.dstWidth,height:l.dstHeight,name:kn(e.name,h)})}else o(new Error("Unsupported image format"))},s.src=URL.createObjectURL(e)}))}function Pn(e){return new Promise(((t,n)=>{const r=new FileReader;r.onerror=e=>{n(r.error)},r.onload=()=>{t({mime:e.type,bits:r.result.split(",")[1]})},r.readAsDataURL(e)}))}function Ln(e){if(!Array.isArray(e))return null;try{let t="";return new Uint8Array(e).forEach((e=>t+=String.fromCharCode(e))),window.btoa(t)}catch(e){}return null}function Bn(e){const t=[];try{return[...window.atob(e)].forEach((e=>{t.push(e.charCodeAt(0))})),t}catch(e){}return null}const Fn="#666C";class Hn extends t().PureComponent{constructor(e){super(e);let n=Bn(this.props.preview);(!Array.isArray(n)||n.length<16)&&(n=null),this.state={canPlay:!1,playing:!1,currentTime:"0:00",duration:this.props.duration>0?_n(this.props.duration/1e3):"-:--",longMin:this.props.duration>=6e5,preview:n},this.initAudio=this.initAudio.bind(this),this.initCanvas=this.initCanvas.bind(this),this.resampleBars=this.resampleBars.bind(this),this.visualize=this.visualize.bind(this),this.handlePlay=this.handlePlay.bind(this),this.handleSeek=this.handleSeek.bind(this),this.handleError=this.handleError.bind(this),this.audioPlayer=null,this.viewBuffer=[],this.canvasRef=t().createRef()}componentDidMount(){this.props.src&&this.initAudio(),this.initCanvas()}componentWillUnmount(){this.audioPlayer&&(this.audioPlayer.oncanplay=null,this.audioPlayer.ontimeupdate=null,this.audioPlayer.onended=null,this.audioPlayer.pause(),this.audioPlayer=null)}componentDidUpdate(e){if(this.props.src!=e.src&&this.initAudio(),this.props.preview!=e.preview){let e=Bn(this.props.preview);(!Array.isArray(e)||e.length<16)&&(e=null),this.setState({preview:e},this.initCanvas)}}initAudio(){this.audioPlayer=new Audio(this.props.src),this.audioPlayer.oncanplay=e=>this.setState({canPlay:!0}),this.audioPlayer.ontimeupdate=e=>this.setState({currentTime:_n(this.audioPlayer.currentTime,this.state.longMin)}),this.audioPlayer.onended=e=>{this.audioPlayer.currentTime=0,this.setState({playing:!1,currentTime:_n(0,this.state.longMin)})}}initCanvas(){this.canvasRef.current.width=2*this.canvasRef.current.offsetWidth,this.canvasRef.current.height=2*this.canvasRef.current.offsetHeight,this.canvasContext=this.canvasRef.current.getContext("2d"),this.canvasContext.lineCap="round",this.viewBuffer=this.resampleBars(this.state.preview),this.visualize()}visualize(){if(!this.canvasRef.current)return;const e=this.effectiveWidth,t=this.canvasRef.current.height;this.canvasContext.lineWidth=6;const n=()=>{if(this.canvasRef.current&&this.audioPlayer&&(this.canvasContext.clearRect(0,0,this.canvasRef.current.width,t),this.viewBuffer)){this.state.playing&&window.requestAnimationFrame(n);const r=this.props.duration?Math.max(0,Math.min(1e3*this.audioPlayer.currentTime/this.props.duration,1))*(e-12):-1;this.canvasContext.beginPath(),this.canvasContext.strokeStyle=Fn;for(let e=0;e<this.viewBuffer.length;e++){let n=1+10*e+3,a=this.viewBuffer[e]*t*.9;const i=n<r?Fn:"#888A";this.canvasContext.strokeStyle!=i&&(this.canvasContext.stroke(),this.canvasContext.beginPath(),this.canvasContext.strokeStyle=i),this.canvasContext.moveTo(n,.5*(t-a)),this.canvasContext.lineTo(n,.5*t+.5*a)}this.canvasContext.stroke(),this.props.duration&&(this.canvasContext.beginPath(),this.canvasContext.arc(r+12,.5*t,12,0,2*Math.PI),this.canvasContext.fillStyle="#444E",this.canvasContext.fill())}};n()}resampleBars(e){const t=(this.canvasRef.current.width-4)/10|0;if(this.effectiveWidth=10*t+4,!Array.isArray(e)||0==e.length)return Array.apply(null,Array(t)).map((e=>.01));const n=e.length/t;let r=[],a=-1;for(let i=0;i<t;i++){let t=i*n|0,o=(i+1)*n|0;if(o==t)r[i]=e[t];else{let n=0;for(let r=t;r<o;r++)n+=e[r];r[i]=Math.max(0,n/(o-t))}a=Math.max(r[i],a)}return a>0?r.map((e=>e/a)):Array.apply(null,Array(t)).map((e=>.01))}handlePlay(e){e.preventDefault(),this.state.canPlay&&(this.state.playing?(this.audioPlayer.pause(),this.setState({playing:!1})):(this.audioPlayer.play(),this.setState({playing:!0},this.visualize)))}handleError(e){console.error(e)}handleSeek(e){if(e.preventDefault(),e.target&&this.props.duration){const t=e.target.getBoundingClientRect(),n=(e.clientX-t.left)/this.effectiveWidth*2;this.audioPlayer.currentTime=this.props.duration*n/1e3,this.setState({currentTime:_n(this.audioPlayer.currentTime,this.state.longMin)}),this.state.playing||this.visualize()}}render(){const e="material-icons"+(this.props.short?"":" large")+(this.state.canPlay?"":" disabled"),n=t().createElement("a",{href:"#",onClick:this.handlePlay,title:"Play"},t().createElement("i",{className:e},this.state.playing?"pause_circle":this.state.canPlay?"play_circle":"not_interested"));return t().createElement("div",{className:"audio-player"},this.props.short?t().createElement(t().Fragment,null,t().createElement("canvas",{className:"playback",ref:this.canvasRef,onClick:this.handleSeek}),n):t().createElement(t().Fragment,null,n,t().createElement("div",null,t().createElement("canvas",{className:"playback",ref:this.canvasRef,onClick:this.handleSeek}),t().createElement("div",{className:"timer"},this.state.currentTime,"/",this.state.duration))))}}class qn extends t().PureComponent{render(){const e=["declined","disconnected","missed"].includes(this.props.callState),n="material-icons medium "+(e?"red":"green"),r=this.props.incoming?e?"call_missed":"call_received":e?"call_missed_outgoing":"call_made";let a;if(e)switch(this.props.callState){case"declined":a=t().createElement(i.FormattedMessage,{id:"call_declined",defaultMessage:[{type:0,value:"declined"}]});break;case"missed":a=this.props.incoming?t().createElement(i.FormattedMessage,{id:"call_missed",defaultMessage:[{type:0,value:"missed"}]}):t().createElement(i.FormattedMessage,{id:"call_cancelled",defaultMessage:[{type:0,value:"cancelled"}]});break;default:a=t().createElement(i.FormattedMessage,{id:"call_disconnected",defaultMessage:[{type:0,value:"disconnected"}]})}else a=t().createElement("span",null,_n(this.props.duration/1e3));return t().createElement("div",{className:"call-message"},t().createElement("div",null,t().createElement("i",{className:"material-icons big gray"},"call")),t().createElement("div",{className:"flex-column narrow"},t().createElement("div",null,this.props.incoming?t().createElement(i.FormattedMessage,{id:"calls_incoming",defaultMessage:[{type:0,value:"Incoming call"}]}):t().createElement(i.FormattedMessage,{id:"calls_outgoing",defaultMessage:[{type:0,value:"Outgoing call"}]})),t().createElement("div",{className:"duration"},t().createElement("i",{className:n},r)," ",a)))}}class Un extends t().PureComponent{render(){const e=["declined","disconnected","missed"].includes(this.props.callState),n=this.props.incoming?e?"call_missed":"call_received":e?"call_missed_outgoing":"call_made";let r;if(e)switch(this.props.callState){case"declined":r=t().createElement(i.FormattedMessage,{id:"call_declined",defaultMessage:[{type:0,value:"declined"}]});break;case"missed":r=this.props.incoming?t().createElement(i.FormattedMessage,{id:"call_missed",defaultMessage:[{type:0,value:"missed"}]}):t().createElement(i.FormattedMessage,{id:"call_cancelled",defaultMessage:[{type:0,value:"cancelled"}]});break;default:r=t().createElement(i.FormattedMessage,{id:"call_disconnected",defaultMessage:[{type:0,value:"disconnected"}]})}else r=t().createElement("span",null,_n(this.props.duration/1e3));return t().createElement(t().Fragment,null,t().createElement("div",{className:"composed-material"},t().createElement("i",{className:"material-icons"},"call"),t().createElement("i",{className:"material-icons second"},n))," ",r)}}class Vn extends t().PureComponent{constructor(e){super(e),this.state={src:"img/placeholder.png",style:Object.assign({padding:"4px"},this.props.style),className:this.props.className,alt:this.props.alt,onClick:this.props.onClick}}componentDidMount(){this.props.whenDone.promise.then((e=>this.setState({src:e.src,style:{...this.state.style,padding:0}}))).catch((()=>this.setState({src:"img/broken_image.png"})))}componentWillUnmount(){this.props.whenDone.cancel()}componentDidUpdate(e){e.whenDone!=this.props.whenDone&&(this.setState({src:"img/placeholder.png",style:{...this.state.style,padding:"4px"}}),this.props.whenDone.promise.then((e=>this.setState({src:e.src,style:{...this.state.style,padding:0}}))).catch((()=>this.setState({src:"img/broken_image.png"}))))}render(){return t().createElement("img",this.state)}}class Wn extends t().PureComponent{render(){return t().createElement("div",{className:"uploader"},t().createElement("div",null,t().createElement("span",{style:{width:100*this.props.progress+"%"}})),this.props.progress<.999?t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.props.onCancel()}},t().createElement("i",{className:"material-icons"},"close")," ",t().createElement(i.FormattedMessage,{id:"action_cancel",defaultMessage:[{type:0,value:"cancel"}]})):t().createElement(i.FormattedMessage,{id:"upload_finishing",defaultMessage:[{type:0,value:"finishing..."}]}))}}class zn extends t().PureComponent{constructor(e){super(e)}render(){return t().createElement("div",{className:"inline-image"},t().createElement("img",this.props),t().createElement("div",{className:"rounded-container"},t().createElement(Wn,{progress:this.props.progress,onCancel:this.props.onCancelUpload})))}}const Yn=(0,i.defineMessages)({drafty_form:{id:"drafty_form",defaultMessage:[{type:0,value:"Form:"}]},drafty_attachment:{id:"drafty_attachment",defaultMessage:[{type:0,value:"Attachment"}]},drafty_image:{id:"drafty_image",defaultMessage:[{type:0,value:"Picture"}]},drafty_unknown:{id:"drafty_unknown",defaultMessage:[{type:0,value:"Unsupported"}]}});function Gn(e,t,n){if(!t)return n.src="img/broken_image.png",n.style={width:"36px",height:"36px"},e;n.className="inline-image";const r=On(t.width,t.height,this.viewportWidth>0?Math.min(this.viewportWidth-84.5,448.5):448.5,312,!1)||{dstWidth:32,dstHeight:32};return n.style={width:r.dstWidth+"px",height:r.dstHeight+"px",minWidth:r.dstWidth+"px",minHeight:r.dstHeight+"px"},$t.Drafty.isProcessing(t)?e=zn:(n.src=this.authorizeURL(Tn(n.src,"image")),n.alt=t.name,n.src?(Math.max(t.width||0,t.height||0)>sn&&(n.onClick=this.onImagePreview,n.className+=" image-clickable"),n.loading="lazy"):n.src="img/broken_image.png"),e}function Xn(e,n,r,a,i){if(i.includes("QQ"))return Kn.call(this,e,n,r,a);if(!e)return r;let o=$t.Drafty.tagName(e),s=$t.Drafty.attrValue(e,n)||{};switch(s.key=a,e){case"AU":s.src&&(s.src=this.authorizeURL(Tn(s.src,"audio")),s.duration=n.duration>0?0|n.duration:void 0,s.preview=n.preview,s.loading="lazy"),o=Hn,r=null;break;case"BR":r=null;break;case"EX":case"RW":break;case"HL":s.className="highlight";break;case"HD":o=null,r=null;break;case"IM":o=Gn.call(this,o,n,s),r=null;break;case"BN":s.onClick=this.onFormButtonClick;let e=t().Children.map(r,(e=>"string"==typeof e?e:void 0));e&&0!=e.length||(e=[s.name]),s["data-title"]=e.join("");break;case"MN":s.className="mention",n&&(s.className+=" "+yn(n.val,!1,!0));break;case"FM":s.className="bot-form";break;case"QQ":s.className="reply-quote",s.onClick=this.onQuoteClick;break;case"VC":o=qn,r=null,n&&(s.callState=n.state,s.incoming=n.incoming,s.duration=n.duration);break;default:if(!o){o=t().Fragment,s={key:a};let e=r;Array.isArray(r)&&r.join("").trim()||(e=[t().createElement("span",{key:"x1",className:"gray"},this.formatMessage(Yn.drafty_unknown))]),r=[t().createElement("i",{key:"x0",className:"material-icons gray"},"extension")," "].concat(e)}}return o?t().createElement(o,s,r):r}function $n(e,n,r,a){if(!e)return r;let i=$t.Drafty.tagName(e);const o={key:a};switch(e){case"AU":i=t().Fragment,r=[t().createElement("i",{key:"au",className:"material-icons"},"mic")," ",_n(n.duration/1e3)];break;case"BR":i=t().Fragment,r=[" "];break;case"HL":o.className="highlight preview";break;case"LN":case"MN":i="span";break;case"IM":i=t().Fragment,r=[t().createElement("i",{key:"im",className:"material-icons"},"photo")," ",this.formatMessage(Yn.drafty_image)];break;case"BN":i="span",o.className="flat-button faux";break;case"FM":i=t().Fragment,r=[t().createElement("i",{key:"fm",className:"material-icons"},"dashboard"),this.formatMessage(Yn.drafty_form)].concat(" ",r||[]);break;case"RW":i=t().Fragment;break;case"EX":if(n){if("application/json"==n.mime)return null;delete n.val,delete n.ref}i=t().Fragment,r=[t().createElement("i",{key:"ex",className:"material-icons"},"attachment")," ",this.formatMessage(Yn.drafty_attachment)];break;case"VC":i=Un,n&&(o.callState=n.state,o.incoming=n.incoming,o.duration=n.duration),r=null;break;case"QQ":case"HD":i=null,r=null;break;default:i||(i=t().Fragment,r=[t().createElement("i",{key:"x0",className:"material-icons gray"},"extension")," ",this.formatMessage(Yn.drafty_unknown)])}return i?t().createElement(i,o,r):r}function jn(e,t){return e.style={width:"36px",height:"36px",maxWidth:"36px",maxHeight:"36px"},e.className="inline-image",e.alt=this.formatMessage(Yn.drafty_image),t||(e.src="img/broken_image.png"),e.title=e.alt,e}function Kn(e,n,r,a){if(["BR","EX","IM","MN"].includes(e)){let i=$t.Drafty.tagName(e),o=$t.Drafty.attrValue(e,n)||{};switch(o.key=a,e){case"BR":r=null;break;case"IM":o=jn.call(this,o,n),r=[t().createElement("img",o,null)," ",o.alt],i=t().Fragment,o={key:a};break;case"MN":i="span",o.className="mention",n&&(o.className+=" "+yn(n.val,!1,!0));break;case"EX":let e;if(n){if("application/json"==n.mime)return null;e=n.name,delete n.val,delete n.ref}i=t().Fragment,r=[t().createElement("i",{key:"ex",className:"material-icons"},"attachment"),fn(e,16)||this.formatMessage(Yn.drafty_attachment)]}return t().createElement(i,o,r)}return $n.call(this,e,n,r,a)}function Zn(e){let t;if(e.val){const n=function(e,t){if(!e)return null;try{const n=atob(e),r=n.length,a=new ArrayBuffer(r),i=new Uint8Array(a);for(let e=0;e<r;e++)i[e]=n.charCodeAt(e);return new Blob([a],{type:t})}catch(e){console.error("Failed to convert base64 to blob: ",e)}return null}(e.val,e.mime);if(!n)throw new Error("Invalid image");t=Promise.resolve(n)}else{if(!e.ref)throw new Error("Missing image data");t=fetch(this.authorizeURL(Tn(e.ref,"image"))).then((e=>{if(e.ok)return e.blob();throw new Error(`Image fetch unsuccessful: ${e.status} ${e.statusText}`)}))}return t.then((e=>In(e,sn,sn,-1,!0))).then((t=>(e.mime=t.mime,e.size=t.blob.size,e.width=t.width,e.height=t.height,delete e.ref,e.src=URL.createObjectURL(t.blob),Pn(t.blob)))).then((t=>(e.val=t.bits,e))).catch((t=>{throw delete e.val,delete e.src,e.width=sn,e.height=sn,t}))}function Qn(e,n,r,a,i){if("IM"==e){const e=jn.call(this,{key:a},n);let i;try{i=En(Zn.call(this,n))}catch(e){i=En(e)}return e.whenDone=i,r=[t().createElement(Vn,e,null)," ",e.alt],t().createElement(t().Fragment,{key:a},r)}if("QQ"==e){if(i.includes("QQ"))return t().createElement("span",{key:a},[t().createElement("i",{key:"qq",className:"material-icons"},"format_quote")," "]);const e=$t.Drafty.attrValue("QQ",n)||{};return e.key=a,e.className="reply-quote",t().createElement($t.Drafty.tagName("QQ"),e,r)}return Kn.call(this,e,n,r,a)}class Jn extends t().Component{constructor(e){super(e),this.handleClick=this.handleClick.bind(this),this.handleContextClick=this.handleContextClick.bind(this)}handleClick(e){e.preventDefault(),e.stopPropagation(),this.props.onSelected&&this.props.onSelected(this.props.item,this.props.index)}handleContextClick(e){e.preventDefault(),e.stopPropagation(),this.props.showContextMenu({topicName:this.props.item,y:e.pageY,x:e.pageX})}render(){let e=this.props.title;e?e.length>30&&(e=e.substring(0,28)+"…"):e=t().createElement("i",null,t().createElement(i.FormattedMessage,{id:"unnamed_topic",defaultMessage:[{type:0,value:"Unnamed"}]}));const n=this.props.now?"online":"offline",r=!this.props.avatar||this.props.avatar,a=this.props.badges?this.props.badges.slice():[],o=[];let s;this.props.isVerified&&o.push({icon:"verified",color:"verified-color"}),this.props.isStaff&&o.push({icon:"staff",color:"staff-color"}),this.props.isDangerous&&o.push({icon:"dangerous",color:"danger-color"}),this.props.acs&&(this.props.showMode&&a.push({name:this.props.acs.getMode(),key:"mode"}),this.props.acs.isMuted()&&o.push({icon:"muted"}),this.props.acs.isJoiner()||o.push({icon:"banned"})),"string"==typeof this.props.preview?s=this.props.preview:$t.Drafty.isValid(this.props.preview)?s=t().createElement(t().Fragment,null,$t.Drafty.format(this.props.preview,$n,{formatMessage:this.props.intl.formatMessage,previewIsResponse:this.props.previewIsResponse})):this.props.preview&&(s=t().createElement(t().Fragment,null,t().createElement("i",{className:"material-icons gray"},"warning_amber")," ",t().createElement("i",{className:"gray"},t().createElement(i.FormattedMessage,{id:"invalid_content",defaultMessage:[{type:0,value:"invalid content"}]}))));const l=Cn(this.props.received),c=l?t().createElement("i",{className:"material-icons small space-right"+(l.color?" "+l.color:"")},l.name):null,u="contact-title"+(this.props.deleted?" deleted":"");return t().createElement("li",{className:!this.props.showCheckmark&&this.props.selected?"selected":null,onClick:this.handleClick},t().createElement("div",{className:"avatar-box"},t().createElement(Sn,{tinode:this.props.tinode,avatar:r,title:this.props.title,topic:this.props.item,deleted:this.props.deleted}),this.props.deleted?t().createElement("i",{className:"deleted material-icons"},"cancel"):this.props.showOnline?t().createElement("span",{className:n}):this.props.showCheckmark&&this.props.selected?t().createElement("i",{className:"checkmark material-icons"},"check_circle"):null),t().createElement("div",{className:"text-box"},t().createElement("div",null,t().createElement("span",{className:u},e),this.props.isChannel?t().createElement("img",{src:"/img/channel.png",className:"channel",alt:"channel"}):null,t().createElement(mn,{badges:o}),this.props.deleted?null:t().createElement(Dn,{count:this.props.unread})),this.props.showMode?t().createElement("span",null,t().createElement(mn,{badges:a})):this.props.small?null:t().createElement("div",{className:"contact-comment"},c,t().createElement("span",null,s||this.props.comment||" "))),this.props.showContextMenu?t().createElement("span",{className:"menuTrigger"},t().createElement("a",{href:"#",onClick:this.handleContextClick},t().createElement("i",{className:"material-icons"},"expand_more"))):null)}}const er=(0,i.injectIntl)(Jn);class tr extends t().PureComponent{constructor(e){super(e),this.handleClick=this.handleClick.bind(this)}handleClick(e){e.preventDefault(),e.stopPropagation(),this.props.onAction(this.props.action)}render(){const{formatMessage:e}=this.props.intl;return t().createElement("li",{onClick:this.handleClick,className:"action"},t().createElement("div",{className:"action-text"},e(this.props.title,this.props.values)))}}const nr=(0,i.injectIntl)(tr),rr=(0,i.defineMessages)({badge_you:{id:"badge_you",defaultMessage:[{type:0,value:"you"}]},badge_owner:{id:"badge_owner",defaultMessage:[{type:0,value:"owner"}]}});class ar extends t().Component{render(){const{formatMessage:e}=this.props.intl,n=Array.isArray(this.props.topicSelected),r=[];let a=0;return this.props.contacts&&this.props.contacts.length>0&&this.props.contacts.map((i=>{if(i.action)r.push(t().createElement(nr,{title:i.title,action:i.action,values:i.values,key:i.action,onAction:this.props.onAction}));else{const o=this.props.showMode?i.user:i.topic||i.user;if(this.props.filterFunc&&this.props.filter){const e=[o];if(i.private&&i.private.comment&&e.push((""+i.private.comment).toLowerCase()),i.public&&i.public.fn&&e.push((""+i.public.fn).toLowerCase()),!this.props.filterFunc(this.props.filter,e))return}const s=$t.Tinode.isChannelTopicName(o),l=n?this.props.topicSelected.indexOf(o)>-1:this.props.topicSelected===o,c=[];this.props.showMode&&(o==this.props.myUserId&&c.push({name:e(rr.badge_you),color:"green"}),i.acs&&i.acs.isOwner()&&c.push({name:e(rr.badge_owner),color:"blue"}));const u=Array.isArray(i.private)?i.private.join(","):i.private?i.private.comment:null;let h,d,p,m;if(!this.props.showMode&&i.latestMessage){const e=i.latestMessage(!0);e&&(d=e.head?e.head.forwarded:null,m=e._status||i.msgStatus(e,!0),p=e.from!=this.props.myUserId,e.content&&(h="string"==typeof e.content?e.content.substr(0,80):$t.Drafty.preview(e.content,80)))}r.push(t().createElement(er,{tinode:this.props.tinode,title:i.public?i.public.fn:null,avatar:Mn(i.public?i.public.photo:null),comment:u,preview:h,previewIsResponse:p,forwarded:d,received:m,unread:this.props.showUnread?i.unread:0,now:i.online&&this.props.connected,acs:i.acs,showMode:this.props.showMode,badges:c,showCheckmark:n,selected:l,showOnline:this.props.showOnline&&!s,isChannel:s,showContextMenu:this.props.showContextMenu,isVerified:i.trusted&&i.trusted.verified,isStaff:i.trusted&&i.trusted.staff,isDangerous:i.trusted&&i.trusted.danger,deleted:i._deleted,onSelected:this.props.onTopicSelected,item:o,index:r.length,key:o})),a++}}),this),t().createElement("div",{className:this.props.noScroll?null:"scrollable-panel"},0==a?t().createElement("div",{className:"center-medium-text",dangerouslySetInnerHTML:{__html:this.props.emptyListMessage}}):null,r.length>0?t().createElement("ul",{className:"contact-box"},r):null)}}const ir=(0,i.injectIntl)(ar);class or extends t().PureComponent{constructor(e){super(e),this.state={edited:!1,search:""},this.handleSearchChange=this.handleSearchChange.bind(this),this.handleSearch=this.handleSearch.bind(this),this.handleClear=this.handleClear.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this)}componentWillUnmount(){this.state.edited&&(this.setState({search:"",edited:!1}),this.props.onSearchContacts($t.Tinode.DEL_CHAR))}handleSearchChange(e){this.setState({search:e.target.value})}handleSearch(e){e.preventDefault();var t=this.state.search.trim();this.setState({edited:t.length>0}),this.props.onSearchContacts(t.length>0?t:$t.Tinode.DEL_CHAR)}handleClear(e){e.preventDefault(),this.state.edited&&this.props.onSearchContacts($t.Tinode.DEL_CHAR),this.setState({search:"",edited:!1})}handleKeyDown(e){"Enter"===e.key?this.handleSearch(e):"Escape"===e.key&&this.handleClear()}render(){return t().createElement("div",{className:"panel-form"},t().createElement("div",{className:"panel-form-row"},t().createElement("i",{className:"material-icons search"},"search"),t().createElement("input",{className:"search",type:"text",placeholder:this.props.placeholder,value:this.state.search,onChange:this.handleSearchChange,onKeyDown:this.handleKeyDown,required:!0,autoFocus:!0}),this.state.search?t().createElement("a",{href:"#",onClick:this.handleClear},t().createElement("i",{className:"material-icons"},"highlight_off")):t().createElement("span",null,t().createElement("i",{className:"material-icons"}," "))))}}class sr extends t().Component{constructor(e){super(e),this.state={query:null},this.handleEscapeKey=this.handleEscapeKey.bind(this),this.handleClose=this.handleClose.bind(this),this.handleSearchContacts=this.handleSearchContacts.bind(this),this.handleContactSelected=this.handleContactSelected.bind(this)}componentDidMount(){this.props.onInitFind()}handleEscapeKey(e){27===e.keyCode&&this.props.hide(!1)}handleClose(e){e.preventDefault(),this.props.hide(!1)}handleSearchContacts(e){this.setState({query:$t.Tinode.isNullValue(e)?null:e}),this.props.onSearchContacts(e)}handleContactSelected(e){this.props.onTopicSelected(e),this.props.hide(!0)}render(){let e=null!=this.state.query?this.props.searchResults:this.props.contacts;return e=e.filter((e=>e.name!=this.props.topicSelected&&e.acs.isJoiner()&&e.acs.isWriter())),t().createElement("div",{className:"alert-container"},t().createElement("div",{className:"forward-dialog"},t().createElement("div",{className:"title with-control"},t().createElement("div",null,t().createElement(i.FormattedMessage,{id:"forward_to",defaultMessage:[{type:0,value:"Forward to"}],desription:"Title of the contact selector dialog when forwarding a message"})),t().createElement("div",null,t().createElement("a",{href:"#",onClick:this.handleClose},t().createElement("i",{className:"material-icons"},"close")))),t().createElement(i.FormattedMessage,{id:"forward_to_search_placeholder",defaultMessage:[{type:0,value:"Search contacts"}]},(e=>t().createElement(or,{placeholder:e,onSearchContacts:this.handleSearchContacts}))),t().createElement(i.FormattedMessage,{id:"search_no_results",defaultMessage:[{type:0,value:"Search returned no results"}]},(n=>t().createElement(ir,{tinode:this.props.tinode,contacts:e,myUserId:this.props.myUserId,emptyListMessage:n,showOnline:!1,showUnread:!1,showContextMenu:!1,onTopicSelected:this.handleContactSelected})))))}}const lr={staff:"verified_user"},cr=(0,i.defineMessages)({badge_verified:{id:"badge_verified",defaultMessage:[{type:0,value:"Verified/official"}]},badge_staff:{id:"badge_staff",defaultMessage:[{type:0,value:"Staff-managed"}]},badge_danger:{id:"badge_danger",defaultMessage:[{type:0,value:"Untrustworthy"}]}});class ur extends t().PureComponent{render(){const{formatMessage:e}=this.props.intl;let n=null;return this.props.trustedBadges&&this.props.trustedBadges.length>0?(n=[],this.props.trustedBadges.map((r=>{const a=this.props.short?null:e(cr["badge_"+r]),i="material-icons "+r+"-color";n.push(t().createElement("div",{className:"trusted-badge",key:r},t().createElement("i",{className:i},lr[r]||r)," ",a))})),t().createElement(t().Fragment,null,n)):null}}const hr=(0,i.injectIntl)(ur),dr="started",pr=new Audio("audio/call-in.m4a");class mr extends t().Component{constructor(e){super(e),this.state={topic:null,fullName:void 0,avatar:null,trustedBadges:[],previousMetaDesc:void 0},this.resetDesc=this.resetDesc.bind(this),this.onMetaDesc=this.onMetaDesc.bind(this),this.handleRejectCall=this.handleRejectCall.bind(this),this.handleAcceptCall=this.handleAcceptCall.bind(this),this.ringTimer=null}componentDidMount(){const e=this.props.tinode.getTopic(this.props.topic);e&&(this.resetDesc(e,this.props),2==this.props.callState&&(pr.play().catch((e=>{})),this.ringTimer=setInterval((e=>{pr.play().catch((e=>{}))}),2e3),this.props.onRinging(this.props.topic,this.props.seq)))}componentDidUpdate(e){const t=this.props.tinode.getTopic(e.topic);t&&(this.onMetaDesc!=t.onMetaDesc&&(this.previousMetaDesc=t.onMetaDesc,t.onMetaDesc=this.onMetaDesc),this.state.topic!=e.topic&&(this.setState({topic:e.topic}),this.resetDesc(t,e)))}componentWillUnmount(){null!=this.ringTimer&&(clearInterval(this.ringTimer),pr.pause());const e=this.props.tinode.getTopic(this.props.topic);e&&(this.setState({topic:null}),e.onMetaDesc=this.previousMetaDesc)}resetDesc(e,t){e.getDefaultAccess(),e.getAccessMode();const n=[];if(e.trusted)for(const[t,r]of Object.entries(e.trusted))r&&n.push(t);this.setState({fullName:An(e.public?e.public.fn:void 0,ln),avatar:Mn(e.public?e.public.photo:null),trustedBadges:n})}onMetaDesc(e){const t=this.props.tinode.getTopic(this.props.topic);t&&(this.resetDesc(t,this.props),this.previousMetaDesc&&this.previousMetaDesc!=this.onMetaDesc&&this.previousMetaDesc(e))}handleAcceptCall(){this.props.onAcceptCall(this.props.topic)}handleRejectCall(){this.props.onReject(this.props.topic,this.props.seq),this.props.onClose()}render(){return t().createElement("div",{className:"alert-container"},t().createElement("div",{className:"incoming-call"},t().createElement("div",{className:"caller-card incoming pulse"},t().createElement("div",{className:"avatar-box"},t().createElement(Sn,{tinode:this.props.tinode,avatar:this.state.avatar||!0,topic:this.props.topic,title:this.state.fullName})),t().createElement("div",{className:"caller-name"},An(this.state.fullName,20),t().createElement(hr,{short:!0,trustedBadges:this.state.trustedBadges}))),t().createElement("div",{className:"controls"},2==this.props.callState?t().createElement(t().Fragment,null,t().createElement("button",{className:"danger",onClick:this.handleRejectCall},t().createElement("i",{className:"material-icons"},"call_end")),t().createElement("button",{className:"positive",onClick:this.handleAcceptCall},t().createElement("i",{className:"material-icons"},"call"))):null)))}}class _r extends t().PureComponent{render(){const e="load-spinner-box"+(this.props.large?" large":"")+(this.props.clear?" clear":"")+(this.props.centered?" centered":"");return this.props.show?t().createElement("div",{className:e},t().createElement("div",{className:"loader-spinner"})):null}}class gr extends t().Component{constructor(e){super(e),this.state={source:e.avatar},this.handleFileReceived=this.handleFileReceived.bind(this)}componentDidUpdate(e){this.props.avatar!=e.avatar&&this.setState({source:this.props.avatar})}handleFileReceived(e){const t=e.target.files[0];this.props.onImageUpdated(t.type,URL.createObjectURL(t),t.name),e.target.value=""}render(){const e="file-input-avatar-"+(""+Math.random()).substring(0,4),n="avatar-upload"+(this.props.readOnly?" read-only":"");return t().createElement("div",{className:n},this.props.readOnly||!this.state.source?null:t().createElement("a",{href:"#",className:"clear-avatar",onClick:e=>{e.preventDefault(),this.props.onImageUpdated()}},t().createElement("i",{className:"material-icons"},"clear")),this.state.source?t().createElement("img",{src:this.props.tinode.authorizeURL(Tn(this.state.source,"image")),className:"preview"}):this.props.readOnly&&this.props.uid?t().createElement("div",{className:"avatar-box"},t().createElement(Sn,{tinode:this.props.tinode,avatar:!0,topic:this.props.uid,title:this.props.title})):t().createElement("div",{className:"blank"},rn,"×",rn),this.props.readOnly?null:t().createElement("input",{type:"file",id:e,className:"inputfile hidden",accept:"image/*",onChange:this.handleFileReceived}),this.props.readOnly?null:t().createElement("label",{htmlFor:e,className:"round"},t().createElement("i",{className:"material-icons"},"file_upload")),t().createElement(_r,{show:this.props.uploading,large:!0,clear:!0,centered:!0}))}}class fr extends t().PureComponent{constructor(e){super(e),this.handleChange=this.handleChange.bind(this)}handleChange(){this.props.onChange(this.props.name,!this.props.checked)}render(){let e,n=["material-icons"];Array.isArray(this.props.className)?n.push(...this.props.className):this.props.className&&n.push(this.props.className),this.props.onChange?this.props.checked?(n.push("blue","clickable"),e="check_box"):!1===this.props.checked?(n.push("blue","clickable"),e="check_box_outline_blank"):(n.push("lt-blue"),e="indeterminate_check_box"):e=this.props.checked?"check_box":"check_box_outline_blank";let r={className:n.join(" "),id:this.props.id};return this.props.onChange&&(r.onClick=this.handleChange),t().createElement("i",r,e)}}class yr extends t().PureComponent{render(){return t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.props.onCancel()}},t().createElement("i",{className:"material-icons"},"close"))}}class vr extends t().PureComponent{constructor(e){super(e),this.state={show:!1},this.hide=this.hide.bind(this)}componentDidUpdate(e){e.level!==this.props.level&&this.setState({show:!!this.props.level})}hide(){this.setState({show:!1}),this.props.onClearError&&this.props.onClearError()}render(){const e={err:"error",warn:"warning",info:"info"}[this.props.level]||"",n="info-box "+e;return t().createElement("div",{className:n},t().createElement("div",{className:"icon"},t().createElement("i",{className:"material-icons"},e)),t().createElement("span",null,this.props.text,this.props.action?t().createElement(t().Fragment,null,t().createElement("a",{href:"#",style:{whiteSpace:"nowrap"},onClick:e=>{e.preventDefault(),this.props.action()}},this.props.actionText)):null),t().createElement("div",{className:"cancel"},t().createElement(yr,{onCancel:this.hide})))}}class br extends t().PureComponent{constructor(e){super(e),this.handleCancel=this.handleCancel.bind(this)}handleCancel(e){e.preventDefault(),this.props.onCancel(this.props.topic,this.props.index)}render(){const e=this.props.title||this.props.topic,n=this.props.invalid?"chip invalid":"chip";return t().createElement("div",{className:n},this.props.noAvatar?t().createElement("span",{className:"spacer"}):t().createElement("div",{className:"avatar-box"},t().createElement(Sn,{tinode:this.props.tinode,avatar:this.props.avatar||!0,topic:this.props.topic,title:this.props.title})),t().createElement("span",null,e),this.props.onCancel&&!this.props.required?t().createElement("a",{href:"#",onClick:this.handleCancel},"×"):t().createElement("span",{className:"spacer"}))}}class xr extends t().Component{constructor(e){super(e),this.state=xr.deriveStateFromProps(e),this.state.input="",this.state.focused=!1,this.handleTextInput=this.handleTextInput.bind(this),this.removeChipAt=this.removeChipAt.bind(this),this.handleChipCancel=this.handleChipCancel.bind(this),this.handleFocusGained=this.handleFocusGained.bind(this),this.handleFocusLost=this.handleFocusLost.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this)}static deriveStateFromProps(e){return{placeholder:e.chips?"":e.prompt,sortedChips:xr.sortChips(e.chips,e.staticMembers),chipIndex:xr.indexChips(e.chips)}}componentDidUpdate(e,t){e.chips==this.props.chips&&e.staticMembers==this.props.staticMembers&&e.prompt==this.props.prompt||this.setState(xr.deriveStateFromProps(this.props)),(!t||this.props.chips.length>t.sortedChips.length)&&this.setState({input:""})}static indexChips(e){const t={};let n=0;return e.map((e=>{t[e.user]=n,n++})),t}static sortChips(e,t){const n=[],r=[];return e.map((e=>{t&&t.includes(e.user)?n.push(e):r.push(e)})),n.concat(r)}handleTextInput(e){this.setState({input:e.target.value}),this.props.filterFunc&&this.props.filterFunc(e.target.value)}removeChipAt(e){const t=this.state.sortedChips[e];this.props.onChipRemoved(t.user,this.state.chipIndex[t.user])}handleChipCancel(e,t){this.removeChipAt(t)}handleFocusGained(){this.setState({focused:!0})}handleFocusLost(){this.setState({focused:!1}),this.props.onFocusLost&&this.props.onFocusLost(this.state.input)}handleKeyDown(e){if("Backspace"===e.key){if(0==this.state.input.length&&this.state.sortedChips.length>0){const e=this.state.sortedChips.length-1;this.state.sortedChips[e].user!==this.props.staticMembers&&this.removeChipAt(e)}}else"Enter"===e.key?this.props.onEnter&&this.props.onEnter(this.state.input):"Escape"===e.key&&this.props.onCancel&&this.props.onCancel()}render(){const e=[];let n=0;const r=this.props.staticMembers||[];this.state.sortedChips.map((a=>{e.push(t().createElement(br,{tinode:this.props.tinode,onCancel:this.handleChipCancel,avatar:Mn(a.public?a.public.photo:null),title:a.public?a.public.fn:void 0,noAvatar:this.props.avatarDisabled,topic:a.user,required:r.includes(a.user),invalid:a.invalid,index:n,key:a.user})),n++}));const a="chip-input"+(this.state.focused?" focused":""),i=!(this.props.tabIndex>0);return t().createElement("div",{className:a},e,t().createElement("input",{type:"text",placeholder:this.state.placeholder,onChange:this.handleTextInput,onFocus:this.handleFocusGained,onBlur:this.handleFocusLost,onKeyDown:this.handleKeyDown,value:this.state.input,tabIndex:this.props.tabIndex,autoFocus:i}))}}const wr=(0,i.defineMessages)({no_contacts:{id:"no_contacts",defaultMessage:[{type:0,value:"You have no contacts :-("}]},contacts_not_found_short:{id:"contacts_not_found_short",defaultMessage:[{type:0,value:"No contacts match '"},{type:1,value:"query"},{type:0,value:"'"}]}});class Tr extends t().Component{constructor(e){super(e),this.state={members:e.members,index:Tr.indexMembers(e.members),staticMembers:Tr.staticMembers(e.members,e.keepInitialMembers,e.requiredMember),contactFilter:"",noContactsMessage:e.intl.formatMessage(wr.no_contacts),selectedContacts:Tr.selectedContacts(e.members)},this.handleContactSelected=this.handleContactSelected.bind(this),this.handleMemberRemoved=this.handleMemberRemoved.bind(this),this.handleContactFilter=this.handleContactFilter.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.handleCancel=this.handleCancel.bind(this)}static indexMembers(e){let t={};return e.map((e=>{t[e.user]={delta:0,present:!0}})),t}static staticMembers(e,t,n){let r=[];return e.map((e=>{(t||e.user==n)&&r.push(e.user)})),r}static selectedContacts(e){let t=[];return e.map((e=>{t.push(e.user)})),t}handleContactSelected(e,t){let n=this.state.index[e];if(n){if(n.present)return;n.delta+=1,n.present=!0}else n={delta:1,present:!0};let r=this.state.members.slice();r.push(this.props.contacts[t]);const a=Tr.selectedContacts(r),i=this.state.index;i[e]=n,this.setState({members:r,index:i,selectedContacts:a})}handleMemberRemoved(e,t){const n=this.state.index[e];if(!n||!n.present)return;n.present=!1,n.delta-=1;let r=this.state.members.slice();r.splice(t,1);const a=Tr.selectedContacts(r),i=this.state.index;i[e]=n,this.setState({members:r,index:i,selectedContacts:a})}handleContactFilter(e){const{formatMessage:t}=this.props.intl,n=e?t(wr.contacts_not_found_short,{query:e}):t(wr.no_contacts);this.setState({contactFilter:e,noContactsMessage:n})}static doContactFiltering(e,t){if(e){for(let n=0;n<t.length;n++)if(t[n].indexOf(e)>=0)return!0;return!1}return!0}handleSubmit(){var e=this,t=[],n=[],r=[];Object.keys(this.state.index).map((function(a){e.state.index[a].present&&t.push(a),e.state.index[a].delta>0?n.push(a):e.state.index[a].delta<0&&r.push(a)})),this.props.onSubmit(t,n,r)}handleCancel(){this.props.onCancel()}render(){const{formatMessage:e}=this.props.intl;return t().createElement("div",{id:"group-manager"},t().createElement("div",{className:"panel-form-row"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"title_group_members",defaultMessage:[{type:0,value:"Group Members"}]}))),t().createElement("div",{className:"panel-form-row"},t().createElement(xr,{tinode:this.props.tinode,chips:this.state.members,staticMembers:this.state.staticMembers,prompt:"add members",filterFunc:this.handleContactFilter,onChipRemoved:this.handleMemberRemoved})),t().createElement("div",{className:"panel-form-row"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"title_all_contacts",defaultMessage:[{type:0,value:"All Contacts"}]}))),t().createElement(ir,{tinode:this.props.tinode,contacts:this.props.contacts,myUserId:this.props.myUserId,topicSelected:this.state.selectedContacts,filter:this.state.contactFilter,filterFunc:Tr.doContactFiltering,emptyListMessage:this.state.noContactsMessage,showOnline:!1,showUnread:!1,onTopicSelected:this.handleContactSelected}),t().createElement("div",{id:"group-manager-buttons",className:"panel-form-row"},t().createElement("button",{className:"secondary",onClick:this.handleCancel},t().createElement(i.FormattedMessage,{id:"button_cancel",defaultMessage:[{type:0,value:"Cancel"}]})),t().createElement("button",{className:"primary",onClick:this.handleSubmit},t().createElement(i.FormattedMessage,{id:"button_ok",defaultMessage:[{type:0,value:"OK"}]}))))}}const Cr=(0,i.injectIntl)(Tr),Er=(0,i.defineMessages)({joiner:{id:"permission_join",defaultMessage:[{type:0,value:"Join ("},{type:1,value:"val"},{type:0,value:")"}]},reader:{id:"permission_read",defaultMessage:[{type:0,value:"Read ("},{type:1,value:"val"},{type:0,value:")"}]},writer:{id:"permission_write",defaultMessage:[{type:0,value:"Write ("},{type:1,value:"val"},{type:0,value:")"}]},preser:{id:"permission_pres",defaultMessage:[{type:0,value:"Get notified ("},{type:1,value:"val"},{type:0,value:")"}]},approver:{id:"permission_admin",defaultMessage:[{type:0,value:"Approve ("},{type:1,value:"val"},{type:0,value:")"}]},sharer:{id:"permission_share",defaultMessage:[{type:0,value:"Share ("},{type:1,value:"val"},{type:0,value:")"}]},deleter:{id:"permission_delete",defaultMessage:[{type:0,value:"Delete ("},{type:1,value:"val"},{type:0,value:")"}]},owner:{id:"permission_owner",defaultMessage:[{type:0,value:"Owner ("},{type:1,value:"val"},{type:0,value:")"}]}});class Ar extends t().Component{constructor(e){super(e),this.state={mode:(e.mode||"").replace("N","")},this.handleChange=this.handleChange.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.handleCancel=this.handleCancel.bind(this)}handleChange(e){let t=this.state.mode;-1==t.indexOf(e)?t+=e:t=t.replace(e,""),this.setState({mode:t})}handleSubmit(){const e=(this.state.mode||"N").split("").sort().join("");e!==(this.props.mode||"N").split("").sort().join("")?this.props.onSubmit(e):this.props.onCancel()}handleCancel(){this.props.onCancel()}render(){const{formatMessage:e}=this.props.intl,n="JRWPASDO",r={J:e(Er.joiner,{val:"J"}),R:e(Er.reader,{val:"R"}),W:e(Er.writer,{val:"W"}),P:e(Er.preser,{val:"P"}),A:e(Er.approver,{val:"A"}),S:e(Er.sharer,{val:"S"}),D:e(Er.deleter,{val:"D"}),O:e(Er.owner,{val:"O"})};let a=this.props.skip||"",o=this.state.mode,s=(this.props.compare||"").replace("N",""),l=[];for(let e=0;e<n.length;e++){let i=n.charAt(e);a.indexOf(i)>=0&&o.indexOf(i)<0||l.push(t().createElement("tr",{key:i},t().createElement("td",null,r[i]),t().createElement("td",{className:"checkbox"},a.indexOf(i)<0?t().createElement(fr,{name:i,checked:o.indexOf(i)>=0,onChange:this.handleChange}):t().createElement(fr,{name:i,checked:o.indexOf(i)>=0})),this.props.compare?t().createElement("td",{className:"checkbox"},t().createElement(fr,{name:i,checked:s.indexOf(i)>=0})):null))}return t().createElement("div",{className:"panel-form-column"},this.props.userTitle?t().createElement("ul",{className:"contact-box small"},t().createElement(er,{tinode:this.props.tinode,item:this.props.item,title:this.props.userTitle,small:!0,avatar:Mn(this.props.userAvatar?this.props.userAvatar:null)})):null,t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"title_permissions",defaultMessage:[{type:0,value:"Permissions"}]})),t().createElement("table",{className:"permission-editor"},this.props.compare?t().createElement("thead",null,t().createElement("tr",null,t().createElement("th",null),t().createElement("th",null,this.props.modeTitle),t().createElement("th",null,this.props.compareTitle))):null,t().createElement("tbody",null,l)),t().createElement("br",null),t().createElement("div",{className:"dialog-buttons"},t().createElement("button",{className:"outline",onClick:this.handleCancel},t().createElement(i.FormattedMessage,{id:"button_cancel",defaultMessage:[{type:0,value:"Cancel"}]})),t().createElement("button",{className:"primary",onClick:this.handleSubmit},t().createElement(i.FormattedMessage,{id:"button_ok",defaultMessage:[{type:0,value:"OK"}]}))))}}const Sr=(0,i.injectIntl)(Ar);class Dr extends t().Component{constructor(e){super(e),this.state={panX:0,panY:0,originX:0,originY:0,zoom:1,minZoom:0,maxZoom:2.5},this.overlay=t().createRef(),this.cutout=t().createRef(),this.preview=t().createRef(),this.boundingBox=t().createRef(),this.imageWidth=0,this.imageHeight=0,this.mouseX=0,this.mouseY=0,this.prevDistance=0,this.cutoutRect={},this.bBoxRect={},this.originX=0,this.originY=0,this.initScaling=this.initScaling.bind(this),this.onZoom=this.onZoom.bind(this),this.handleZoom=this.handleZoom.bind(this),this.mouseDown=this.mouseDown.bind(this),this.mouseUp=this.mouseUp.bind(this),this.mouseMove=this.mouseMove.bind(this),this.mouseTouch=this.mouseTouch.bind(this),this.positionAll=this.positionAll.bind(this),this.translate=this.translate.bind(this)}componentDidMount(){this.overlay.current.addEventListener("mousedown",this.mouseDown,{passive:!0}),this.overlay.current.addEventListener("touchstart",this.mouseDown,{passive:!0}),this.bBoxRect=this.boundingBox.current.getBoundingClientRect(),this.originX=this.bBoxRect.width/2,this.originY=this.bBoxRect.height/2,this.cutoutRect=this.cutout.current.getBoundingClientRect()}componentWillUnmount(){this.overlay.current.removeEventListener("mousedown",this.mouseDown),this.overlay.current.removeEventListener("touchstart",this.mouseDown)}positionAll(e,t,n){this.setState({panX:e,panY:t,zoom:n,originX:this.originX-e,originY:this.originY-t});const r=(this.originX-e)*n-this.originX,a=(this.originY-t)*n-this.originY;this.props.onChange((r+this.cutoutRect.left-this.bBoxRect.left)/n,(a+this.cutoutRect.top-this.bBoxRect.top)/n,this.cutoutRect.width/n,this.cutoutRect.height/n,n)}static checkBound(e,t,n,r){let a=Math.min(0,n[0]-t[0]-r,t[1]-n[1]+r);return(0==a||Math.min(0,n[0]-t[0],t[1]-n[1])<a)&&(e+=r),e}initScaling(){const e=this.preview.current.getBoundingClientRect();this.imageWidth=e.width,this.imageHeight=e.height;const t=Math.max(this.cutoutRect.width/e.width,this.cutoutRect.height/e.height);this.setState({minZoom:t,maxZoom:Math.max(2.5,t+1)});const n=Math.max(this.bBoxRect.width/e.width,this.bBoxRect.height/e.height),r=this.cutoutRect.left-this.bBoxRect.left-(e.width-this.cutoutRect.width)/2,a=this.cutoutRect.top-this.bBoxRect.top-(e.height-this.cutoutRect.height)/2;this.positionAll(r,a,n)}onZoom(e){this.handleZoom(e.target.value)}handleZoom(e){let t=this.state.panX,n=this.state.panY;const r=this.originX-(this.originX-t)*e,a=r+this.imageWidth*e,i=this.cutoutRect.left-this.bBoxRect.left,o=i+this.cutoutRect.width;i<r?t-=r-i:o>a&&(t+=o-a);const s=this.originY-(this.originY-n)*e,l=s+this.imageHeight*e,c=this.cutoutRect.top-this.bBoxRect.top,u=c+this.cutoutRect.height;c<s?n-=s-c:u>l&&(n+=u-l),this.positionAll(t,n,e)}mouseDown(e){e.touches?(this.mouseX=e.touches[0].pageX,this.mouseY=e.touches[0].pageY):(this.mouseX=e.pageX,this.mouseY=e.pageY),window.addEventListener("mousemove",this.mouseMove,{passive:!1}),window.addEventListener("touchmove",this.mouseTouch,{passive:!1}),window.addEventListener("mouseup",this.mouseUp,{passive:!0}),window.addEventListener("touchend",this.mouseUp,{passive:!0}),document.body.style.userSelect="none"}translate(e,t){const n=e-this.mouseX,r=t-this.mouseY;this.mouseX=e,this.mouseY=t;const a=this.preview.current.getBoundingClientRect();let i=Dr.checkBound(this.state.panX,[a.left,a.right],[this.cutoutRect.left,this.cutoutRect.right],n),o=Dr.checkBound(this.state.panY,[a.top,a.bottom],[this.cutoutRect.top,this.cutoutRect.bottom],r);this.positionAll(i,o,this.state.zoom)}mouseMove(e){e.preventDefault(),this.translate(e.pageX,e.pageY)}mouseTouch(e){if(e.preventDefault(),1==e.touches.length)return void this.translate(e.touches[0].pageX,e.touches[0].pageY);const[t,n]=e.touches,r=Math.sqrt((t.pageX-n.pageX)*(t.pageX-n.pageX)+(t.pageY-n.pageY)*(t.pageY-n.pageY));this.prevDistance||(this.prevDistance=r/this.state.zoom);let a=r/this.prevDistance;this.handleZoom(Math.max(this.minZoom,Math.min(this.maxZoom,a)))}mouseUp(e){window.removeEventListener("mousemove",this.mouseMove),window.removeEventListener("touchmove",this.mouseTouch),window.removeEventListener("mouseup",this.mouseUp),window.removeEventListener("touchend",this.mouseUp),document.body.style.userSelect="",this.positionAll(this.state.panX,this.state.panY,this.state.zoom)}render(){const e=`translate3d(${this.state.panX}px, ${this.state.panY}px, 0) scale(${this.state.zoom})`,n=`${this.state.originX}px ${this.state.originY}px`,r={top:this.originY-this.state.originY*this.state.zoom+"px",left:this.originX-this.state.originX*this.state.zoom+"px",width:this.imageWidth*this.state.zoom+"px",height:this.imageHeight*this.state.zoom+"px"};return t().createElement("div",{className:"cropper"},t().createElement("div",{className:"bounding-box",ref:this.boundingBox},t().createElement("img",{src:this.props.source,className:"preview",alt:"",style:{transform:e,transformOrigin:n},ref:this.preview,onLoad:this.initScaling}),t().createElement("div",{className:"cutout circle",ref:this.cutout}),t().createElement("div",{className:"overlay",style:r,ref:this.overlay})),t().createElement("div",{className:"zoom-wrapper"},t().createElement("input",{type:"range",className:"zoomer",step:"0.001",min:this.state.minZoom,max:this.state.maxZoom,value:this.state.zoom,onChange:this.onZoom})))}}class Rr extends t().PureComponent{constructor(e){super(e),this.state={top:0,left:0,width:0,height:0,scale:1},this.handleSubmit=this.handleSubmit.bind(this),this.handleChange=this.handleChange.bind(this)}handleChange(e,t,n,r,a){this.setState({left:e,top:t,width:n,height:r,scale:a})}handleSubmit(){(function(e,t,n,r,a,i,o){return new Promise(((s,l)=>{const c=new Image;c.crossOrigin="Anonymous",c.onerror=e=>{l(new Error("Image format unrecognized"))},c.onload=()=>{URL.revokeObjectURL(c.src);let t=document.createElement("canvas");t.width=a*o,t.height=i*o;let u=t.getContext("2d");u.imageSmoothingEnabled=!0,u.drawImage(c,n,r,a,i,0,0,t.width,t.height),e=Rn.includes(e)?e:"image/jpeg",t.toBlob((n=>{t=null,n?s({mime:e,blob:n,width:a,height:i}):l(new Error("Unsupported image format"))}),e)},c.src=t}))})(this.props.mime,this.props.avatar,this.state.left,this.state.top,this.state.width,this.state.height,this.state.scale).then((e=>{this.props.onSubmit(e.mime,e.blob,e.width,e.height)})).catch((e=>{this.props.onError(e)}))}render(){return t().createElement("div",{className:"panel-form"},t().createElement("div",{className:"panel-form-row"},t().createElement(Dr,{source:this.props.avatar,onChange:this.handleChange})),t().createElement("div",{className:"dialog-buttons"},this.props.onCancel?t().createElement("button",{className:"secondary",onClick:this.props.onCancel},t().createElement(i.FormattedMessage,{id:"button_cancel",defaultMessage:[{type:0,value:"Cancel"}]})):null,t().createElement("button",{className:"primary",onClick:this.handleSubmit},t().createElement(i.FormattedMessage,{id:"button_ok",defaultMessage:[{type:0,value:"OK"}]}))))}}class Nr extends t().PureComponent{constructor(e){super(e),this.inputRef=t().createRef(),this.state={value:this.props.value,visible:!1},this.handleVisibility=this.handleVisibility.bind(this),this.handeTextChange=this.handeTextChange.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleEditingFinished=this.handleEditingFinished.bind(this)}componentDidMount(){this.props.autoFocus&&this.inputRef.current.focus()}handeTextChange(e){this.setState({value:e.target.value}),this.props.onChange&&this.props.onChange(e)}handleVisibility(e){e.preventDefault(),this.setState({visible:!this.state.visible})}handleKeyDown(e){27==e.keyCode?(this.setState({value:this.props.value,visible:!1}),this.props.onFinished&&this.props.onFinished()):13==e.keyCode&&this.handleEditingFinished()}handleEditingFinished(e){if(e){let t=e.currentTarget;setTimeout((()=>{t.contains(document.activeElement)||this.props.onFinished&&this.props.onFinished(this.state.value)}),0)}else this.props.onFinished&&this.props.onFinished(this.state.value.trim())}render(){return t().createElement("div",{tabIndex:"-1",className:"group-focus",onBlur:this.handleEditingFinished},t().createElement("input",{className:"with-visibility",type:this.state.visible?"text":"password",value:this.state.value,placeholder:this.props.placeholder,required:this.props.required?"required":"",autoFocus:this.props.autoFocus?"autoFocus":"",autoComplete:this.props.autoComplete,onChange:this.handeTextChange,onKeyDown:this.handleKeyDown,ref:this.inputRef}),t().createElement("span",{onClick:this.handleVisibility},t().createElement("i",{className:"material-icons clickable light-gray"},this.state.visible?"visibility":"visibility_off")))}}class Mr extends t().Component{constructor(e){super(e),this.selfRef=t().createRef(),this.state={active:e.active,initialValue:e.value||"",value:e.value||""},this.handeTextChange=this.handeTextChange.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleStartEditing=this.handleStartEditing.bind(this),this.handleEditingFinished=this.handleEditingFinished.bind(this),this.handlePasswordFinished=this.handlePasswordFinished.bind(this)}componentDidUpdate(e,t){const n=this.props.value||"";t.initialValue==n||t.active||this.setState({initialValue:n,value:n})}handeTextChange(e){this.setState({value:e.target.value||""})}handleKeyDown(e){27===e.keyCode?this.setState({value:this.props.value,active:!1}):13===e.keyCode&&this.handleEditingFinished(e)}handleStartEditing(){this.props.readOnly||this.setState({active:!0},(()=>{this.selfRef.current&&this.selfRef.current.focus()}))}handleEditingFinished(e){const t=this.state.value.trim();!this.props.required||e.target.checkValidity()&&t?(this.setState({active:!1}),(t||this.props.value)&&t!==this.props.value&&this.props.onFinished(t)):this.setState({value:this.props.value,active:!1})}handlePasswordFinished(e){this.setState({active:!1}),e&&e!==this.props.value&&this.props.onFinished(e)}render(){if(!this.state.active){let e="password"==this.props.type?"••••••••":this.state.value,n="in-place-edit"+(this.props.readOnly?" disabled":"");return e||(e=this.props.placeholder,n+=" placeholder"),this.props.multiline&&1!=this.props.multiline||(n+=" short"),t().createElement("span",{className:n,onClick:this.handleStartEditing},t().createElement("span",null,e))}let e;const n={};return"password"==this.props.type?(e=Nr,n.onFinished=this.handlePasswordFinished):(this.props.multiline>1?(e="textarea",n.rows=this.props.multiline,n.className="inplace-edit"):(e="input",n.type=this.props.type||"text"),n.value=this.state.value,n.ref=this.selfRef,n.onChange=this.handeTextChange,n.onKeyDown=this.handleKeyDown,n.onBlur=this.handleEditingFinished),n.placeholder=this.props.placeholder,n.required=this.props.required?"required":"",n.autoComplete=this.props.autoComplete,n.autoFocus=!0,t().createElement(e,n,null)}}class Or extends t().Component{constructor(e){super(e),this.state={tags:this.props.tags||[],tagInput:"",activated:this.props.activated},this.handleTagInput=this.handleTagInput.bind(this),this.handleAddTag=this.handleAddTag.bind(this),this.handleRemoveTag=this.handleRemoveTag.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.handleCancel=this.handleCancel.bind(this)}static getDerivedStateFromProps(e,t){const n=e.tags||[];return xn(n,t.tags)||t.activated?null:{tags:n}}handleTagInput(e){if(this.setState({tagInput:e}),e.length>0){const t=e[e.length-1];'"'==e[0]?e.length>1&&'"'==t&&this.handleAddTag(e.substring(1,e.length-1)):","!=t&&" "!=t&&";"!=t&&'"'!=t||this.handleAddTag(e.substring(0,e.length-1).trim())}}handleAddTag(e){const t=this.props.tinode.getServerParam("maxTagCount",16);if(e.length>0&&this.state.tags.length<t){const t=this.state.tags.slice(0);return t.push(e),this.setState({tags:t,tagInput:""}),this.props.onTagsChanged&&this.props.onTagsChanged(t),t}return this.state.tags}handleRemoveTag(e,t){const n=this.state.tags.slice(0);n.splice(t,1),this.setState({tags:n}),this.props.onTagsChanged&&this.props.onTagsChanged(n)}handleSubmit(){this.props.onSubmit(this.handleAddTag(this.state.tagInput.trim())),this.setState({activated:!1,tags:this.props.tags||[]})}handleCancel(){this.setState({activated:!1,tagInput:"",tags:this.props.tags||[]}),this.props.onCancel&&this.props.onCancel()}render(){const e=this.props.tinode.getServerParam("minTagLength",2),n=this.props.tinode.getServerParam("maxTagLength",96);let r=[];return this.state.activated?this.state.tags.map((t=>{r.push({user:t,invalid:t.length<e||t.length>n})})):(this.state.tags.map((e=>{r.push(t().createElement("span",{className:"badge",key:r.length},e))})),0==r.length&&(r=t().createElement("i",null,t().createElement(i.FormattedMessage,{id:"tags_not_found",defaultMessage:[{type:0,value:"No tags defined. Add some."}]})))),t().createElement("div",{className:"panel-form-column"},t().createElement("div",{className:"panel-form-row"},t().createElement("label",{className:"small"},this.props.title)),this.state.activated?t().createElement("div",null,t().createElement(i.FormattedMessage,{id:"tags_editor_no_tags",defaultMessage:[{type:0,value:"Add some tags"}]},(e=>t().createElement(xr,{tinode:this.props.tinode,chips:r,avatarDisabled:!0,prompt:e,tabIndex:this.props.tabIndex,onEnter:this.handleAddTag,onFocusLost:this.handleAddTag,onCancel:this.handleCancel,onChipRemoved:this.handleRemoveTag,filterFunc:this.handleTagInput}))),this.props.onSubmit||this.props.onCancel?t().createElement("div",{id:"tag-manager-buttons",className:"dialog-buttons panel-form-row"},t().createElement("button",{className:"outline",onClick:this.handleCancel},t().createElement(i.FormattedMessage,{id:"button_cancel",defaultMessage:[{type:0,value:"Cancel"}]})),t().createElement("button",{className:"primary",onClick:this.handleSubmit},t().createElement(i.FormattedMessage,{id:"button_ok",defaultMessage:[{type:0,value:"OK"}]}))):null):t().createElement("div",{className:"quoted"},t().createElement("a",{href:"#",className:"flat-button",onClick:e=>{e.preventDefault(),this.setState({activated:!0})}},t().createElement("i",{className:"material-icons"},"edit"),"  ",t().createElement(i.FormattedMessage,{id:"title_manage_tags",defaultMessage:[{type:0,value:"Manage"}]})),t().createElement(t().Fragment,null,r)))}}class kr extends t().Component{constructor(e){super(e);const t=this.props.tinode.getTopic(this.props.topic),n=t.getAccessMode();this.state={isMe:$t.Tinode.isMeTopicName(this.props.topic),owner:n&&n.isOwner(),fullName:t.public?t.public.fn:void 0,private:t.private?t.private.comment:null,description:t.public?t.public.note:void 0,avatar:Mn(t.public?t.public.photo:null),tags:t.tags()||[],newAvatar:null,newAvatarMime:null},this.previousOnTags=null,this.tnNewTags=this.tnNewTags.bind(this),this.handleFullNameUpdate=this.handleFullNameUpdate.bind(this),this.handleImageUpdated=this.handleImageUpdated.bind(this),this.handleAvatarCropped=this.handleAvatarCropped.bind(this),this.handleAvatarCropCancel=this.handleAvatarCropCancel.bind(this),this.uploadAvatar=this.uploadAvatar.bind(this),this.handlePrivateUpdate=this.handlePrivateUpdate.bind(this),this.handleDescriptionUpdate=this.handleDescriptionUpdate.bind(this),this.handleTagsUpdated=this.handleTagsUpdated.bind(this)}componentDidMount(){const e=this.props.tinode.getTopic(this.props.topic);this.previousOnTags=e.onTagsUpdated,e.onTagsUpdated=this.tnNewTags}componentWillUnmount(){this.props.tinode.getTopic(this.props.topic).onTagsUpdated=this.previousOnTags}tnNewTags(e){this.setState({tags:e})}handleFullNameUpdate(e){(e=e.trim().substring(0,ln))&&this.state.fullName!==e&&(this.setState({fullName:e}),this.props.onUpdateTopicDesc(this.props.topic,bn(e,null)))}handlePrivateUpdate(e){e=e.trim().substring(0,ln),this.state.private!==e&&(this.setState({private:e}),this.props.onUpdateTopicDesc(this.props.topic,null,e||$t.Tinode.DEL_CHAR))}handleDescriptionUpdate(e){(e=e.trim().substring(0,cn))&&(this.setState({description:e}),this.props.onUpdateTopicDesc(this.props.topic,bn(null,null,null,e)))}handleImageUpdated(e,t){this.setState({newAvatar:t,newAvatarMime:e}),t||(this.setState({avatar:null}),this.props.onUpdateTopicDesc(this.props.topic,bn(null,$t.Tinode.DEL_CHAR)))}handleAvatarCropped(e,t,n,r){const a=t?URL.createObjectURL(t):null;this.setState({avatar:a,newAvatar:null,newAvatarMime:null}),t&&this.uploadAvatar(e,t,n,r)}uploadAvatar(e,t,n,r){const a=e=>{let{mime:t,blob:n}=e;if(n.size>4096){this.props.tinode.getLargeFileHelper().upload(n).then((e=>this.props.onUpdateTopicDesc(this.props.topic,bn(null,e)))).catch((e=>this.props.onError(e.message,"err")))}else Pn(n).then((e=>{const n=Mn({data:e.bits,type:t});this.setState({source:n}),this.props.onUpdateTopicDesc(this.props.topic,bn(null,n))}))};n>rn||r>rn||n!=r?In(t,rn,rn,on,!0).then((e=>a(e))).catch((e=>this.props.onError(e.message,"err"))):a({mime:e,blob:t,width:n,height:r})}handleAvatarCropCancel(){this.setState({newAvatar:null,newAvatarMime:null})}handleTagsUpdated(e){xn(this.state.tags.slice(0),e.slice(0))||this.props.onUpdateTags(e)}render(){if(this.state.newAvatar)return t().createElement(Rr,{avatar:this.state.newAvatar,mime:this.state.newAvatarMime,onSubmit:this.handleAvatarCropped,onCancel:this.handleAvatarCropCancel,onError:this.props.onError});const e=this.state.isMe||this.state.owner;return t().createElement(t().Fragment,null,t().createElement("div",{className:"panel-form-column"},t().createElement("center",null,t().createElement(gr,{tinode:this.props.tinode,avatar:this.state.avatar,readOnly:!e,uid:this.props.topic,title:this.state.fullName,onImageUpdated:this.handleImageUpdated,onError:this.props.onError})),this.state.isMe?t().createElement("div",{className:"group"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_your_name",defaultMessage:[{type:0,value:"Your name"}]})),t().createElement("div",null,t().createElement(i.FormattedMessage,{id:"full_name_prompt",defaultMessage:[{type:0,value:"Full name, e.g. John Doe"}]},(e=>t().createElement(Mr,{placeholder:e,value:this.state.fullName,required:!0,onFinished:this.handleFullNameUpdate}))))):t().createElement(t().Fragment,null,t().createElement("div",{className:"group"},t().createElement("div",null,t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_topic_name",defaultMessage:[{type:0,value:"Name"}]}))),t().createElement("div",null,t().createElement(i.FormattedMessage,{id:"topic_name_editing_placeholder",defaultMessage:[{type:0,value:"Freeform name of the group"}]},(n=>t().createElement(Mr,{placeholder:n,readOnly:!e,value:this.state.fullName,required:!0,onFinished:this.handleFullNameUpdate}))))),t().createElement("div",{className:"group"},t().createElement("div",null,t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_private",defaultMessage:[{type:0,value:"Private comment"}]}))),t().createElement("div",null,t().createElement(i.FormattedMessage,{id:"private_editing_placeholder",defaultMessage:[{type:0,value:"Visible to you only"}]},(e=>t().createElement(Mr,{placeholder:e,value:this.state.private,onFinished:this.handlePrivateUpdate})))))),e||this.state.description?t().createElement("div",{className:"group"},t().createElement("div",null,t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_description",defaultMessage:[{type:0,value:"Description"}]}))),t().createElement("div",null,t().createElement(i.FormattedMessage,{id:"description_editing_placeholder",defaultMessage:[{type:0,value:"Description (optional)"}]},(n=>t().createElement(Mr,{placeholder:n,readOnly:!e,value:this.state.description,multiline:2,onFinished:this.handleDescriptionUpdate}))))):null),e?t().createElement(t().Fragment,null,t().createElement("div",{className:"hr"}),t().createElement(i.FormattedMessage,{id:"title_tag_manager",defaultMessage:[{type:0,value:"Tags (search & discovery)"}]},(e=>t().createElement(Or,{tinode:this.props.tinode,title:e,activated:!1,tags:this.state.tags,onSubmit:this.handleTagsUpdated})))):null)}}class Ir extends t().Component{constructor(e){super(e);const t=this.props.tinode.getTopic(this.props.topic),n=t.getAccessMode();this.state={isMe:"me"==this.props.topic,owner:n&&n.isOwner(),credentials:(t.getCredentials?t.getCredentials():null)||[],addCredActive:!1,addCredInvalid:!1,newCred:"",tags:[]},this.previousTagsUpdated=void 0,this.onTagsUpdated=this.onTagsUpdated.bind(this),this.handleTagsUpdated=this.handleTagsUpdated.bind(this),this.tnCredsUpdated=this.tnCredsUpdated.bind(this),this.handleCredChange=this.handleCredChange.bind(this),this.handleCredKeyDown=this.handleCredKeyDown.bind(this),this.handleCredEntered=this.handleCredEntered.bind(this)}componentDidUpdate(e){const t=this.props.tinode.getTopic(e.topic);t&&(t.onCredsUpdated=this.tnCredsUpdated,t.onTagsUpdated!=this.onTagsUpdated&&("grp"==t.getType()?(this.previousTagsUpdated=t.onTagsUpdated,t.onTagsUpdated=this.onTagsUpdated):this.previousTagsUpdated=void 0),this.state.topic!=e.topic&&this.setState({topic:e.topic}))}componentWillUnmount(){const e=this.props.tinode.getTopic(this.props.topic);e.onCredsUpdated=void 0,e.onTagsUpdated=this.previousTagsUpdated}tnCredsUpdated(e){this.setState({credentials:e||[]})}handleCredChange(e){this.setState({newCred:e.target.value,addCredInvalid:!1})}handleCredKeyDown(e){27===e.keyCode?this.setState({newCred:"",addCredActive:!1}):13===e.keyCode&&this.handleCredEntered(e)}handleCredEntered(e){const t=this.state.newCred.trim();if(!t)return void this.setState({addCredActive:!1,addCredInvalid:!1});let n,r=function(e){return e=e.trim(),/^(?:\+?(\d{1,3}))?[- (.]*(\d{3})[- ).]*(\d{3})[- .]*(\d{2})[- .]*(\d{2})?$/.test(e)?e.replace(/[- ().]*/,""):null}(t);r?n="tel":(r=function(e){return e=e.trim(),/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/.test(e)?e:null}(t),r&&(n="email")),n?(this.props.onCredAdd(n,r),this.setState({addCredActive:!1,newCred:""})):this.setState({addCredInvalid:!0})}onTagsUpdated(e){this.setState({tags:e}),this.previousTagsUpdated&&this.previousTagsUpdated!=this.onTagsUpdated&&this.previousTagsUpdated(e)}handleTagsUpdated(e){xn(this.state.tags.slice(0),e.slice(0))||this.props.onTopicTagsUpdateRequest(this.props.topic,e)}render(){const e=[];return this.state.isMe&&this.state.credentials.map((n=>{e.push(t().createElement("div",{key:n.meth+":"+n.val+":"+n.done},n.meth,": ",t().createElement("tt",null,n.val),t().createElement("span",null," ",n.done?null:t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.props.onCredConfirm(n.meth,n.val)}},t().createElement(i.FormattedMessage,{id:"validate_credential_action",defaultMessage:[{type:0,value:"confirm"}]}))," ",t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.props.onCredDelete(n.meth,n.val)}},t().createElement("i",{className:"material-icons gray"},"delete_outline")))))})),t().createElement("div",{className:"scrollable-panel"},t().createElement(kr,{tinode:this.props.tinode,topic:this.props.topic,onUpdateTopicDesc:this.props.onUpdateTopicDesc,onUpdateTags:this.handleTagsUpdated,onError:this.props.onError}),this.state.isMe?t().createElement(t().Fragment,null,t().createElement("div",{className:"hr"}),t().createElement("div",{className:"panel-form-column"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_user_contacts",defaultMessage:[{type:0,value:"Contacts:"}]})),t().createElement("div",{className:"quoted"},e,this.state.addCredActive?t().createElement(i.FormattedMessage,{id:"phone_or_email_prompt",defaultMessage:[{type:0,value:"Phone number or email"}]},(e=>t().createElement("input",{type:"text",value:this.state.value,className:this.state.addCredInvalid?"invalid":null,placeholder:e,required:"required",autoFocus:!0,onChange:this.handleCredChange,onKeyDown:this.handleCredKeyDown,onBlur:this.handleCredEntered}))):null,t().createElement("div",null,t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.setState({addCredActive:!0})}},t().createElement("i",{className:"material-icons"},"add"),t().createElement(i.FormattedMessage,{id:"button_add_another",defaultMessage:[{type:0,value:"Add another"}]})))))):null)}}const Pr=(0,i.defineMessages)({clear_messages:{id:"action_clear_messages",defaultMessage:[{type:0,value:"Clear Messages"}]},clear_messages_warning:{id:"clear_messages_warning",defaultMessage:[{type:0,value:"Are you sure you want to clear all messages? It cannot be undone."}]},delete_messages:{id:"action_delete_messages",defaultMessage:[{type:0,value:"Clear Messages for All"}]},delete_messages_warning:{id:"delete_messages_warning",defaultMessage:[{type:0,value:"Are you sure you want to delete all messages for everyone? It cannot be undone."}]},topic_delete:{id:"topic_delete",defaultMessage:[{type:0,value:"Delete Conversation"}]},topic_delete_warning:{id:"topic_delete_warning",defaultMessage:[{type:0,value:"Are you sure you want to delete this conversation? It cannot be undone."}]},leave_chat:{id:"action_leave_chat",defaultMessage:[{type:0,value:"Leave Conversation"}]},leave_chat_warning:{id:"leave_chat_warning",defaultMessage:[{type:0,value:"Are you sure you want to leave this conversation?"}]},block_contact:{id:"action_block_contact",defaultMessage:[{type:0,value:"Block Contact"}]},block_contact_warning:{id:"block_contact_warning",defaultMessage:[{type:0,value:"Are you sure you want to block this contact?"}]},report_chat:{id:"action_report_chat",defaultMessage:[{type:0,value:"Report Conversation"}]},report_chat_warning:{id:"report_chat_warning",defaultMessage:[{type:0,value:"Are you sure you want to block and report this conversation?"}]},other_user:{id:"label_other_user",defaultMessage:[{type:0,value:"Other"}]}});class Lr extends t().PureComponent{constructor(e){super(e),this.handleDeleteTopic=this.handleDeleteTopic.bind(this),this.handleDeleteMessages=this.handleDeleteMessages.bind(this),this.handleLeave=this.handleLeave.bind(this),this.handleBlock=this.handleBlock.bind(this),this.handleReport=this.handleReport.bind(this)}handleDeleteTopic(e){e.preventDefault();const{formatMessage:t}=this.props.intl;this.props.onShowAlert(t(Pr.topic_delete),t(Pr.topic_delete_warning),(()=>{this.props.onDeleteTopic(this.props.topic)}),null,!0,null)}handleDeleteMessages(e){e.preventDefault();const{formatMessage:t}=this.props.intl;this.props.onShowAlert(t(this.props.deleter?Pr.delete_messages:Pr.clear_messages),t(this.props.deleter?Pr.delete_messages_warning:Pr.clear_messages_warning),(()=>{this.props.onDeleteMessages(this.props.topic)}),null,!0,null)}handleLeave(e){e.preventDefault();const{formatMessage:t}=this.props.intl;this.props.onShowAlert(t(Pr.leave_chat),t(Pr.leave_chat_warning),(()=>{this.props.onLeaveTopic(this.props.topic)}),null,!0,null)}handleBlock(e){e.preventDefault();const{formatMessage:t}=this.props.intl;this.props.onShowAlert(t(Pr.block_contact),t(Pr.block_contact_warning),(()=>{this.props.onBlockTopic(this.props.topic)}),null,!0,null)}handleReport(e){e.preventDefault();const{formatMessage:t}=this.props.intl;this.props.onShowAlert(t(Pr.report_chat),t(Pr.report_chat_warning),(e=>{this.props.onReportTopic(this.props.topic)}),null,!0,null)}render(){const{formatMessage:e}=this.props.intl;return t().createElement("div",{className:"scrollable-panel"},t().createElement("div",{className:"panel-form-column"},this.props.channel?null:t().createElement("a",{href:"#",className:"flat-button",onClick:this.handleDeleteMessages},t().createElement("i",{className:"material-icons"},"delete_outline"),"  ",e(this.props.deleter?Pr.delete_messages:Pr.clear_messages)),this.props.owner?t().createElement("a",{href:"#",className:"danger flat-button",onClick:this.handleDeleteTopic},t().createElement("i",{className:"material-icons"},"delete"),"  ",e(Pr.topic_delete)):t().createElement("a",{href:"#",className:"danger flat-button",onClick:this.handleLeave},t().createElement("i",{className:"material-icons"},"exit_to_app"),"  ",e(Pr.leave_chat)),this.props.groupTopic?null:t().createElement("a",{href:"#",className:"danger flat-button",onClick:this.handleBlock},t().createElement("i",{className:"material-icons"},"block"),"  ",e(Pr.block_contact)),this.props.owner?null:t().createElement("a",{href:"#",className:"danger flat-button",onClick:this.handleReport},t().createElement("i",{className:"material-icons"},"report"),"  ",e(Pr.report_chat))),t().createElement("div",{className:"hr"}),t().createElement("div",{className:"panel-form-column"},this.props.groupTopic?t().createElement(t().Fragment,null,t().createElement("div",{className:"group"},t().createElement("label",null,t().createElement(i.FormattedMessage,{id:"label_your_permissions",defaultMessage:[{type:0,value:"Your permissions:"}]}))," ",t().createElement("tt",{className:"clickable",onClick:e=>{e.preventDefault(),this.props.onLaunchPermissionsEditor("want")}},this.props.access)),this.props.channel?null:t().createElement("div",{className:"group"},t().createElement("div",null,t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_default_access_mode",defaultMessage:[{type:0,value:"Default access mode:"}]}))),t().createElement("div",{className:"quoted"},t().createElement("div",null,"Auth: ",t().createElement("tt",{className:this.props.owner?"clickable":null,onClick:e=>{e.preventDefault(),this.props.owner&&this.props.onLaunchPermissionsEditor("auth")}},this.props.auth)),t().createElement("div",null,"Anon: ",t().createElement("tt",{className:this.props.owner?"clickable":null,onClick:e=>{e.preventDefault(),this.props.owner&&this.props.onLaunchPermissionsEditor("anon")}},this.props.anon))))):t().createElement("div",{className:"group"},t().createElement("div",null,t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_permissions",defaultMessage:[{type:0,value:"Permissions:"}]}))),t().createElement("div",{className:"quoted"},t().createElement("div",null,t().createElement(i.FormattedMessage,{id:"label_you",defaultMessage:[{type:0,value:"You:"}]})," ",t().createElement("tt",{className:"clickable",onClick:e=>{e.preventDefault(),this.props.onLaunchPermissionsEditor("want")}},this.props.access)),t().createElement("div",null,this.props.fullName?this.props.fullName:e(Pr.other_user),":  ",t().createElement("tt",{className:"clickable",onClick:e=>{e.preventDefault(),this.props.onLaunchPermissionsEditor("given")}},this.props.modeGiven2))))))}}const Br=(0,i.injectIntl)(Lr),Fr=(0,i.defineMessages)({info:{id:"panel_title_info",defaultMessage:[{type:0,value:"Info"}]},general:{id:"panel_title_general",defaultMessage:[{type:0,value:"General"}]},security:{id:"panel_title_security",defaultMessage:[{type:0,value:"Security"}]},members:{id:"panel_title_members",defaultMessage:[{type:0,value:"Members"}]},crop:{id:"panel_title_crop",defaultMessage:[{type:0,value:"Drag to Adjust"}]},perm_want:{id:"requested_permissions",defaultMessage:[{type:0,value:"Requested"}]},perm_given:{id:"granted_permissions",defaultMessage:[{type:0,value:"Granted"}]},perm_auth:{id:"permissions_authenticated",defaultMessage:[{type:0,value:"Authenticated"}]},perm_anon:{id:"permissions_anonymous",defaultMessage:[{type:0,value:"Anonymous"}]},perm_user:{id:"permissions_user",defaultMessage:[{type:0,value:"User's Permissions"}]},edit_permissions:{id:"menu_item_edit_permissions",defaultMessage:[{type:0,value:"Edit permissions"}]}});class Hr extends t().Component{constructor(e){super(e),this.state={topic:null,owner:!1,admin:!1,sharer:!1,deleter:!1,muted:!1,address:null,groupTopic:void 0,channel:void 0,fullName:void 0,description:void 0,avatar:null,private:null,selectedContact:null,access:null,modeGiven:null,modeWant:null,modeGiven2:null,modeWant2:null,auth:null,anon:null,contactList:[],trustedBadges:[],previousMetaDesc:void 0,previousSubsUpdated:void 0},this.resetSubs=this.resetSubs.bind(this),this.resetDesc=this.resetDesc.bind(this),this.resetTags=this.resetTags.bind(this),this.onMetaDesc=this.onMetaDesc.bind(this),this.onSubsUpdated=this.onSubsUpdated.bind(this),this.handleImageChanged=this.handleImageChanged.bind(this),this.handleMuted=this.handleMuted.bind(this),this.handleUnarchive=this.handleUnarchive.bind(this),this.handlePermissionsChanged=this.handlePermissionsChanged.bind(this),this.handleLaunchPermissionsEditor=this.handleLaunchPermissionsEditor.bind(this),this.handleShowAddMembers=this.handleShowAddMembers.bind(this),this.handleMemberUpdateRequest=this.handleMemberUpdateRequest.bind(this),this.handleMemberSelected=this.handleMemberSelected.bind(this),this.handleContextMenu=this.handleContextMenu.bind(this),this.handleBackNavigate=this.handleBackNavigate.bind(this)}componentDidUpdate(e){const t=this.props.tinode.getTopic(e.topic);t&&(this.onMetaDesc!=t.onMetaDesc&&(this.previousMetaDesc=t.onMetaDesc,t.onMetaDesc=this.onMetaDesc,this.previousSubsUpdated=t.onSubsUpdated,t.onSubsUpdated=this.onSubsUpdated),this.state.topic!=e.topic&&(this.setState({topic:e.topic}),this.resetDesc(t,e),this.resetSubs(t,e),this.resetTags(t)))}componentWillUnmount(){const e=this.props.tinode.getTopic(this.props.topic);e&&(this.setState({topic:null}),e.onMetaDesc=this.previousMetaDesc,e.onSubsUpdated=this.previousSubsUpdated)}resetSubs(e,t){const n={contactList:[]};if("p2p"==e.getType()){const r=e.subscriber(t.topic);r?(n.modeGiven2=r.acs.getGiven(),n.modeWant2=r.acs.getWant()):(n.modeGiven2="N",n.modeWant2="N")}else e.subscribers((e=>{n.contactList.push(e)}),this);this.setState(n)}resetDesc(e,t){const n=e.getDefaultAccess()||{},r=e.getAccessMode(),a=[];if(e.trusted)for(const[t,n]of Object.entries(e.trusted))n&&a.push(t);this.setState({owner:r&&r.isOwner(),admin:r&&r.isAdmin(),sharer:r&&r.isSharer(),deleter:r&&r.isDeleter(),muted:r&&r.isMuted(),fullName:An(e.public&&e.public.fn,ln),description:An(e.public&&e.public.note,cn),avatar:Mn(e.public?e.public.photo:null),trustedBadges:a,private:An(e.private&&e.private.comment,ln),archived:e.isArchived(),address:e.name,groupTopic:e.isGroupType(),channel:e.isChannelType()||e.chan,access:r?r.getMode():void 0,modeGiven:r?r.getGiven():void 0,modeWant:r?r.getWant():void 0,auth:n.auth,anon:n.anon})}resetTags(e){if("grp"!=e.getType())return;const t=e.getAccessMode();t&&t.isOwner()&&e.getMeta(e.startMetaQuery().withTags().build())}onMetaDesc(e){const t=this.props.tinode.getTopic(this.props.topic);t&&(this.resetDesc(t,this.props),this.previousMetaDesc&&this.previousMetaDesc!=this.onMetaDesc&&this.previousMetaDesc(e))}onSubsUpdated(e){const t=this.props.tinode.getTopic(this.props.topic);t&&(this.resetSubs(t,this.props),this.previousSubsUpdated&&this.previousSubsUpdated!=this.onSubsUpdated&&this.previousSubsUpdated(e))}handleImageChanged(e,t){this.setState({avatar:t}),this.props.onTopicDescUpdate(this.props.topic,bn(null,t||$t.Tinode.DEL_CHAR),null)}handleMuted(e,t){this.setState({muted:t}),this.props.onChangePermissions(this.props.topic,t?"-P":"+P")}handleUnarchive(e,t){this.props.onTopicUnArchive(this.props.topic)}handlePermissionsChanged(e,t){switch(e){case"auth":this.props.onTopicDescUpdateRequest(this.props.topic,null,null,{auth:t});break;case"anon":this.props.onTopicDescUpdateRequest(this.props.topic,null,null,{anon:t});break;case"mode":case"want":this.props.onChangePermissions(this.props.topic,t);break;case"given":this.props.onChangePermissions(this.props.topic,t,this.props.topic);break;case"user":this.props.onChangePermissions(this.props.topic,t,this.state.userPermissionsEdited)}this.handleBackNavigate()}handleLaunchPermissionsEditor(e,t){const{formatMessage:n}=this.props.intl;let r,a,i,o,s,l,c;switch(e){case"mode":r=this.state.access;break;case"want":r=this.state.modeWant,a=this.state.modeGiven,this.state.owner?i="O":(i=$t.AccessMode.encode($t.AccessMode.diff("ASDO",this.state.modeGiven)),this.state.channel&&(i+="W")),o=n(Fr.perm_want),s=n(Fr.perm_given);break;case"given":r=this.state.modeGiven2,a=this.state.modeWant2,i=this.state.groupTopic?this.state.owner?"":"O":"ASDO",o=n(Fr.perm_given),s=n(Fr.perm_want);break;case"auth":r=this.state.auth,i="O";break;case"anon":r=this.state.anon,i="O";break;case"user":{const e=this.props.tinode.getTopic(this.props.topic);if(!e)return;const u=e.subscriber(t);if(!u||!u.acs)return;r=u.acs.getGiven(),a=u.acs.getWant(),i=this.state.owner?"":"O",o=n(Fr.perm_given),s=n(Fr.perm_want),u.public&&(l=u.public.fn,c=u.public.photo);break}default:return void console.error("Unknown permission editing mode '"+e+"'")}this.setState({userPermissionsEdited:t,userPermissionsTitle:l,userPermissionsAvatar:c,editedPermissions:r,immutablePermissions:a,editedPermissionsTitle:o,immutablePermissionsTitle:s,editedPermissionsSkipped:i}),this.props.onNavigate(`perm/${e}`)}handleShowAddMembers(e){e.preventDefault(),this.props.onInitFind(),this.props.onNavigate("members")}handleMemberUpdateRequest(e,t,n){this.props.onMemberUpdateRequest(this.props.topic,t,n),this.props.onNavigate("info")}handleMemberSelected(e){this.setState({selectedContact:e})}handleBackNavigate(){const e=(this.props.panel||"info").split("/");"info"==e[0]?this.props.onNavigate(null):"perm"==e[0]?"user"==e[1]?this.props.onNavigate("info"):this.props.onNavigate("security"):this.props.onNavigate("info")}handleContextMenu(e){const{formatMessage:t}=this.props.intl,n=this.props.tinode.getTopic(this.props.topic);if(!n)return;const r=n.subscriber(e.topicName);if(!r||!r.acs)return;const a=this.props.tinode.isMe(e.topicName),i=[{title:t(Fr.edit_permissions),handler:()=>{this.handleLaunchPermissionsEditor(a?"want":"user",e.topicName)}}];a||i.push("member_delete"),i.push(r.acs.isMuted()?"member_unmute":"member_mute"),a||i.push(r.acs.isJoiner()?"member_block":"member_unblock"),this.props.showContextMenu({topicName:this.props.topic,x:e.x,y:e.y,user:e.topicName},i)}render(){const e=(this.props.panel||"info").split("/"),n=e[0];e.shift();const{formatMessage:r}=this.props.intl,a=r(("perm"==n?Fr["perm_"+e[0]]:Fr[n])||Fr.info);return t().createElement("div",{id:"info-view"},t().createElement("div",{className:"caption-panel",id:"info-caption-panel"},t().createElement("div",{className:"panel-title",id:"info-title"},a),t().createElement("div",null,t().createElement(yr,{onCancel:this.handleBackNavigate}))),this.props.displayMobile?t().createElement(vr,{level:this.props.errorLevel,text:this.props.errorText,onClearError:this.props.onError}):null,"members"==n?t().createElement(Cr,{tinode:this.props.tinode,members:this.state.contactList,requiredMember:this.props.myUserId,keepInitialMembers:!this.state.admin&&!this.state.owner,myUserId:this.props.myUserId,contacts:this.props.searchableContacts,onCancel:this.handleBackNavigate,onSubmit:this.handleMemberUpdateRequest}):"perm"==n&&e.length>0?t().createElement(Sr,{tinode:this.props.tinode,mode:this.state.editedPermissions,compare:this.state.immutablePermissions,skip:this.state.editedPermissionsSkipped,modeTitle:this.state.editedPermissionsTitle,compareTitle:this.state.immutablePermissionsTitle,userTitle:this.state.userPermissionsTitle,item:this.state.userPermissionsEdited,userAvatar:this.state.userPermissionsAvatar,onSubmit:t=>this.handlePermissionsChanged(e[0],t),onCancel:this.handleBackNavigate}):"general"==n?t().createElement(Ir,{tinode:this.props.tinode,topic:this.props.topic,onCredAdd:this.props.onCredAdd,onTopicTagsUpdateRequest:this.props.onTopicTagsUpdateRequest,onCredConfirm:this.props.onCredConfirm,onCredDelete:this.props.onCredDelete,onUpdateTopicDesc:this.props.onTopicDescUpdateRequest,onError:this.props.onError}):"security"==n?t().createElement(Br,{topic:this.props.topic,owner:this.state.owner,admin:this.state.admin,sharer:this.state.sharer,deleter:this.state.deleter,muted:this.state.muted,groupTopic:this.state.groupTopic,channel:this.state.channel,access:this.state.access,modeGiven:this.state.modeGiven,modeWant:this.state.modeWant,modeGiven2:this.state.modeGiven2,modeWant2:this.state.modeWant2,auth:this.state.auth,anon:this.state.anon,onShowAlert:this.props.onShowAlert,onDeleteMessages:this.props.onDeleteMessages,onLeaveTopic:this.props.onLeaveTopic,onBlockTopic:this.props.onBlockTopic,onReportTopic:this.props.onReportTopic,onLaunchPermissionsEditor:this.handleLaunchPermissionsEditor,onNavigate:this.props.onNavigate}):t().createElement("div",{id:"info-view-content",className:"scrollable-panel"},t().createElement("div",{className:"panel-form-column"},t().createElement("a",{href:"#",className:"flat-button float-right",onClick:e=>{e.preventDefault(),this.props.onNavigate("general")}},t().createElement("i",{className:"material-icons"},"edit")," ",t().createElement(i.FormattedMessage,{id:"button_edit",defaultMessage:[{type:0,value:"Edit"}]})),t().createElement("center",null,t().createElement(gr,{tinode:this.props.tinode,avatar:this.state.avatar,readOnly:!0,uid:this.props.topic,title:this.state.fullName})),t().createElement("div",{className:"group"},t().createElement("div",null,t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_topic_name",defaultMessage:[{type:0,value:"Name"}]}))),t().createElement("div",{className:"large ellipsized"},this.state.fullName,this.state.channel?t().createElement("img",{src:"/img/channel.png",className:"channel",alt:"channel"}):null)),this.state.private?t().createElement("div",{className:"group"},t().createElement("div",null,t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_private",defaultMessage:[{type:0,value:"Private comment"}]}))),t().createElement("div",{className:"large ellipsized"},this.state.private)):null,t().createElement("div",{className:"group"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_user_id",defaultMessage:[{type:0,value:"ID:"}]}))," ",t().createElement("tt",null,this.state.address)),t().createElement("div",{className:"group"},t().createElement(hr,{trustedBadges:this.state.trustedBadges})),this.state.description?t().createElement("div",{className:"group"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_description",defaultMessage:[{type:0,value:"Description"}]})),t().createElement("div",null,this.state.description)):null),t().createElement("div",{className:"hr"}),t().createElement("div",{className:"panel-form-row"},t().createElement("label",null,t().createElement(i.FormattedMessage,{id:"label_muting_topic",defaultMessage:[{type:0,value:"Muted:"}]})),t().createElement(fr,{name:"P",checked:this.state.muted,onChange:this.handleMuted})),this.state.archived?t().createElement("div",{className:"panel-form-row"},t().createElement("label",null,t().createElement(i.FormattedMessage,{id:"label_unarchive_topic",defaultMessage:[{type:0,value:"Archived:"}]})),t().createElement(fr,{name:"archived",checked:!0,onChange:this.handleUnarchive})):null,t().createElement("div",{className:"hr"}),t().createElement("div",{className:"panel-form-row"},t().createElement("a",{href:"#",className:"flat-button",onClick:e=>{e.preventDefault(),this.props.onNavigate("security")}},t().createElement("i",{className:"material-icons"},"security")," ",t().createElement(i.FormattedMessage,{id:"button_security",defaultMessage:[{type:0,value:"Security"}]}))),this.state.groupTopic&&this.state.sharer?t().createElement(t().Fragment,null,t().createElement("div",{className:"hr"}),t().createElement("div",{className:"panel-form-row"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_group_members",defaultMessage:[{type:0,value:"Group members:"}]}))),t().createElement("div",{className:"panel-form-row"},t().createElement("a",{href:"#",className:"flat-button",onClick:this.handleShowAddMembers},t().createElement("i",{className:"material-icons"},"person_add"),"  ",t().createElement(i.FormattedMessage,{id:"button_add_members",defaultMessage:[{type:0,value:"Add members"}]}))),t().createElement(i.FormattedMessage,{id:"group_has_no_members",defaultMessage:[{type:0,value:"No members"}]},(e=>t().createElement(ir,{tinode:this.props.tinode,contacts:this.state.contactList,myUserId:this.props.myUserId,emptyListMessage:e,topicSelected:this.state.selectedContact,showOnline:!1,showUnread:!1,showMode:!0,noScroll:!0,onTopicSelected:this.handleMemberSelected,showContextMenu:!!this.state.admin&&this.handleContextMenu})))):null))}}const qr=(0,i.injectIntl)(Hr),Ur=new Audio("audio/call-out.m4a");Ur.loop=!0;const Vr=new Audio("audio/call-end.m4a");Vr.loop=!0;const Wr=new Audio("audio/dialing.m4a"),zr=(0,i.defineMessages)({already_in_call:{id:"already_in_call",defaultMessage:[{type:0,value:"You already in an ongoing call!"}]}});class Yr extends t().PureComponent{constructor(e){super(e),this.state={localStream:void 0,pc:void 0,previousOnInfo:void 0,waitingForPeer:!1,callInitialSetupComplete:!1},this.localStreamConstraints={audio:!0,video:!0},this.isOutgoingCall=1==e.callState,this.localRef=t().createRef(),this.remoteRef=t().createRef(),this.remoteIceCandidatesCache=[],this.onInfo=this.onInfo.bind(this),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this.createPeerConnection=this.createPeerConnection.bind(this),this.canSendOffer=this.canSendOffer.bind(this),this.drainRemoteIceCandidatesCache=this.drainRemoteIceCandidatesCache.bind(this),this.handleNegotiationNeededEvent=this.handleNegotiationNeededEvent.bind(this),this.handleICECandidateEvent=this.handleICECandidateEvent.bind(this),this.handleNewICECandidateMsg=this.handleNewICECandidateMsg.bind(this),this.handleICEConnectionStateChangeEvent=this.handleICEConnectionStateChangeEvent.bind(this),this.handleSignalingStateChangeEvent=this.handleSignalingStateChangeEvent.bind(this),this.handleICEGatheringStateChangeEvent=this.handleICEGatheringStateChangeEvent.bind(this),this.handleIceCandidateErrorEvent=this.handleIceCandidateErrorEvent.bind(this),this.handleTrackEvent=this.handleTrackEvent.bind(this),this.handleVideoOfferMsg=this.handleVideoOfferMsg.bind(this),this.handleVideoAnswerMsg=this.handleVideoAnswerMsg.bind(this),this.handleNewICECandidateMsg=this.handleNewICECandidateMsg.bind(this),this.reportError=this.reportError.bind(this),this.handleGetUserMediaError=this.handleGetUserMediaError.bind(this),this.stopTracks=this.stopTracks.bind(this),this.handleCloseClick=this.handleCloseClick.bind(this),this.handleToggleCameraClick=this.handleToggleCameraClick.bind(this),this.handleToggleMicClick=this.handleToggleMicClick.bind(this),this.toggleMedia=this.toggleMedia.bind(this),this.handleRemoteHangup=this.handleRemoteHangup.bind(this),this.handleVideoCallAccepted=this.handleVideoCallAccepted.bind(this)}componentDidMount(){const e=this.props.tinode.getTopic(this.props.topic);this.previousOnInfo=e.onInfo,e.onInfo=this.onInfo,1!=this.props.callState&&3!=this.props.callState||!this.localRef.current||this.start()}componentWillUnmount(){this.props.tinode.getTopic(this.props.topic).onInfo=this.previousOnInfo,this.stop()}handleVideoCallAccepted(e){Ur.pause();const t=this.createPeerConnection(),n=this.state.localStream;n.getTracks().forEach((e=>{t.addTrack(e,n)}))}onInfo(e){if("call"==e.what)switch(e.event){case"accept":this.handleVideoCallAccepted(e);break;case"answer":this.handleVideoAnswerMsg(e);break;case"ice-candidate":this.handleNewICECandidateMsg(e);break;case"hang-up":this.handleRemoteHangup(e);break;case"offer":this.handleVideoOfferMsg(e);break;case"ringing":Ur.play().catch((e=>{}));break;default:console.warn("Unknown call event",e.event)}}start(){this.state.localStream?this.props.onError(this.props.intl.formatMessage(zr.already_in_call)):3!=this.props.callState?navigator.mediaDevices.getUserMedia(this.localStreamConstraints).then((e=>{this.setState({localStream:e,waitingForPeer:!0}),this.localRef.current.srcObject=e,Wr.play(),this.props.onInvite(this.props.topic,this.props.seq,this.props.callState)})).catch(this.handleGetUserMediaError):this.props.onInvite(this.props.topic,this.props.seq,this.props.callState)}stop(){Vr.pause(),Vr.currentTime=0,Ur.pause(),Ur.currentTime=0,this.stopTracks(this.localRef.current),this.stopTracks(this.remoteRef.current),this.state.pc&&(this.state.pc.ontrack=null,this.state.pc.onremovetrack=null,this.state.pc.onremovestream=null,this.state.pc.onicecandidate=null,this.state.pc.oniceconnectionstatechange=null,this.state.pc.onsignalingstatechange=null,this.state.pc.onicegatheringstatechange=null,this.state.pc.onnegotiationneeded=null,this.state.pc.onicecandidateerror=null,this.state.pc.close()),this.setState({pc:null,waitingForPeer:!1})}stopTracks(e){if(!e)return;let t=e.srcObject;if(!t)return;let n=t.getTracks();n&&n.forEach((e=>{e.stop(),e.enabled=!1})),e.srcObject=null,e.src=""}createPeerConnection(){const e=this.props.tinode.getServerParam("iceServers",null),t=e?new RTCPeerConnection({iceServers:e}):new RTCPeerConnection;return t.onicecandidate=this.handleICECandidateEvent,t.oniceconnectionstatechange=this.handleICEConnectionStateChangeEvent,t.onicegatheringstatechange=this.handleICEGatheringStateChangeEvent,t.onsignalingstatechange=this.handleSignalingStateChangeEvent,t.onnegotiationneeded=this.handleNegotiationNeededEvent,t.onicecandidateerror=this.handleIceCandidateErrorEvent,t.ontrack=this.handleTrackEvent,this.setState({pc:t,waitingForPeer:!1}),t}handleVideoAnswerMsg(e){const t=new RTCSessionDescription(e.payload);this.state.pc.setRemoteDescription(t).then((e=>{this.setState({callInitialSetupComplete:!0},(()=>this.drainRemoteIceCandidatesCache()))})).catch(this.reportError)}reportError(e){this.props.onError(e.message,"err")}canSendOffer(){return this.isOutgoingCall||this.state.callInitialSetupComplete}handleNegotiationNeededEvent(){this.canSendOffer()&&this.state.pc.createOffer().then((e=>this.state.pc.setLocalDescription(e))).then((e=>{this.props.onSendOffer(this.props.topic,this.props.seq,this.state.pc.localDescription.toJSON())})).catch(this.reportError)}handleIceCandidateErrorEvent(e){console.warn("ICE candidate error:",e)}handleICECandidateEvent(e){e.candidate&&this.props.onIceCandidate(this.props.topic,this.props.seq,e.candidate.toJSON())}handleNewICECandidateMsg(e){const t=new RTCIceCandidate(e.payload);this.state.callInitialSetupComplete?this.state.pc.addIceCandidate(t).catch(this.reportError):this.remoteIceCandidatesCache.push(t)}drainRemoteIceCandidatesCache(){this.remoteIceCandidatesCache.forEach((e=>{this.state.pc.addIceCandidate(e).catch(this.reportError)})),this.remoteIceCandidatesCache=[]}handleICEConnectionStateChangeEvent(e){switch(this.state.pc.iceConnectionState){case"closed":case"failed":this.handleCloseClick()}}handleSignalingStateChangeEvent(e){"closed"==this.state.pc.signalingState&&this.handleCloseClick()}handleICEGatheringStateChangeEvent(e){}handleTrackEvent(e){this.remoteRef.current.srcObject=e.streams[0],this.forceUpdate()}handleGetUserMediaError(e){switch(e.name){case"NotFoundError":this.reportError(e.message);break;case"SecurityError":case"PermissionDeniedError":break;default:this.reportError(e.message),console.error("Error opening your camera and/or microphone:",e.message)}this.handleCloseClick()}handleVideoOfferMsg(e){let t=null;const n=this.createPeerConnection(),r=new RTCSessionDescription(e.payload);n.setRemoteDescription(r).then((e=>navigator.mediaDevices.getUserMedia(this.localStreamConstraints))).then((e=>{t=e,this.localRef.current.srcObject=e,this.setState({localStream:e}),t.getTracks().forEach((e=>{n.addTrack(e,t)}))})).then((e=>n.createAnswer())).then((e=>n.setLocalDescription(e))).then((e=>{this.props.onSendAnswer(this.props.topic,this.props.seq,n.localDescription.toJSON()),this.setState({callInitialSetupComplete:!0},(()=>this.drainRemoteIceCandidatesCache()))})).catch(this.handleGetUserMediaError)}handleRemoteHangup(){this.state.waitingForPeer?(this.setState({waitingForPeer:!1}),Ur.pause(),Ur.currentTime=0,Vr.loop=!0,Vr.play().catch((e=>{})),setTimeout((e=>{this.handleCloseClick()}),2e3)):this.handleCloseClick()}handleCloseClick(){this.stop(),this.props.onHangup(this.props.topic,this.props.seq)}toggleMedia(e){this.state.localStream.getTracks().forEach((t=>{t.kind==e&&(t.enabled=!t.enabled)})),this.forceUpdate()}handleToggleCameraClick(){this.toggleMedia("video")}handleToggleMicClick(){this.toggleMedia("audio")}render(){const e=this.remoteRef.current&&this.remoteRef.current.srcObject,n=!(this.state.localStream&&this.state.localStream.getTracks()),r=this.state.localStream&&this.state.localStream.getAudioTracks()[0].enabled?"mic":"mic_off",a=this.state.localStream&&this.state.localStream.getVideoTracks()[0].enabled?"videocam":"videocam_off",o=An(this.props.title,20),s=this.state.waitingForPeer?" pulse":"";return t().createElement(t().Fragment,null,t().createElement("div",{id:"video-container"},t().createElement("div",{id:"video-container-panel"},t().createElement("div",{className:"call-party self"},t().createElement("video",{ref:this.localRef,autoPlay:!0,muted:!0,playsInline:!0}),t().createElement("div",{className:"caller-name inactive"},t().createElement(i.FormattedMessage,{id:"calls_you_label",defaultMessage:[{type:0,value:"You"}]}))),t().createElement("div",{className:"call-party peer"},t().createElement("video",{ref:this.remoteRef,autoPlay:!0,playsInline:!0}),e?t().createElement("div",{className:"caller-name inactive"},o):t().createElement("div",{className:`caller-card${s}`},t().createElement("div",{className:"avatar-box"},t().createElement(Sn,{tinode:this.props.tinode,avatar:this.props.avatar,topic:this.props.topic,title:this.props.title})),t().createElement("div",{className:"caller-name"},o)))),t().createElement("div",{className:"controls"},t().createElement("button",{className:"danger",onClick:this.handleCloseClick},t().createElement("i",{className:"material-icons"},"call_end")),t().createElement("button",{className:"secondary",onClick:this.handleToggleCameraClick,disabled:n},t().createElement("i",{className:"material-icons"},a)),t().createElement("button",{className:"secondary",onClick:this.handleToggleMicClick,disabled:n},t().createElement("i",{className:"material-icons"},r)))))}}const Gr=(0,i.injectIntl)(Yr);class Xr extends t().Component{constructor(e){super(e),this.state={downloader:null,progress:0},this.downloadFile=this.downloadFile.bind(this),this.handleCancel=this.handleCancel.bind(this)}downloadFile(e,t,n){if(!e)return void this.props.onError("Invalid download URL '"+e+"'");const r=this.props.tinode.getLargeFileHelper();this.setState({downloader:r}),r.download(e,t,n,(e=>{this.setState({progress:e/this.props.size})}),(e=>{this.props.onError(e,"err")})).then((()=>{this.setState({downloader:null,progress:0})})).catch((e=>{e&&this.props.onError("Error downloading file: "+e.message,"err"),this.setState({downloader:null,progress:0})}))}handleCancel(){this.props.uploading?this.props.onCancelUpload():this.state.downloader&&this.state.downloader.cancel()}render(){let e=this.props.filename||"file_attachment";e.length>36&&(e=e.substr(0,16)+"..."+e.substr(-16));let n,r,a=this.props.size>0?t().createElement("span",{className:"small gray"},"(",gn(this.props.size),")"):null;this.props.uploading||this.state.downloader||!function(e){return e&&!/^\s*([a-z][a-z0-9+.-]*:|\/\/)/im.test(e)}(this.props.downloadUrl)?(n=wn(this.props.downloadUrl),r=null):(n="#",r=e=>{e.preventDefault(),this.downloadFile(this.props.downloadUrl,this.props.filename,this.props.mimetype)});const o=t().createElement(t().Fragment,null,t().createElement("i",{className:"material-icons"},"file_download")," ",t().createElement(i.FormattedMessage,{id:"save_attachment",defaultMessage:[{type:0,value:"save"}]}));return t().createElement("div",{className:"attachment"},t().createElement("div",null,t().createElement("i",{className:"material-icons big gray"},"insert_drive_file")),t().createElement("div",{className:"flex-column"},t().createElement("div",null,e," ",a),this.props.uploading||this.state.downloader?t().createElement(Wn,{progress:this.props.uploading?this.props.progress:this.state.progress,onCancel:this.handleCancel}):t().createElement("div",null,n?t().createElement("a",{href:n,download:this.props.filename,onClick:r},o):t().createElement("span",{className:"light-gray"},o))))}}const $r=(0,i.defineMessages)({message_sending:{id:"message_sending",defaultMessage:[{type:0,value:"sending..."}]},message_sending_failed:{id:"message_sending_failed",defaultMessage:[{type:0,value:"failed"}]}});class jr extends t().PureComponent{render(){const{formatMessage:e}=this.props.intl;let n;n=this.props.received<=$t.Tinode.MESSAGE_STATUS_SENDING?e($r.message_sending):this.props.received==$t.Tinode.MESSAGE_STATUS_FAILED?e($r.message_sending_failed):this.props.timestamp.toLocaleTimeString(this.props.intl.locale,{timeStyle:"short"});const r=Cn(this.props.received),a=r?t().createElement("i",{className:"material-icons small "+r.color},r.name):null;return t().createElement("span",{className:"timestamp"},n," ",a)}}const Kr=(0,i.injectIntl)(jr);var Zr=Object.defineProperty,Qr=(e,t,n)=>(((e,t,n)=>{t in e?Zr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),Jr=(e=>(e[e.OBSERVER_ACTION=1]="OBSERVER_ACTION",e[e.SERVER_ACTION=2]="SERVER_ACTION",e[e.UNDO_ACTION=3]="UNDO_ACTION",e[e.DEFAULT_ACTION=3]="DEFAULT_ACTION",e))(Jr||{});class ea{constructor(e,t){Qr(this,"_observers"),Qr(this,"_doActionData"),Qr(this,"_oldActionData"),Qr(this,"_operation"),this._doActionData=e,this._observers=t,this._operation=1}getDoActionData(){return this._doActionData}getOldActionDaa(){return this._oldActionData}hasOperation(e){return(this._operation&e)===e}addOperation(e){this._operation|=e}removeOperation(e){this._operation&=~e}}class ta extends ea{constructor(e,t,n){super(e,n),Qr(this,"_workbook"),this._workbook=t}getWorkSheet(){const{_workbook:e,_doActionData:t}=this,{sheetId:n}=t;return e.getSheetBySheetId(n)}getWorkBook(){return this._workbook}}class na{constructor(e=!1){Qr(this,"skipNextObservers"),Qr(this,"lastReturnValue"),Qr(this,"isStopPropagation",!1),this.initialize(e)}initialize(e=!1){return this.skipNextObservers=e,this}stopPropagation(){this.isStopPropagation=!0}}class ra{constructor(e){Qr(this,"_willBeUnregistered",!1),Qr(this,"unregisterOnNextCall",!1),this.callback=e}}class aa{constructor(e){Qr(this,"_observers",new Array),Qr(this,"_eventState"),Qr(this,"_onObserverAdded"),this._eventState=new na,e&&(this._onObserverAdded=e)}get observers(){return this._observers}add(e,t=!1,n=!1){if(!e)return null;const r=new ra(e);return r.unregisterOnNextCall=n,t?this._observers.unshift(r):this._observers.push(r),this._onObserverAdded&&this._onObserverAdded(r),r}addOnce(e){return this.add(e,void 0,!0)}remove(e){return!(!e||-1===this._observers.indexOf(e))&&(this._deferUnregister(e),!0)}removeCallback(e){for(let t=0;t<this._observers.length;t++){const n=this._observers[t];if(!n._willBeUnregistered&&n.callback===e)return this._deferUnregister(n),!0}return!1}_deferUnregister(e){e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout((()=>{this._remove(e)}),0)}_remove(e){if(!e)return!1;const t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)}makeObserverTopPriority(e){this._remove(e),this._observers.unshift(e)}makeObserverBottomPriority(e){this._remove(e),this._observers.push(e)}notifyObservers(e){if(!this._observers.length)return null;const t=this._eventState;t.skipNextObservers=!1,t.lastReturnValue=e,t.isStopPropagation=!1;let n=!1;for(let r=0;r<this._observers.length;r++){const a=this._observers[r];if(!a._willBeUnregistered&&(t.lastReturnValue=a.callback(e,t),a.unregisterOnNextCall&&this._deferUnregister(a),t.isStopPropagation&&(n=!0),t.skipNextObservers))return{lastReturnValue:t.lastReturnValue,stopPropagation:n}}return{lastReturnValue:t.lastReturnValue,stopPropagation:n}}notifyObserversWithPromise(e){let t=Promise.resolve(e);if(!this._observers.length)return t;const n=this._eventState;n.skipNextObservers=!1;for(let r=0;r<this._observers.length;r++){const a=this._observers[r];n.skipNextObservers||a._willBeUnregistered||(t=t.then((()=>a.callback(e,n))),a.unregisterOnNextCall&&this._deferUnregister(a))}return t.then((()=>e))}notifyObserver(e,t){if(e._willBeUnregistered)return;const n=this._eventState;return n.skipNextObservers=!1,e.callback(t,n),e.unregisterOnNextCall&&this._deferUnregister(e),{lastReturnValue:n.lastReturnValue,stopPropagation:n.isStopPropagation}}hasObservers(){return this._observers.length>0}clear(){this._observers=new Array,this._onObserverAdded=null}clone(){const e=new aa;return e._observers=this._observers.slice(0),e}}class ia{constructor(e,t){Qr(this,"namespace"),Qr(this,"name"),Qr(this,"observableHooks"),this.name=e,this.observableHooks=t}}class oa{constructor(){Qr(this,"_observableHooksArray"),this._observableHooksArray=new Array}addHooks(e,t){this._observableHooksArray.push(new ia(e,t))}getHooks(e){const t=this._observableHooksArray.find((t=>t.name===e));return t?t.observableHooks:null}}function sa(e,t){let n=e.length-1;return n=e.length<40||t<=e[20]||t>=e[n-20]?function(e,t){let n=0,r=0,a=0,i=-1,o=e.length-1;for(;n<e.length&&o>=0&&o>=n;){if(r=e[o],a=0===o?0:e[o-1],t>=a&&t<r){i=o;break}if(r=e[n],a=0===n?0:e[n-1],t>=a&&t<r){i=n;break}n++,o--}return i}(e,t):function(e,t){let n=0,r=e.length-1;for(;n<=r;){let a=Math.floor((r+n)/2);if(t<e[a]&&(0===a||t>=e[a-1]))return a;if(t>=e[a])n=a+1;else{if(!(t<e[a]))return-1;r=a-1}}return-1}(e,t),n}const la=e=>null!=e;class ca{constructor(...e){if(Qr(this,"_array"),Qr(this,"_length"),_a.hasLength(e,1)){if(_a.isObject(e[0]))return this._array=e[0],void(this._length=ca.getMaxLength(this._array));if(_a.isNumber(e[0]))return this._array={},void(this._length=e[0])}if(_a.hasLength(e,2)){const t=e[0],n=e[1];return this._array=t,void(this._length=n)}_a.hasLength(e,0)&&(this._array={},this._length=0)}static getMaxLength(e){if(e){const t=Object.keys(e);if(t.length)return Math.max(...t)+1}return 0}obtain(e,t){var n;return null!=(n=this._array[e])?n:t}getKeys(){return Object.keys(this._array)}get(e){return this._array[e]}set(e,t){if(la(t)){const n=this._length;this._array[e]=t,e>=n&&(this._length=e+1)}}pop(){const e=this._length,t=this._array;if(e>0){const n=e-1,r=t[n];return n>0&&(delete t[n],this._length--),r}return null}push(e){if(la(e)){let t=this._length;this._array[t++]=e,this._length=t}}first(){return this._array[0]}last(){const e=this._length-1;return this._array[e]}shift(){const e=this._length;if(e>0){const t=this._array[0],n=e-1;let r;for(let e=0;e<n;e++)r=this._array[e+1],la(r)&&(this._array[e]=r);return this._length--,delete this._array[n],t}return null}unshift(e){if(la(e)){const t=this._length,n=this._array,r=t+1;let a=n[0];for(let e=1;e<r;e++){const t=this._array[e];la(a)&&(n[e]=a),a=t}n[0]=e,this._length=r}}clear(){this._array={},this._length=0}getLength(){return this._length}getSizeOf(){const e=this._array;return Object.keys(e).length}toJSON(){return this._array}toArray(){const e=new Array,t=this._array,n=Object.keys(t),r=n.length;for(let a=0;a<r;a++){const r=+n[a];e[r]=t[r]}return e}forEach(e){const t=this._array,n=Object.keys(t),r=n.length;for(let a=0;a<r;a++){const r=+n[a];if(!1===e(r,t[r]))return this}return this}clone(e){const t=new ca;return e?this.forEach(((n,r)=>{t.set(n,e(r))})):this.forEach(((e,n)=>{t.set(e,n)})),t}isEmpty(){const e=this._array;return 0===Object.keys(e).length}delete(e){this.splice(e,1)}includes(e){const t=this._array,n=Object.keys(t),r=n.length;for(let a=0;a<r;a++){if(t[+n[a]]===e)return!0}return!1}slice(e,t){const n=this._array;if(this._length>0){const r={};let a=0;for(let i=e;i<t;i++){const e=n[i];la(e)&&(r[a]=n[i],a++)}return new ca(r,a)}return new ca}concat(e){const t=this._array,n=Object.keys(t),r=n.length,a=e._array,i=Object.keys(a),o=i.length,s=new ca(r+o),l=s._array;let c=0;for(let e=0;e<r;e++,c++){const r=n[e];l[c]=t[r]}for(let e=0;e<o;e++,c++){const t=i[e];l[c]=a[t]}return s}find(e){const t=this._array,n=Object.keys(t),r=n.length;for(let a=0;a<r;a++){const r=+n[a],i=t[r];if(!0===e(r,i))return i}return null}splice(e,t){const n=this._length;if(n>0){const r=e+t,a=this._array;let i=0;const o={};for(let t=e;t<r;t++){const e=a[t];la(e)&&(delete a[t],o[i]=e,i++)}const s=r-e,l=n;if(this._length-=s,this._length<=0)this._array={},this._length=0;else for(let e=r;e<l;e++){const t=a[e];la(t)&&(a[e-s]=a[e],delete a[e])}return new ca(o,i)}return new ca}findIndex(e){const t=this._array,n=Object.keys(t),r=n.length;for(let a=0;a<r;a++){const r=+n[a];if(!0===e(r,t[r]))return a}return-1}map(e){const t=this._array,n=Object.keys(t),r=n.length,a={};for(let i=0;i<r;i++){const r=t[+n[i]];a[i]=e(r)}return new ca(a)}filter(e){const t=this._array,n=Object.keys(t),r=n.length,a={};let i=0;for(let o=0;o<r;o++){const r=+n[o],s=t[r];e(r,s)&&(a[i]=s,i++)}return new ca(a,i)}insert(e,t){const n=this._length,r=this._array;for(let t=n-1;t>=e;t--)r[t+1]=r[t];return r[e]=t,this._length=n+1,this}inserts(e,t){const n=t._array,r=t._length,a=this._array;for(let t=this._length-1;t>=e;t--){const e=a[t];la(e)&&(delete a[t],a[t+r]=e)}for(let t=0;t<r;t++){const r=n[t];la(r)&&(a[t+e]=n[t])}return this._length+=r,this}[Symbol.iterator](){return new ua(this)}}class ua{constructor(e){Qr(this,"_array"),Qr(this,"_keys"),Qr(this,"_cursor"),this._array=e,this._keys=e.getKeys(),this._cursor=0}next(){const e=this._array,t=this._keys,n=this._cursor;if(n<t.length){const r=t[n],a=e.get(+r);return this._cursor++,{value:a,done:!1}}return{value:null,done:!0}}[Symbol.iterator](){return new ua(this._array)}}class ha{constructor(e={}){Qr(this,"_matrix"),_a.isAssignableFrom(e,ha)?this._matrix=e._matrix:_a.isAssignableFrom(e,ca)?this._matrix=e:_a.isPlainObject(e)&&(this._matrix=new ca(e))}getMatrix(){return this._matrix}forEach(e){const t=this._matrix.getKeys(),n=t.length;for(let r=0;r<n;r++){const n=+t[r];if(!1===e(n,this.getRow(n)))return this}return this}forValue(e){const t=this._matrix.getKeys(),n=t.length;for(let r=0;r<n;r++){const n=+t[r],a=this.getRow(n),i=a.getKeys(),o=i.length;for(let t=0;t<o;t++){const r=+i[t];if(!1===e(n,r,a.get(r)))return this}}return this}swapRow(e,t){const n=this._matrix.get(e),r=this._matrix.get(t);this._matrix.set(t,n),this._matrix.set(e,r)}getRow(e){const{_matrix:t}=this;let n=t.get(e);return _a.isAssignableFrom(n,ca)?n:_a.isPlainObject(n)?(n=new ca(n),t.set(e,n),n):void 0}getRowOrCreate(e){const t=this.getRow(e);if(t)return t;const n=new ca;return this._matrix.set(e,n),n}reset(){this._matrix=new ca({})}hasValue(){const e=this._matrix;for(const t of e)if(!t.isEmpty())return!0;return!1}getValue(e,t){const n=this.getRow(e);return n?n.get(t):null}setValue(e,t,n){this.getRowOrCreate(e).set(t,n)}deleteValue(e,t){const n=this.getRow(e);n&&n.delete(t)}spliceRows(e,t){const n=this._matrix.splice(e,t);return new ha(n)}pushRow(e){this._matrix.push(e)}insertRow(e,t){this._matrix.insert(e,t)}insertRows(e,t){this._matrix.inserts(e,t._matrix)}spliceColumns(e,t){const n=new ha;return this._matrix.forEach(((r,a)=>{var i;for(let a=e;a<e+t;a++)n.setValue(r,a-e,this.getValue(r,a));null==(i=this._matrix.get(r))||i.splice(e,t)})),n}insertColumns(e,t){const n=t.getRow(0).getLength();this._matrix.forEach(((r,a)=>{var i,o;for(let s=e;s<e+n;s++)null==(i=t.getRow(r))||i.get(s-e),a.insert(s,null==(o=t.getRow(r))?void 0:o.get(s-e))}))}getFragments(e,t,n,r){const a=new ha;for(let i=e;i<=t;i++){const e=new ca;for(let t=n;t<=r;t++){const n=this.getValue(i,t);e.push(n)}a.pushRow(e)}return a}getSizeOf(){return this._matrix.getSizeOf()}getLength(){return this._matrix.getLength()}getRange(){const e=this.getSizeOf();let t=0;const n=this.getLength();for(let e=0;e<n;e++){const n=this.getRow(e);if(n){const e=n.getSizeOf();n.getSizeOf()>t&&(t=e-1)}}return{startRow:0,startColumn:0,endRow:e,endColumn:t}}toArray(){return this._matrix.toArray().map((e=>e.toArray()))}toJSON(){const{_matrix:e}=this;return e.toJSON()}getData(){const e=JSON.stringify(this);return JSON.parse(e)}getArrayData(){let e=0,t=0,n=!1,r=!1;const a=new ha;return this.forEach(((i,o)=>{n||(n=!0,e=i),o.forEach(((n,o)=>{r?n<t&&(t=n):(r=!0,t=n);const s=this.getValue(i,n);a.setValue(i-e,n-t,s)}))})),a.getData()}getDataRange(){let e=0,t=0,n=0,r=!1,a=!1;this.forEach(((i,o)=>{r||(r=!0,e=i);const s=o.getLength()-1;s>n&&(n=s),o.forEach(((e,n)=>{a?e<t&&(t=e):(a=!0,t=e)}))}));const i=e+this.getSizeOf()-1;return{startRow:e,startColumn:t,endRow:i,endColumn:n}}}const da=/^-ms-/,pa=/-([a-z])/g,ma=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];class _a{static stringAt(e){let t="",n=e;for(;n>=ma.length;)n/=ma.length,n-=1,t+=ma[n%ma.length];return t+=ma[e%ma.length],t}static getEnvironment(){const{appVersion:e}=navigator,t=this.getSystemType();return{app_version:e,os:t,os_version:t,device_id:"",platform:"web"}}static indexAt(e){let t=0;for(let n=0;n<e.length-1;n+=1){const r=e.charCodeAt(n)-65,a=e.length-1-n;t+=ma.length**a+ma.length*r}return t+=e.charCodeAt(e.length-1)-65,t}static deleteBlank(e){return _a.isString(e)?e.replace(/\s/g,""):e}static getSystemType(){const e=navigator.userAgent,t="Win32"===navigator.platform||"Windows"===navigator.platform,n="Mac68K"===navigator.platform||"MacPPC"===navigator.platform||"Macintosh"===navigator.platform||"MacIntel"===navigator.platform;if(n)return"Mac";if("X11"===navigator.platform&&!t&&!n)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(t){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Windows 2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"Windows XP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Windows 2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"Windows Vista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Windows 7";if(e.indexOf("Windows NT 10")>-1||e.indexOf("Windows 10")>-1)return"Windows 10";if(e.indexOf("Windows NT 11")>-1||e.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const e=navigator.userAgent,t=e.indexOf("Opera")>-1,n=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!t,r=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,a=e.indexOf("Edge")>-1,i=e.indexOf("Firefox")>-1,o=e.indexOf("Safari")>-1&&-1===e.indexOf("Chrome"),s=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(n){new RegExp("MSIE (\\d+\\.\\d+);").test(e);const t=parseFloat(RegExp.$1);return 7===t?"IE7":8===t?"IE8":9===t?"IE9":10===t?"IE10":"0"}return i?"FF":t?"Opera":o?"Safari":s?"Chrome":a?"Edge":r?"IE11":"Unknown browser"}static generateRandomId(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return`${e()+e()}-${e()}-${e()}-${e()}-${e()}${e()}${e()}`}static getClassName(e){return e.constructor.name}static deepMerge(e,...t){function n(e,t){e.forEach(((e,a)=>{var i,o;if(_a.isArray(e)){const r=null!=(i=t[a])?i:[];return t[a]=r,void n(e,r)}if(_a.isObject(e)){const n=null!=(o=t[a])?o:{};return t[a]=n,void r(e,n)}t[a]=e}))}function r(e,t){Object.keys(e).forEach((a=>{var i,o;const s=e[a];if(_a.isObject(s)){const e=null!=(i=t[a])?i:{};return t[a]=e,void r(s,e)}if(_a.isArray(s)){const e=null!=(o=t[a])?o:[];return t[a]=e,void n(s,e)}t[a]=s}))}return t.forEach((t=>t&&function(t){Object.keys(t).forEach((a=>{var i,o;const s=t[a];if(_a.isArray(s)){const t=null!=(i=e[a])?i:[];return e[a]=t,void n(s,t)}if(_a.isObject(s)){const t=null!=(o=e[a])?o:{};return e[a]=t,void r(s,t)}e[a]=s}))}(t))),e}static numberFixed(e,t){return Number(Number(e).toFixed(t))}static diffValue(e,t){function n(r,a){return _a.getValueType(r)===_a.getValueType(a)&&(_a.isArray(r)?function(r,a){if(e.length!==t.length)return!1;for(let e=0,t=r.length;e<t;e++){if(!n(r[e],a[e]))return!1}return!0}(r,a):_a.isObject(r)?function(e,t){const r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(const i of r){if(!a.includes(i))return!1;if(!n(e[i],t[i]))return!1}return!0}(r,a):_a.isDate(r)?r.getTime()===a.getTime():_a.isRegExp(r)?r.toString()===a.toString():r===a)}return n(e,t)}static deepClone(e){if(!this.isDefine(e))return e;if(this.isRegExp(e))return new RegExp(e);if(this.isDate(e))return new Date(e);if(this.isArray(e)){const t=[];return e.forEach(((e,n)=>{t[n]=_a.deepClone(e)})),t}if(this.isObject(e)){const t={};return Object.keys(e).forEach((n=>{const r=e[n];t[n]=_a.deepClone(r)})),Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}return e}static getLanguage(){return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||"en-US"}static getValueType(e){return Object.prototype.toString.apply(e)}static isDefine(e){return null!=e}static isBlank(e){return!this.isDefine(e)||!!this.isString(e)&&""===e.trim()}static isAssignableFrom(e,t){return e instanceof t}static isBoolean(e){return"[object Boolean]"===this.getValueType(e)}static isPlainObject(e){return!!this.isDefine(e)&&Object.getPrototypeOf(e)===Object.getPrototypeOf({})}static isFunction(e){return"[object Function]"===this.getValueType(e)}static isDate(e){return"[object Date]"===this.getValueType(e)}static isRegExp(e){return"[object RegExp]"===this.getValueType(e)}static isArray(e){return"[object Array]"===this.getValueType(e)}static isString(e){return"[object String]"===this.getValueType(e)}static isNumber(e){return"[object Number]"===this.getValueType(e)}static isObject(e){return"[object Object]"===this.getValueType(e)}static isEmptyObject(e){for(const t in e)return!1;return!0}static isMobile(){let e=0,t=0;return document.body.clientWidth&&(e=document.body.clientWidth),document.body.clientHeight&&(t=document.body.clientHeight),this.isAndroid()||this.isIPhone()||this.isTablet()||e<350&&t<500}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isWeChat(){const e=navigator.userAgent.toLowerCase();return"micromessenger"===String(e.match(/MicroMessenger/i))}static isAndroid(){const e=navigator.userAgent;return e.indexOf("Android")>-1||e.indexOf("Linux")>-1}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isIEBrowser(){return this.getBrowserType().startsWith("IE")}static itCount(e){return t=>{for(let n=0;n<e;n++)t&&t()}}static hasLength(e,t){return!!_a.isDefine(e)&&(_a.isDefine(t)?e.length===t:e.length>0)}static capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}static fCamelCase(e,t){return t.toUpperCase()}static camelCase(e){return e.replace(da,"ms-").replace(pa,this.fCamelCase)}static removeNull(e){if(this.isObject(e)){const t={};return Object.keys(e).forEach((t=>{const n=e[t];null==n?delete e[t]:_a.removeNull(n)})),t}return e}static fillTwoDimensionalArray(e,t,n){return new Array(e).fill(n).map((e=>new Array(t).fill(n)))}static fillObjectMatrix(e,t,n){const r=new ha;for(let a=0;a<e;a++)for(let e=0;e<t;e++)r.setValue(a,e,n);return r.getData()}static numToWord(e){let t="";for(;e>0;){let n=e%26;n=0===n?n=26:n,t=String.fromCharCode(96+n)+t,e=(e-n)/26}return t.toLocaleUpperCase()}static ABCatNum(e){if(null==e||0===e.length)return NaN;const t=e.toLowerCase().split(""),n=t.length;let r=0,a=0;for(let e=0;e<n;e++)a=t[e].charCodeAt(0)-96,r+=a*26**(n-e-1);return 0===r?NaN:r-1}static chatAtABC(e){const t="a".charCodeAt(0),n="z".charCodeAt(0)-t+1;let r="";for(;e>=0;)r=String.fromCharCode(e%n+t)+r,e=Math.floor(e/n)-1;return r.toUpperCase()}static randSort(e){for(let t=0,n=e.length;t<n;t++){const r=parseInt((Math.random()*n).toString()),a=e[r];e[r]=e[t],e[t]=a}return e}static commonExtend(e,t){let n={};for(let t in e)n[t]=e[t];for(let e in t)null!=t[e]&&(n[e]=t[e]);return n}}var ga=(e=>(e[e.DEFAULT_SERIES=0]="DEFAULT_SERIES",e[e.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",e))(ga||{}),fa=(e=>(e[e.NONE=0]="NONE",e[e.THIN=1]="THIN",e[e.HAIR=2]="HAIR",e[e.DOTTED=3]="DOTTED",e[e.DASHED=4]="DASHED",e[e.DASH_DOT=5]="DASH_DOT",e[e.DASH_DOT_DOT=6]="DASH_DOT_DOT",e[e.DOUBLE=7]="DOUBLE",e[e.MEDIUM=8]="MEDIUM",e[e.MEDIUM_DASHED=9]="MEDIUM_DASHED",e[e.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",e[e.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",e[e.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",e[e.THICK=13]="THICK",e))(fa||{}),ya=(e=>(e.TOP="top",e.BOTTOM="bottom",e.LEFT="left",e.RIGHT="right",e.NONE="none",e.ALL="all",e.OUTSIDE="outside",e.INSIDE="inside",e.HORIZONTAL="horizontal",e.VERTICAL="vertical",e))(ya||{}),va=(e=>(e[e.UNSUPPORTED=0]="UNSUPPORTED",e[e.RGB=1]="RGB",e[e.HEX=2]="HEX",e[e.THEME=3]="THEME",e))(va||{}),ba=(e=>(e[e.PASTE_NORMAL=0]="PASTE_NORMAL",e[e.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",e[e.PASTE_FORMAT=2]="PASTE_FORMAT",e[e.PASTE_FORMULA=3]="PASTE_FORMULA",e[e.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",e[e.PASTE_VALUES=5]="PASTE_VALUES",e[e.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",e[e.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",e))(ba||{}),xa=(e=>(e[e.COLUMNS=0]="COLUMNS",e[e.ROWS=1]="ROWS",e))(xa||{}),wa=(e=>(e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.TOP=2]="TOP",e[e.BOTTOM=3]="BOTTOM",e))(wa||{}),Ta=(e=>(e[e.NUMBER_FORMAT_TYPE_UNSPECIFIED=0]="NUMBER_FORMAT_TYPE_UNSPECIFIED",e[e.TEXT=1]="TEXT",e[e.NUMBER=2]="NUMBER",e[e.PERCENT=3]="PERCENT",e[e.CURRENCY=4]="CURRENCY",e[e.DATE=5]="DATE",e[e.TIME=6]="TIME",e[e.DATE_TIME=7]="DATE_TIME",e[e.SCIENTIFIC=8]="SCIENTIFIC",e))(Ta||{}),Ca=(e=>(e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESC=27]="ESC",e[e.SPACE=33]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.WIN=91]="WIN",e[e.WIN_R=92]="WIN_R",e[e.MENU=93]="MENU",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUM_LOCK=144]="NUM_LOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e))(Ca||{}),Ea=(e=>(e.EN="en",e.ZH="zh",e))(Ea||{}),Aa=(e=>(e[e.GRID=0]="GRID",e[e.KANBAN=1]="KANBAN",e[e.GANTT=2]="GANTT",e))(Aa||{}),Sa=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",e))(Sa||{}),Da=(e=>(e[e.DASH=0]="DASH",e[e.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",e[e.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",e[e.DASHED_HEAVY=3]="DASHED_HEAVY",e[e.DASH_LONG=4]="DASH_LONG",e[e.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",e[e.DOT_DASH=6]="DOT_DASH",e[e.DOT_DOT_DASH=7]="DOT_DOT_DASH",e[e.DOTTED=8]="DOTTED",e[e.DOTTED_HEAVY=9]="DOTTED_HEAVY",e[e.DOUBLE=10]="DOUBLE",e[e.NONE=11]="NONE",e[e.SINGLE=12]="SINGLE",e[e.THICK=13]="THICK",e[e.WAVE=14]="WAVE",e[e.WAVY_DOUBLE=15]="WAVY_DOUBLE",e[e.WAVY_HEAVY=16]="WAVY_HEAVY",e[e.WORDS=17]="WORDS",e))(Da||{}),Ra=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LEFT=1]="LEFT",e[e.CENTER=2]="CENTER",e[e.RIGHT=3]="RIGHT",e[e.JUSTIFIED=4]="JUSTIFIED",e))(Ra||{}),Na=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.TOP=1]="TOP",e[e.MIDDLE=2]="MIDDLE",e[e.BOTTOM=3]="BOTTOM",e))(Na||{}),Ma=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.OVERFLOW=1]="OVERFLOW",e[e.CLIP=2]="CLIP",e[e.WRAP=3]="WRAP",e))(Ma||{}),Oa=(e=>(e[e.NORMAL=0]="NORMAL",e[e.SUBSCRIPT=1]="SUBSCRIPT",e[e.SUPERSCRIPT=2]="SUPERSCRIPT",e))(Oa||{}),ka=(e=>(e[e.FALSE=0]="FALSE",e[e.TRUE=1]="TRUE",e))(ka||{}),Ia=(e=>(e[e.STRING=0]="STRING",e[e.NUMBER=1]="NUMBER",e[e.BOOLEAN=2]="BOOLEAN",e[e.FORCE_STRING=3]="FORCE_STRING",e))(Ia||{}),Pa=(e=>(e[e.DARK1=0]="DARK1",e[e.LIGHT1=1]="LIGHT1",e[e.DARK2=2]="DARK2",e[e.LIGHT2=3]="LIGHT2",e[e.ACCENT1=4]="ACCENT1",e[e.ACCENT2=5]="ACCENT2",e[e.ACCENT3=6]="ACCENT3",e[e.ACCENT4=7]="ACCENT4",e[e.ACCENT5=8]="ACCENT5",e[e.ACCENT6=9]="ACCENT6",e[e.HYPERLINK=10]="HYPERLINK",e[e.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",e))(Pa||{}),La=(e=>(e.OFFICE="Office",e.OFFICE_2007_2010="Office 2007-2010",e.GRAYSCALE="Grayscale",e.BLUE_WARM="Blue Warm",e.BLUE="Blue",e.BLUE_II="Blue II",e.BLUE_GREEN="Blue Green",e.GREEN="Green",e.GREEN_YELLOW="Green Yellow",e.YELLOW="Yellow",e.YELLOW_ORANGE="Yellow Orange",e.ORANGE="Orange",e.ORANGE_RED="Orange Red",e.RED_ORANGE="Red Orange",e.RED="Red",e.RED_VIOLET="Red Violet",e.VIOLET="Violet",e.VIOLET_II="Violet II",e.MEDIAN="Median",e.PAPER="Paper",e.MARQUEE="Marquee",e.SLIPSTREAM="Slipstream",e.Aspect="Aspect",e))(La||{});class Ba{constructor(){Qr(this,"_themeValue"),Qr(this,"_themeColors"),Qr(this,"_themeTint"),Qr(this,"_rgbValue"),Qr(this,"_colorType"),this._colorType=va.UNSUPPORTED,this._themeColors=La.OFFICE,this._themeTint=0}asRgbColor(){return new Va(this._rgbValue,this)}asThemeColor(){return new za(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case va.THEME:return this.asThemeColor();case va.RGB:return this.asRgbColor();case va.UNSUPPORTED:throw Error("unsupported color type")}}setRgbColor(e){return this._colorType=va.RGB,this._rgbValue=e,this}setThemeColors(e){this._colorType=va.THEME,this._themeColors=e}setThemeTint(e){this._colorType=va.THEME,this._themeTint=e}setThemeColor(e){return this._colorType=va.THEME,this._themeValue=e,this}getColorType(){return this._colorType}}const Fa={[La.OFFICE]:{[Pa.ACCENT1]:"#4472C4",[Pa.ACCENT2]:"#ED7D31",[Pa.ACCENT3]:"#A5A5A5",[Pa.ACCENT4]:"#70AD47",[Pa.ACCENT5]:"#5B9BD5",[Pa.ACCENT6]:"#70AD47",[Pa.DARK1]:"#000000",[Pa.DARK2]:"#44546A",[Pa.LIGHT1]:"#FFFFFF",[Pa.LIGHT2]:"#E7E6E6",[Pa.HYPERLINK]:"#0563C1",[Pa.FOLLOWED_HYPERLINK]:"#954F72"}};class Ha{constructor(e){Qr(this,"_builder"),this._builder=e}static rgbColorToHexValue(e){return`#${((1<<24)+(e.getRed()<<16)+(e.getGreen()<<8)+e.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(e){e?e.indexOf("#")>-1&&(e=e.substring(1)):e="#000000";let t=+`0x${e[0]}${e[1]}`,n=+`0x${e[2]}${e[3]}`,r=+`0x${e[4]}${e[5]}`;return(new Ba).setRgbColor(`rgb(${t},${n},${r})`).asRgbColor()}static hexToRgbString(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((e,t,n,r)=>t+t+n+n+r+r));const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);let n=null;if(t){n=`rgba(${parseInt(t[1],16)},${parseInt(t[2],16)},${parseInt(t[3],16)})`}return n}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new Ha(this._builder)}equals(e){return!1}}class qa{constructor(e){Qr(this,"_saturation"),Qr(this,"_hue"),Qr(this,"_lightness"),Qr(this,"_alpha");const t=e.getRed()/255,n=e.getGreen()/255,r=e.getBlue()/255,a=e.getAlpha()/255,i=Math.min(t,Math.min(n,r)),o=Math.max(t,Math.max(n,r)),s=o-i;if(o===i)return this._hue=0,this._saturation=0,void(this._lightness=o);this._lightness=(i+o)/2,this._lightness<.5?this._saturation=s/(o+i):this._saturation=s/(2-o-i),t===o&&(this._hue=(n-r)/s),n===o&&(this._hue=2+(r-t)/s),r===o&&(this._hue=4+(t-n)/s),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=a}asRgbColor(){const e=new Ba;if(0===this._saturation)return e.setRgbColor(`rgba(${255*this._lightness},${255*this._lightness},${255*this._lightness},${255*this._alpha})`),e.asRgbColor();let t;t=this._lightness<.5?this._lightness*(1+this._saturation):this._lightness+this._saturation-this._lightness*this._saturation;const n=2*this._lightness-t,r=this._hue/360,a=r+1/3,i=this.setColor(t,n,a),o=this.setColor(t,n,r),s=r-1/3,l=this.setColor(t,n,s);return e.setRgbColor(`rgba(${Math.round(255*i)},${Math.round(255*o)},${Math.round(255*l)},${255*this._alpha})`),e.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(e,t,n){let r;return n<0&&(n+=1),n>1&&(n-=1),r=6*n<1?t+6*(e-t)*n:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t,r}setLightness(e){this._lightness=e}}const Ua=class extends Ha{constructor(e,t){super(t),Qr(this,"_cssString"),Qr(this,"_red"),Qr(this,"_green"),Qr(this,"_blue"),Qr(this,"_alpha");let n=e.match(Ua.RGBA_EXTRACT);if(n){const t=+n[1],r=+n[2],a=+n[3],i=+n[4];return this._cssString=e,this._red=t,this._green=r,this._blue=a,void(this._alpha=i)}if(n=e.match(Ua.RGB_EXTRACT),n){const t=+n[1],r=+n[2],a=+n[3];return this._cssString=e,this._red=t,this._green=r,this._blue=a,void(this._alpha=1)}throw new Error("Invalid rgba or rgb color")}asHexString(){return Ha.rgbColorToHexValue(this)}getRed(){let e=this._red+Ua.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getGreen(){let e=this._green+Ua.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getBlue(){let e=this._blue+Ua.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getAlpha(){return this._alpha}getColorType(){return va.RGB}clone(){return new Ua(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(e){return e instanceof Ua&&(e._red===this._red&&e._blue===this._blue&&e._green===this._green&&e._alpha===this._alpha)}getCssString(){return this._cssString}};let Va=Ua;Qr(Va,"RGB_COLOR_AMT",0),Qr(Va,"RGBA_EXTRACT",new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*")),Qr(Va,"RGB_EXTRACT",new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*"));const Wa=class extends Ha{constructor(e,t,n,r){super(r),Qr(this,"_themeColorType"),Qr(this,"_themeTint"),Qr(this,"_themeColors"),this._themeColorType=e,this._themeTint=t,this._themeColors=n}lumValue(e,t){if(null==e)return t;let n;return n=e<0?t*(1+e):t*(1-e)+(255-255*(1-e)),n}asRgbColor(){const e=Fa[this._themeColors];if(null==e)throw new Error("not find themeColors type");const t=e.get(this._themeColorType);if(null==t)throw new Error("not find themeColors value");let n;if(Wa._cacheThemeColor.has(this._themeColors)){if(n=Wa._cacheThemeColor.get(this._themeColors),n.has(this._themeColorType))return n.get(this._themeColorType)}else n=new Map,Wa._cacheThemeColor.set(this._themeColors,n);const r=new qa(Ha.hexValueToRgbColor(t));r.setLightness(this.lumValue(this._themeTint,255*r.getLightness())/255);const a=r.asRgbColor();return n.set(this._themeColorType,a),a}clone(){return new Wa(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(e){return e instanceof Wa&&e._themeColorType===this._themeColorType}getColorType(){return va.THEME}getThemeColorType(){return this._themeColorType}};let za=Wa;Qr(za,"_cacheThemeColor",new Map);var Ya=(e=>(e.INSERT_ROW_DATA_ACTION="InsertRowDataAction",e.REMOVE_ROW_DATA_ACTION="RemoveRowDataAction",e.INSERT_ROW_ACTION="InsertRowAction",e.REMOVE_ROW_ACTION="RemoveRowAction",e.SET_RANGE_STYLE_ACTION="SetRangeStyleAction",e.SET_RANGE_FORMULA_ACTION="SetRangeFormulaAction",e.SET_RANGE_FORMAT_ACTION="SetRangeFormatAction",e.SET_SELECTION_ACTION="SetSelectionActivateAction",e.SET_RANGE_DATA_ACTION="SetRangeDataAction",e.SET_RANGE_FORMATTED_VALUE_ACTION="SetRangeFormattedValueAction",e.SET_RANGE_NOTE_ACTION="SetRangeNoteAction",e.DELETE_RANGE_ACTION="DeleteRangeAction",e.INSERT_SHEET_ACTION="InsertSheetAction",e.REMOVE_SHEET_ACTION="RemoveSheetAction",e.CLEAR_RANGE_ACTION="ClearRangeAction",e.INSERT_RANGE_ACTION="InsertRangeAction",e.SET_TAB_COLOR_ACTION="SetTabColorAction",e.HIDE_SHEET_ACTION="SetWorkSheetHideAction",e.SET_WORKSHEET_ACTIVATE_ACTION="SetWorkSheetActivateAction",e.INSERT_COLUMN_ACTION="InsertColumnAction",e.INSERT_COLUMN_DATA_ACTION="InsertColumnDataAction",e.REMOVE_COLUMN_ACTION="RemoveColumnAction",e.REMOVE_COLUMN_DATA_ACTION="RemoveColumnDataAction",e.SET_HIDE_ROW_ACTION="SetRowHideAction",e.SET_HIDE_COLUMN_ACTION="SetColumnHideAction",e.SET_SHOW_ROW_ACTION="SetRowShowAction",e.SET_SHOW_COLUMN_ACTION="SetColumnShowAction",e.ADD_MERGE_ACTION="AddMergeAction",e.REMOVE_MERGE_ACTION="RemoveMergeAction",e.SET_WORKSHEET_NAME_ACTION="SetWorkSheetNameAction",e.SET_WORKSHEET_STATUS_ACTION="SetWorkSheetStatusAction",e.SET_BORDER_ACTION="SetBorderAction",e.SET_COLUMN_WIDTH_ACTION="SetColumnWidthAction",e.SET_ROW_HEIGHT_ACTION="SetRowHeightAction",e.SET_HIDDEN_GRIDLINES_ACTION="SetHiddenGridlinesAction",e.SET_RIGHT_TO_LEFT_ACTION="SetRightToLeftAction",e.DELETE_BANDING_ACTION="DeleteBandingAction",e.SET_BANDING_ACTION="SetBandingAction",e.ADD_BANDING_ACTION="AddBandingAction",e.DELETE_NAMED_RANGE_ACTION="DeleteNamedRangeAction",e.SET_NAMED_RANGE_ACTION="SetNamedRangeAction",e.ADD_NAMED_RANGE_ACTION="AddNamedRangeAction",e.SET_SHEET_ORDER_ACTION="SetSheetOrderAction",e.SET_ZOOM_RATIO_ACTION="SetZoomRatioAction",e))(Ya||{});const Ga={sheetId:"",rangeData:{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}},Xa={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1},$a={extensions:[],id:"",sheetOrder:[],socketEnable:ka.FALSE,socketUrl:"",name:"",timeZone:"",appVersion:"",theme:"",skin:"",locale:Ea.EN,creator:"",styles:{},sheets:{},lastModifiedBy:"",createdTime:"",modifiedTime:"",pluginMeta:{},namedRanges:[]},ja={type:Aa.GRID,name:"",id:"",tabColor:"",hidden:ka.FALSE,freezeColumn:-1,rowCount:1e3,columnCount:100,freezeRow:-1,zoomRatio:1,scrollTop:0,scrollLeft:0,defaultColumnWidth:73,defaultRowHeight:19,mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},status:ka.FALSE,showGridlines:ka.TRUE,rowTitle:{width:46,hidden:ka.FALSE},columnTitle:{height:20,hidden:ka.FALSE},selections:["A1"],rightToLeft:ka.FALSE,pluginMeta:{}},Ka={ff:"Times New Roman",fs:14,it:ka.FALSE,bl:ka.FALSE,ul:{s:ka.FALSE},st:{s:ka.FALSE},ol:{s:ka.FALSE},tr:{a:0,v:ka.FALSE},td:Sa.UNSPECIFIED,cl:{rgb:"#000"},bg:{rgb:"#fff"},ht:Ra.UNSPECIFIED,vt:Na.UNSPECIFIED,tb:Ma.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0}},Za="set",Qa="insert",Ja="remove";const ei={modifier:["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Symbol","SymbolLock"],legacyModifier:["Hyper","Super"],whiteSpace:["Enter","Tab"],navigation:["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home","PageDown","PageUp"],editing:["Backspace","Clear","Copy","CrSel","Cut","Delete","EraseEof","ExSel","Insert","Paste","Redo","Undo"],ui:["Accept","Again","Attn","Cancel","ContextMenu","Escape","Execute","Find","Help","Pause","Play","Props","Select","ZoomIn","ZoomOut"],device:["BrightnessDown","BrightnessUp","Eject","LogOff","Power","PowerOff","PrintScreen","Hibernate","Standby","WakeUp"],imeCompositionKeys:["AllCandidates","Alphanumeric","CodeInput","Compose","Convert","Dead","FinalMode","GroupFirst","GroupLast","GroupNext","GroupPrevious","ModeChange","NextCandidate","NonConvert","PreviousCandidate","Process","SingleCandidate"],koreanSpecific:["HangulMode","HanjaMode","JunjaMode"],japaneseSpecific:["Eisu","Hankaku","Hiragana","HiraganaKatakana","KanaMode","KanjiMode","Katakana","Romaji","Zenkaku","ZenkakuHankaku"],commonFunction:["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Soft1","Soft2","Soft3","Soft4"],multimedia:["ChannelDown","ChannelUp","Close","MailForward","MailReply","MailSend","MediaClose","MediaFastForward","MediaPause","MediaPlay","MediaPlayPause","MediaRecord","MediaRewind","MediaStop","MediaTrackNext","MediaTrackPrevious","New","Open","Print","Save","SpellCheck"],multimediaNumpad:["Key11","Key12"],audio:["AudioBalanceLeft","AudioBalanceRight","AudioBassBoostDown","AudioBassBoostToggle","AudioBassBoostUp","AudioFaderFront","AudioFaderRear","AudioSurroundModeNext","AudioTrebleDown","AudioTrebleUp","AudioVolumeDown","AudioVolumeUp","AudioVolumeMute","MicrophoneToggle","MicrophoneVolumeDown","MicrophoneVolumeUp","MicrophoneVolumeMute"],speech:["SpeechCorrectionList","SpeechInputToggle"],application:["LaunchApplication1","LaunchApplication2","LaunchCalendar","LaunchContacts","LaunchMail","LaunchMediaPlayer","LaunchMusicPlayer","LaunchPhone","LaunchScreenSaver","LaunchSpreadsheet","LaunchWebBrowser","LaunchWebCam","LaunchWordProcessor"],browser:["BrowserBack","BrowserFavorites","BrowserForward","BrowserHome","BrowserRefresh","BrowserSearch","BrowserStop"],mobilePhone:["AppSwitch","Call","Camera","CameraFocus","EndCall","GoBack","GoHome","HeadsetHook","LastNumberRedial","Notification","MannerMode","VoiceDial"],tv:["TV","TV3DMode","TVAntennaCable","TVAudioDescription","TVAudioDescriptionMixDown","TVAudioDescriptionMixUp","TVContentsMenu","TVDataService","TVInput","TVInputComponent1","TVInputComponent2","TVInputComposite1","TVInputComposite2","TVInputHDMI1","TVInputHDMI2","TVInputHDMI3","TVInputHDMI4","TVInputVGA1","TVMediaContext","TVNetwork","TVNumberEntry","TVPower","TVRadioService","TVSatellite","TVSatelliteBS","TVSatelliteCS","TVSatelliteToggle","TVTerrestrialAnalog","TVTerrestrialDigital","TVTimer"],mediaControls:["AVRInput","AVRPower","ColorF0Red","ColorF1Green","ColorF2Yellow","ColorF3Blue","ColorF4Grey","ColorF5Brown","ClosedCaptionToggle","Dimmer","DisplaySwap","DVR","Exit","FavoriteClear0","FavoriteClear1","FavoriteClear2","FavoriteClear3","FavoriteRecall0","FavoriteRecall1","FavoriteRecall2","FavoriteRecall3","FavoriteStore0","FavoriteStore1","FavoriteStore2","FavoriteStore3","Guide","GuideNextDay","GuidePreviousDay","Info","InstantReplay","Link","ListProgram","LiveContent","Lock","MediaApps","MediaAudioTrack","MediaLast","MediaSkipBackward","MediaSkipForward","MediaStepBackward","MediaStepForward","MediaTopMenu","NavigateIn","NavigateNext","NavigateOut","NavigatePrevious","NextFavoriteChannel","NextUserProfile","OnDemand","Pairing","PinPDown","PinPMove","PinPToggle","PinPUp","PlaySpeedDown","PlaySpeedReset","PlaySpeedUp","RandomToggle","RcLowBattery","RecordSpeedNext","RfBypass","ScanChannelsToggle","ScreenModeNext","Settings","SplitScreenToggle","STBInput","STBPower","Subtitle","Teletext","VideoModeNext","Wink","ZoomToggle"]};var ti=(e=>(e.BASE_COMPONENT="baseComponent",e.BASE_RENDER="renderEngine",e.SPREADSHEET="spreadsheet",e.DOCUMENT="document",e.SLIDE="slide",e))(ti||{});class ni{constructor(e,t){Qr(this,"_columnData"),Qr(this,"_workSheet"),this._workSheet=e,this._columnData=new ca(t)}getColumnData(){return this._columnData}getColumnDatas(e,t){const n=new ca;for(let r=e;r<e+t;r++){const e=this.getColumnOrCreate(r);n.push(e)}return n}getSize(){return this._columnData.getLength()}getColumnWidth(...e){const{_workSheet:t}=this,{_columnData:n}=this,r=t.getConfig();let a=0;if(1===e.length)a=n.obtain(e[0],{hd:ka.FALSE,w:r.defaultColumnWidth}).w;else if(2===e.length)for(let t=e[0];t<e[0]+e[1];t++){a+=n.obtain(t,{hd:ka.FALSE,w:r.defaultColumnWidth}).w}return a}setColumnWidth(e,t){const n=this._workSheet.getContext(),r=this._workSheet.getCommandManager(),a={sheetId:this._workSheet.getSheetId(),actionName:Ya.SET_COLUMN_WIDTH_ACTION,columnIndex:e,columnWidth:t},i=new xs(n.getWorkBook(),a);r.invoke(i)}getColumn(e){const t=this._columnData.get(e);if(t)return t}getColumnOrCreate(e){const{_workSheet:t}=this,{_columnData:n}=this,r=t.getConfig(),a=n.get(e);if(a)return a;const i={w:r.defaultColumnWidth,hd:ka.FALSE};return this._columnData.set(e,i),i}}function ri(e,t){for(let n=0;n<t.length;n++)e.add(t[n]);return[]}function ai(e,t){let n=[];for(let r=0;r<t.length;r++)n=n.concat(e.remove(t[r]));return n}class ii{constructor(e,t,n,r,a){Qr(this,"operation"),Qr(this,"type"),Qr(this,"value"),Qr(this,"key"),Qr(this,"attribute"),this.operation=e,this.type=t,this.attribute=n,this.key=r,this.value=a}getData(){return this.toJSON()}toJSON(){return{operation:this.operation,key:this.key,value:this.value,type:this.type,attribute:this.attribute}}}class oi extends ii{constructor(e,t="",n="",r=""){super(e,"worksheet",t,n,r)}}function si(e,t){e.push(t)}function li(e,t){return e.find(((n,r)=>n.namedRangeId===t?(e.splice(r,1),n):null))}function ci(e,t,n,r){const{startRow:a,endRow:i,startColumn:o,endColumn:s}=r,l=i-a+1,c=s-o+1,u=e.rowCount,h=e.columnCount,d=new ha;if(n===xa.ROWS)for(let e=a;e<=u;e++)for(let n=o;n<=s;n++){if(e<=i){const r=t.getValue(e,n);d.setValue(e,n,r)}const r=t.getValue(e+l,n);r?t.setValue(e,n,_a.deepClone(r)):t.getValue(e,n)&&(t.deleteValue(e,n),n--)}else if(n===xa.COLUMNS)for(let e=a;e<=i;e++)for(let n=o;n<=h;n++){if(n<=s){const r=t.getValue(e,n);d.setValue(e,n,r)}else for(let r=0;r<=s;r++){const a=t.getValue(e,n);d.setValue(e,n+r,a)}const r=t.getValue(e,n+c);if(r)t.setValue(e,n,_a.deepClone(r));else if(t.getValue(e,n)){for(let r=0;r<=s;r++)t.deleteValue(e,n);break}}return d.getData()}function ui(e,t){const n=e.getConfig(),r=n.hidden;return n.hidden=t,r}function hi(e=0,t=1,n){new ca(n).inserts(e,new ca(t))}function di(e,t,n){new ha(n).insertColumns(e,new ha(t))}function pi(e,t,n){new ha(n).insertRows(e,new ha(t))}function mi(e,t,n,r,a){const{startRow:i,endRow:o,startColumn:s,endColumn:l}=r,c=o-i+1,u=l-s+1,h=e.rowCount,d=e.columnCount;if(n===xa.ROWS){for(let e=h;e>=i;e--)for(let n=s;n<=l;n++){const r=t.getValue(e,n);t.setValue(e+c,n,r)}for(let e=o;e>=i;e--)for(let n=s;n<=l;n++)t.setValue(e,n,a[e-i][n-s])}else if(n===xa.COLUMNS){for(let e=i;e<=o;e++)for(let n=d;n>=s;n--){const r=t.getValue(e,n);t.setValue(e,n+u,r)}for(let e=i;e<=o;e++)for(let n=l;n>=s;n--)t.setValue(e,n,a[e-i][n-s])}}function _i(e=0,t=1,n){new ca(n).inserts(e,new ca(t))}function gi(e,t,n){const r=e.getWorksheets(),a=e.getConfig(),{sheets:i,sheetOrder:o}=a;if(i[n.id])throw new Error(`Insert Sheet fail ${n.id} is already exist`);return i[n.id]=n,o.splice(t,0,n.id),r.set(n.id,new wo(e.getContext(),n)),n.id}function fi(e,t,n){const r=new ca(n),a=new ca,i=e+t;for(let t=e;t<i;t++){const n=r.splice(e,1);n.getLength()&&a.set(t,n.first())}return a.getLength()}function yi(e,t,n){return new ha(n).spliceColumns(e,t).toJSON()}function vi(e,t,n){const r=new ca(n),a=new ca,i=e+t;for(let t=e;t<i;t++){const n=r.splice(e,1);n.getLength()&&a.set(t,n.first())}return a.getLength()}function bi(e,t,n){return new ha(n).spliceRows(e,t).toJSON()}function xi(e,t){const n=e.getWorksheets(),r=e.getConfig(),{sheets:a}=r;if(null==a[t])throw new Error(`Remove Sheet fail ${t} is not exist`);const i=a[t],o=r.sheetOrder.findIndex((e=>e===t));return delete a[t],r.sheetOrder.splice(o,1),n.delete(t),{index:o,sheet:i}}function wi(e,t,n){const r=new ha(n),a=new ha;return r.forEach(((n,r)=>{r.forEach(((r,i)=>{const o=e.getValue(n,r);if(o){const e=t.get(o.s);e&&a.setValue(n,r,e),o.s=t.setValue(i)}}))})),a.toJSON()}function Ti(e=0,t,n){for(let r=e;r<e+t;r++){n.getColumnOrCreate(r).hd=1}}function Ci(e=0,t,n){for(let r=e;r<e+t;r++){const e=n.getColumn(r);e&&(e.hd=0)}}function Ei(e=0,t,n){const r=[];for(let a=e;a<e+t.length;a++){const e=n.getColumnOrCreate(a);r[a]=e.w,e.w=t[a]}return r}function Ai(e,t){const n=e.getConfig(),r=0===n.showGridlines;return n.showGridlines=t?0:1,r}function Si(e=0,t,n){for(let r=e;r<e+t;r++){const e=n.getRowOrCreate(r);e&&(e.hd=1)}}function Di(e,t){return e.find(((n,r)=>n.namedRangeId===t.namedRangeId?(e[r]=t,n):null))}function Ri(e,t,n,r){const{startRow:a,endRow:i,startColumn:o,endColumn:s}=n,l=new ha;for(let n=a;n<=i;n++)for(let i=o;i<=s;i++){const s=e.getValue(n,i)||{},c=s.s?r.get(s.s):null;null==c&&delete s.s;const u=Oi(c,t[n-a][i-o]);u&&_a.removeNull(u),_a.isEmptyObject(u)?delete s.s:s.s=r.setValue(u),s.p&&ki(s.p,t[n-a][i-o]),e.setValue(n,i,s),l.setValue(n-a,i-o,Ni(c,t[n-a][i-o]))}return l.getData()}function Ni(e,t){return function(e,t){if(!t||!Object.keys(t).length)return e;const n=_a.deepClone(e)||{};for(const e in t)"bd"===e?n[e]=Mi(n[e]||{},t[e]):e in n||(n[e]=null);return n}(e,t)}function Mi(e,t){if(!t||!Object.keys(t).length)return e;for(const n in t)n in e||(e[n]=null);return e}function Oi(e,t,n=!1){if(!t)return t;const r=_a.deepClone(e)||{};for(const e in t)n&&["bd","tr","td","ht","vt","tb","pd"].includes(e)||(e in r&&"bd"===e?r[e]=Object.assign(r[e],t[e]):(r[e]=t[e],"cl"in r&&["ul","ol","st"].includes(e)&&(r[e].cl=r.cl)));return r}function ki(e,t){var n;null==(n=e.body)||n.blockElementOrder.forEach((n=>{var r,a;if(0===(null==(r=e.body)?void 0:r.blockElements[n].blockType)){const r=null==(a=e.body)?void 0:a.blockElements[n].paragraph;null==r||r.elementOrder.forEach((({elementId:e,paragraphElementType:n})=>{r.elements[e].tr||(r.elements[e].tr={});const a=r.elements[e].tr;a.ts||(a.ts={});const i=Oi(a.ts,t,!0);i&&_a.removeNull(i),_a.isEmptyObject(i)?delete a.ts:a.ts=i}))}}))}function Ii(e,t,n,r,a){let i;isNaN(parseInt(Object.keys(t)[0]))||(i=new ha(t));const o=new ha,{startRow:s,endRow:l,startColumn:c,endColumn:u}=n;if(a){for(let n=s;n<=l;n++)for(let r=c;r<=u;r++){const s=i?i.getValue(n,r):t,l=e.getValue(n,r),c={};a.contentsOnly&&(c.m=null==l?void 0:l.m,c.v=null==l?void 0:l.v),a.formatOnly&&(c.v=null==l?void 0:l.v,c.m=null==l?void 0:l.m),o.setValue(n,r,c||{}),e.setValue(n,r,s||{})}return o.getData()}for(let n=s;n<=l;n++)for(let a=c;a<=u;a++){const s=i?i.getValue(n,a):t,l=e.getValue(n,a)||{};if(!s){e.setValue(n,a,s),o.setValue(n,a,l);continue}const c=l.s?r.get(l.s):null,u=Ni(c,null==s?void 0:s.s),h=_a.deepClone(l);h.s=u,o.setValue(n,a,h),null==c&&delete l.s;const d=Oi(c,null==s?void 0:s.s);d&&_a.removeNull(d),_a.isEmptyObject(d)?delete l.s:l.s=r.setValue(d),s.p&&(l.p=s.p),s.v&&(l.v=s.v),s.m?l.m=s.m:l.m=String(l.v),s.t&&(l.t=s.t),e.setValue(n,a,l)}return o.getData()}function Pi(e,t,n){const r=new ha(t),a=new ha;for(let t=n.startRow;t<=n.endRow;t++)for(let a=n.startColumn;a<=n.endColumn;a++){const n=r.getValue(t,a);if(n){JSON.parse(n);const r=e.getValue(t,a),i=_a.deepClone(r||{});e.setValue(t,a,i||{})}else{const n=e.getValue(t,a),r=_a.deepClone(n||{});e.setValue(t,a,r||{})}}return a.getData()}function Li(e,t,n){const r=new ha(t),a=new ha;for(let t=n.startRow;t<=n.endRow;t++)for(let a=n.startColumn;a<=n.endColumn;a++){const n=r.getValue(t,a),i=e.getValue(t,a),o=_a.deepClone(i||{});o.f=n,e.setValue(t,a,o||{})}return a.getData()}function Bi(e,t,n){const r=new ha(t),a=new ha;for(let t=n.startRow;t<=n.endRow;t++)for(let a=n.startColumn;a<=n.endColumn;a++){const n=r.getValue(t,a),i=e.getValue(t,a),o=_a.deepClone(i||{});o.n=n,e.setValue(t,a,o||{})}return a.getData()}function Fi(e,t,n){const r=new ha(t),a=new ha;for(let t=n.startRow;t<=n.endRow;t++)for(let i=n.startColumn;i<=n.endColumn;i++){const n=r.getValue(t,i),o=e.getValue(t,i);a.setValue(t,i,o&&o.v||"");const s=_a.deepClone(o||{});s.v=n,s.m=`${n}`,e.setValue(t,i,s||{})}return a.getData()}function Hi(e,t){const n=e.getConfig(),r=n.rightToLeft;return n.rightToLeft=t,r}function qi(e=0,t,n){const r=[];for(let a=e;a<e+t.length;a++){const e=n.getRowOrCreate(a);r[a]=e.h,e.h=t[a]}return r}function Ui(e,t,n,r){var a,i,o;const s=e.getSelection(),l=null==(a=s.getActiveRangeList())?void 0:a.getRangeList(),c=null==(i=s.getActiveRange())?void 0:i.getRangeData(),u=null==(o=s.getCurrentCell())?void 0:o.getRangeData();return s.setRanges(t,n,r),{activeRangeList:l,activeRange:c,currentCell:u}}function Vi(e,t,n){const r=e.getConfig(),a=r.sheetOrder.findIndex((e=>e===t)),i=r.sheetOrder.filter((e=>e!==t));return i.splice(n,0,t),r.sheetOrder=i,a}function Wi(e=0,t,n){for(let r=e;r<e+t;r++){const e=n.getRow(r);e&&(e.hd=0)}}function zi(e,t){const n=e.getConfig(),r=n.tabColor;return n.tabColor=t,r}function Yi(e,t){const n=e.getContext().getWorkBook().getActiveSheet();let r="";const a=ka.FALSE;n&&(r=n.getSheetId());const i=e.getContext().getWorkBook().getSheets(),o=e.getSheetId();return i.forEach((e=>{e.getSheetId()===o?e.getConfig().status=ka.TRUE:e.getConfig().status=ka.FALSE})),{oldSheetId:r,status:a}}function Gi(e,t){const n=e.getConfig(),r=n.name;return n.name=t,r}function Xi(e,t){const n=e.getConfig(),r=n.status;return n.status=t,r}function $i(e,t,n){const r=e.getSheetBySheetId(t);if(r){const e=r.getConfig().zoomRatio;return r.getConfig().zoomRatio=n,e}return 1}class ji extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new oi(Za)]},this._oldActionData={...e,cellValue:this.do(),convertor:[new oi(Qa)]},this.validate()}do(){const e=this.getWorkSheet(),t=ci({rowCount:e.getConfig().rowCount,columnCount:e.getConfig().columnCount},e.getCellMatrix(),this._doActionData.shiftDimension,this._doActionData.rangeData);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t,shiftDimension:n}=this._doActionData;this._oldActionData={sheetId:e,actionName:Ya.INSERT_RANGE_ACTION,shiftDimension:n,rangeData:t,cellValue:this.do(),convertor:[new oi(Qa)]}}undo(){const e=this.getWorkSheet(),{shiftDimension:t,rangeData:n,cellValue:r}=this._oldActionData;e&&(mi({rowCount:e.getConfig().rowCount,columnCount:e.getConfig().columnCount},e.getCellMatrix(),t,n,r),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class Ki extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet().getColumnManager();hi(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnData().toJSON()),this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet().getColumnManager();this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this}),fi(this._oldActionData.columnIndex,this._oldActionData.columnCount,e.getColumnData().toJSON())}validate(){return!1}}class Zi extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet().getRowManager();_i(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowData().toJSON()),this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet().getRowManager();this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this}),vi(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getRowData().toJSON())}validate(){return!1}}class Qi extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,columnCount:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet().getColumnManager(),t=fi(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnData().toJSON());return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet().getColumnManager();hi(this._oldActionData.columnIndex,this._oldActionData.columnCount,e.getColumnData().toJSON()),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Ji extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new oi(Ja)]},this._oldActionData={...e,rowCount:this.do(),convertor:[new oi(Ja)]},this.validate()}do(){const e=this.getWorkSheet().getRowManager(),t=vi(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowData().toJSON());return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet().getRowManager();_i(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getRowData().toJSON()),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class eo extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,order:this.do(),convertor:[]},this.validate()}do(){const e=Vi(this.getWorkSheet().getContext().getWorkBook(),this._doActionData.sheetId,this._doActionData.order);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){Vi(this.getWorkSheet().getContext().getWorkBook(),this._oldActionData.sheetId,this._oldActionData.order),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class to{constructor(...e){if(Qr(this,"startRow"),Qr(this,"startColumn"),Qr(this,"endRow"),Qr(this,"endColumn"),_a.hasLength(e,0))return this.startRow=0,this.startColumn=0,this.endRow=0,void(this.endColumn=0);if(_a.hasLength(e,1)){const t=e[0];return this.startRow=t.startRow,this.startColumn=t.startColumn,this.endRow=t.endRow,void(this.endColumn=t.endColumn)}if(_a.hasLength(e,4)){const t=e[0],n=e[1],r=e[2],a=e[3];this.startRow=t,this.startColumn=n,this.endRow=r,this.endColumn=a}}intersects(e){const t=this.startRow,n=this.endRow,r=this.startColumn,a=this.endColumn,i=e.startRow,o=e.endRow,s=e.startColumn,l=e.endColumn,c=Math.abs(r+a-s-l),u=Math.abs(r-a)+Math.abs(s-l),h=Math.abs(t+n-i-o),d=Math.abs(t-n)+Math.abs(i-o);return c<=u&&h<=d}union(e){const{startRow:t,startColumn:n,endRow:r,endColumn:a}=this;return new to(e.startRow<this.startRow?e.startRow:t,e.startColumn<n?e.startColumn:n,e.endRow>r?e.endRow:r,e.endColumn>a?e.endColumn:a)}getData(){return{startRow:this.startRow,startColumn:this.startColumn,endRow:this.endRow,endColumn:this.endColumn}}equals(e){return this.endRow===e.endRow&&this.endColumn===e.endColumn&&this.startRow===e.startRow&&this.startColumn===e.startColumn}}const no=class{static checkup(e,...t){if(e.length!==t.length)return!1;const n=e.length;for(let r=0;r<n;r++){const n=e[r],a=t[r];switch(a){case no.BOOLEAN_TYPE:if(!_a.isBoolean(n))return!1;break;case no.NUMBER_TYPE:if(!_a.isNumber(n))return!1;break;case no.STRING_TYPE:if(!_a.isString(n))return!1;break;case no.FUNCTION_TYPE:if(!_a.isFunction(n))return!1;break;case no.OBJECT_TYPE:if(!_a.isPlainObject(n))return!1;break;default:if(!_a.isAssignableFrom(n,a))return!1}}return!0}};let ro=no;Qr(ro,"STRING_TYPE",1),Qr(ro,"NUMBER_TYPE",2),Qr(ro,"BOOLEAN_TYPE",3),Qr(ro,"FUNCTION_TYPE",4),Qr(ro,"OBJECT_TYPE",5);class ao{constructor(e,t){Qr(this,"_rectangleList"),Qr(this,"_worksheet"),this._worksheet=e,this._rectangleList=t,ps.getCommandInjectorObservers().add((e=>{let t=e.include(Zi),n=e.include(Ki),r=e.include(Ji),a=e.include(Qi),i=e.include(ji);if(t){const e=t.getDoActionData();if(e.sheetId===this._worksheet.getSheetId()){const t=_a.deepClone(this._rectangleList);for(let n=0;n<t.length;n++){const r=t[n],a=e.rowCount;e.rowIndex>r.endRow||(e.rowIndex>=r.startRow&&e.rowIndex<=r.endRow||(r.startRow+=a),r.endRow+=a)}this.modifyMerge(this._rectangleList,t)}}if(n){const e=n.getDoActionData();if(e.sheetId===this._worksheet.getSheetId()){const t=_a.deepClone(this._rectangleList);for(let n=0;n<t.length;n++){const r=t[n],a=e.columnCount;e.columnIndex>r.endColumn||(e.columnIndex>=r.startColumn&&e.columnIndex<=r.endColumn||(r.startColumn+=a),r.endColumn+=a)}this.modifyMerge(this._rectangleList,t)}}if(r){const e=r.getDoActionData();if(e.sheetId===this._worksheet.getSheetId()&&e.sheetId===this._worksheet.getSheetId()){const t=_a.deepClone(this._rectangleList);for(let n=0;n<t.length;n++){const r=t[n],a=e.rowCount;e.rowIndex>r.endRow||(e.rowIndex>=r.startRow&&e.rowIndex<=r.endRow||(r.startRow-=a),r.endRow-=a)}this.modifyMerge(this._rectangleList,t)}}if(a){const e=a.getDoActionData();if(e.sheetId===this._worksheet.getSheetId()&&e.sheetId===this._worksheet.getSheetId()){const t=_a.deepClone(this._rectangleList);for(let n=0;n<t.length;n++){const r=t[n],a=e.columnCount;e.columnIndex>r.endColumn||(e.columnIndex>=r.startColumn&&e.columnIndex<=r.endColumn||(r.startColumn-=a),r.endColumn-=a)}this.modifyMerge(this._rectangleList,t)}}if(i){const e=i.getDoActionData();if(e.sheetId===this._worksheet.getSheetId()){const t=_a.deepClone(this._rectangleList),n=this.getByRowColumn(e.rangeData.startRow,e.rangeData.endRow,e.rangeData.startColumn,e.rangeData.endColumn);if(n&&n.forEach((e=>{const n=new to(e);for(let e=0;e<t.length;e++){const r=t[e];n.intersects(new to(r))&&t.splice(e,1)}})),e.shiftDimension)for(let n=0;n<t.length;n++){const r=t[n];if(r.endRow>=e.rangeData.startRow){if(r.endColumn<e.rangeData.startColumn)continue;if(r.startColumn>e.rangeData.endColumn)continue;if(!(r.startColumn>=e.rangeData.startColumn&&r.endColumn<=e.rangeData.endColumn))return;{const t=e.rangeData.endRow-e.rangeData.startRow;r.startRow-=t,r.endRow-=t}}}else for(let n=0;n<t.length;n++){const r=t[n];if(r.startColumn>e.rangeData.endColumn){if(r.endRow<e.rangeData.startRow)continue;if(r.startRow>e.rangeData.endRow)continue;if(!(r.startRow>=e.rangeData.startRow&&r.endRow<=e.rangeData.endRow))return;{const t=e.rangeData.endColumn-e.rangeData.startColumn;r.startColumn-=t,r.endColumn-=t}}}this.modifyMerge(this._rectangleList,t)}}}))}getMergeData(){return this._rectangleList}getByRowColumn(...e){const{_rectangleList:t}=this;let n;ro.checkup(e,ro.NUMBER_TYPE,ro.NUMBER_TYPE,ro.NUMBER_TYPE,ro.NUMBER_TYPE)?n=new to(e[0],e[2],e[1],e[3]):ro.checkup(e,ro.NUMBER_TYPE,ro.NUMBER_TYPE)&&(n=new to(e[0],e[1],e[0],e[1]));const r=[];for(let e=0;e<t.length;e++){const a=t[e];n.intersects(new to(a))&&r.push(a)}return r.length?r:null}remove(e){const{_rectangleList:t}=this,{length:n}=t,r=new to(e),a=[],i=[];for(let e=0;e<n;e++){const n=t[e];r.intersects(new to(n))?i.push(n):a.push(n)}return this._rectangleList=a,i}size(){return this._rectangleList.length}add(e){const t=this.remove(e);return this._rectangleList.push(e),t}union(e){const{_rectangleList:t}=this,{length:n}=t;let r=new to(e);for(let e=0;e<n;e++){const n=t[e];r=r.union(new to(n))}return r.getData()}getMergedRanges(e){const{_rectangleList:t}=this,{length:n}=t,r=[];for(let a=0;a<n;a++){const n=t[a];new to(e).intersects(new to(n))&&r.push(n)}return r}modifyMerge(e,t){const n=this._worksheet.getCommandManager(),r=this._worksheet.getContext(),a={actionName:Ya.REMOVE_MERGE_ACTION,sheetId:this._worksheet.getSheetId(),rectangles:e},i={actionName:Ya.ADD_MERGE_ACTION,sheetId:this._worksheet.getSheetId(),rectangles:t},o=new xs(r.getWorkBook(),a,i);n.invoke(o)}}var io=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},oo={exports:{}};!function(e,t){e.exports=function(){var e=1e3,t=6e4,n=36e5,r="millisecond",a="second",i="minute",o="hour",s="day",l="week",c="month",u="quarter",h="year",d="date",p="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,_=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},f=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},y={s:f,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),a=n%60;return(t<=0?"+":"-")+f(r,2,"0")+":"+f(a,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),a=t.clone().add(r,c),i=n-a<0,o=t.clone().add(r+(i?-1:1),c);return+(-(r+(n-a)/(i?a-o:o-a))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:h,w:l,d:s,D:d,h:o,m:i,s:a,ms:r,Q:u}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},v="en",b={};b[v]=g;var x=function(e){return e instanceof E},w=function e(t,n,r){var a;if(!t)return v;if("string"==typeof t){var i=t.toLowerCase();b[i]&&(a=i),n&&(b[i]=n,a=i);var o=t.split("-");if(!a&&o.length>1)return e(o[0])}else{var s=t.name;b[s]=t,a=s}return!r&&a&&(v=a),a||!r&&v},T=function(e,t){if(x(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new E(n)},C=y;C.l=w,C.i=x,C.w=function(e,t){return T(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var E=function(){function g(e){this.$L=w(e.locale,null,!0),this.parse(e)}var f=g.prototype;return f.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(C.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(m);if(r){var a=r[2]-1||0,i=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],a,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)):new Date(r[1],a,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},f.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},f.$utils=function(){return C},f.isValid=function(){return this.$d.toString()!==p},f.isSame=function(e,t){var n=T(e);return this.startOf(t)<=n&&n<=this.endOf(t)},f.isAfter=function(e,t){return T(e)<this.startOf(t)},f.isBefore=function(e,t){return this.endOf(t)<T(e)},f.$g=function(e,t,n){return C.u(e)?this[t]:this.set(n,e)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(e,t){var n=this,r=!!C.u(t)||t,u=C.p(e),p=function(e,t){var a=C.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return r?a:a.endOf(s)},m=function(e,t){return C.w(n.toDate()[e].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},_=this.$W,g=this.$M,f=this.$D,y="set"+(this.$u?"UTC":"");switch(u){case h:return r?p(1,0):p(31,11);case c:return r?p(1,g):p(0,g+1);case l:var v=this.$locale().weekStart||0,b=(_<v?_+7:_)-v;return p(r?f-b:f+(6-b),g);case s:case d:return m(y+"Hours",0);case o:return m(y+"Minutes",1);case i:return m(y+"Seconds",2);case a:return m(y+"Milliseconds",3);default:return this.clone()}},f.endOf=function(e){return this.startOf(e,!1)},f.$set=function(e,t){var n,l=C.p(e),u="set"+(this.$u?"UTC":""),p=(n={},n[s]=u+"Date",n[d]=u+"Date",n[c]=u+"Month",n[h]=u+"FullYear",n[o]=u+"Hours",n[i]=u+"Minutes",n[a]=u+"Seconds",n[r]=u+"Milliseconds",n)[l],m=l===s?this.$D+(t-this.$W):t;if(l===c||l===h){var _=this.clone().set(d,1);_.$d[p](m),_.init(),this.$d=_.set(d,Math.min(this.$D,_.daysInMonth())).$d}else p&&this.$d[p](m);return this.init(),this},f.set=function(e,t){return this.clone().$set(e,t)},f.get=function(e){return this[C.p(e)]()},f.add=function(r,u){var d,p=this;r=Number(r);var m=C.p(u),_=function(e){var t=T(p);return C.w(t.date(t.date()+Math.round(e*r)),p)};if(m===c)return this.set(c,this.$M+r);if(m===h)return this.set(h,this.$y+r);if(m===s)return _(1);if(m===l)return _(7);var g=(d={},d[i]=t,d[o]=n,d[a]=e,d)[m]||1,f=this.$d.getTime()+r*g;return C.w(f,this)},f.subtract=function(e,t){return this.add(-1*e,t)},f.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||p;var r=e||"YYYY-MM-DDTHH:mm:ssZ",a=C.z(this),i=this.$H,o=this.$m,s=this.$M,l=n.weekdays,c=n.months,u=function(e,n,a,i){return e&&(e[n]||e(t,r))||a[n].slice(0,i)},h=function(e){return C.s(i%12||12,e,"0")},d=n.meridiem||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r},m={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:C.s(s+1,2,"0"),MMM:u(n.monthsShort,s,c,3),MMMM:u(c,s),D:this.$D,DD:C.s(this.$D,2,"0"),d:String(this.$W),dd:u(n.weekdaysMin,this.$W,l,2),ddd:u(n.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(i),HH:C.s(i,2,"0"),h:h(1),hh:h(2),a:d(i,o,!0),A:d(i,o,!1),m:String(o),mm:C.s(o,2,"0"),s:String(this.$s),ss:C.s(this.$s,2,"0"),SSS:C.s(this.$ms,3,"0"),Z:a};return r.replace(_,(function(e,t){return t||m[e]||a.replace(":","")}))},f.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},f.diff=function(r,d,p){var m,_=C.p(d),g=T(r),f=(g.utcOffset()-this.utcOffset())*t,y=this-g,v=C.m(this,g);return v=(m={},m[h]=v/12,m[c]=v,m[u]=v/3,m[l]=(y-f)/6048e5,m[s]=(y-f)/864e5,m[o]=y/n,m[i]=y/t,m[a]=y/e,m)[_]||y,p?v:C.a(v)},f.daysInMonth=function(){return this.endOf(c).$D},f.$locale=function(){return b[this.$L]},f.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=w(e,t,!0);return r&&(n.$L=r),n},f.clone=function(){return C.w(this.$d,this)},f.toDate=function(){return new Date(this.valueOf())},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},g}(),A=E.prototype;return T.prototype=A,[["$ms",r],["$s",a],["$m",i],["$H",o],["$W",s],["$M",c],["$y",h],["$D",d]].forEach((function(e){A[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),T.extend=function(e,t){return e.$i||(e(t,E,T),e.$i=!0),T},T.locale=w,T.isDayjs=x,T.unix=function(e){return T(1e3*e)},T.en=b[v],T.Ls=b,T.p={},T}()}(oo);const so=oo.exports;var lo={exports:{}};!function(e){!function(t,n){e.exports?e.exports=n():t.numeral=n()}(io,(function(){var e,t,n={},r={},a={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},i={currentLocale:a.currentLocale,zeroFormat:a.zeroFormat,nullFormat:a.nullFormat,defaultFormat:a.defaultFormat,scalePercentBy100:a.scalePercentBy100};function o(e,t){this._input=e,this._value=t}return e=function(r){var a,s,l,c;if(e.isNumeral(r))a=r.value();else if(0===r||typeof r>"u")a=0;else if(null===r||t.isNaN(r))a=null;else if("string"==typeof r)if(i.zeroFormat&&r===i.zeroFormat)a=0;else if(i.nullFormat&&r===i.nullFormat||!r.replace(/[^0-9]+/g,"").length)a=null;else{for(s in n)if((c="function"==typeof n[s].regexps.unformat?n[s].regexps.unformat():n[s].regexps.unformat)&&r.match(c)){l=n[s].unformat;break}a=(l=l||e._.stringToNumber)(r)}else a=Number(r)||null;return new o(r,a)},e.version="2.0.6",e.isNumeral=function(e){return e instanceof o},e._=t={numberToFormat:function(t,n,a){var i,o,s,l,c,u,h,d,p=r[e.options.currentLocale],m=!1,_=!1,g="",f=1e12,y=1e9,v=1e6,b="",x=!1;if(t=t||0,s=Math.abs(t),e._.includes(n,"(")?(m=!0,n=n.replace(/[\(|\)]/g,"")):(e._.includes(n,"+")||e._.includes(n,"-"))&&(u=e._.includes(n,"+")?n.indexOf("+"):t<0?n.indexOf("-"):-1,n=n.replace(/[\+|\-]/g,"")),e._.includes(n,"a")&&(o=!!(o=n.match(/a(k|m|b|t)?/))&&o[1],e._.includes(n," a")&&(g=" "),n=n.replace(new RegExp(g+"a[kmbt]?"),""),s>=f&&!o||"t"===o?(g+=p.abbreviations.trillion,t/=f):s<f&&s>=y&&!o||"b"===o?(g+=p.abbreviations.billion,t/=y):s<y&&s>=v&&!o||"m"===o?(g+=p.abbreviations.million,t/=v):(s<v&&s>=1e3&&!o||"k"===o)&&(g+=p.abbreviations.thousand,t/=1e3)),e._.includes(n,"[.]")&&(_=!0,n=n.replace("[.]",".")),l=t.toString().split(".")[0],c=n.split(".")[1],h=n.indexOf(","),i=(n.split(".")[0].split(",")[0].match(/0/g)||[]).length,c?(e._.includes(c,"[")?(c=(c=c.replace("]","")).split("["),b=e._.toFixed(t,c[0].length+c[1].length,a,c[1].length)):b=e._.toFixed(t,c.length,a),l=b.split(".")[0],b=e._.includes(b,".")?p.delimiters.decimal+b.split(".")[1]:"",_&&0===Number(b.slice(1))&&(b="")):l=e._.toFixed(t,0,a),g&&!o&&Number(l)>=1e3&&g!==p.abbreviations.trillion)switch(l=String(Number(l)/1e3),g){case p.abbreviations.thousand:g=p.abbreviations.million;break;case p.abbreviations.million:g=p.abbreviations.billion;break;case p.abbreviations.billion:g=p.abbreviations.trillion}if(e._.includes(l,"-")&&(l=l.slice(1),x=!0),l.length<i)for(var w=i-l.length;w>0;w--)l="0"+l;return h>-1&&(l=l.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+p.delimiters.thousands)),0===n.indexOf(".")&&(l=""),d=l+b+(g||""),m?d=(m&&x?"(":"")+d+(m&&x?")":""):u>=0?d=0===u?(x?"-":"+")+d:d+(x?"-":"+"):x&&(d="-"+d),d},stringToNumber:function(e){var t,n,a,o=r[i.currentLocale],s=e,l={thousand:3,million:6,billion:9,trillion:12};if(i.zeroFormat&&e===i.zeroFormat)n=0;else if(i.nullFormat&&e===i.nullFormat||!e.replace(/[^0-9]+/g,"").length)n=null;else{for(t in n=1,"."!==o.delimiters.decimal&&(e=e.replace(/\./g,"").replace(o.delimiters.decimal,".")),l)if(a=new RegExp("[^a-zA-Z]"+o.abbreviations[t]+"(?:\\)|(\\"+o.currency.symbol+")?(?:\\))?)?$"),s.match(a)){n*=Math.pow(10,l[t]);break}n*=(e.split("-").length+Math.min(e.split("(").length-1,e.split(")").length-1))%2?1:-1,e=e.replace(/[^0-9\.]+/g,""),n*=Number(e)}return n},isNaN:function(e){return"number"==typeof e&&isNaN(e)},includes:function(e,t){return-1!==e.indexOf(t)},insert:function(e,t,n){return e.slice(0,n)+t+e.slice(n)},reduce:function(e,t){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var n,r=Object(e),a=r.length>>>0,i=0;if(3===arguments.length)n=arguments[2];else{for(;i<a&&!(i in r);)i++;if(i>=a)throw new TypeError("Reduce of empty array with no initial value");n=r[i++]}for(;i<a;i++)i in r&&(n=t(n,r[i],i,r));return n},multiplier:function(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)},correctionFactor:function(){var e=Array.prototype.slice.call(arguments);return e.reduce((function(e,n){var r=t.multiplier(n);return e>r?e:r}),1)},toFixed:function(e,t,n,r){var a,i,o,s,l=e.toString().split("."),c=t-(r||0);return a=2===l.length?Math.min(Math.max(l[1].length,c),t):c,o=Math.pow(10,a),s=(n(e+"e+"+a)/o).toFixed(a),r>t-a&&(i=new RegExp("\\.?0{1,"+(r-(t-a))+"}$"),s=s.replace(i,"")),s}},e.options=i,e.formats=n,e.locales=r,e.locale=function(e){return e&&(i.currentLocale=e.toLowerCase()),i.currentLocale},e.localeData=function(e){if(!e)return r[i.currentLocale];if(e=e.toLowerCase(),!r[e])throw new Error("Unknown locale : "+e);return r[e]},e.reset=function(){for(var e in a)i[e]=a[e]},e.zeroFormat=function(e){i.zeroFormat="string"==typeof e?e:null},e.nullFormat=function(e){i.nullFormat="string"==typeof e?e:null},e.defaultFormat=function(e){i.defaultFormat="string"==typeof e?e:"0.0"},e.register=function(e,t,n){if(t=t.toLowerCase(),this[e+"s"][t])throw new TypeError(t+" "+e+" already registered.");return this[e+"s"][t]=n,n},e.validate=function(t,n){var r,a,i,o,s,l,c,u;if("string"!=typeof t&&(t+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",t)),(t=t.trim()).match(/^\d+$/))return!0;if(""===t)return!1;try{c=e.localeData(n)}catch{c=e.localeData(e.locale())}return i=c.currency.symbol,s=c.abbreviations,r=c.delimiters.decimal,a="."===c.delimiters.thousands?"\\.":c.delimiters.thousands,(null===(u=t.match(/^[^\d]+/))||(t=t.substr(1),u[0]===i))&&(null===(u=t.match(/[^\d]+$/))||(t=t.slice(0,-1),u[0]===s.thousand||u[0]===s.million||u[0]===s.billion||u[0]===s.trillion))&&(l=new RegExp(a+"{2}"),!t.match(/[^\d.,]/g)&&(!((o=t.split(r)).length>2)&&(o.length<2?!!o[0].match(/^\d+.*\d$/)&&!o[0].match(l):1===o[0].length?!!o[0].match(/^\d+$/)&&!o[0].match(l)&&!!o[1].match(/^\d+$/):!!o[0].match(/^\d+.*\d$/)&&!o[0].match(l)&&!!o[1].match(/^\d+$/))))},e.fn=o.prototype={clone:function(){return e(this)},format:function(t,r){var a,o,s,l=this._value,c=t||i.defaultFormat;if(r=r||Math.round,0===l&&null!==i.zeroFormat)o=i.zeroFormat;else if(null===l&&null!==i.nullFormat)o=i.nullFormat;else{for(a in n)if(c.match(n[a].regexps.format)){s=n[a].format;break}o=(s=s||e._.numberToFormat)(l,c,r)}return o},value:function(){return this._value},input:function(){return this._input},set:function(e){return this._value=Number(e),this},add:function(e){var n=t.correctionFactor.call(null,this._value,e);return this._value=t.reduce([this._value,e],(function(e,t,r,a){return e+Math.round(n*t)}),0)/n,this},subtract:function(e){var n=t.correctionFactor.call(null,this._value,e);return this._value=t.reduce([e],(function(e,t,r,a){return e-Math.round(n*t)}),Math.round(this._value*n))/n,this},multiply:function(e){return this._value=t.reduce([this._value,e],(function(e,n,r,a){var i=t.correctionFactor(e,n);return Math.round(e*i)*Math.round(n*i)/Math.round(i*i)}),1),this},divide:function(e){return this._value=t.reduce([this._value,e],(function(e,n,r,a){var i=t.correctionFactor(e,n);return Math.round(e*i)/Math.round(n*i)})),this},difference:function(t){return Math.abs(e(this._value).subtract(t).value())}},e.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),e.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(t,n,r){var a,i=e._.includes(n," BPS")?" ":"";return t*=1e4,n=n.replace(/\s?BPS/,""),a=e._.numberToFormat(t,n,r),e._.includes(a,")")?((a=a.split("")).splice(-1,0,i+"BPS"),a=a.join("")):a=a+i+"BPS",a},unformat:function(t){return+(1e-4*e._.stringToNumber(t)).toFixed(15)}}),function(){var t={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},n={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},r=t.suffixes.concat(n.suffixes.filter((function(e){return t.suffixes.indexOf(e)<0}))),a=r.join("|");a="("+a.replace("B","B(?!PS)")+")",e.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(a)},format:function(r,a,i){var o,s,l,c=e._.includes(a,"ib")?n:t,u=e._.includes(a," b")||e._.includes(a," ib")?" ":"";for(a=a.replace(/\s?i?b/,""),o=0;o<=c.suffixes.length;o++)if(s=Math.pow(c.base,o),l=Math.pow(c.base,o+1),null===r||0===r||r>=s&&r<l){u+=c.suffixes[o],s>0&&(r/=s);break}return e._.numberToFormat(r,a,i)+u},unformat:function(r){var a,i,o=e._.stringToNumber(r);if(o){for(a=t.suffixes.length-1;a>=0;a--){if(e._.includes(r,t.suffixes[a])){i=Math.pow(t.base,a);break}if(e._.includes(r,n.suffixes[a])){i=Math.pow(n.base,a);break}}o*=i||1}return o}})}(),e.register("format","currency",{regexps:{format:/(\$)/},format:function(t,n,r){var a,i,o,s=e.locales[e.options.currentLocale],l={before:n.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:n.match(/([\+|\-|\)|\s|\$]*)$/)[0]};for(n=n.replace(/\s?\$\s?/,""),a=e._.numberToFormat(t,n,r),t>=0?(l.before=l.before.replace(/[\-\(]/,""),l.after=l.after.replace(/[\-\)]/,"")):t<0&&!e._.includes(l.before,"-")&&!e._.includes(l.before,"(")&&(l.before="-"+l.before),o=0;o<l.before.length;o++)switch(i=l.before[o],i){case"$":a=e._.insert(a,s.currency.symbol,o);break;case" ":a=e._.insert(a," ",o+s.currency.symbol.length-1)}for(o=l.after.length-1;o>=0;o--)switch(i=l.after[o],i){case"$":a=o===l.after.length-1?a+s.currency.symbol:e._.insert(a,s.currency.symbol,-(l.after.length-(1+o)));break;case" ":a=o===l.after.length-1?a+" ":e._.insert(a," ",-(l.after.length-(1+o)+s.currency.symbol.length-1))}return a}}),e.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(t,n,r){var a=("number"!=typeof t||e._.isNaN(t)?"0e+0":t.toExponential()).split("e");return n=n.replace(/e[\+|\-]{1}0/,""),e._.numberToFormat(Number(a[0]),n,r)+"e"+a[1]},unformat:function(t){var n=e._.includes(t,"e+")?t.split("e+"):t.split("e-"),r=Number(n[0]),a=Number(n[1]);return a=e._.includes(t,"e-")?a*=-1:a,e._.reduce([r,Math.pow(10,a)],(function(t,n,r,a){var i=e._.correctionFactor(t,n);return t*i*(n*i)/(i*i)}),1)}}),e.register("format","ordinal",{regexps:{format:/(o)/},format:function(t,n,r){var a=e.locales[e.options.currentLocale],i=e._.includes(n," o")?" ":"";return n=n.replace(/\s?o/,""),i+=a.ordinal(t),e._.numberToFormat(t,n,r)+i}}),e.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(t,n,r){var a,i=e._.includes(n," %")?" ":"";return e.options.scalePercentBy100&&(t*=100),n=n.replace(/\s?\%/,""),a=e._.numberToFormat(t,n,r),e._.includes(a,")")?((a=a.split("")).splice(-1,0,i+"%"),a=a.join("")):a=a+i+"%",a},unformat:function(t){var n=e._.stringToNumber(t);return e.options.scalePercentBy100?.01*n:n}}),e.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(e,t,n){var r=Math.floor(e/60/60),a=Math.floor((e-60*r*60)/60),i=Math.round(e-60*r*60-60*a);return r+":"+(a<10?"0"+a:a)+":"+(i<10?"0"+i:i)},unformat:function(e){var t=e.split(":"),n=0;return 3===t.length?(n+=60*Number(t[0])*60,n+=60*Number(t[1]),n+=Number(t[2])):2===t.length&&(n+=60*Number(t[0]),n+=Number(t[1])),Number(n)}}),e}))}(lo);const co=lo.exports,uo={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"};function ho(e){return null!==e&&""!==e.toString().replace(/\s/g,"")&&"boolean"!=typeof e&&!Number.isNaN(e)}let po=new Date("2017-02-19T19:06:09.000Z");Number.isNaN(po.getFullYear())&&(po=new Date("2/19/17"));const mo=2017===po.getFullYear();const _o=new Date(1900,2,1,0,0,0);function go(e){let t=null,n={},r=e;if(null===e)return null;if(/^-?[0-9]{1,}[,][0-9]{3}(.[0-9]{1,2})?$/.test(e)){t=e,r=Number(e.split(".")[0].replace(",",""));let a="#,##0";if(e.split(".")[1]){a="#,##0.";for(let t=0;t<e.split(".")[1].length;t++)a+=0}n={fa:a,t:"n"}}else if("'"===e.toString().substr(0,1))t=e.toString().substr(1),n={fa:"@",t:"s"};else if("TRUE"===e.toString().toUpperCase())t="TRUE",n={fa:"General",t:"b"},r=!0;else if("FALSE"===e.toString().toUpperCase())t="FALSE",n={fa:"General",t:"b"},r=!1;else if(function(e){let t=!1;for(const n in uo)if(e===uo[n]){t=!0;break}return t}(e))t=e.toString(),n={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(e))t=e.toString(),n={fa:"@",t:"s"};else if(ho(e)&&Math.abs(parseFloat(e))>0&&(Math.abs(parseFloat(e))>=1e11||Math.abs(parseFloat(e))<1e-9)){r=co(e).value();const a=r.toExponential();if(a.indexOf(".")>-1){let e=a.split(".")[1].split("e")[0].length;e>5&&(e=5),n={fa:`#0.${new Array(e+1).join("0")}E+00`,t:"n"}}else n={fa:"#0.E+00",t:"n"};t=fo.format(n.fa,r)}else if(e.toString().indexOf("%")>-1){const a=e.toString().indexOf("%");let i=e.toString().substr(0,a);const o=i.replace(/,/g,"");if(a===e.toString().length-1&&ho(o))if(i.indexOf(".")>-1)if(i.indexOf(".")===i.lastIndexOf(".")){const a=i.split(".")[0];let o=i.split(".")[1].length;if(o>9&&(o=9),a.indexOf(",")>-1){let i=!0,s=a.split(",");for(let e=1;e<s.length;e++)if(s[e].length<3){i=!1;break}i?(n={fa:`#,##0.${new Array(o+1).join("0")}%`,t:"n"},r=co(e).value(),t=fo.format(n.fa,r)):(t=e.toString(),n={fa:"@",t:"s"})}else n={fa:`0.${new Array(o+1).join("0")}%`,t:"n"},r=co(e).value(),t=fo.format(n.fa,r)}else t=e.toString(),n={fa:"@",t:"s"};else if(i.indexOf(",")>-1){let a=!0,o=i.split(",");for(let e=1;e<o.length;e++)if(o[e].length<3){a=!1;break}a?(n={fa:"#,##0%",t:"n"},r=co(e).value(),t=fo.format(n.fa,r)):(t=e.toString(),n={fa:"@",t:"s"})}else n={fa:"0%",t:"n"},r=co(e).value(),t=fo.format(n.fa,r);else t=e.toString(),n={fa:"@",t:"s"}}else if(e.toString().indexOf(".")>-1)if(e.toString().indexOf(".")===e.toString().lastIndexOf(".")){const a=e.toString().split(".")[0];let i=e.toString().split(".")[1],o=i.length;if(o>9&&(o=9),a.indexOf(",")>-1){let i=!0,s=a.split(",");for(let e=1;e<s.length;e++)if(!ho(s[e])||s[e].length<3){i=!1;break}i?(n={fa:`#,##0.${new Array(o+1).join("0")}`,t:"n"},r=co(e).value(),t=fo.format(n.fa,r)):(t=e.toString(),n={fa:"@",t:"s"})}else ho(a)&&ho(i)?(n={fa:`0.${new Array(o+1).join("0")}`,t:"n"},r=co(e).value(),t=fo.format(n.fa,r)):(t=e.toString(),n={fa:"@",t:"s"})}else t=e.toString(),n={fa:"@",t:"s"};else ho(e)?(t=e.toString(),n={fa:"General",t:"n"},r=parseFloat(e)):function(e){return!(null===e||e.toString().length<5||!function(e){if(!/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(e)&&!/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(e))return!1;const t=RegExp.$1,n=RegExp.$2,r=RegExp.$3;return!(t<1900||n>12||r>31||2===n&&(29===new Date(t,1,29).getDate()&&r>29||29!==new Date(t,1,29).getDate()&&r>28))}(e))}(e)&&(e.toString().indexOf(".")>-1||e.toString().indexOf(":")>-1||e.toString().length<16)?(r=function(e,t){let n=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());const r=Date.UTC(1899,11,31,0,0,0);return t?n-=1262304e5:e>=_o&&(n+=864e5),(n-r)/864e5}(function(e,t){const n=new Date(e);if(mo)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917===po.getFullYear()&&!Number.isNaN(n.getFullYear())){const t=n.getFullYear();return e.indexOf(`${t}`)>-1||n.setFullYear(n.getFullYear()+100),n}const r=e.match(/\d+/g)||["2017","2","19","0","0","0"];let a=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-60*a.getTimezoneOffset()*1e3)),a}(e.toString().replace(/-/g,"/"))),r.toString().indexOf(".")>-1?e.toString().length>18?n.fa="yyyy-MM-dd hh:mm:ss":e.toString().length>11?n.fa="yyyy-MM-dd hh:mm":n.fa="yyyy-MM-dd":n.fa="yyyy-MM-dd",n.t="d",t=fo.format(n.fa,r)):(t=e,n.fa="General",n.t="g");return[t,n,r]}const fo={format(e,t){}};class yo{static getApplyData(e,t,n,r,a){const i=this,o=[];i.applyType=r,i.direction=a;const s=Math.floor(n/t),l=n%t,c=e.number,u=[];if(c)for(let e=0;e<c.length;e++){const o=i.getLenS(c[e].index,l),h=c[e].index.length*s+o;let d;d=1===r?i.getDataByType(c[e].data,h,a,r,"number"):"2"===r?i.getDataByType(c[e].data,h,a,r):i.getDataByType(c[e].data,h,a,"0");const p=i.getDataIndex(t,n,c[e].index);u.push({data:d,index:p})}const h=e.extendNumber,d=[];if(h)for(let e=0;e<h.length;e++){const o=i.getLenS(h[e].index,l),c=h[e].index.length*s+o;let u;u="1"===r||"3"===r?i.getDataByType(h[e].data,c,a,r,"extendNumber"):"2"===r?i.getDataByType(h[e].data,c,a,r):i.getDataByType(h[e].data,c,a,"0");const p=i.getDataIndex(t,n,h[e].index);d.push({data:u,index:p})}const p=e.date,m=[];if(p)for(let e=0;e<p.length;e++){const o=i.getLenS(p[e].index,l),c=p[e].index.length*s+o;let u;u="1"===r||"3"===r?i.getDataByType(p[e].data,c,a,r,"date"):"8"===r?i.getDataByType(p[e].data,c,a,"0"):i.getDataByType(p[e].data,c,a,r);const h=i.getDataIndex(t,n,p[e].index);m.push({data:u,index:h})}const _=e.chnNumber,g=[];if(_)for(let e=0;e<_.length;e++){const o=i.getLenS(_[e].index,l),c=_[e].index.length*s+o;let u;u="1"===r||"3"===r?i.getDataByType(_[e].data,c,a,r,"chnNumber"):"2"===r||"8"===r?i.getDataByType(_[e].data,c,a,r):i.getDataByType(_[e].data,c,a,"0");const h=i.getDataIndex(t,n,_[e].index);g.push({data:u,index:h})}const f=e.chnWeek2,y=[];if(f)for(let e=0;e<f.length;e++){const o=i.getLenS(f[e].index,l),c=f[e].index.length*s+o;let u;u="1"===r||"3"===r?i.getDataByType(f[e].data,c,a,r,"chnWeek2"):"2"===r?i.getDataByType(f[e].data,c,a,r):i.getDataByType(f[e].data,c,a,"0");const h=i.getDataIndex(t,n,f[e].index);y.push({data:u,index:h})}const v=e.chnWeek3,b=[];if(v)for(let e=0;e<v.length;e++){const o=i.getLenS(v[e].index,l),c=v[e].index.length*s+o;let u;u="1"===r||"3"===r?i.getDataByType(v[e].data,c,a,r,"chnWeek3"):"2"===r?i.getDataByType(v[e].data,c,a,r):i.getDataByType(v[e].data,c,a,"0");const h=i.getDataIndex(t,n,v[e].index);b.push({data:u,index:h})}const x=e.other,w=[];if(x)for(let e=0;e<x.length;e++){const o=i.getLenS(x[e].index,l),c=x[e].index.length*s+o;let u;u="2"===r||"3"===r?i.getDataByType(x[e].data,c,a,r):i.getDataByType(x[e].data,c,a,"0");const h=i.getDataIndex(t,n,x[e].index);w.push({data:u,index:h})}for(let e=1;e<=n;e++){if(u.length>0)for(let t=0;t<u.length;t++)e in u[t].index&&o.push(u[t].data[u[t].index[e]]);if(d.length>0)for(let t=0;t<d.length;t++)e in d[t].index&&o.push(d[t].data[d[t].index[e]]);if(m.length>0)for(let t=0;t<m.length;t++)e in m[t].index&&o.push(m[t].data[m[t].index[e]]);if(g.length>0)for(let t=0;t<g.length;t++)e in g[t].index&&o.push(g[t].data[g[t].index[e]]);if(y.length>0)for(let t=0;t<y.length;t++)e in y[t].index&&o.push(y[t].data[y[t].index[e]]);if(b.length>0)for(let t=0;t<b.length;t++)e in b[t].index&&o.push(b[t].data[b[t].index[e]]);if(w.length>0)for(let t=0;t<w.length;t++)e in w[t].index&&o.push(w[t].data[w[t].index[e]])}return o}static getCopyData(e,t,n,r,a,i){const o=this,s=[];let l=0,c=0,u=0,h=0;i===wa.BOTTOM||i===wa.TOP?(l=r,c=a,u=t,h=n):(i===wa.RIGHT||i===wa.LEFT)&&(l=t,c=n,u=r,h=a);for(let t=l;t<=c;t++){const t={};let n=[],r=[],a="",i=null,l=null,c=!0;for(let s=u,d=0;s<=h;s++,d++){const p=e[d];let m;if(p&&p.v&&!p.f)if(p.fm&&p.fm.t===Ta.NUMBER)m="number",i=null,l=null;else if(p.fm&&p.fm.t===Ta.DATE)m="date",i=null,l=null;else if(o.isExtendNumber(p.m)[0]){m="extendNumber";const e=o.isExtendNumber(p.m);null===i||null===l?(c=!0,i=e[2],l=e[3]):e[2]!==i||e[3]!==l?(c=!1,i=e[2],l=e[3]):c=!0}else o.isChnNumber(p.m)?(m="chnNumber",i=null,l=null):o.isChnWeek2(p.m)?(m="chnWeek2",i=null,l=null):o.isChnWeek3(p.m)?(m="chnWeek3",i=null,l=null):(m="other",i=null,l=null);else m="other",i=null,l=null;"extendNumber"===m?s===u?u===h?(a=m,n.push(p),r.push(s-u+1),t[a]=[],t[a].push({data:n,index:r})):(a=m,n.push(p),r.push(s-u+1)):s===h?a===m&&c?(n.push(p),r.push(s-u+1),a in t||(t[a]=[]),t[a].push({data:n,index:r})):(a in t||(t[a]=[]),t[a].push({data:n,index:r}),a=m,n=[],n.push(p),r=[],r.push(s-u+1),a in t||(t[a]=[]),t[a].push({data:n,index:r})):a===m&&c?(n.push(p),r.push(s-u+1)):(a in t||(t[a]=[]),t[a].push({data:n,index:r}),a=m,n=[],n.push(p),r=[],r.push(s-u+1)):s===u?u===h?(a=m,n.push(p),r.push(s-u+1),t[a]=[],t[a].push({data:n,index:r})):(a=m,n.push(p),r.push(s-u+1)):s===h?a===m?(n.push(p),r.push(s-u+1),a in t||(t[a]=[]),t[a].push({data:n,index:r})):(a in t||(t[a]=[]),t[a].push({data:n,index:r}),a=m,n=[],n.push(p),r=[],r.push(s-u+1),a in t||(t[a]=[]),t[a].push({data:n,index:r})):a===m?(n.push(p),r.push(s-u+1)):(a in t||(t[a]=[]),t[a].push({data:n,index:r}),a=m,n=[],n.push(p),r=[],r.push(s-u+1))}s.push(t)}return s}static ChineseToNumber(e){const t=this;let n=0,r=0,a=0,i=!1;const o=e.split("");for(let e=0;e<o.length;e++){const s=t.chnNumChar[o[e]];if(typeof s<"u")a=s,e===o.length-1&&(r+=a);else{const s=t.chnNameValue[o[e]].value;i=t.chnNameValue[o[e]].secUnit,i?(r=(r+a)*s,n+=r,r=0):r+=a*s,a=0}}return n+r}static NumberToChinese(e){const t=this;let n=0,r="",a="",i=!1;if(0===e)return t.chnNumChar2[0];for(;e>0;){const o=e%1e4;i&&(a=t.chnNumChar2[0]+a),r=t.SectionToChinese(o),r+=0!==o?t.chnUnitSection[n]:t.chnUnitSection[0],a=r+a,i=o<1e3&&o>0,e=Math.floor(e/1e4),n++}return a}static SectionToChinese(e){const t=this;let n="",r="",a=0,i=!0;for(;e>0;){const o=e%10;0===o?i||(i=!0,r=t.chnNumChar2[o]+r):(i=!1,n=t.chnNumChar2[o],n+=t.chnUnitChar[a],r=n+r),a++,e=Math.floor(e/10)}return r}static getLenS(e,t){let n=0;for(let r=0;r<e.length&&e[r]<=t;r++)n++;return n}static getDataByType(e,t,n,r,a){const i=this;let o=[];if(r===ga.ALTERNATE_SERIES)(n===wa.TOP||n===wa.LEFT)&&e.reverse(),o=i.FillCopy(e,t);else if(r===ga.DEFAULT_SERIES)if("number"===a)o=i.FillSeries(e,t,n);else if("extendNumber"===a)if(1===e.length){let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1),o=i.FillExtendNumber(e,t,r)}else{const r=[];for(let t=0;t<e.length;t++){const n=e[t].m;r.push(Number(i.isExtendNumber(n)[1]))}if((n===wa.TOP||n===wa.LEFT)&&(e.reverse(),r.reverse()),i.isEqualDiff(r)){const n=r[1]-r[0];o=i.FillExtendNumber(e,t,n)}else o=i.FillCopy(e,t)}else if("date"===a)if(1===e.length){let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1),o=i.FillDays(e,t,r)}else{(n===wa.TOP||n===wa.LEFT)&&e.reverse();const r=i.judgeDate(e);if(r[0]&&r[3]){const n=so(e[1].m).diff(so(e[0].m),"months");o=i.FillMonths(e,t,n)}else if(!r[0]&&r[2]){const n=so(e[1].m).diff(so(e[0].m),"days");o=i.FillDays(e,t,n)}else o=i.FillCopy(e,t)}else if("chnNumber"===a)if(1===e.length)if("日"===e[0].m||i.ChineseToNumber(e[0].m)<7){let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1),o=i.FillChnWeek(e,t,r)}else{let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1),o=i.FillChnNumber(e,t,r)}else{let r=!1;for(let t=0;t<e.length;t++)if("日"===e[t].m){r=!0;break}const a=[];let s=0;for(let t=0;t<e.length;t++)"日"===e[t].m?0===t?a.push(0):(s++,a.push(7*s)):r&&i.ChineseToNumber(e[t].m)>0&&i.ChineseToNumber(e[t].m)<7?a.push(i.ChineseToNumber(e[t].m)+7*s):a.push(i.ChineseToNumber(e[t].m));if((n===wa.TOP||n===wa.LEFT)&&(e.reverse(),a.reverse()),i.isEqualDiff(a))if(r||a[a.length-1]<6&&a[0]>0||a[0]<6&&a[a.length-1]>0){const n=a[1]-a[0];o=i.FillChnWeek(e,t,n)}else{const n=a[1]-a[0];o=i.FillChnNumber(e,t,n)}else o=i.FillCopy(e,t)}else if("chnWeek2"===a)if(1===e.length){let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1),o=i.FillChnWeek2(e,t,r)}else{const r=[];let a=0;for(let t=0;t<e.length;t++){const n=e[t].m.substr(e[t].m.length-1,1);"周日"===e[t].m?0===t?r.push(0):(a++,r.push(7*a)):r.push(i.ChineseToNumber(n)+7*a)}if((n===wa.TOP||n===wa.LEFT)&&(e.reverse(),r.reverse()),i.isEqualDiff(r)){const n=r[1]-r[0];o=i.FillChnWeek2(e,t,n)}else o=i.FillCopy(e,t)}else if("chnWeek3"===a)if(1===e.length){let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1),o=i.FillChnWeek3(e,t,r)}else{const r=[];let a=0;for(let t=0;t<e.length;t++){const n=e[t].m.substr(e[t].m.length-1,1);"星期日"===e[t].m?0===t?r.push(0):(a++,r.push(7*a)):r.push(i.ChineseToNumber(n)+7*a)}if((n===wa.TOP||n===wa.LEFT)&&(e.reverse(),r.reverse()),i.isEqualDiff(r)){const n=r[1]-r[0];o=i.FillChnWeek3(e,t,n)}else o=i.FillCopy(e,t)}else(n===wa.TOP||n===wa.LEFT)&&e.reverse(),o=i.FillCopy(e,t);else if("2"===r)(n===wa.TOP||n===wa.LEFT)&&e.reverse(),o=i.FillOnlyFormat(e,t);else if("3"===r){const r=i.getDataByType(e,t,n,"1",a);o=i.FillWithoutFormat(r)}else if("4"===r)if(1===e.length){let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1),o=i.FillDays(e,t,r)}else if(2===e.length){(n===wa.TOP||n===wa.LEFT)&&e.reverse();const r=so(e[1].m).diff(so(e[0].m),"days");o=i.FillDays(e,t,r)}else{(n===wa.TOP||n===wa.LEFT)&&e.reverse();const r=i.judgeDate(e);if(r[0]&&r[3]){const n=so(e[1].m).diff(so(e[0].m),"months");o=i.FillMonths(e,t,n)}else if(!r[0]&&r[2]){const n=so(e[1].m).diff(so(e[0].m),"days");o=i.FillDays(e,t,n)}else o=i.FillCopy(e,t)}else if("5"===r)if(1===e.length){let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1);const a=Math.round(1.5*t);for(let n=1;n<=a;n++){const a={...e[n]},i=so(a.m).add(n,"days").day();if(0===i||6===i)continue;const s=so(a.m).add(r*n,"days").format("YYYY-MM-DD");if(a.m=s,a.v=go(s)[2],o.push(a),o.length===t)break}}else if(2===e.length)if(so(e[1].m).date()===so(e[0].m).date()&&0!==so(e[1].m).diff(so(e[0].m),"months")){(n===wa.TOP||n===wa.LEFT)&&e.reverse();const r=so(e[1].m).diff(so(e[0].m),"months");for(let n=1;n<=t;n++){const t={...e[(n-1)%e.length]},a=so(e[e.length-1]).add(r*n,"months").day();let i;i=0===a?so(e[e.length-1]).add(r*n,"months").subtract(2,"days").format("YYYY-MM-DD"):6===a?so(e[e.length-1]).add(r*n,"months").subtract(1,"days").format("YYYY-MM-DD"):so(e[e.length-1]).add(r*n,"months").format("YYYY-MM-DD"),t.m=i,t.v=go(i)[2],o.push(t)}}else if(Math.abs(so(e[1].m).diff(so(e[0].m)))>7){let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1,e.reverse());let a=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,i={...e[t]},s=Math.ceil(n/e.length);0===t&&(a=so(i.m).add(r*s,"months").diff(so(i.m),"days"));const l=so(i.m).add(a,"days").day();let c;c=0===l?so(i.m).add(a,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?so(i.m).add(a,"days").subtract(1,"days").format("YYYY-MM-DD"):so(i.m).add(a,"days").format("YYYY-MM-DD"),i.m=c,i.v=go(c)[2],o.push(i)}}else{let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=7:(n===wa.TOP||n===wa.LEFT)&&(r=-7,e.reverse());let a=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,i={...e[t]},s=Math.ceil(n/e.length);0===t&&(a=so(i.m).add(r*s,"days").diff(so(i.m),"days"));const l=so(i.m).add(a,"days").day();let c;c=0===l?so(i.m).add(a,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?so(i.m).add(a,"days").subtract(1,"days").format("YYYY-MM-DD"):so(i.m).add(a,"days").format("YYYY-MM-DD"),i.m=c,i.v=go(c)[2],o.push(i)}}else{const r=i.judgeDate(e);if(r[0]&&r[3]){(n===wa.TOP||n===wa.LEFT)&&e.reverse();const r=so(e[1].m).diff(so(e[0].m),"months");for(let n=1;n<=t;n++){const t={...e[(n-1)%e.length]},a=so(e[e.length-1].m).add(r*n,"months").day();let i;i=0===a?so(e[e.length-1].m).add(r*n,"months").subtract(2,"days").format("YYYY-MM-DD"):6===a?so(e[e.length-1].m).add(r*n,"months").subtract(1,"days").format("YYYY-MM-DD"):so(e[e.length-1].m).add(r*n,"months").format("YYYY-MM-DD"),t.m=i,t.v=go(i)[2],o.push(t)}}else if(!r[0]&&r[2])if(Math.abs(so(e[1].m).diff(so(e[0].m)))>7){let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1,e.reverse());let a=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,i={...e[t]},s=Math.ceil(n/e.length);0===t&&(a=so(i.m).add(r*s,"months").diff(so(i.m),"days"));const l=so(i.m).add(a,"days").day();let c;c=0===l?so(i.m).add(a,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?so(i.m).add(a,"days").subtract(1,"days").format("YYYY-MM-DD"):so(i.m).add(a,"days").format("YYYY-MM-DD"),i.m=c,i.v=go(c)[2],o.push(i)}}else{let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=7:(n===wa.TOP||n===wa.LEFT)&&(r=-7,e.reverse());let a=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,i={...e[t]},s=Math.ceil(n/e.length);0===t&&(a=so(i.m).add(r*s,"days").diff(so(i.m),"days"));const l=so(i.m).add(a,"days").day();let c;c=0===l?so(i.m).add(a,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?so(i.m).add(a,"days").subtract(1,"days").format("YYYY-MM-DD"):so(i.m).add(a,"days").format("YYYY-MM-DD"),i.m=c,i.v=go(c)[2],o.push(i)}}else(n===wa.TOP||n===wa.LEFT)&&e.reverse(),o=i.FillCopy(e,t)}else if("6"===r)if(1===e.length){let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1),o=i.FillMonths(e,t,r)}else if(2===e.length)if(so(e[1].m).date()===so(e[0].m).date()&&0!==so(e[1].m).diff(so(e[0].m),"months")){(n===wa.TOP||n===wa.LEFT)&&e.reverse();const r=so(e[1].m).diff(so(e[0].m),"months");o=i.FillMonths(e,t,r)}else{let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1,e.reverse());let a=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,i={...e[t]},s=Math.ceil(n/e.length);0===t&&(a=so(i.m).add(r*s,"months").diff(so(i.m),"days"));const l=so(i.m).add(a,"days").format("YYYY-MM-DD");i.m=l,i.v=go(l)[2],o.push(i)}}else{const r=i.judgeDate(e);if(r[0]&&r[3]){(n===wa.TOP||n===wa.LEFT)&&e.reverse();const r=so(e[1].m).diff(so(e[0].m),"months");o=i.FillMonths(e,t,r)}else if(!r[0]&&r[2]){let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1,e.reverse());let a=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,i={...e[t]},s=Math.ceil(n/e.length);0===t&&(a=so(i.m).add(r*s,"months").diff(so(i.m),"days"));const l=so(i.m).add(a,"days").format("YYYY-MM-DD");i.m=l,i.v=go(l)[2],o.push(i)}}else(n===wa.TOP||n===wa.LEFT)&&e.reverse(),o=i.FillCopy(e,t)}else if("7"===r)if(1===e.length){let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1),o=i.FillYears(e,t,r)}else if(2===e.length)if(so(e[1].m).date()===so(e[0].m).date()&&so(e[1].m).month()===so(e[0].m).month()&&0!==so(e[1].m).diff(so(e[0].m),"years")){(n===wa.TOP||n===wa.LEFT)&&e.reverse();const r=so(e[1].m).diff(so(e[0].m),"years");o=i.FillYears(e,t,r)}else{let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1,e.reverse());let a=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,i={...e[t]},s=Math.ceil(n/e.length);0===t&&(a=so(i.m).add(r*s,"years").diff(so(i.m),"days"));const l=so(i.m).add(a,"days").format("YYYY-MM-DD");i.m=l,i.v=go(l)[2],o.push(i)}}else{const r=i.judgeDate(e);if(r[0]&&r[1]&&r[4]){(n===wa.TOP||n===wa.LEFT)&&e.reverse();const r=so(e[1].m).diff(so(e[0].m),"years");o=i.FillYears(e,t,r)}else if(r[0]&&r[3]||r[2]){let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1,e.reverse());let a=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,i={...e[t]},s=Math.ceil(n/e.length);0===t&&(a=so(i.m).add(r*s,"years").diff(so(i.m),"days"));const l=so(i.m).add(a,"days").format("YYYY-MM-DD");i.m=l,i.v=go(l)[2],o.push(i)}}else(n===wa.TOP||n===wa.LEFT)&&e.reverse(),o=i.FillCopy(e,t)}else if("8"===r)if(1===e.length){let r=0;n===wa.BOTTOM||n===wa.RIGHT?r=1:(n===wa.TOP||n===wa.LEFT)&&(r=-1),o=i.FillChnNumber(e,t,r)}else{const r=[];for(let t=0;t<e.length;t++)r.push(i.ChineseToNumber(e[t].m));if((n===wa.TOP||n===wa.LEFT)&&(e.reverse(),r.reverse()),i.isEqualDiff(r)){const n=r[1]-r[0];o=i.FillChnNumber(e,t,n)}else o=i.FillCopy(e,t)}return o}static getDataIndex(e,t,n){const r={},a=Math.floor(t/e),i=t%e;let o=0;if(a>0){for(let t=1;t<=a;t++)for(let a=0;a<n.length;a++)r[n[a]+(t-1)*e]=o,o++;for(let t=0;t<n.length&&n[t]<=i;t++)r[n[t]+e*a]=o,o++}else for(let e=0;e<n.length&&n[e]<=i;e++)r[n[e]]=o,o++;return r}static FillCopy(e,t){const n=[];for(let r=1;r<=t;r++){const t={...e[(r-1)%e.length]};n.push(t)}return n}static FillSeries(e,t,n){const r=this,a=[],i=[];for(let t=0;t<e.length;t++)i.push(Number(e[t].v));if(e.length>2&&r.isEqualRatio(i))for(let r=1;r<=t;r++){const t={...e[(r-1)%e.length]};let i;n===wa.BOTTOM||n===wa.RIGHT?i=Number(e[e.length-1].v)*(Number(e[1].v)/Number(e[0].v))**r:(n===wa.TOP||n===wa.LEFT)&&(i=Number(e[0].v)/(Number(e[1].v)/Number(e[0].v))**r),t.v=i,t.m=i,a.push(t)}else{const o=r.getXArr(e.length);for(let s=1;s<=t;s++){const t={...e[(s-1)%e.length]};let l;n===wa.BOTTOM||n===wa.RIGHT?l=r.forecast(e.length+s,i,o):(n===wa.TOP||n===wa.LEFT)&&(l=r.forecast(1-s,i,o)),t.v=l,t.m=l,a.push(t)}}return a}static FillExtendNumber(e,t,n){const r=[],a=/0|([1-9]+[0-9]*)/g;for(let i=1;i<=t;i++){const t={...e[(i-1)%e.length]},o=e[e.length-1].m,s=o.match(a),l=s[s.length-1],c=Math.abs(Number(l)+n*i),u=o.lastIndexOf(l),h=o.substr(0,u)+c.toString()+o.substr(u+l.length);t.v=h,t.m=h,r.push(t)}return r}static FillOnlyFormat(e,t){const n=[];for(let r=1;r<=t;r++){const t={...e[(r-1)%e.length]};delete t.f,delete t.m,delete t.v,n.push(t)}return n}static FillWithoutFormat(e){const t=[];for(let n=0;n<e.length;n++){const r={...e[n]};let a;a=null===r.f?{m:r.v.toString(),v:r.v}:{f:r.f,m:r.v.toString(),v:r.v},t.push(a)}return t}static FillDays(e,t,n){const r=[];for(let a=1;a<=t;a++){const t={...e[(a-1)%e.length]};let i=void t.v;i=so(i).add(n*a,"days").format("YYYY-MM-DD"),t.v=go(i)[2],t.m=(t.fm.f,void t.v),r.push(t)}return r}static FillMonths(e,t,n){const r=[];for(let a=1;a<=t;a++){const t={...e[(a-1)%e.length]};let i=void t.v;i=so(i).add(n*a,"months").format("YYYY-MM-DD"),t.v=go(i)[2],t.m=(t.fm.f,void t.v),r.push(t)}return r}static FillYears(e,t,n){const r=[];for(let a=1;a<=t;a++){const t={...e[(a-1)%e.length]};let i=void t.v;i=so(i).add(n*a,"years").format("YYYY-MM-DD"),t.v=go(i)[2],t.m=(t.fm.t,void t.v),r.push(t)}return r}static FillChnWeek(e,t,n){const r=this,a=[];for(let i=1;i<=t;i++){const t={...e[(i-1)%e.length]};let o;o="日"===e[e.length-1].m?7+n*i:r.ChineseToNumber(e[e.length-1].m)+n*i,o<0&&(o=7*Math.ceil(Math.abs(o)/7)+o);const s=o%7;0===s?(t.m="日",t.v="日"):1===s?(t.m="一",t.v="一"):2===s?(t.m="二",t.v="二"):3===s?(t.m="三",t.v="三"):4===s?(t.m="四",t.v="四"):5===s?(t.m="五",t.v="五"):6===s&&(t.m="六",t.v="六"),a.push(t)}return a}static FillChnWeek2(e,t,n){const r=this,a=[];for(let i=1;i<=t;i++){const t={...e[(i-1)%e.length]};let o;if("周日"===e[e.length-1].m)o=7+n*i;else{const t=e[e.length-1].m,a=t.substr(t.length-1,1);o=r.ChineseToNumber(a)+n*i}o<0&&(o=7*Math.ceil(Math.abs(o)/7)+o);const s=o%7;0===s?(t.m="周日",t.v="周日"):1===s?(t.m="周一",t.v="周一"):2===s?(t.m="周二",t.v="周二"):3===s?(t.m="周三",t.v="周三"):4===s?(t.m="周四",t.v="周四"):5===s?(t.m="周五",t.v="周五"):6===s&&(t.m="周六",t.v="周六"),a.push(t)}return a}static FillChnWeek3(e,t,n){const r=this,a=[];for(let i=1;i<=t;i++){const t={...e[(i-1)%e.length]};let o;if("星期日"===e[e.length-1].m)o=7+n*i;else{const t=e[e.length-1].m,a=t.substr(t.length-1,1);o=r.ChineseToNumber(a)+n*i}o<0&&(o=7*Math.ceil(Math.abs(o)/7)+o);const s=o%7;0===s?(t.m="星期日",t.v="星期日"):1===s?(t.m="星期一",t.v="星期一"):2===s?(t.m="星期二",t.v="星期二"):3===s?(t.m="星期三",t.v="星期三"):4===s?(t.m="星期四",t.v="星期四"):5===s?(t.m="星期五",t.v="星期五"):6===s&&(t.m="星期六",t.v="星期六"),a.push(t)}return a}static FillChnNumber(e,t,n){const r=this,a=[];for(let i=1;i<=t;i++){const t={...e[(i-1)%e.length]},o=r.ChineseToNumber(e[e.length-1].m)+n*i;let s;s=o<=0?"零":r.NumberToChinese(o),t.v=s,t.m=s.toString(),a.push(t)}return a}static isEqualDiff(e){let t=!0;const n=e[1]-e[0];for(let r=1;r<e.length;r++)if(e[r]-e[r-1]!==n){t=!1;break}return t}static isChnNumber(e){const t=this;let n=!0;if(1===e.length)n="日"===e||e in t.chnNumChar;else{const r=e.split("");for(let e=0;e<r.length;e++)if(!(r[e]in t.chnNumChar)&&!(r[e]in t.chnNameValue)){n=!1;break}}return n}static isExtendNumber(e){const t=/0|([1-9]+[0-9]*)/g,n=t.test(e);if(n){const r=e.match(t),a=r[r.length-1],i=e.lastIndexOf(a),o=e.substr(0,i),s=e.substr(i+a.length);return[n,Number(a),o,s]}return[n]}static isChnWeek1(e){let t;return t=1===e.length&&("日"===e||this.ChineseToNumber(e)<7),t}static isChnWeek2(e){let t;return t=2===e.length&&("周一"===e||"周二"===e||"周三"===e||"周四"===e||"周五"===e||"周六"===e||"周日"===e),t}static isChnWeek3(e){let t;return t=3===e.length&&("星期一"===e||"星期二"===e||"星期三"===e||"星期四"===e||"星期五"===e||"星期六"===e||"星期日"===e),t}static isEqualRatio(e){let t=!0;const n=e[1]/e[0];for(let r=1;r<e.length;r++)if(e[r]/e[r-1]!==n){t=!1;break}return t}static getXArr(e){const t=[];for(let n=1;n<=e;n++)t.push(n);return t}static forecast(e,t,n){function r(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}const a=r(n),i=r(t);let o,s=0,l=0;for(let e=0;e<n.length;e++)s+=(n[e]-a)*(t[e]-i),l+=(n[e]-a)*(n[e]-a);o=0===l?1:s/l;const c=i-o*a;return Math.round(1e5*(c+o*e))/1e5}static judgeDate(e){let t=!0,n=!0,r=!0,a=!0,i=!0;const o=so(e[0].m).date(),s=so(e[0].m).month(),l=so(e[1].m).diff(so(e[0].m),"days"),c=so(e[1].m).diff(so(e[0].m),"months"),u=so(e[1].m).diff(so(e[0].m),"years");for(let h=1;h<e.length;h++)so(e[h].m).date()!==o&&(t=!1),so(e[h].m).month()!==s&&(n=!1),so(e[h].m).diff(so(e[h-1].m),"days")!==l&&(r=!1),so(e[h].m).diff(so(e[h-1].m),"months")!==c&&(a=!1),so(e[h].m).diff(so(e[h-1].m),"years")!==u&&(i=!1);return 0===l&&(r=!1),0===c&&(a=!1),0===u&&(i=!1),[t,n,r,a,i]}}Qr(yo,"applyType"),Qr(yo,"direction"),Qr(yo,"chnNumChar"),Qr(yo,"chnNameValue"),Qr(yo,"chnNumChar2"),Qr(yo,"chnUnitChar"),Qr(yo,"chnUnitSection");let vo=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),"");class bo{constructor(e,t){Qr(this,"_rangeListId"),Qr(this,"_commandManager"),Qr(this,"_workbook"),Qr(this,"_context"),Qr(this,"_worksheet"),Qr(this,"_rangeList"),this._context=e.getContext(),this._workbook=this._context.getWorkBook(),this._commandManager=this._context.getCommandManager(),this._worksheet=e,this._rangeList=[],t.forEach((e=>{this._rangeList.push(this._context.getWorkBook().transformRangeType(e).rangeData)})),-1===this._rangeList[0].startRow&&console.error("Invalid range,default set startRow -1")}getRangeList(){return this._rangeList}activate(){return-1===this._rangeList[0].startRow?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this._rangeList}),this)}setValue(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:a}=this;const i=t.map((t=>{let{startRow:n,startColumn:r,endRow:i,endColumn:o}=t,s=new ha;for(let t=n;t<=i;t++)for(let t=r;t<=o;t++)s.setValue(n,r,{m:`${e}`,v:e});return{sheetId:a.getSheetId(),actionName:Ya.SET_RANGE_DATA_ACTION,cellValue:s.getData(),rangeData:t}}));let o=new xs(n.getWorkBook(),...i);return r.invoke(o),this}clear(...e){const{_context:t,_worksheet:n,_commandManager:r,_rangeList:a}=this;let i={formatOnly:!0,contentsOnly:!0,commentsOnly:!0,validationsOnly:!0,skipFilteredRows:!0};ro.checkup(e,ro.OBJECT_TYPE)&&(i=e[0]);const o=a.map((e=>({sheetId:n.getSheetId(),actionName:Ya.CLEAR_RANGE_ACTION,options:i,rangeData:e})));let s=new xs(t.getWorkBook(),...o);return r.invoke(s),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}clearNote(){return this.clear({commentsOnly:!0})}_setStyle(e,t){let{_rangeList:n,_context:r,_commandManager:a,_worksheet:i}=this;const o=n.map((n=>{let{startRow:r,startColumn:a,endRow:o,endColumn:s}=n;const l={[t]:e},c=_a.fillObjectMatrix(o-r+1,s-a+1,l);return{sheetId:i.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:c,rangeData:n}}));let s=new xs(r.getWorkBook(),...o);return a.invoke(s),this}setBackground(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:a}=this;const i=t.map((t=>{let{startRow:n,startColumn:r,endRow:i,endColumn:o}=t;const s={bg:{rgb:e}},l=_a.fillObjectMatrix(i-n+1,o-r+1,s);return{sheetId:a.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:l,rangeData:t}}));let o=new xs(n.getWorkBook(),...i);return r.invoke(o),this}setBackgroundRGB(e,t,n){const r=`RGB(${e},${t},${n})`;let{_rangeList:a,_context:i,_commandManager:o,_worksheet:s}=this;const l=a.map((e=>{let{startRow:t,startColumn:n,endRow:a,endColumn:i}=e;const o={bg:{rgb:r}},l=_a.fillObjectMatrix(a-t+1,i-n+1,o);return{sheetId:s.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:l,rangeData:e}}));let c=new xs(i.getWorkBook(),...l);return o.invoke(c),this}setFontColor(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:a}=this;const i=t.map((t=>{let{startRow:n,startColumn:r,endRow:i,endColumn:o}=t;const s={cl:{rgb:e}},l=_a.fillObjectMatrix(i-n+1,o-r+1,s);return{sheetId:a.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:l,rangeData:t}}));let o=new xs(n.getWorkBook(),...i);return r.invoke(o),this}setFontFamily(e){return this._setStyle(e,"ff")}setUnderline(e){const t={s:e?ka.TRUE:ka.FALSE};return this._setStyle(t,"ul")}setOverline(e){const t={s:e?ka.TRUE:ka.FALSE};return this._setStyle(t,"ol")}setStrikeThrough(e){const t={s:e?ka.TRUE:ka.FALSE};return this._setStyle(t,"st")}setFontSize(e){return this._setStyle(e,"fs")}setFontStyle(e){const t=e?ka.TRUE:ka.FALSE;return this._setStyle(t,"it")}setFontWeight(e){const t=e?ka.TRUE:ka.FALSE;return this._setStyle(t,"bl")}setFormula(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:a}=this;const i=t.map((t=>{let{startRow:n,startColumn:r,endRow:i,endColumn:o}=t,s=new ha;for(let t=n;t<=i;t++)for(let n=r;n<=o;n++)s.setValue(t,n,e);return{sheetId:a.getSheetId(),actionName:Ya.SET_RANGE_FORMULA_ACTION,cellFormula:s.getData(),rangeData:t}}));let o=new xs(n.getWorkBook(),...i);return r.invoke(o),this}setHorizontalAlignment(e){return this._setStyle(e,"ht")}setTextDirection(e){return this._setStyle(e,"td")}setTextRotation(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:a}=this;const i=t.map((t=>{let{startRow:n,startColumn:r,endRow:i,endColumn:o}=t;const s={tr:{v:0,a:Number(e)}},l=_a.fillObjectMatrix(i-n+1,o-r+1,s);return{sheetId:a.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:l,rangeData:t}}));let o=new xs(n.getWorkBook(),...i);return r.invoke(o),this}setVerticalAlignment(e){return this._setStyle(e,"vt"),this}setVerticalText(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:a}=this;const i=t.map((t=>{let{startRow:n,startColumn:r,endRow:i,endColumn:o}=t;const s={tr:{v:e,a:0}},l=_a.fillObjectMatrix(i-n+1,o-r+1,s);return{sheetId:a.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:l,rangeData:t}}));let o=new xs(n.getWorkBook(),...i);return r.invoke(o),this}setWrap(e){return this._setStyle(e,"tb")}setWrapStrategy(e){return this._setStyle(e,"tb")}trimWhitespace(){let{_rangeList:e,_context:t,_commandManager:n,_worksheet:r}=this;const a=e.map((e=>{let{startRow:t,startColumn:n,endRow:a,endColumn:i}=e;const o=this._worksheet.getCellMatrix(),s=/\s+/g;let l=new ha;for(let e=t;e<a+1;e++)for(let t=n;t<i+1;t++){const n=o.getValue(e,t).m.replace(s,"");l.setValue(e,t,n||"")}return{sheetId:r.getSheetId(),actionName:Ya.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:l.getData(),rangeData:e}}));let i=new xs(t.getWorkBook(),...a);return n.invoke(i),this}}class xo{constructor(e,t){Qr(this,"_rowData"),Qr(this,"_workSheet"),this._workSheet=e,this._rowData=new ca(t)}getRowData(){return this._rowData}getRowDatas(e,t){const n=new ca;for(let r=e;r<e+t;r++){const e=this.getRowOrCreate(r);n.push(e)}return n}getRowHeight(...e){const{_workSheet:t}=this,{_rowData:n}=this,r=t.getConfig();let a=0;if(1===e.length)a=n.obtain(e[0],{hd:ka.FALSE,h:r.defaultRowHeight}).h;else if(2===e.length)for(let t=e[0];t<e[0]+e[1];t++){a+=n.obtain(t,{hd:ka.FALSE,h:r.defaultRowHeight}).h}return a}setRowHeight(e,t){const n=this._workSheet.getContext(),r=this._workSheet.getCommandManager(),a={sheetId:this._workSheet.getSheetId(),actionName:Ya.SET_ROW_HEIGHT_ACTION,rowIndex:e,rowHeight:t},i=new xs(n.getWorkBook(),a);r.invoke(i)}getRow(e){const{_rowData:t}=this;return t.get(e)}getSize(){return this._rowData.getLength()}getRowOrCreate(e){const{_workSheet:t}=this,{_rowData:n}=this,r=n.get(e);if(r)return r;const a=t.getConfig(),i={hd:ka.FALSE,h:a.defaultRowHeight};return n.set(e,i),i}}class wo{constructor(...e){var t;if(Qr(this,"_commandManager"),Qr(this,"_selection"),Qr(this,"_context"),Qr(this,"_workbook"),Qr(this,"_config"),Qr(this,"_initialized"),Qr(this,"_merges"),Qr(this,"_sheetId"),Qr(this,"_cellData"),Qr(this,"_rowManager"),Qr(this,"_columnManager"),_a.hasLength(e,1)){e=[e[0],_a.commonExtend({},ja)]}if(_a.hasLength(e,2)){this._context=e[0],this._config=_a.commonExtend(ja,e[1]);const{columnData:n,rowData:r,cellData:a}=this._config;this._sheetId=null!=(t=this._config.id)?t:vo(6),this._initialized=!1,this._cellData=new ha(a),this._workbook=this._context.getWorkBook(),this._commandManager=this._context.getCommandManager(),this._rowManager=new xo(this,r),this._columnManager=new ni(this,n),this._initialize()}}_initialize(){this._merges=new ao(this,this._config.mergeData)}getCellMatrix(){return this._cellData}activate(){if(this._config.status===ka.TRUE)return this;const{_context:e,_commandManager:t}=this,n=e.getContextObserver("onBeforeChangeActiveSheetObservable"),r=e.getContextObserver("onAfterChangeActiveSheetObservable"),a={sheetId:this._sheetId,actionName:Ya.SET_WORKSHEET_ACTIVATE_ACTION,status:ka.TRUE},i=new xs(e.getWorkBook(),a);return n.notifyObservers({sheet:this}),t.invoke(i),r.notifyObservers({sheet:this}),this}setConfig(e){return this._config=_a.commonExtend(ja,e),this}getRowManager(){return this._rowManager}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}setName(e){const{_context:t,_commandManager:n,_sheetId:r}=this,a=t.getContextObserver("onBeforeChangeSheetNameObservable"),i=t.getContextObserver("onAfterChangeSheetNameObservable"),o={actionName:Ya.SET_WORKSHEET_NAME_ACTION,sheetName:e,sheetId:r},s=t.getWorkBook().getSheets();for(let t=0;t<s.length;t++){const n=s[t];if(n!==this&&n.getName()===e)return console.warn("Duplicate name"),this}a.notifyObservers();const l=new xs(t.getWorkBook(),o);return n.invoke(l),i.notifyObservers({name:e,sheet:this}),this}getName(){return this._config.name}clone(){const{_config:e,_context:t}=this,n=_a.deepClone(e);return new wo(t,n)}getContext(){return this._context}getMerges(){return this._merges}getCommandManager(){return this._commandManager}getSheetData(){return[]}getRange(...e){return _a.hasLength(e,1)?new To(this,e[0]):_a.hasLength(e,2)?new To(this,{row:[e[0],e[0]],column:[e[1],e[1]]}):_a.hasLength(e,3)?new To(this,{row:[e[0],e[2]],column:[e[1],e[1]]}):_a.hasLength(e,4)?new To(this,{row:[e[0],e[2]],column:[e[1],e[3]]}):void 0}getRangeList(e){return new bo(this,e)}getStatus(){const{_config:e}=this;return e.status}setStatus(e){const{_context:t,_commandManager:n,_sheetId:r}=this,a={actionName:Ya.SET_WORKSHEET_STATUS_ACTION,sheetId:r,sheetStatus:e},i=new xs(t.getWorkBook(),a);return n.invoke(i),this}getZoomRatio(){return this._config.zoomRatio||1}setZoomRatio(e){const{_context:t,_sheetId:n,_commandManager:r}=this,a={actionName:Ya.SET_ZOOM_RATIO_ACTION,sheetId:n,zoom:e},i=new xs(t.getWorkBook(),a);r.invoke(i),t.getContextObserver("onZoomRatioSheetObservable").notifyObservers({zoomRatio:e})}getSelection(){return this._selection}copy(e){const{_config:t,_context:n}=this,r=_a.deepClone(t);return r.name=e,r.status=ka.FALSE,r.id=vo(),new wo(n,r)}getConfig(){return this._config.mergeData=this._merges.getMergeData(),this._config}insertRows(...e){let t=0,n=1;_a.hasLength(e,1)&&(t=e[0]),_a.hasLength(e,2)&&(t=e[0],n=e[1]);const{_context:r,_commandManager:a,_sheetId:i}=this,o={actionName:Ya.INSERT_ROW_DATA_ACTION,sheetId:i,rowIndex:t,rowData:new ha(new ca(n)).toJSON()},s={actionName:Ya.INSERT_ROW_ACTION,sheetId:i,rowIndex:t,rowCount:n},l=new xs(r.getWorkBook(),o,s);return a.invoke(l),this}insertRowAfter(...e){let t=0,n=1;_a.hasLength(e,1)&&(t=e[0]+1),_a.hasLength(e,2)&&(t=e[0]+1,n=e[1]);const{_context:r,_commandManager:a,_sheetId:i}=this,o={actionName:Ya.INSERT_ROW_DATA_ACTION,sheetId:i,rowIndex:t,rowData:new ha(new ca(n)).toJSON()},s={actionName:Ya.INSERT_ROW_ACTION,sheetId:i,rowIndex:t,rowCount:n},l=new xs(r.getWorkBook(),o,s);return a.invoke(l),this}insertRowBefore(...e){let t=0,n=1;_a.hasLength(e,1)&&(t=e[0]-1),_a.hasLength(e,2)&&(t=e[0]-1,n=e[1]),t<0&&(t=0);const{_context:r,_commandManager:a,_sheetId:i}=this,o={actionName:Ya.INSERT_ROW_DATA_ACTION,sheetId:i,rowIndex:t,rowData:new ha(new ca(n)).toJSON()},s={actionName:Ya.INSERT_ROW_ACTION,sheetId:i,rowIndex:t,rowCount:n},l=new xs(r.getWorkBook(),o,s);return a.invoke(l),this}insertColumns(...e){let t=0,n=1;_a.hasLength(e,1)&&(t=e[0]),_a.hasLength(e,2)&&(t=e[0],n=e[1]);const{_context:r,_commandManager:a,_sheetId:i}=this,o=new ha;this._cellData.forEach((e=>{for(let r=t;r<t+n;r++)o.setValue(e,r-t,{})}));const s={actionName:Ya.INSERT_COLUMN_DATA_ACTION,sheetId:i,columnIndex:t,columnData:o.toJSON()},l={actionName:Ya.INSERT_COLUMN_ACTION,sheetId:i,columnIndex:t,columnCount:n},c=new xs(r.getWorkBook(),l,s);return a.invoke(c),this}insertColumnBefore(...e){let t=0,n=1;_a.hasLength(e,1)&&(t=e[0]-1),_a.hasLength(e,2)&&(t=e[0]-1,n=e[1]),t<0&&(t=0);const{_context:r,_commandManager:a,_sheetId:i}=this,o=new ha;this._cellData.forEach((e=>{for(let r=t;r<t+n;r++)o.setValue(e,r-t,{})}));const s={actionName:Ya.INSERT_COLUMN_DATA_ACTION,sheetId:i,columnIndex:t,columnData:o.toJSON()},l={actionName:Ya.INSERT_COLUMN_ACTION,sheetId:i,columnIndex:t,columnCount:n},c=new xs(r.getWorkBook(),l,s);return a.invoke(c),this}insertColumnAfter(...e){let t=0,n=1;_a.hasLength(e,1)&&(t=e[0]+1),_a.hasLength(e,2)&&(t=e[0]+1,n=e[1]);const{_context:r,_commandManager:a,_sheetId:i}=this,o=new ha;this._cellData.forEach((e=>{for(let r=t;r<t+n;r++)o.setValue(e,r-t,{})}));const s={actionName:Ya.INSERT_COLUMN_DATA_ACTION,sheetId:i,columnIndex:t,columnData:o.toJSON()},l={actionName:Ya.INSERT_COLUMN_ACTION,sheetId:i,columnIndex:t,columnCount:n},c=new xs(r.getWorkBook(),s,l);return a.invoke(c),this}clear(...e){const{_context:t,_commandManager:n}=this,r={startRow:0,endRow:this.getConfig().rowCount-1,startColumn:0,endColumn:this.getConfig().columnCount-1};let a={formatOnly:!0,contentsOnly:!0};ro.checkup(e,ro.OBJECT_TYPE)&&(a=e[0]);const i={sheetId:this._sheetId,actionName:Ya.CLEAR_RANGE_ACTION,options:a,rangeData:r},o=new xs(t.getWorkBook(),i);return n.invoke(o),this}setTabColor(e){const{_context:t,_commandManager:n}=this,r=t.getContextObserver("onSheetTabColorChangeObservable"),a={sheetId:this._sheetId,actionName:Ya.SET_TAB_COLOR_ACTION,color:e},i=new xs(t.getWorkBook(),a);return n.invoke(i),r.notifyObservers(),this}hideSheet(){const{_context:e,_workbook:t,_commandManager:n}=this;if(!this._config.hidden){const r=e.getContextObserver("onHideSheetObservable"),a={sheetId:this._sheetId,actionName:Ya.HIDE_SHEET_ACTION,hidden:ka.TRUE},i=new xs(t,a);if(n.invoke(i),this.getStatus()===ka.TRUE){const e=t.getSheetIndex(this),n=t.nextSheet(e);n&&n.activate()}r.notifyObservers({sheet:this})}return this}showSheet(){if(!this._config.hidden)return this;const{_context:e,_commandManager:t}=this,n={sheetId:this._sheetId,actionName:Ya.HIDE_SHEET_ACTION,hidden:ka.FALSE},r=new xs(e.getWorkBook(),n);return t.invoke(r),e.getContextObserver("onShowSheetObservable").notifyObservers({sheet:this}),this}setCommandManager(e){return this._commandManager=e,this}setActiveSelection(...e){const t=e[0];return t?this._selection.setSelection({selection:t}):this._selection.setSelection()}getFrozenRows(){return this._config.freezeRow}getFrozenColumns(){return this._config.freezeColumn}getMaxColumns(){const{_config:e}=this,{columnCount:t}=e;return t}getMaxRows(){const{_config:e}=this,{rowCount:t}=e;return t}getType(){const{_config:e}=this,{type:t}=e;return t}clearContents(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({contentsOnly:!0}),this}clearFormats(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({formatOnly:!0}),this}clearNotes(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({commentsOnly:!0}),this}deleteColumn(e){const{_context:t,_commandManager:n,_sheetId:r}=this,a={actionName:Ya.REMOVE_COLUMN_DATA_ACTION,sheetId:r,columnCount:1,columnIndex:e},i={actionName:Ya.REMOVE_COLUMN_ACTION,sheetId:r,columnCount:1,columnIndex:e},o=new xs(t.getWorkBook(),a,i);return n.invoke(o),this}deleteColumns(e,t){const{_context:n,_commandManager:r,_sheetId:a}=this,i={actionName:Ya.REMOVE_COLUMN_DATA_ACTION,sheetId:a,columnCount:t,columnIndex:e},o={actionName:Ya.REMOVE_COLUMN_ACTION,sheetId:a,columnCount:t,columnIndex:e},s=new xs(n.getWorkBook(),i,o);return r.invoke(s),this}deleteRow(e){const{_context:t,_commandManager:n,_sheetId:r}=this,a={actionName:Ya.REMOVE_ROW_DATA_ACTION,sheetId:r,rowCount:1,rowIndex:e},i={actionName:Ya.REMOVE_ROW_ACTION,sheetId:r,rowCount:1,rowIndex:e},o=new xs(t.getWorkBook(),a,i);return n.invoke(o),this}deleteRows(e,t){const{_context:n,_commandManager:r,_sheetId:a}=this,i={actionName:Ya.REMOVE_ROW_DATA_ACTION,sheetId:a,rowCount:t,rowIndex:e},o={actionName:Ya.REMOVE_ROW_ACTION,sheetId:a,rowCount:t,rowIndex:e},s=new xs(n.getWorkBook(),i,o);return r.invoke(s),this}getRowCount(){return this._config.rowCount}getColumnCount(){return this._config.columnCount}setBorderStyle(e,t,n){const{_commandManager:r,_sheetId:a}=this,i=this.getContext(),o=this.getCellMatrix(),s=i.getWorkBook(),l=s.getStyles(),c=this.getRange({startRow:e.startRow-1,startColumn:e.startColumn,endRow:e.startRow-1,endColumn:e.endColumn}),u=this.getRange({startRow:e.startRow,startColumn:e.startColumn-1,endRow:e.startRow,endColumn:e.endColumn-1}),h=this.getRange({startRow:e.endRow+1,startColumn:e.startColumn,endRow:e.endRow+1,endColumn:e.endColumn}),d=this.getRange({startRow:e.startRow,startColumn:e.endColumn+1,endRow:e.startRow,endColumn:e.endColumn+1}),p=this.getRange(e),m=new ha,_=new ha,g=new ha,f=new ha,y=new ha;c.forEach(((e,t)=>{const n=o.getValue(e,t);if(n){const r=l.get(n.s);if(r){const n=_a.deepClone(r);n.bd&&delete n.bd.b,m.setValue(e,t,n)}}})),h.forEach(((e,t)=>{const n=o.getValue(e,t);if(n){const r=l.get(n.s);if(r){const n=_a.deepClone(r);n.bd&&delete n.bd.t,g.setValue(e,t,n)}}})),u.forEach(((e,t)=>{const n=o.getValue(e,t);if(n){const r=l.get(n.s);if(r){const n=_a.deepClone(r);n.bd&&delete n.bd.r,_.setValue(e,t,n)}}})),d.forEach(((e,t)=>{const n=o.getValue(e,t);if(n){const r=l.get(n.s);if(r){const n=_a.deepClone(r);n.bd&&delete n.bd.l,f.setValue(e,t,n)}}})),p.forEach(((e,n)=>{y.setValue(e,n,t)}));const v=[];if(n.includes(wa.TOP)){const e={sheetId:a,actionName:Ya.SET_BORDER_ACTION,styles:g.toJSON()};v.push(e)}if(n.includes(wa.BOTTOM)){const e={sheetId:a,actionName:Ya.SET_BORDER_ACTION,styles:m.toJSON()};v.push(e)}if(n.includes(wa.LEFT)){const e={sheetId:a,actionName:Ya.SET_BORDER_ACTION,styles:f.toJSON()};v.push(e)}if(n.includes(wa.RIGHT)){const e={sheetId:a,actionName:Ya.SET_BORDER_ACTION,styles:_.toJSON()};v.push(e)}const b={sheetId:a,actionName:Ya.SET_BORDER_ACTION,styles:y.toJSON()};v.push(b);const x=new xs(s,...v);return r.invoke(x),this}setCurrentCell(e){return e.activateAsCurrentCell()}getActiveCell(){return this.getSelection().getCurrentCell()}getActiveRange(){return this.getSelection().getActiveRange()}getActiveRangeList(){return this.getSelection().getActiveRangeList()}getIndex(){const e=this._context.getWorkBook().getSheets().findIndex((e=>e&&e.getSheetId()===this._sheetId));return e>-1?e+1:null}getParent(){return this._context.getWorkBook()}isSheetHidden(){return this._config.hidden}setActiveRange(e){return this.getSelection().setSelection(e)}setActiveRangeList(e){const t=this.getSelection();return t.setSelection(e),t.getActiveRangeList()}hideRow(e){const t=e.getRangeData(),n=t.startRow,r=t.endRow-t.startRow+1,{_context:a,_commandManager:i,_sheetId:o}=this,s={actionName:Ya.SET_HIDE_ROW_ACTION,sheetId:o,rowCount:r,rowIndex:n},l=new xs(a.getWorkBook(),s);return i.invoke(l),this}hideRows(...e){const t=--e[0];let n=1;e[1]&&(n=e[1]);const{_context:r,_commandManager:a,_sheetId:i}=this,o={actionName:Ya.SET_HIDE_ROW_ACTION,sheetId:i,rowCount:n,rowIndex:t},s=new xs(r.getWorkBook(),o);return a.invoke(s),this}hideColumn(e){const t=e.getRangeData(),n=t.startColumn,r=t.endColumn-t.startColumn+1,{_context:a,_commandManager:i,_sheetId:o}=this,s={actionName:Ya.SET_HIDE_COLUMN_ACTION,sheetId:o,columnCount:r,columnIndex:n},l=new xs(a.getWorkBook(),s);return i.invoke(l),this}hideColumns(...e){const t=e[0];let n=1;e[1]&&(n=e[1]);const{_context:r,_commandManager:a,_sheetId:i}=this,o={actionName:Ya.SET_HIDE_COLUMN_ACTION,sheetId:i,columnCount:n,columnIndex:t},s=new xs(r.getWorkBook(),o);return a.invoke(s),this}unhideRow(e){const t=e.getRangeData(),n=t.startRow,r=t.endRow-t.startRow+1,{_context:a,_commandManager:i,_sheetId:o}=this,s={actionName:Ya.SET_SHOW_ROW_ACTION,sheetId:o,rowCount:r,rowIndex:n},l=new xs(a.getWorkBook(),s);return i.invoke(l),this}unhideColumn(e){const t=e.getRangeData(),n=t.startColumn,r=t.endColumn-t.startColumn+1,{_context:a,_commandManager:i,_sheetId:o}=this,s={actionName:Ya.SET_SHOW_COLUMN_ACTION,sheetId:o,columnCount:r,columnIndex:n},l=new xs(a.getWorkBook(),s);return i.invoke(l),this}showColumns(...e){const t=e[0];let n=1;e[1]&&(n=e[1]);const{_context:r,_commandManager:a,_sheetId:i}=this,o={actionName:Ya.SET_SHOW_COLUMN_ACTION,sheetId:i,columnCount:n,columnIndex:t},s=new xs(r.getWorkBook(),o);return a.invoke(s),this}showRows(...e){const t=--e[0];let n=1;e[1]&&(n=e[1]);const{_context:r,_commandManager:a,_sheetId:i}=this,o={actionName:Ya.SET_SHOW_ROW_ACTION,sheetId:i,rowCount:n,rowIndex:t},s=new xs(r.getWorkBook(),o);return a.invoke(s),this}hasHiddenGridlines(){const{_config:e}=this,{showGridlines:t}=e;return 0===t}getTabColor(){const{_config:e}=this,{tabColor:t}=e;return t}getColumnWidth(e){return this.getColumnManager().getColumnWidth(e)}getRowHeight(e){return this.getRowManager().getRowHeight(e)}setColumnWidth(...e){let t,n=[];if(_a.hasLength(e,2)&&(t=e[0],n=[e[1]]),_a.hasLength(e,3)){t=e[0];for(let t=0;t<e[1];t++)n.push(e[2])}return this.getColumnManager().setColumnWidth(t,n),this}setRowHeights(e,t,n){const r=[];for(let e=0;e<t;e++)r.push(n);return this.getRowManager().setRowHeight(e,r),this}setRowHeight(e,t){const n=[t];return this.getRowManager().setRowHeight(e,n),this}setHiddenGridlines(e){const{_context:t,_commandManager:n,_sheetId:r}=this,a={actionName:Ya.SET_HIDDEN_GRIDLINES_ACTION,hideGridlines:e,sheetId:r},i=new xs(t.getWorkBook(),a);return n.invoke(i),this}isRightToLeft(){const{_config:e}=this,{rightToLeft:t}=e;return t}setRightToLeft(e){const{_context:t,_commandManager:n,_sheetId:r}=this,a={actionName:Ya.SET_RIGHT_TO_LEFT_ACTION,rightToLeft:e,sheetId:r},i=new xs(t.getWorkBook(),a);return n.invoke(i),this}getPluginMeta(e){return this._config.pluginMeta[e]}setPluginMeta(e,t){this._config.pluginMeta[e]=t}copyTo(e){const t=this._context.getWorkBook().getSheets()[e];if(!t)return this;const n=_a.deepClone(this._config);return n.sheetId=t.getConfig().id,t.setConfig(n),t}getLastRow(){return this._cellData.getLength()}getLastColumn(){return this._cellData.getRange().endColumn}getSheetValues(e,t,n,r){return new To(this,{startRow:e,startColumn:t,endRow:e+n-1,endColumn:t+r-1}).getValues()}getDataRange(){return new To(this,this._cellData.getRange())}moveRows(e,t){const{startRow:n}=e.getRangeData(),{endRow:r}=e.getRangeData(),a=this._cellData.spliceRows(n,r-n+1);return this._cellData.insertRows(t,a),this}moveColumns(e,t){const n=e.getRangeData().startColumn,r=e.getRangeData().endColumn,a=this._cellData.spliceColumns(n,r-n+1);return this._cellData.insertColumns(t,a),this}}class To{constructor(e,t){Qr(this,"_commandManager"),Qr(this,"_context"),Qr(this,"_rangeData"),Qr(this,"_worksheet"),this._context=e.getContext(),this._commandManager=this._context.getCommandManager(),this._rangeData=this._context.getWorkBook().transformRangeType(t).rangeData,this._worksheet=e,Object.values(this._rangeData).includes(-1)&&console.error("Invalid range,default set index -1")}static foreach(e,t){const{startRow:n,startColumn:r,endRow:a,endColumn:i}=e;for(let e=n;e<=a;e++)for(let n=r;n<=i;n++)t(e,n)}getRangeData(){return this._rangeData}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData,a=[];for(let i=e;i<=t;i++){const e=[];for(let t=n;t<=r;t++)e.push(this.getMatrix().getValue(i,t)||null);a.push(e)}return a}getMatrix(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData,a=this._worksheet.getCellMatrix(),i=new ha;for(let o=e;o<=t;o++)for(let e=n;e<=r;e++)i.setValue(o,e,a.getValue(o,e)||null);return i}getMatrixObject(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData,a=this._worksheet.getCellMatrix(),i=new ha;for(let o=e;o<=t;o++)for(let t=n;t<=r;t++)i.setValue(o-e,t-n,a.getValue(o,t)||{});return i}getDisplayValue(){const e=this.getValue();return e&&e.p?e.p:e&&e.m?e.m:""}getDisplayValues(){return this.getValues().map((e=>e.map((e=>e&&e.p?e.p:e&&e.m?e.m:""))))}getA1Notation(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData;let a,i;return n<r?(a=_a.numToWord(n+1)+(e+1),i=_a.numToWord(r+1)+(t+1)):(a=_a.numToWord(r+1)+(t+1),i=_a.numToWord(n+1)+(e+1)),a===i?`${a}`:`${a}:${i}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){return this.getValues().map((e=>e.map((e=>{var t,n,r;const a=this._context.getWorkBook().getStyles();let i=null==(t=Ka.bg)?void 0:t.rgb;return null!=e&&e.s&&(i=null==(r=null==(n=a.get(null==e?void 0:e.s))?void 0:n.bg)?void 0:r.rgb),i}))))}getCell(e,t){const{startRow:n,endRow:r,startColumn:a,endColumn:i}=this._rangeData,o={startRow:n+e,endRow:n+e,startColumn:a+t,endColumn:a+t};return new To(this._worksheet,o)}getColumn(){return this._rangeData.startColumn}getObjectValue(e={}){return this.getObjectValues(e)[0][0]}getObjectValues(e={}){const{startRow:t,endRow:n,startColumn:r,endColumn:a}=this._rangeData,i=this._worksheet.getCellMatrix().getFragments(t,n,r,a).getData();if(e.isIncludeStyle){const e=this._context.getWorkBook().getStyles();for(let o=0;o<=n-t;o++)for(let t=0;t<=a-r;t++){if(!i[o][t])continue;const n=i[o][t].s;n&&(i[o][t].s=e.get(n))}}return i}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){return this.getValues().map((e=>e.map((e=>{var t,n,r;const a=this._context.getWorkBook().getStyles();return(null==e?void 0:e.s)&&(null==(n=null==(t=a.get(e.s))?void 0:t.cl)?void 0:n.rgb)||(null==(r=Ka.cl)?void 0:r.rgb)}))))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){return this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getStrikeThrough(){return this.getStrikeThroughs()[0][0]}_getStyles(e){return this.getValues().map((t=>t.map((t=>{const n=this._context.getWorkBook().getStyles();return(null==t?void 0:t.s)&&n.get(t.s)[e]||Ka[e]}))))}getFontSize(){return this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getFontStyle(){return this.getFontStyles()[0][0]}getFontStyles(){return this._getStyles("it")}getFontWeight(){return this.getFontWeights()[0][0]}getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_rangeData:e,_worksheet:t}=this,{startRow:n,endRow:r}=e;let a=0;for(let e=0;e<=r-n;e++){a+=t.getRowHeight(e)}return a}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._rangeData.endColumn}getLastRow(){return this._rangeData.endRow}getMergedRanges(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData;return this._worksheet.getMerges().getMergedRanges({startRow:e,endRow:t,startColumn:n,endColumn:r}).map((e=>new To(this._worksheet,e)))}getNextDataCell(e){const{_worksheet:t}=this,{startRow:n,endRow:r,startColumn:a,endColumn:i}=this._rangeData,o=t.getMaxRows(),s=t.getMaxColumns();if(e===wa.BOTTOM){for(let e=0;e<o-a;e++)this._worksheet.getCellMatrix().getValue(n+e,a)&&t.getRange(n+e,a,n+e,a);return t.getRange(o,a,o,a)}if(e===wa.TOP){for(let e=0;e<n;e++)this._worksheet.getCellMatrix().getValue(n-e,a)&&t.getRange(n-e,a,n-e,n);return t.getRange(0,a,0,a)}if(e===wa.RIGHT){for(let e=0;e<s-a;e++)this._worksheet.getCellMatrix().getValue(n,a+e)&&t.getRange(n,a+e,n,a+e);return t.getRange(n,s,n,s)}if(e===wa.LEFT){for(let e=0;e<o-a;e++)this._worksheet.getCellMatrix().getValue(n,a-e)&&t.getRange(n,a-e,n,a-e);return t.getRange(n,0,n,0)}return t.getRange(Xa)}getNumColumns(){const{startColumn:e,endColumn:t}=this._rangeData;return t-e+1}getNumRows(){const{startRow:e,endRow:t}=this._rangeData;return t-e+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map((e=>e.map((e=>(null==e?void 0:e.p)||""))))}getRowIndex(){return this._rangeData.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){return this.getValues().map((e=>e.map((e=>{const t=this._context.getWorkBook().getStyles();return e&&e.s?t.get(e.s):null}))))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_rangeData:e,_worksheet:t}=this,{startColumn:n,endColumn:r}=e;let a=0;for(let e=0;e<=r-n;e++)a+=t.getColumnWidth(e);return a}getWrap(){return this.getWraps()[0][0]}getWraps(){return this._getStyles("tb")}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}isBlank(){return this.getValues().some((e=>e.some((e=>""===(null==e?void 0:e.m)))))}isPartOfMerge(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData;return!!this._worksheet.getMerges().getByRowColumn(e,t,n,r)}_setStyle(e,t){const{_context:n,_worksheet:r,_commandManager:a}=this,{startRow:i,endRow:o,startColumn:s,endColumn:l}=this._rangeData,c={[t]:e},u=_a.fillObjectMatrix(o-i+1,l-s+1,c),h={sheetId:r.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new xs(n.getWorkBook(),h);return a.invoke(d),this}_setStyles(e,t){const{_context:n,_worksheet:r,_commandManager:a}=this,{startRow:i,endRow:o,startColumn:s,endColumn:l}=this._rangeData,c=new ha;for(let n=0;n<o-i+1;n++)for(let r=0;r<l-s+1;r++)c.setValue(n,r,{[t]:e[n][r]});const u={sheetId:r.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:c.getData(),rangeData:this._rangeData},h=new xs(n.getWorkBook(),u);return a.invoke(h),this}setBackground(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={bg:{rgb:e}},c=_a.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new xs(t.getWorkBook(),u);return r.invoke(h),this}setBackgrounds(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l=new ha;for(let t=0;t<i-a+1;t++)for(let n=0;n<s-o+1;n++)l.setValue(t,n,{bg:{rgb:e[t][n]}});const c={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},u=new xs(t.getWorkBook(),c);return r.invoke(u),this}setBackgroundRGB(e,t,n){const{_context:r,_worksheet:a,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:l,endColumn:c}=this._rangeData,u={bg:{rgb:`RGB(${e},${t},${n})`}},h=_a.fillObjectMatrix(s-o+1,c-l+1,u),d={sheetId:a.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},p=new xs(r.getWorkBook(),d);return i.invoke(p),this}setFontColors(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l=new ha;for(let t=0;t<i-a+1;t++)for(let n=0;n<s-o+1;n++)l.setValue(t,n,{cl:{rgb:e[t][n]}});const c={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},u=new xs(t.getWorkBook(),c);return r.invoke(u),this}setFontFamilies(e){return this._setStyles(e,"ff"),this}setUnderline(e){return this._setStyle(e,"ul"),this}setOverline(e){return this._setStyle(e,"ol"),this}setStrikeThrough(e){return this._setStyle(e,"st"),this}setUnderlines(e){return this._setStyles(e,"ul"),this}setOverlines(e){return this._setStyles(e,"ol"),this}setStrikeThroughs(e){return this._setStyles(e,"st"),this}setFontSizes(e){return this._setStyles(e,"fs"),this}setFontStyle(e){return this._setStyle(e,"it"),this}setFontStyles(e){return this._setStyles(e,"it"),this}setFontWeight(e){return this._setStyle(e,"bl"),this}setFontWeights(e){return this._setStyles(e,"bl"),this}setFormula(e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:a}=this,{startRow:i,startColumn:o,endRow:s,endColumn:l}=t,c=new ha;for(let t=i;t<=s;t++)for(let n=o;n<=l;n++)c.setValue(t,n,e);const u={sheetId:a.getSheetId(),actionName:Ya.SET_RANGE_FORMULA_ACTION,cellFormula:c.getData(),rangeData:this._rangeData},h=new xs(n.getWorkBook(),u);return r.invoke(h),this}setFormulas(e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:a}=this,{startRow:i,startColumn:o,endRow:s,endColumn:l}=t,c=new ha;for(let t=0;t<=s-i;t++)for(let n=0;n<=l-o;n++)c.setValue(t+i,n+o,e[t][n]);const u={sheetId:a.getSheetId(),actionName:Ya.SET_RANGE_FORMULA_ACTION,cellFormula:c.getData(),rangeData:this._rangeData},h=new xs(n.getWorkBook(),u);return r.invoke(h),this}setHorizontalAlignments(e){return this._setStyles(e,"ht"),this}setTextDirections(e){return this._setStyles(e,"td"),this}setTextRotation(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={tr:{v:0,a:Number(e)}},c=_a.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new xs(t.getWorkBook(),u);return r.invoke(h),this}setTextRotations(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l=new ha;for(let t=0;t<i-a+1;t++)for(let n=0;n<s-o+1;n++)l.setValue(t,n,{tr:{v:0,a:e[t][n]}});l.getData();const c={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},u=new xs(t.getWorkBook(),c);return r.invoke(u),this}setTextStyle(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={...e},c=_a.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new xs(t.getWorkBook(),u);return r.invoke(h),this}setTextStyles(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l=new ha;for(let t=0;t<i-a+1;t++)for(let n=0;n<s-o+1;n++)l.setValue(t,n,{...e[t][n]});const c={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},u=new xs(t.getWorkBook(),c);return r.invoke(u),this}setVerticalAlignments(e){return this._setStyles(e,"vt"),this}setVerticalText(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={tr:{v:e,a:90}},c=_a.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new xs(t.getWorkBook(),u);return r.invoke(h),this}setWrap(e){return this._setStyle(e,"tb"),this}setWrapStrategies(e){return this._setStyles(e,"tb"),this}setWraps(e){return this._setStyles(e,"tb"),this}autoFill(e,t){const{_worksheet:n,_context:r,_commandManager:a}=this,{startRow:i,endRow:o,startColumn:s,endColumn:l}=this._rangeData,{startRow:c,endRow:u,startColumn:h,endColumn:d}=e._rangeData;let p=wa.BOTTOM,m=0,_=0;const g=i,f=o,y=s,v=l,b=c,x=u,w=h,T=d,C=new ha;if(p=w===y&&T===v?x>f?wa.BOTTOM:wa.TOP:T>v?wa.RIGHT:wa.LEFT,p===wa.BOTTOM||p===wa.TOP){m=f-g+1,_=x-b+1;for(let e=0;e<=l-s;e++){const n=this.getColumnMatrix(e).toArray();yo.getCopyData(n,g,f,y,v,p).forEach((n=>{yo.getApplyData(n,m,_,t,p).forEach(((t,n)=>{C.setValue(n,e,t)}))}))}}else if(p===wa.RIGHT||p===wa.LEFT){_=T-w,m=v-y;for(let e=0;e<=o-i;e++){const n=this.getRowMatrix(e).toArray();yo.getCopyData(n,g,f,y,v,p).forEach((e=>{yo.getApplyData(e,m,_,t,p)}))}}const E={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_DATA_ACTION,cellValue:C.getData(),rangeData:e._rangeData},A=new xs(r.getWorkBook(),E);return a.invoke(A),this}getDataRegion(...e){const{startRow:t,endRow:n,startColumn:r,endColumn:a}=this._rangeData;let i,o;const s=this._worksheet.getCellMatrix();if(!_a.isNumber(e[0])){let e=t,n=t;const a=this._worksheet.getRowCount();for(let n=1;n<t;n++)if(!s.getValue(t-n,r)){e=t-n+1;break}const l=0;for(;l<a-t;)if(!s.getValue(t+l,r)){n=t-l-1;break}let c=t,u=t;const h=this._worksheet.getColumnCount();for(let e=1;e<t;e++)if(!s.getValue(t,r-e)){c=t-e+1;break}const d=0;for(;d<h-r;)if(!s.getValue(t,r+d)){u=t-d-1;break}return o=c-u,o=e-n,i=t,this._worksheet.getRange(e,c,i,o)}{const n=e[0];if(n===xa.COLUMNS){let e=t,n=t;const a=this._worksheet.getRowCount();for(let n=1;n<t;n++)if(!s.getValue(t-n,r)){e=t-n+1;break}const l=0;for(;l<a-t;)if(!s.getValue(t+l,r)){n=t-l-1;break}return o=e-n,i=0,this._worksheet.getRange(t,e,i,o)}if(n===xa.ROWS){let e=t,n=t;const a=this._worksheet.getColumnCount();for(let n=1;n<t;n++)if(!s.getValue(t,r-n)){e=t-n+1;break}const l=0;for(;l<a-r;)if(!s.getValue(t,r+l)){n=t-l-1;break}return o=0,i=e-n,this._worksheet.getRange(e,r,i,o)}}return this}trimWhitespace(){var e;const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l=this._worksheet.getCellMatrix(),c=/\s+/g,u=new ha;for(let t=0;t<=i-a;t++)for(let n=0;n<=s-o;n++){const r=null==(e=l.getValue(t,n).m)?void 0:e.replace(c,"");u.setValue(t+a,n+o,r||"")}const h={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:u.getData(),rangeData:this._rangeData},d=new xs(t.getWorkBook(),h);return r.invoke(d),this}activate(){var e;return-1===(null==(e=this._rangeData)?void 0:e.startRow)?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this}),this)}activateAsCurrentCell(){return this._worksheet.getSelection().setCurrentCell(this),this}isIntersection(e){const t=this._rangeData.startRow,n=this._rangeData.endRow,r=this._rangeData.startColumn,a=this._rangeData.endColumn,i=e.getRangeData().startRow,o=e.getRangeData().endRow,s=e.getRangeData().startColumn,l=e.getRangeData().endColumn,c=Math.abs(r+a-s-l),u=Math.abs(r-a)+Math.abs(s-l),h=Math.abs(t+n-i-o),d=Math.abs(t-n)+Math.abs(i-o);return c<=u&&h<=d}setFontColor(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={cl:{rgb:e}},c=_a.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new xs(t.getWorkBook(),u);return r.invoke(h),this}copyTo(...e){const{_context:t,_worksheet:n,_commandManager:r}=this,a=e[0],[i,o]=this._handleCopyRange(this,a),{startRow:s,startColumn:l,endRow:c,endColumn:u}=o;if(ro.checkup(e,To,ro.BOOLEAN_TYPE)){const a=e[1];if(e[2],a===ba.PASTE_NORMAL){const e=new ha;i.forEach(((t,n)=>t.forEach(((t,r)=>{e.setValue(n+s,r+l,t||{})}))));const a={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_DATA_ACTION,cellValue:e.getData(),rangeData:o},c=new xs(t.getWorkBook(),a);r.invoke(c)}else if(a===ba.PASTE_FORMAT){const e=t.getWorkBook().getStyles(),a=new ha;i.map(((t,n)=>t.forEach(((t,r)=>{a.setValue(n,r,t.s?e.get(t.s):{})}))));const s={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:a.getData(),rangeData:o},l=new xs(t.getWorkBook(),s);r.invoke(l)}else if(a===ba.PASTE_VALUES){const e=new ha;i.forEach(((t,n)=>t.forEach(((t,r)=>{e.setValue(n+s,r+l,(null==t?void 0:t.v)||"")}))));const a={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:e.getData(),rangeData:o},c=new xs(t.getWorkBook(),a);r.invoke(c)}else if(a===ba.PASTE_COLUMN_WIDTHS){const e=this._rangeData.startColumn;for(let t=0;t<u-e;t++){const r=n.getColumnWidth(e+t);n.setColumnWidth(e+t,r)}}}else if(ro.checkup(e,To,ro.OBJECT_TYPE)){const a=e[1],c=new ha;i.forEach(((e,t)=>e.forEach(((e,n)=>{c.setValue(t+s,n+l,e||{})}))));const u={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_DATA_ACTION,cellValue:c.getData(),rangeData:o,options:a},h=new xs(t.getWorkBook(),u);r.invoke(h)}else if(ro.checkup(e,To)){const e=new ha;i.forEach(((t,n)=>t.forEach(((t,r)=>{e.setValue(n+s,r+l,t||{})}))));const a={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_DATA_ACTION,cellValue:e.getData(),rangeData:o},c=new xs(t.getWorkBook(),a);r.invoke(c)}}copyFormatToRange(...e){const{_context:t,_commandManager:n}=this,r=e[1],a=e[2],i=e[3],o=e[4],s=_a.isAssignableFrom(e[0],wo)?e[0].getSheetId():e[0],[l,c]=this._handleCopyRange(this,{startRow:r,endRow:a,startColumn:i,endColumn:o}),u=t.getWorkBook().getStyles(),h=new ha;l.map(((e,t)=>e.map(((e,n)=>(h.setValue(t,n,e.s?u.get(e.s):{}),e.s?u.get(e.s):{})))));const d={sheetId:s,actionName:Ya.SET_RANGE_STYLE_ACTION,value:h.getData(),rangeData:c},p=new xs(t.getWorkBook(),d);n.invoke(p)}copyValuesToRange(...e){const{_context:t,_commandManager:n}=this,r=e[1],a=e[2],i=e[3],o=e[4],s=_a.isAssignableFrom(e[0],wo)?e[0].getSheetId():e[0],[l,c]=this._handleCopyRange(this,{startRow:r,endRow:a,startColumn:i,endColumn:o}),u=new ha;l.forEach(((e,t)=>e.forEach(((e,n)=>{u.setValue(t+c.startRow,n+c.startColumn,(null==e?void 0:e.v)||"")}))));const h={sheetId:s,actionName:Ya.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:u.getData(),rangeData:c},d=new xs(t.getWorkBook(),h);n.invoke(d)}moveTo(e){const{_context:t,_worksheet:n,_commandManager:r,_rangeData:a}=this,i={sheetId:n.getSheetId(),actionName:Ya.CLEAR_RANGE_ACTION,options:{formatOnly:!0,contentsOnly:!0,commentsOnly:!0,validationsOnly:!0,skipFilteredRows:!0},rangeData:a},o=this.getMatrix(),{startRow:s,endRow:l,startColumn:c,endColumn:u}=this._rangeData,{startRow:h,startColumn:d}=e.getRangeData(),p=new ha;for(let e=s;e<=l;e++)for(let t=c;t<=u;t++)p.setValue(h+(e-s),d+(t-c),o.getValue(e,t)||{});const m={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_DATA_ACTION,cellValue:p.getData(),rangeData:{startRow:h,endRow:h+(l-s),startColumn:d,endColumn:d+(u-c)}},_=new xs(t.getWorkBook(),i,m);r.invoke(_)}offset(...e){const{startRow:t,endRow:n,startColumn:r,endColumn:a}=this._rangeData,i=e[0],o=e[1],s=e[2],l=e[3],c={startRow:t+i,endRow:n+i,startColumn:r+o,endColumn:a+o};return _a.isNumber(s)&&(c.endRow=c.startRow+s-1),_a.isNumber(l)&&(c.endColumn=c.endColumn+l-1),new To(this._worksheet,c)}setBorder(...e){const t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],o=e[5],s=e[6]?e[6]:"black",l=e[7]?e[7]:fa.DASH_DOT,{_context:c,_worksheet:u,_commandManager:h}=this,d=c.getWorkBook(),p=this._rangeData,m=u.getSheetId(),_={startRow:p.startRow-1,startColumn:p.startColumn,endRow:p.startRow-1,endColumn:p.endColumn},g={startRow:p.startRow,startColumn:p.startColumn-1,endRow:p.endRow,endColumn:p.startColumn-1},f={startRow:p.endRow+1,startColumn:p.startColumn,endRow:p.endRow+1,endColumn:p.endColumn},y={startRow:p.startRow,startColumn:p.endColumn+1,endRow:p.endRow,endColumn:p.endColumn+1},v={startRow:p.startRow,startColumn:p.startColumn,endRow:p.startRow,endColumn:p.endColumn},b={startRow:p.startRow,startColumn:p.startColumn,endRow:p.endRow,endColumn:p.startColumn},x={startRow:p.endRow,startColumn:p.startColumn,endRow:p.endRow,endColumn:p.endColumn},w={startRow:p.startRow,startColumn:p.endColumn,endRow:p.endRow,endColumn:p.endColumn},T=new To(u,_),C=new To(u,g),E=new To(u,f),A=new To(u,y),S=new To(u,v),D=new To(u,b),R=new To(u,x),N=new To(u,w),M=new ha,O=new ha,k=new ha,I=new ha,P=new ha,L=[],B={s:l,cl:{rgb:s}};if(!0===t||!1===t){if(T.isValid()){T.forEach(((e,t)=>{M.setValue(e,t,{bd:{b:null}})}));const e={sheetId:m,actionName:Ya.SET_RANGE_STYLE_ACTION,value:M.getArrayData(),rangeData:_};L.push(e)}S.forEach(((e,n)=>{if(!0===t){const t=_a.deepMerge(P.getValue(e,n)||{},{bd:{t:_a.deepClone(B)}});P.setValue(e,n,t)}else if(!1===t){const t=_a.deepMerge(P.getValue(e,n)||{},{bd:{t:null}});P.setValue(e,n,t)}}))}if(!0===r||!1===r){if(E.isValid()){E.forEach(((e,t)=>{k.setValue(e,t,{bd:{t:null}})}));const e={sheetId:m,actionName:Ya.SET_RANGE_STYLE_ACTION,value:k.getArrayData(),rangeData:f};L.push(e)}R.forEach(((e,t)=>{if(!0===r){const n=_a.deepMerge(P.getValue(e,t)||{},{bd:{b:_a.deepClone(B)}});P.setValue(e,t,n)}else if(!1===r){const n=_a.deepMerge(P.getValue(e,t)||{},{bd:{b:null}});P.setValue(e,t,n)}}))}if(!0===n||!1===n){if(C.isValid()){C.forEach(((e,t)=>{O.setValue(e,t,{bd:{r:null}})}));const e={sheetId:m,actionName:Ya.SET_RANGE_STYLE_ACTION,value:O.getArrayData(),rangeData:g};L.push(e)}D.forEach(((e,t)=>{if(!0===n){const n=_a.deepMerge(P.getValue(e,t)||{},{bd:{l:_a.deepClone(B)}});P.setValue(e,t,n)}else if(!1===n){const n=_a.deepMerge(P.getValue(e,t)||{},{bd:{l:null}});P.setValue(e,t,n)}}))}if(!0===a||!1===a){if(A.isValid()){A.forEach(((e,t)=>{I.setValue(e,t,{bd:{l:null}})}));const e={sheetId:m,actionName:Ya.SET_RANGE_STYLE_ACTION,value:I.getArrayData(),rangeData:y};L.push(e)}N.forEach(((e,t)=>{if(!0===a){const n=_a.deepMerge(P.getValue(e,t)||{},{bd:{r:_a.deepClone(B)}});P.setValue(e,t,n)}else if(!1===a){const n=_a.deepMerge(P.getValue(e,t)||{},{bd:{r:null}});P.setValue(e,t,n)}}))}(!0===i||!1===i)&&this.forEach(((e,t)=>{if(t!==p.endColumn)if(!0===i){const n=_a.deepMerge(P.getValue(e,t)||{},{bd:{r:_a.deepClone(B)}});P.setValue(e,t,n)}else if(!1===i){const n=_a.deepMerge(P.getValue(e,t)||{},{bd:{r:null}});P.setValue(e,t,n)}if(t!==p.startColumn){const n=_a.deepMerge(P.getValue(e,t)||{},{bd:{l:null}});P.setValue(e,t,n)}})),(!0===o||!1===o)&&this.forEach(((e,t)=>{if(e!==p.endRow)if(!0===o){const n=_a.deepMerge(P.getValue(e,t)||{},{bd:{b:_a.deepClone(B)}});P.setValue(e,t,n)}else if(!1===o){const n=_a.deepMerge(P.getValue(e,t)||{},{bd:{b:null}});P.setValue(e,t,n)}if(e!==p.startRow){const n=_a.deepMerge(P.getValue(e,t)||{},{bd:{t:null}});P.setValue(e,t,n)}}));const F={sheetId:m,actionName:Ya.SET_RANGE_STYLE_ACTION,value:P.getArrayData(),rangeData:P.getDataRange()};L.push(F);const H=new xs(d,...L);return h.invoke(H),this}setBorderByType(e,t,n){let r=null,a=null,i=null,o=null,s=null,l=null;switch(e){case ya.TOP:r=!0;break;case ya.BOTTOM:i=!0;break;case ya.LEFT:a=!0;break;case ya.RIGHT:o=!0;break;case ya.NONE:r=!1,a=!1,i=!1,o=!1,s=!1,l=!1;break;case ya.ALL:r=!0,a=!0,i=!0,o=!0,s=!0,l=!0;break;case ya.OUTSIDE:r=!0,a=!0,i=!0,o=!0;break;case ya.INSIDE:s=!0,l=!0;break;case ya.HORIZONTAL:l=!0;break;case ya.VERTICAL:s=!0}this.setBorder(r,a,i,o,s,l,t,n)}setFontFamily(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={ff:e},c=_a.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new xs(t.getWorkBook(),u);return r.invoke(h),this}setFontSize(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={fs:e},c=_a.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new xs(t.getWorkBook(),u);return r.invoke(h),this}setHorizontalAlignment(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={ht:e},c=_a.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new xs(t.getWorkBook(),u);return r.invoke(h),this}setVerticalAlignment(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={vt:e},c=_a.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new xs(t.getWorkBook(),u);return r.invoke(h),this}setTextDirection(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={td:e},c=_a.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new xs(t.getWorkBook(),u);return r.invoke(h),this}setWrapStrategy(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={tb:e},c=_a.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Ya.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new xs(t.getWorkBook(),u);return r.invoke(h),this}setValue(e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:a}=this,{startRow:i,startColumn:o,endRow:s,endColumn:l}=t,c=new ha;for(let t=i;t<=s;t++)for(let n=o;n<=l;n++)c.setValue(t,n,e);const u={sheetId:a.getSheetId(),actionName:Ya.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:c.getData(),rangeData:this._rangeData},h=new xs(n.getWorkBook(),u);return r.invoke(h),this}setValues(...e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:a}=this,i=e[0];if(ro.checkup(e,Array)){const{startRow:e,startColumn:o,endRow:s,endColumn:l}=t,c=new ha;for(let t=0;t<=s-e;t++)for(let n=0;n<=l-o;n++)c.setValue(t+e,n+o,i[t][n]);const u={sheetId:a.getSheetId(),actionName:Ya.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:c.getData(),rangeData:this._rangeData},h=new xs(n.getWorkBook(),u);r.invoke(h)}else if(ro.checkup(e,ha)){const e={sheetId:a.getSheetId(),actionName:Ya.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:i,rangeData:this._rangeData},t=new xs(n.getWorkBook(),e);r.invoke(t)}return this}setRangeData(e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:a}=this,i={sheetId:a.getSheetId(),actionName:Ya.SET_RANGE_DATA_ACTION,cellValue:e,rangeData:t},o=new xs(n.getWorkBook(),i);return r.invoke(o),this}setRangeDatas(...e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:a}=this,i=e[0];if(ro.checkup(e,Array)){const{startRow:e,startColumn:o,endRow:s,endColumn:l}=t,c=new ha;for(let t=0;t<=s-e;t++)for(let n=0;n<=l-o;n++)c.setValue(t+e,n+o,i[t][n]);const u={sheetId:a.getSheetId(),actionName:Ya.SET_RANGE_DATA_ACTION,cellValue:c.getData(),rangeData:this._rangeData},h=new xs(n.getWorkBook(),u);r.invoke(h)}else if(ro.checkup(e,ha)){const e={sheetId:a.getSheetId(),actionName:Ya.SET_RANGE_DATA_ACTION,cellValue:i,rangeData:this._rangeData},t=new xs(n.getWorkBook(),e);r.invoke(t)}return this}clear(...e){const{_context:t,_worksheet:n,_commandManager:r,_rangeData:a}=this;let i={formatOnly:!0,contentsOnly:!0};ro.checkup(e,ro.OBJECT_TYPE)&&(i=e[0]);const o={sheetId:n.getSheetId(),actionName:Ya.CLEAR_RANGE_ACTION,options:i,rangeData:a},s=new xs(t.getWorkBook(),o);return r.invoke(s),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}clearNote(){return this.clear({commentsOnly:!0})}deleteCells(e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:a}=this,i={sheetId:a.getSheetId(),actionName:Ya.DELETE_RANGE_ACTION,shiftDimension:e,rangeData:t},o=new xs(n.getWorkBook(),i);r.invoke(o)}insertCells(...e){const t=e[0],n=e[1],{_rangeData:r,_context:a,_commandManager:i,_worksheet:o}=this,{startRow:s,endRow:l,startColumn:c,endColumn:u}=this._rangeData;let h=this._rangeData,d=new ha;if(n){d=n.getMatrixObject();const e=n.getRangeData();h={startRow:s,endRow:s+e.endRow-e.startRow,startColumn:c,endColumn:s+e.endColumn-e.startColumn}}else for(let e=s;e<=l;e++)for(let t=c;t<=u;t++)d.setValue(e,t,{m:"",v:""});const p={sheetId:o.getSheetId(),actionName:Ya.INSERT_RANGE_ACTION,shiftDimension:t,rangeData:h,cellValue:d.getData()},m=new xs(a.getWorkBook(),p);return i.invoke(m),this}merge(){const{_worksheet:e}=this,t=e.getContext(),n=e.getSheetId(),r=e.getCommandManager(),a={actionName:Ya.ADD_MERGE_ACTION,sheetId:n,rectangles:[this._rangeData]},i=new xs(t.getWorkBook(),a);return r.invoke(i),this}mergeAcross(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),r=e.getSheetId(),{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l=[];for(let e=a;e<=i;e++){const t={startRow:e,endRow:e,startColumn:o,endColumn:s};l.push(t)}const c={actionName:Ya.ADD_MERGE_ACTION,sheetId:r,rectangles:l},u=new xs(n.getWorkBook(),c);return t.invoke(u),this}mergeVertically(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),r=e.getSheetId(),{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l=[];for(let e=o;e<=s;e++){const t={startRow:a,endRow:i,startColumn:e,endColumn:e};l.push(t)}const c={actionName:Ya.ADD_MERGE_ACTION,sheetId:r,rectangles:l},u=new xs(n.getWorkBook(),c);return t.invoke(u),this}breakApart(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),r=e.getSheetId(),a=this._worksheet.getMerges().getMergedRanges(this._rangeData),i={actionName:Ya.REMOVE_MERGE_ACTION,sheetId:r,rectangles:a},o=new xs(n.getWorkBook(),i);return t.invoke(o),this}removeDuplicates(...e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:a}=this;Array.isArray(e[0])&&e[0];const i=this.getMatrix().getData(),o=[];for(let e=0;e<=t.endColumn-t.startColumn;e++){const t=[],n={},r=this.getColumnMatrix(e).getData();for(const a in r){const i=r[a][e].m;n.hasOwnProperty(i)||(n[i]=1,t.push(e))}o.push(t)}const s=Array.from(new Set(o.flat())),l={};s.forEach(((e,t)=>{l[t]=i[e]}));const c=[{sheetId:a.getSheetId(),actionName:Ya.SET_RANGE_DATA_ACTION,cellValue:l,rangeData:t}],u=new xs(n.getWorkBook(),...c);return r.invoke(u),this}getRowMatrix(e){const{startColumn:t,endColumn:n}=this._rangeData,r=this._worksheet.getCellMatrix(),a=new ha;for(let i=e;i<=e;i++)for(let e=t;e<=n;e++)a.setValue(i,e,r.getValue(i,e)||{});return a}getColumnMatrix(e){const{startRow:t,endRow:n}=this._rangeData,r=this._worksheet.getCellMatrix(),a=new ha;for(let i=t;i<=n;i++)for(let t=e;t<=e;t++)a.setValue(i,t,r.getValue(i,t)||{});return a}_handleCopyRange(...e){const t=e[0];let n=e[1];n=ro.checkup(e,To,To)?n.getRangeData():n;const r=t._worksheet.getCellMatrix(),{startRow:a,endRow:i,startColumn:o,endColumn:s}=t.getRangeData();let{startRow:l,endRow:c,startColumn:u,endColumn:h}=n;const d=i-a+1,p=s-o+1,m=c-l+1,_=h-u+1;let g,f=[];if(m%d==0&&_%p==0){for(let e=0;e<m;e++){const t=[];for(let n=0;n<_;n++){const i=r.getValue((e+a)%d,(n+o)%p)||{};t.push(i)}f.push(t)}g=n}else f=r.getFragments(a,i,o,s).getData(),c+=d-m,h+=p-_,g={startRow:l,endRow:c,startColumn:u,endColumn:h};return[f,g]}forEach(e){To.foreach(this._rangeData,e)}randomize(){const{_context:e,_worksheet:t,_commandManager:n,_rangeData:r}=this,{startRow:a,startColumn:i}=r,o=new ha;_a.randSort(this.getMatrix().toArray()).forEach(((e,t)=>e.forEach(((e,n)=>{o.setValue(t+a,n+i,e||{})}))));const s={sheetId:t.getSheetId(),actionName:Ya.SET_RANGE_DATA_ACTION,cellValue:o.getData(),rangeData:r},l=new xs(e.getWorkBook(),s);n.invoke(l)}isValid(){return!Object.values(this._rangeData).includes(-1)}}class Co{constructor(e={}){Qr(this,"_styles"),this._styles=e}each(e){return Object.entries(this._styles).forEach(e),this}search(e){const{_styles:t}=this;for(const n in t)if(_a.diffValue(t[n],e))return n;return"-1"}get(e){return"string"!=typeof(e=String(e))?e:this._styles[e]}add(e){const t=vo(6);return this._styles[t]=e,t}setValue(e){if(null==e)return;const t=this.search(e);return"-1"!==t?t:this.add(e)}toJSON(){return this._styles}}class Eo{constructor(e={},t){var n;Qr(this,"_worksheets"),Qr(this,"_styles"),Qr(this,"_config"),Qr(this,"_unitId"),Qr(this,"_context"),Qr(this,"_commandManager"),this._config=_a.commonExtend($a,e),this._context=t;const{styles:r}=this._config;this._unitId=null!=(n=this._config.id)?n:vo(6),this._styles=new Co(r),this._worksheets=new Map,this._commandManager=t.getCommandManager(),this._getDefaultWorkSheet()}_getDefaultWorkSheet(){const{_context:e,_config:t,_worksheets:n}=this,{sheets:r,sheetOrder:a}=t;for(let t in r){let i=r[t];i.name=Qo.getSheetName(i.name);const o=new wo(e,i);n.set(o.getSheetId(),o),a.push(o.getSheetId())}}_setDefaultActiveSheet(){this._worksheets.size>0&&(this._worksheets.forEach((e=>{e.setStatus(ka.FALSE)})),this._worksheets[0].setStatus(ka.TRUE))}_getCellRange(e){var t,n,r,a,i;let o="",s="";if(e.indexOf("!")>-1){const t=e.split("!");o=t[0],s=t[1],o=o.replace(/\\'/g,"'").replace(/''/g,"'"),"'"===o.substring(0,1)&&"'"===o.substring(o.length-1,1)&&(o=o.substring(1,o.length-1))}else s=e;if(-1===s.indexOf(":")){const e=parseInt(s.replace(/[^0-9]/g,""),10)-1,t=_a.ABCatNum(s.replace(/[^A-Za-z]/g,""));return Number.isNaN(e)||Number.isNaN(t)?Ga:{sheetId:o,rangeData:{startRow:e,endRow:e,startColumn:t,endColumn:t}}}s=s.split(":");const l=[0,0],c=[0,0],u=(null==(t=this.getSheetBySheetName(o))?void 0:t.getMaxRows())||(null==(n=this.getActiveSheet())?void 0:n.getMaxRows()),h=(null==(r=this.getSheetBySheetName(o))?void 0:r.getMaxColumns())||(null==(a=this.getActiveSheet())?void 0:a.getMaxColumns());return l[0]=parseInt(s[0].replace(/[^0-9]/g,""),10)-1,l[1]=parseInt(s[1].replace(/[^0-9]/g,""),10)-1,Number.isNaN(l[0])&&(l[0]=0),Number.isNaN(l[1])&&(l[1]=u),l[0]>l[1]||(c[0]=_a.ABCatNum(s[0].replace(/[^A-Za-z]/g,"")),c[1]=_a.ABCatNum(s[1].replace(/[^A-Za-z]/g,"")),Number.isNaN(c[0])&&(c[0]=0),Number.isNaN(c[1])&&(c[1]=h),c[0]>c[1])?Ga:{sheetId:(null==(i=this.getSheetBySheetName(o))?void 0:i.getSheetId())||"",rangeData:{startRow:l[0],endRow:l[1],startColumn:c[0],endColumn:c[1]}}}getUnitId(){return this._unitId}getWorksheets(){return this._worksheets}nextSheet(e){if(e>=0){const{sheetOrder:t}=this._config;for(let n=e;n<t.length;n++){const e=this._worksheets.get(t[n]);if(e&&!e.isSheetHidden())return e}if(e<t.length)for(let n=e-1;n>=0;n--){const e=this._worksheets.get(t[n]);if(e&&!e.isSheetHidden())return e}return this._worksheets.get(t[t.length-1])}}setContext(e){this._context=e}setCommandManager(e){this._commandManager=e}insertSheet(...e){const{_context:t,_commandManager:n}=this,r=t.getContextObserver("onBeforeInsertSheetObservable"),a=t.getContextObserver("onAfterInsertSheetObservable");if(_a.hasLength(e,0)){const e={name:Qo.getSheetName(),status:0,id:vo(6)},i=this.getSheetSize();return r.notifyObservers({index:i,sheetId:e.id}),n.invoke(new xs(t.getWorkBook(),{actionName:Ya.INSERT_SHEET_ACTION,sheetId:e.id,index:i,sheet:e})),a.notifyObservers({index:i,sheetId:e.id}),e.id}if(_a.hasLength(e,1)){if(_a.isAssignableFrom(e[0],wo)){const i=e[0],o=this.getSheetSize(),s=i.getConfig();return s.id=vo(6),r.notifyObservers({index:o,sheetId:s.id}),n.invoke(new xs(t.getWorkBook(),{actionName:Ya.INSERT_SHEET_ACTION,sheetId:s.id,index:o,sheet:s})),a.notifyObservers({index:o,sheetId:s.id}),s.id}if(_a.isNumber(e[0])){const i=e[0],o={name:Qo.getSheetName(),status:0,id:vo(6)};return r.notifyObservers({index:i,sheetId:o.id}),n.invoke(new xs(t.getWorkBook(),{actionName:Ya.INSERT_SHEET_ACTION,sheetId:o.id,index:i,sheet:o})),a.notifyObservers({index:i,sheetId:o.id}),o.id}if(_a.isString(e[0])){const i=e[0],o=this.getSheetSize(),s={status:0,name:i,id:vo(6)};return r.notifyObservers({index:o,sheetId:s.id}),n.invoke(new xs(t.getWorkBook(),{actionName:Ya.INSERT_SHEET_ACTION,sheetId:s.id,index:o,sheet:s})),a.notifyObservers({index:o,sheetId:s.id}),s.id}if(_a.isPlainObject(e[0])){const i=e[0],o=this.getSheetSize();return r.notifyObservers({index:o,sheetId:i.id}),n.invoke(new xs(t.getWorkBook(),{actionName:Ya.INSERT_SHEET_ACTION,sheetId:i.id,index:o,sheet:i})),a.notifyObservers({index:o,sheetId:i.id}),i.id}}if(_a.hasLength(e,2)){if(_a.isString(e[0])){const i=e[0],o=e[1],s={status:0,name:i,id:vo(6)};return r.notifyObservers({index:o,sheetId:s.id}),n.invoke(new xs(t.getWorkBook(),{actionName:Ya.INSERT_SHEET_ACTION,sheetId:s.id,index:o,sheet:s})),a.notifyObservers({index:o,sheetId:s.id}),s.id}if(_a.isNumber(e[0])){if(_a.isAssignableFrom(e[1],wo)){const i=e[0],o=e[1].getConfig();return o.id=vo(6),r.notifyObservers({index:i,sheetId:o.id}),n.invoke(new xs(t.getWorkBook(),{actionName:Ya.INSERT_SHEET_ACTION,sheetId:o.id,index:i,sheet:o})),a.notifyObservers({index:i,sheetId:o.id}),o.id}if(_a.isPlainObject(e[1])){const i=e[0],o=e[1];return r.notifyObservers({index:i,sheetId:o.id}),n.invoke(new xs(t.getWorkBook(),{actionName:Ya.INSERT_SHEET_ACTION,sheetId:o.id,index:i,sheet:o})),a.notifyObservers({index:i,sheetId:o.id}),o.id}}}}getActiveSpreadsheet(){return this}getStyles(){return this._styles}getContext(){return this._context}getConfig(){return this._config}create(...e){if(_a.hasLength(e,1)){const{_context:t}=this,n=e[0],r={...ja,name:n},a=new wo(t,r);return this.insertSheet(a),a}if(_a.hasLength(e,3)){const{_context:t}=this,n=e[0],r=e[1],a=e[2],i={...ja,name:n,rowCount:r,columnCount:a},o=new wo(t,i);return this.insertSheet(o),o}}setDefaultActiveSheet(){this._setDefaultActiveSheet()}getIndexBySheetId(e){const{sheetOrder:t}=this._config;return t.findIndex((t=>t===e))}getActiveSheet(){const{sheetOrder:e}=this._config,t=e.find((e=>this._worksheets.get(e).getStatus()===ka.TRUE));return t?this._worksheets.get(t):(console.warn("No active sheet, get first sheet"),this._worksheets[0])}getActiveSheetIndex(){const{sheetOrder:e}=this._config;return e.findIndex((e=>1===this._worksheets.get(e).getStatus()))}getActiveRange(){const e=this.getActiveSheet();return e?e.getSelection().getActiveRange():null}setActiveRange(e){const t=this.getActiveSheet();return t?t.setActiveSelection(e):null}setActiveRangeList(e){const t=this.getActiveSheet();if(t){const n=t.getRangeList(e);return n.activate(),n.getRangeList()}return null}getActiveRangeList(){const e=this.getActiveSheet();return e?e.getSelection().getActiveRangeList():null}getSelection(){const e=this.getActiveSheet();if(e)return e.getSelection()}getCurrentCell(){const e=this.getSelection();if(e)return e.getCurrentCell()}getSheetSize(){return this._config.sheetOrder.length}setCurrentCell(e){return e.activateAsCurrentCell()}flush(){}setSheetOrder(e,t){const{_context:n,_commandManager:r}=this,a=n.getContextObserver("onSheetOrderObservable"),i={actionName:Ya.SET_SHEET_ORDER_ACTION,sheetId:e,order:t},o=new xs(n.getWorkBook(),i);r.invoke(o),a.notifyObservers()}getSheets(){const{sheetOrder:e}=this._config;return e.map((e=>this._worksheets.get(e)))}getSheetIndex(e){const{sheetOrder:t}=this._config;return t.findIndex((t=>e.getSheetId()===t))}removeSheetBySheetId(e){const{_commandManager:t,_config:n}=this,{sheetOrder:r}=n,a=this.getSheetBySheetId(e);if(r.length>1&&null!=a){const n=this.getSheetIndex(a),r=this.getContext().getContextObserver("onBeforeRemoveSheetObservable"),i=this.getContext().getContextObserver("onAfterRemoveSheetObservable");if(r.notifyObservers({index:n}),t.invoke(new xs(this,{actionName:Ya.REMOVE_SHEET_ACTION,sheetId:e})),a.getStatus()===ka.TRUE){const e=this.nextSheet(n);e&&e.activate()}i.notifyObservers({index:n,sheetId:e})}}getSheetBySheetName(e){const{sheetOrder:t}=this._config,n=t.find((t=>this._worksheets.get(t).getName()===e));return this._worksheets.get(n)}getSheetBySheetId(e){return this._worksheets.get(e)}setActiveSheet(...e){let t=!1;const n=e[0];return ro.checkup(e,wo,ro.BOOLEAN_TYPE)&&(t=e[1]),n.activate(),t&&n.setActiveSelection(),n}getCommandManager(){return this._commandManager}getPluginMeta(e){return this._config.pluginMeta[e]}setPluginMeta(e,t){return this._config.pluginMeta||(this._config.pluginMeta={}),this._config.pluginMeta[e]=t}static isIRangeType(e){return"string"==typeof e||"startRow"in e||"row"in e}transformRangeType(e){return"string"==typeof e?this._getCellRange(e):"string"!=typeof e&&"row"in e?{sheetId:"",rangeData:{startRow:e.row[0],startColumn:e.column[0],endRow:e.row[1],endColumn:e.column[1]}}:"string"!=typeof e&&"startRow"in e?{sheetId:"",rangeData:e}:Ga}static rangeDataToRangeStringData(e){const{startRow:t,endRow:n,startColumn:r,endColumn:a}=e;return`${_a.chatAtABC(r)+(t+1)}:${_a.chatAtABC(a)}${n+1}`}load(e){this._config=e}save(){return this._config}}function Ao(e){if(!e)return;let{row:t,column:n,startY:r,endY:a,startX:i,endX:o,isMerged:s,mergeInfo:l}=e,c=t,u=n,h=t,d=n;if(s&&l){const{startRow:e,startColumn:t,endRow:n,endColumn:s,startY:p,endY:m,startX:_,endX:g}=l;c=e,u=t,h=n,d=s,r=p,a=m,i=_,o=g}return{startRow:c,startColumn:u,endRow:h,endColumn:d,startY:r,endY:a,startX:i,endX:o}}function So(e){return!e||0===((null==e?void 0:e.m)||"").length&&!e.p}function Do(e){if(e){if(e.rgb)return e.rgb;if(e.th)return(new Ba).setThemeColor(e.th).asThemeColor().asRgbColor().getCssString()}return null}function Ro(e){return null!=e}function No(e){return e instanceof FormData}const Mo=()=>{},Oo=e=>e;const ko={type:"POST",url:"",async:!0,header:{},dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:{},username:"",password:"",timeout:500,error:Mo,beforeSend:Oo,dataFilter:Oo,success:Mo,complete:Mo};function Io(e){return new Promise(((t,n)=>{const r=function(e,...t){for(const n of t)if(n)for(const t in n)n.hasOwnProperty(t)&&Ro(n[t])&&(e[t]=n[t]);return e}({},ko,e),a=new XMLHttpRequest;switch(r.beforeSend(r),a.responseType=r.dataType,a.timeout=r.timeout,a.addEventListener("readystatechange",(e=>{if(4===a.readyState)if(200===a.status){const e=r.dataFilter(a.response);r.success(e),r.complete(),t(e)}else r.error(e),n(e)})),a.addEventListener("timeout",(e=>{r.error(e)})),a.open(r.type,r.url,r.async,r.username,r.password),Object.keys(r.header).forEach((e=>{const t=r.header[e];a.setRequestHeader(e,t)})),No(r.data)?a.setRequestHeader("Content-Type","multipart/form-data"):r.contentType&&a.setRequestHeader("Content-Type",r.contentType),r.type){case"DELETE":case"GET":a.send();break;case"POST":case"PUT":if(function(e){return!!e&&Object.getPrototypeOf(e)===Object.getPrototypeOf({})}(r.data))return void a.send(JSON.stringify(r.data));if(function(e){return"[object String]"===Object.prototype.toString.apply(e)}(r.data))return void a.send(r.data);if(function(e){return"[object Array]"===Object.prototype.toString.apply(e)}(r.data))return void a.send(JSON.stringify(r.data));No(r.data)&&a.send(r.data)}}))}function Po(e){return null!=e}var Lo=(e=>(e.MESSAGE="message",e.OPEN="open",e.CLOSE="close",e.ERROR="error",e.RETRY="retry",e.DESTROY="destroy",e))(Lo||{});const Bo={url:"",heartbeatTime:6e3};class Fo{constructor(e){Qr(this,"_config"),Qr(this,"_listens"),Qr(this,"_timer"),Qr(this,"_socket");const t=function(e,...t){for(const n of t)if(n)for(const t in n)n.hasOwnProperty(t)&&Po(n[t])&&(e[t]=n[t]);return e}({},Bo,e);if(function(e){return function(e){return null==e}(e)||""===e.toString()}(t.url))throw new Error("url must be input");this._listens=new Map,this._timer=-1,this._config=e}_create(){const{_config:e}=this;this._socket=new WebSocket(e.url)}_bind(){this._socket.addEventListener("message",this._message),this._socket.addEventListener("open",this._open),this._socket.addEventListener("close",this._close),this._socket.addEventListener("error",this._error)}_message(e){const t=this._listens.get("message");t&&t(e)}_open(e){const t=this._listens.get("open");t&&(t(e),this._heartbeat())}_error(e){const t=this._listens.get("error");t&&(t(e),this._retry())}_close(e){const t=this._listens.get("close");t&&(t(e),this.destroy())}_clear(){this._timer>-1&&clearInterval(this._timer),this._timer=-1,this._socket.removeEventListener("message",this._message),this._socket.removeEventListener("open",this._open),this._socket.removeEventListener("close",this._close),this._socket.removeEventListener("error",this._error),this._socket.close()}_heartbeat(){const{_socket:e,_config:t}=this,{heartbeatTime:n}=t;this._timer=setInterval((function(){e.send("heartbea_message")}),n)}_retry(){const e=this._listens.get("retry");e&&e(),this._clear(),this._create(),this._bind()}link(){this._create(),this._bind()}send(e){this._socket.send(e)}destroy(){const e=this._listens.get("destroy");e&&e(),this._clear(),this._listens.clear()}on(e,t){this._listens[e]=t}}const Ho=Object.keys(ei).reduce(((e,t)=>[...e,...ei[t]]),[]);const qo={},Uo={};class Vo{constructor(){Qr(this,"options")}initialize(e){this.options={currentLocale:e||["zh","zh-CN"].includes(_a.getLanguage())?Ea.ZH:Ea.EN,locales:{zh:qo,en:Uo}}}get(e){if(e){const{locales:t,currentLocale:n}=this.options;return Vo.getValue(t[n],e)||""}return String()}getObject(e){const{locales:t,currentLocale:n}=this.options;return Vo.getValue(t[n],e)}load(e){_a.deepMerge(this.options.locales,e)}change(e){this.options.currentLocale=e}static getValue(e,t){try{return e[t]?e[t]:t.split(".").reduce(((e,t)=>e[t]),e)}catch{console.error("Key %s not found",t)}}}class Wo{static info(...e){console&&console.log(...e)}static error(...e){console&&console.error(...e)}static warn(...e){console&&console.warn(...e)}static br(){Wo.info("\n")}static capsule(e,t,n="",r=""){console&&console.log(`%c${n}%c${e}%c${t}%c${r}`,"","padding:3px;color:white;background:#023047","padding:3px;color:white;background:#219EBC","")}}const zo=Symbol("newer"),Yo=Symbol("older");class Go{constructor(e){Qr(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[zo],{done:!1,value:e.key}):{done:!0,value:void 0}}}class Xo{constructor(e){Qr(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[zo],{done:!1,value:e.value}):{done:!0,value:void 0}}}class $o{constructor(e){Qr(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[zo],{done:!1,value:[e.key,e.value]}):{done:!0,value:void 0}}}class jo{constructor(...e){if(Qr(this,"_keymap"),Qr(this,"size"),Qr(this,"limit"),Qr(this,"oldest"),Qr(this,"newest"),Te.hasLength(e,1)){if(Te.isNumber(e[0])){const t=e[0];return void this._initialize(t,void 0)}if(Te.isIterable(e[0])){const t=e[0];return void this._initialize(0,t)}}else if(Te.hasLength(e,2)){const t=e[0],n=e[1];this._initialize(t,n)}}_initialize(e,t){this.oldest=void 0,this.newest=void 0,this.size=0,this.limit=e,this._keymap=new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}_markEntryAsUsed(e){e!==this.newest&&(e[zo]&&(e===this.oldest&&(this.oldest=e[zo]),e[zo][Yo]=e[Yo]),e[Yo]&&(e[Yo][zo]=e[zo]),e[zo]=void 0,e[Yo]=this.newest,this.newest&&(this.newest[zo]=e),this.newest=e)}assign(e){let t,n=this.limit||Number.MAX_VALUE;this._keymap.clear();let r=e[Symbol.iterator]();for(let e=r.next();!e.done;r.next()){let r=new _s(e.value[0],e.value[1]);if(this._keymap.set(r.key,r),t?(t[zo]=r,r[Yo]=t):this.oldest=r,r,0==n--)throw new Error("overflow")}this.newest=t,this.size=this._keymap.size}set(e,t){let n=this._keymap.get(e);return n?(n.value=t,this._markEntryAsUsed(n),this):(this._keymap.set(e,new _s(e,t)),this.newest?(this.newest[zo]=n,n[Yo]=this.newest):this.oldest=n,this.newest=n,++this.size,this.size>this.limit&&this.shift(),this)}shift(){let e=this.oldest;if(e)return this.oldest&&this.oldest[zo]?(this.oldest=this.oldest[zo],this.oldest[Yo]=void 0):(this.oldest=void 0,this.newest=void 0),e[zo]=e[Yo]=void 0,this._keymap.delete(e.key),--this.size,[e.key,e.value]}get(e){const t=this._keymap.get(e);if(t)return this._markEntryAsUsed(t),t.value}has(e){return this._keymap.has(e)}find(e){let t=this._keymap.get(e);return t?t.value:void 0}delete(e){let t=this._keymap.get(e);if(t)return this._keymap.delete(t.key),t[zo]&&t[Yo]?(t[Yo][zo]=t[zo],t[zo][Yo]=t[Yo]):t[zo]?(t[zo][Yo]=void 0,this.oldest=t[zo]):t[Yo]?(t[Yo][zo]=void 0,this.newest=t[Yo]):this.oldest=this.newest=void 0,this.size--,t.value}clear(){this.oldest=void 0,this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new Go(this.oldest)}values(){return new Xo(this.oldest)}entries(){return this[Symbol.iterator]()}[Symbol.iterator](){return new $o(this.oldest)}forEach(e,t){"object"!=typeof t&&this;let n=this.oldest;for(;n;)e.call(t,n.value,n.key,this),n[zo]}toJSON(){let e=new Array(this.size),t=0,n=this.oldest;for(;n;)e[t++]={key:n.key,value:n.value},n[zo];return e}toString(){let e=String(),t=this.oldest;for(;t;)`${String(t.key)}:${t.value}`,t[zo],t&&" < ";return e}}const Ko=[];let Zo=0;class Qo{static _generateName(){return"sheet"+ ++Zo}static _checkedName(e){const t=Ko.includes(e);return t||Ko.push(e),t}static getSheetName(e){for(void 0===e&&(e=Qo._generateName());Qo._checkedName(e);)e=Qo._generateName();return e}}const Jo="A".charCodeAt(0),es="Z".charCodeAt(0),ts="a".charCodeAt(0);function ns(e){const t=es-Jo+1;let n="";for(;e>=0;)n=String.fromCharCode(e%t+Jo)+n,e=Math.floor(e/t)-1;return n}function rs(e,t=!1){const n=es-Jo+1;let r=ts;t&&(r=Jo);return function(e,t){let n="";for(;t>0;)n+=e,t--;return n}(String.fromCharCode(e%n+r),Math.floor(e/n)+1)}class as{static fromSequence(e){if(_a.isObject(e)&&as.requiredNewInstance(this))return this.newInstance(e);if(_a.isArray(e)&&as.requiredNewInstance(this)){const t=this;return e.map((e=>t.newInstance(e)))}return[]}toSequence(){return{className:_a.getClassName(this)}}}function is(e,t){return e.zIndex>t.zIndex?1:e.zIndex===t.zIndex?0:-1}function os(e,t){return e.zIndex>t.zIndex?-1:e.zIndex===t.zIndex?0:1}(e=>{e.requiredNewInstance=function(e){if(_a.isDefine(e.newInstance))return!0;throw new Error("sequence newInstance need subclass implement!")}})(as||(as={}));Qr(class{static GetClass(e){return this.RegisteredTypes&&this.RegisteredTypes[e]?this.RegisteredTypes[e]:null}},"RegisteredTypes",{});class ss{constructor(e,t,n){Qr(this,"namespace"),Qr(this,"path"),Qr(this,"observable"),this.path=e,this.namespace=t,this.observable=n}}class ls{constructor(){Qr(this,"_observableArray",[])}hasObserver(e,t){return null!=this.getObserver(e,t)}getObserver(...e){if(1===e.length){const t=e[0],n=this._observableArray.find((e=>e.path===t));return n?n.observable:null}if(2===e.length){const t=e[0],n=e[1],r=this._observableArray.find((e=>e.path===t&&e.namespace===n));return r?r.observable:null}}requiredObserver(...e){if(_a.hasLength(e,1)){const t=e[0],n=this.getObserver(t);if(null==n)throw new Error(`not found observable ${t}`);return n}if(_a.hasLength(e,2)){const t=e[0],n=e[1],r=this.getObserver(t,n);if(null==r)throw new Error(`not found observable ${t}`);return r}throw new Error("requiredObserver arguments error")}removeObserver(...e){if(_a.hasLength(e,1)){const t=e[0],n=this._observableArray.findIndex((e=>e.path===t));n>-1&&this._observableArray.splice(n,1)}else if(_a.hasLength(e,2)){const t=e[0],n=e[1],r=this._observableArray.findIndex((e=>e.path===t&&e.namespace===n));r>-1&&this._observableArray.splice(r,1)}}addObserver(...e){if(1===e.length){const t=e[0],n=e[1];return this.hasObserver(t,t)&&this.removeObserver(t),void this._observableArray.push(new ss(t,t,n))}if(3===e.length){const t=e[0],n=e[1],r=e[2];this.hasObserver(t,t)&&this.removeObserver(t,n),this._observableArray.push(new ss(t,n,r))}}}var cs=(e=>(e[e.REDO=0]="REDO",e[e.UNDO=1]="UNDO",e))(cs||{});class us extends aa{}class hs extends aa{}class ds extends aa{}class ps{constructor(e){Qr(this,"_undoManager"),this._undoManager=e.getUndoManager()}static staticInitialize(){this._actionClass=new Map,this._actionObservers=new us,this._commandObservers=new hs,this._commandInjectorObservers=new ds}static getAction(e){return this._actionClass[e]}static getActionObservers(){return this._actionObservers}static getCommandObservers(){return this._commandObservers}static register(e,t){this._actionClass[e]=t}static getCommandInjectorObservers(){return this._commandInjectorObservers}undo(){const{_undoManager:e}=this,t=e.undo();t&&t.undo()}redo(){const{_undoManager:e}=this,t=e.redo();t&&t.redo()}invoke(e){const{_undoManager:t}=this;e.invoke(),t.push(e)}}Qr(ps,"_actionClass"),Qr(ps,"_commandObservers"),Qr(ps,"_actionObservers"),Qr(ps,"_commandInjectorObservers"),ps.staticInitialize();class ms{constructor(){Qr(this,"_data",[])}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new ms}}const gs=ms.create();class fs{constructor(){Qr(this,"_actionExtensionFactoryList",[])}get actionExtensionFactoryList(){return this._actionExtensionFactoryList}initialize(){this._initExtensions()}add(...e){this._actionExtensionFactoryList.push(...e),this._actionExtensionFactoryList.sort(is)}delete(e){const t=this._actionExtensionFactoryList.indexOf(e);this._actionExtensionFactoryList.splice(t,1)}_initExtensions(){this._actionExtensionFactoryList.push(...gs.getData().sort(is))}}const ys=class{constructor(){Qr(this,"_actionExtensionFactoryList")}handle(e){var t;const n=null==(t=null==ys?void 0:ys.register)?void 0:t.actionExtensionFactoryList;!n||(this._actionExtensionFactoryList=n,this._checkExtension(e))}_checkExtension(e){if(!this._actionExtensionFactoryList)return!1;e.forEach((t=>{this._actionExtensionFactoryList.forEach((n=>{const r=n.check(t,e);!1!==r&&r.execute()}))}))}static create(){return this.register||(this.register=new fs,this.register.initialize()),this.register}};let vs=ys;Qr(vs,"register");class bs{constructor(e){Qr(this,"_actions"),(new vs).handle(e)}getDoData(){return this._actions.map((e=>e.getDoActionData()))}getOldData(){return this._actions.map((e=>e.getOldActionDaa()))}getInjector(){const e=this;return new class{injectAction(t){e._actions.push(t)}getActions(){return e._actions.concat([])}include(t){for(let n=0;n<e._actions.length;n++)if(e._actions[n]instanceof t)return e._actions[n];return null}}}redo(){this._actions.forEach((e=>e.redo())),ps.getCommandObservers().notifyObservers({type:cs.REDO,actions:this._actions})}undo(){this._actions.forEach((e=>e.undo())),ps.getCommandObservers().notifyObservers({type:cs.UNDO,actions:this._actions})}invoke(){ps.getCommandInjectorObservers().notifyObservers(this.getInjector()),ps.getCommandObservers().notifyObservers({type:cs.REDO,actions:this._actions})}}class xs extends bs{constructor(e,...t){super(t),Qr(this,"unit"),this.unit=e,this._actions=[],t.forEach((t=>{const n=ps.getAction(t.actionName),r=ps.getActionObservers(),a=new n(t,e,r);this._actions.push(a)}))}}class ws{constructor(){Qr(this,"_undoStack"),Qr(this,"_redoStack"),this._undoStack=[],this._redoStack=[]}push(e){this._redoStack.push(e)}undo(){const e=this._redoStack.pop();if(e)return this._undoStack.push(e),e}redo(){const e=this._undoStack.pop();if(e)return this._redoStack.push(e),e}}ps.register(Ya.INSERT_ROW_DATA_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,rowCount:ca.getMaxLength(e.rowData[0]),convertor:[]},this.validate()}do(){const e=this.getWorkSheet();pi(this._doActionData.rowIndex,this._doActionData.rowData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();bi(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.INSERT_ROW_ACTION,Zi),ps.register(Ya.REMOVE_ROW_DATA_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,rowData:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=bi(this._doActionData.rowIndex,this._doActionData.rowCount,e.getCellMatrix().toJSON());return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();pi(this._oldActionData.rowIndex,this._oldActionData.rowData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.REMOVE_ROW_ACTION,Ji),ps.register(Ya.SET_RANGE_STYLE_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._oldActionData={...e,value:this.do()},this.validate()}do(){const{value:e,rangeData:t}=this._doActionData,n=this._workbook.getStyles(),r=Ri(this.getWorkSheet().getCellMatrix(),e,t,n);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),r}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:Ya.SET_RANGE_STYLE_ACTION,sheetId:e,value:this.do(),rangeData:t}}undo(){const{value:e,rangeData:t,sheetId:n}=this._oldActionData,r=this._workbook.getStyles(),a=this.getWorkSheet().getCellMatrix();this._doActionData={actionName:Ya.SET_RANGE_STYLE_ACTION,sheetId:n,value:Ri(a,e,t,r),rangeData:t},this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.SET_WORKSHEET_STATUS_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,sheetStatus:this.do(),convertor:[]},this.validate()}do(){const e=Xi(this.getWorkSheet(),this._doActionData.sheetStatus);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:Ya.SET_WORKSHEET_STATUS_ACTION,sheetStatus:this.do()}}undo(){const{sheetStatus:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:Ya.SET_WORKSHEET_STATUS_ACTION,sheetId:t,sheetStatus:Xi(n,e)},this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.SET_SELECTION_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new oi(Za)]};const{activeRangeList:r,activeRange:a,currentCell:i}=this.do();this._oldActionData={...e,activeRangeList:r,activeRange:a,currentCell:i},this.validate()}do(){const{activeRangeList:e,activeRange:t,currentCell:n}=this._doActionData,r=Ui(this.getWorkSheet(),e,t,n);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),r}redo(){const{sheetId:e}=this._doActionData,{activeRangeList:t,activeRange:n,currentCell:r}=this.do();this._oldActionData={actionName:Ya.SET_SELECTION_ACTION,sheetId:e,activeRangeList:t,activeRange:n,currentCell:r}}undo(){const{activeRangeList:e,activeRange:t,currentCell:n,sheetId:r}=this._oldActionData,a=Ui(this.getWorkSheet(),e,t,n);this._doActionData={actionName:Ya.SET_SELECTION_ACTION,sheetId:r,activeRangeList:a.activeRangeList,activeRange:a.activeRange,currentCell:a.currentCell},this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.SET_RANGE_DATA_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new oi(Za)]},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=this._workbook.getStyles(),n=Ii(e.getCellMatrix(),this._doActionData.cellValue,this._doActionData.rangeData,t,this._doActionData.options);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),n}redo(){const{sheetId:e,rangeData:t,options:n}=this._doActionData;this._oldActionData={actionName:Ya.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:this.do(),rangeData:t,options:n}}undo(){const{rangeData:e,sheetId:t,cellValue:n,options:r}=this._oldActionData,a=this.getWorkSheet(),i=this._workbook.getStyles();a&&(this._doActionData={actionName:Ya.SET_RANGE_DATA_ACTION,sheetId:t,cellValue:Ii(a.getCellMatrix(),n,e,i),rangeData:e,options:r},this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}),ps.register(Ya.SET_RANGE_FORMATTED_VALUE_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new oi(Za)]},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=Fi(this.getWorkSheet().getCellMatrix(),this._doActionData.cellValue,this._doActionData.rangeData);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:Ya.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellValue:n}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:Ya.SET_RANGE_DATA_ACTION,sheetId:t,cellValue:Fi(r.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}),ps.register(Ya.DELETE_RANGE_ACTION,ji),ps.register(Ya.CLEAR_RANGE_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,cellValue:this.do(),convertor:[]},this.validate()}do(){const e=function(e,t,n){const{startRow:r,endRow:a,startColumn:i,endColumn:o}=n,s=new ha;for(let n=r;n<=a;n++)for(let r=i;r<=o;r++){const a=e.getValue(n,r);s.setValue(n,r,_a.deepClone(a)),a&&(t.formatOnly&&delete a.s,t.contentsOnly&&(a.v="",a.m=""),e.setValue(n,r,_a.deepClone(a)))}return s.getData()}(this.getWorkSheet().getCellMatrix(),this._doActionData.options,this._doActionData.rangeData);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:Ya.SET_RANGE_DATA_ACTION,sheetId:e,rangeData:t,cellValue:this.do(),convertor:[new oi(Qa)]}}undo(){const e=this.getWorkSheet(),{rangeData:t,cellValue:n}=this._oldActionData,r=this._workbook.getStyles();e&&(Ii(e.getCellMatrix(),n,t,r),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}),ps.register(Ya.INSERT_RANGE_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet();e&&(mi({rowCount:e.getLastRow(),columnCount:e.getLastColumn()},e.getCellMatrix(),this._doActionData.shiftDimension,this._doActionData.rangeData,this._doActionData.cellValue),this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}))}redo(){this.do()}undo(){const{rangeData:e,sheetId:t,shiftDimension:n}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:Ya.SET_RANGE_DATA_ACTION,sheetId:t,cellValue:ci({rowCount:r.getLastRow(),columnCount:r.getLastColumn()},r.getCellMatrix(),n,e),rangeData:e,shiftDimension:n},this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}),ps.register(Ya.SET_TAB_COLOR_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new oi(Za)]},this._oldActionData={...e,color:this.do()},this.validate()}do(){const e=zi(this.getWorkSheet(),this._doActionData.color);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:Ya.SET_TAB_COLOR_ACTION,color:this.do()}}undo(){const{color:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:Ya.SET_TAB_COLOR_ACTION,sheetId:t,color:zi(n,e)},this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.HIDE_SHEET_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,hidden:this.do(),convertor:[]},this.validate()}do(){const e=ui(this.getWorkSheet(),this._doActionData.hidden);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:Ya.HIDE_SHEET_ACTION,hidden:this.do()}}undo(){const{hidden:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:Ya.HIDE_SHEET_ACTION,sheetId:t,hidden:ui(n,e)},this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.SET_WORKSHEET_ACTIVATE_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]};const{oldSheetId:r,status:a}=this.do();this._oldActionData={...e,sheetId:r,status:a,convertor:[]},this.validate(),this.removeOperation(Jr.SERVER_ACTION)}do(){const{sheetId:e,status:t}=this._doActionData,n=Yi(this._workbook.getSheetBySheetId(e));return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),n}redo(){const{oldSheetId:e,status:t}=this.do();this._oldActionData={actionName:Ya.SET_WORKSHEET_ACTIVATE_ACTION,sheetId:e,status:t}}undo(){const{sheetId:e}=this._oldActionData;this._oldActionData.status;const t=this._workbook.getSheetBySheetId(e);if(t){const{oldSheetId:e,status:n}=Yi(t);this._doActionData={actionName:Ya.SET_WORKSHEET_ACTIVATE_ACTION,sheetId:e,status:n},this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}}validate(){return!1}}),ps.register(Ya.SET_HIDE_ROW_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet();Si(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Wi(this._oldActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.SET_SHOW_ROW_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet();Wi(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Si(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.SET_HIDE_COLUMN_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet();Ti(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Ci(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.SET_SHOW_COLUMN_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet();Ci(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Ti(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.ADD_MERGE_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new oi(Qa)]},this._oldActionData={...e,rectangles:this.do(),convertor:[new oi(Ja)]},this.validate()}do(){return ri(this.getWorkSheet().getMerges(),this._doActionData.rectangles)}redo(){this.do()}undo(){ai(this.getWorkSheet().getMerges(),this._doActionData.rectangles)}validate(){return!1}}),ps.register(Ya.REMOVE_MERGE_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,rectangles:this.do(),convertor:[]},this.validate()}do(){const e=ai(this.getWorkSheet().getMerges(),this._doActionData.rectangles);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){ri(this.getWorkSheet().getMerges(),this._doActionData.rectangles),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.SET_WORKSHEET_NAME_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,sheetName:this.do(),convertor:[]},this.validate()}do(){const e=Gi(this.getWorkSheet(),this._doActionData.sheetName);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:Ya.SET_WORKSHEET_NAME_ACTION,sheetName:this.do()}}undo(){const{sheetName:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:Ya.SET_WORKSHEET_NAME_ACTION,sheetId:t,sheetName:Gi(n,e)},this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.SET_HIDDEN_GRIDLINES_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,hideGridlines:this.do(),convertor:[]},this.validate()}do(){const e=Ai(this.getWorkSheet(),this._doActionData.hideGridlines);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){this._oldActionData;Ai(this.getWorkSheet(),this._oldActionData.hideGridlines),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.SET_COLUMN_WIDTH_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,columnWidth:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=Ei(this._doActionData.columnIndex,this._doActionData.columnWidth,e.getColumnManager());return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=Ei(this._oldActionData.columnIndex,this._oldActionData.columnWidth,e.getColumnManager());return this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this}),t}validate(){return!1}}),ps.register(Ya.SET_ROW_HEIGHT_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,rowHeight:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=qi(this._doActionData.rowIndex,this._doActionData.rowHeight,e.getRowManager());return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=qi(this._oldActionData.rowIndex,this._oldActionData.rowHeight,e.getRowManager());return this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this}),t}validate(){return!1}}),ps.register(Ya.SET_BORDER_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,styles:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=wi(e.getCellMatrix(),e.getContext().getWorkBook().getStyles(),this._doActionData.styles);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();wi(e.getCellMatrix(),e.getContext().getWorkBook().getStyles(),this._oldActionData.styles),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.SET_RIGHT_TO_LEFT_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,rightToLeft:this.do(),convertor:[]},this.validate()}do(){const e=Hi(this.getWorkSheet(),this._doActionData.rightToLeft);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){this._oldActionData;Hi(this.getWorkSheet(),this._oldActionData.rightToLeft),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.INSERT_COLUMN_DATA_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,columnCount:ca.getMaxLength(e.columnData[0]),convertor:[]},this.validate()}do(){const e=this.getWorkSheet();di(this._doActionData.columnIndex,this._doActionData.columnData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();yi(this._oldActionData.columnIndex,this._oldActionData.columnCount,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.REMOVE_COLUMN_DATA_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new oi(Ja)]},this._oldActionData={...e,columnData:this.do(),convertor:[new oi(Qa)]},this.validate()}do(){const e=this.getWorkSheet(),t=yi(this._doActionData.columnIndex,this._doActionData.columnCount,e.getCellMatrix().toJSON());return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();di(this._oldActionData.columnIndex,this._oldActionData.columnData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),ps.register(Ya.INSERT_COLUMN_ACTION,Ki),ps.register(Ya.REMOVE_COLUMN_ACTION,Qi),ps.register(Ya.DELETE_NAMED_RANGE_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new oi(Za)]},this._oldActionData={actionName:Ya.ADD_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRange:this.do()},this.validate()}do(){const{namedRangeId:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),li(t,e)}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:Ya.ADD_BANDING_ACTION,namedRange:this.do(),convertor:[new oi(Qa)]}}undo(){const{namedRange:e}=this._oldActionData,t=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this}),si(t,e)}validate(){return!1}}),ps.register(Ya.SET_NAMED_RANGE_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new oi(Za)]},this._oldActionData={actionName:Ya.SET_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRange:this.do()},this.validate()}do(){const{namedRange:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),Di(t,e)}redo(){const{sheetId:e,namedRange:t}=this._doActionData;this._oldActionData={actionName:Ya.SET_NAMED_RANGE_ACTION,sheetId:e,namedRange:this.do()}}undo(){const{namedRange:e,sheetId:t}=this._oldActionData,n=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this}),this._doActionData={actionName:Ya.SET_NAMED_RANGE_ACTION,sheetId:t,namedRange:Di(n,e)}}validate(){return!1}}),ps.register(Ya.ADD_NAMED_RANGE_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new oi(Za)]},this.do(),this._oldActionData={actionName:Ya.DELETE_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRangeId:e.namedRange.namedRangeId},this.validate()}do(){const{namedRange:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),si(t,e)}redo(){this.do()}undo(){const{namedRangeId:e,sheetId:t}=this._oldActionData,n=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this}),this._doActionData={actionName:Ya.ADD_NAMED_RANGE_ACTION,sheetId:t,namedRange:li(n,e)}}validate(){return!1}}),ps.register(Ya.SET_RANGE_FORMAT_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new oi(Za)]},this._oldActionData={...e,cellFormat:this.do()},this.validate()}do(){const e=Pi(this.getWorkSheet().getCellMatrix(),this._doActionData.cellFormat,this._doActionData.rangeData);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:Ya.SET_RANGE_FORMAT_ACTION,sheetId:e,cellFormat:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellFormat:n}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:Ya.SET_RANGE_FORMAT_ACTION,sheetId:t,cellFormat:Pi(r.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}),ps.register(Ya.SET_RANGE_FORMULA_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,cellFormula:this.do(),convertor:[]},this.validate()}do(){const e=Li(this.getWorkSheet().getCellMatrix(),this._doActionData.cellFormula,this._doActionData.rangeData);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:Ya.SET_RANGE_FORMULA_ACTION,sheetId:e,cellFormula:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellFormula:n}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:Ya.SET_RANGE_FORMULA_ACTION,sheetId:t,cellFormula:Li(r.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}),ps.register(Ya.SET_RANGE_NOTE_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,cellNote:this.do(),convertor:[]},this.validate()}do(){const e=Bi(this.getWorkSheet().getCellMatrix(),this._doActionData.cellNote,this._doActionData.rangeData);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:Ya.SET_RANGE_NOTE_ACTION,sheetId:e,cellNote:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellNote:n}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:Ya.SET_RANGE_NOTE_ACTION,sheetId:t,cellNote:Bi(r.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}),ps.register(Ya.INSERT_SHEET_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,sheetId:this.do(),convertor:[]}}do(){const e=gi(this.getWorkBook(),this._doActionData.index,this._doActionData.sheet);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),e}redo(){this.redo()}undo(){xi(this.getWorkBook(),this._oldActionData.sheetId),this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){throw new Error("Method not implemented.")}}),ps.register(Ya.REMOVE_SHEET_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,...this.do(),convertor:[]}}do(){return this.redo()}redo(){const e=xi(this.getWorkBook(),this._doActionData.sheetId);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),e}undo(){const e=this.getWorkBook();this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this}),gi(e,this._oldActionData.index,this._oldActionData.sheet)}validate(){throw new Error("Method not implemented.")}}),ps.register(Ya.SET_SHEET_ORDER_ACTION,eo),ps.register(Ya.SET_SHEET_ORDER_ACTION,eo),ps.register(Ya.SET_ZOOM_RATIO_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,zoom:this.do(),convertor:[]},this.validate()}redo(){const e=$i(this.getWorkBook(),this._doActionData.sheetId,this._doActionData.zoom);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),e}do(){return this.redo()}undo(){$i(this.getWorkBook(),this._oldActionData.sheetId,this._oldActionData.zoom),this._observers.notifyObservers({type:cs.REDO,data:this._oldActionData,action:this})}validate(){return!1}});class Ts{constructor(e){Qr(this,"context"),Qr(this,"_name"),Qr(this,"_observeNames"),this._name=e,this._observeNames=[]}onCreate(e){this.context=e}load(e){}save(){return Object()}onMounted(e){}onDestroy(){this.deleteObserve(...this._observeNames)}getPluginName(){return this._name}getContext(){return this.context}getObserver(e){return this.context.getObserverManager().getObserver(e,this._name)}getPluginByName(e){return this.context.getPluginManager().getPluginByName(e)}pushToObserve(...e){const t=this.context.getObserverManager();e.forEach((e=>{this._observeNames.includes(e)||this._observeNames.push(e),t.addObserver(e,this._name,new aa)}))}deleteObserve(...e){const t=this.context.getObserverManager();e.forEach((e=>{t.removeObserver(e,this._name)}))}}class Cs{constructor(e,t=[]){Qr(this,"_context"),Qr(this,"_plugins"),Qr(this,"_initialized"),this._context=e,this._plugins=[],this._initialized=!0,this._plugins=this._plugins.concat(t),this._initialize()}_initialize(){this._initialized&&(this._initialized=!1,this._plugins.forEach((e=>{e.onCreate(this._context),e.onMounted(this._context)})))}install(e){const{_plugins:t}=this;t.push(e),e.onCreate(this._context),e.onMounted(this._context)}uninstall(e){const{_plugins:t}=this,n=t.findIndex((t=>t.getPluginName()===e));if(n>-1){const e=t.splice(n,1)[0];e&&e.onDestroy()}}setContext(e){this._context=e}getRequirePluginByName(e){for(let t=0;t<this._plugins.length;t++)if(this._plugins[t].getPluginName()===e)return this._plugins[t];throw new Error(`not found plugin ${e}`)}getPlugins(){return this._plugins}getPluginByName(e){for(let t=0;t<this._plugins.length;t++)if(this._plugins[t].getPluginName()===e)return this._plugins[t];return null}}class Es{constructor(){Qr(this,"os"),Qr(this,"app_version"),Qr(this,"device_id"),Qr(this,"platform"),Qr(this,"os_version"),this.os="",this.app_version="",this.platform="",this.device_id="",this.os_version=""}}class As{constructor(){Qr(this,"_commandManager"),Qr(this,"_environment"),Qr(this,"_hooksManager"),Qr(this,"_undoManager"),Qr(this,"_locale"),Qr(this,"_pluginManager"),Qr(this,"_observerManager"),this._undoManager=new ws,this._commandManager=new ps(this),this._environment=new Es,this._hooksManager=new oa,this._locale=new Vo,this._pluginManager=new Cs(this),this._observerManager=new ls}getHook(e){return this._hooksManager.getHooks(e)}getLocale(){return this._locale}getHooksManager(){return this._hooksManager}getObserverManager(){return this._observerManager}getPluginManager(){return this._pluginManager}getUndoManager(){return this._undoManager}getCommandManager(){return this._commandManager}}class Ss{constructor(){Qr(this,"_data",[])}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new Ss}}class Ds{install(e){e.addObserver("onAfterSetSelectionObservable","core",new aa),e.addObserver("onBeforeChangeNameObservable","core",new aa),e.addObserver("onAfterChangeNameObservable","core",new aa),e.addObserver("onBeforeChangeActiveSheetObservable","core",new aa),e.addObserver("onAfterChangeActiveSheetObservable","core",new aa),e.addObserver("onBeforeChangeSheetNameObservable","core",new aa),e.addObserver("onAfterChangeSheetNameObservable","core",new aa),e.addObserver("onBeforeInsertSheetObservable","core",new aa),e.addObserver("onAfterInsertSheetObservable","core",new aa),e.addObserver("onBeforeRemoveSheetObservable","core",new aa),e.addObserver("onAfterRemoveSheetObservable","core",new aa),e.addObserver("onBeforeChangeSheetColorObservable","core",new aa),e.addObserver("onAfterChangeSheetColorObservable","core",new aa),e.addObserver("onBeforeChangeSheetDataObservable","core",new aa),e.addObserver("onAfterChangeSheetDataObservable","core",new aa),e.addObserver("onSheetBarDidMountObservable","core",new aa),e.addObserver("onInfoBarDidMountObservable","core",new aa),e.addObserver("onRightMenuDidMountObservable","core",new aa),e.addObserver("onAfterChangeSheetScrollObservable","core",new aa),e.addObserver("onAfterChangeUILocaleObservable","core",new aa),e.addObserver("onSheetRenderDidMountObservable","core",new aa),e.addObserver("onAfterChangeUISkinObservable","core",new aa),e.addObserver("onHideSheetObservable","core",new aa),e.addObserver("onShowSheetObservable","core",new aa),e.addObserver("onSheetTabColorChangeObservable","core",new aa),e.addObserver("onSheetOrderObservable","core",new aa),e.addObserver("onZoomRatioSheetObservable","core",new aa)}}class Rs extends As{constructor(e={}){super(),Qr(this,"_workbook"),this._locale.initialize(e.locale),this._workbook=new Eo(e,this),this._setObserver()}_setObserver(){const e=this.getObserverManager();(new Ds).install(e)}getWorkBook(){return this._workbook}getContextObserver(e){return this.getObserverManager().requiredObserver(e,"core")}}const Ns="dev",Ms="0.0.1";class Os{constructor(e={}){Qr(this,"univerSheetConfig"),Qr(this,"_context"),this.univerSheetConfig=e,this._context=new Rs(e)}static newInstance(e={}){return Wo.capsule(Ns,Ms,"powered by :: universheet :: "),new Os(e)}static get(e){return Io({...e,type:"GET"})}static post(e){return Io({...e,type:"POST"})}static load(e,t){e.getWorkBook().load(t.workbookConfig),e.context.getPluginManager().getPlugins().forEach((e=>{e.load(t[`${e.getPluginName()}Config`])}))}static newColor(){return new Ba}get context(){return this._context}installPlugin(e){this._context.getPluginManager().install(e)}uninstallPlugin(e){this._context.getPluginManager().uninstall(e)}getWorkBook(){return this._context.getWorkBook()}static toJson(e){const t=e.getWorkBook().save(),n={};return e.context.getPluginManager().getPlugins().forEach((e=>{n[`${e.getPluginName()}Config`]=e.save()})),{workbookConfig:t,...n}}}var ks=(e=>(e[e.GLYPH_TYPE_UNSPECIFIED=0]="GLYPH_TYPE_UNSPECIFIED",e[e.NONE=1]="NONE",e[e.DECIMAL=2]="DECIMAL",e[e.ZERO_DECIMAL=3]="ZERO_DECIMAL",e[e.UPPER_ALPHA=4]="UPPER_ALPHA",e[e.ALPHA=5]="ALPHA",e[e.UPPER_ROMAN=6]="UPPER_ROMAN",e[e.ROMAN=7]="ROMAN",e))(ks||{}),Is=(e=>(e[e.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",e[e.START=1]="START",e[e.CENTER=2]="CENTER",e[e.END=3]="END",e))(Is||{}),Ps=(e=>(e[e.PARAGRAPH=0]="PARAGRAPH",e[e.TABLE=1]="TABLE",e[e.SECTION_BREAK=2]="SECTION_BREAK",e[e.CUSTOM=3]="CUSTOM",e))(Ps||{}),Ls=(e=>(e[e.DEFAULT=0]="DEFAULT",e[e.LINES=1]="LINES",e[e.LINES_AND_CHARS=2]="LINES_AND_CHARS",e[e.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",e))(Ls||{}),Bs=(e=>(e[e.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",e[e.CONTINUOUS=1]="CONTINUOUS",e[e.NEXT_PAGE=2]="NEXT_PAGE",e[e.EVEN_PAGE=3]="EVEN_PAGE",e[e.ODD_PAGE=4]="ODD_PAGE",e))(Bs||{}),Fs=(e=>(e[e.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",e[e.NONE=1]="NONE",e[e.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",e))(Fs||{}),Hs=(e=>(e[e.NORMAL=0]="NORMAL",e[e.TBRL=1]="TBRL",e[e.LRTBV=2]="LRTBV",e))(Hs||{}),qs=(e=>(e[e.TEXT_RUN=0]="TEXT_RUN",e[e.AUTO_TEXT=1]="AUTO_TEXT",e[e.PAGE_BREAK=2]="PAGE_BREAK",e[e.COLUMN_BREAK=3]="COLUMN_BREAK",e[e.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",e[e.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",e[e.EQUATION=6]="EQUATION",e[e.DRAWING=7]="DRAWING",e[e.PERSON=8]="PERSON",e[e.RICH_LINK=9]="RICH_LINK",e))(qs||{}),Us=(e=>(e[e.BOTH_SIDES=0]="BOTH_SIDES",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.LARGEST=3]="LARGEST",e))(Us||{}),Vs=(e=>(e[e.INLINE=0]="INLINE",e[e.WRAP_NONE=1]="WRAP_NONE",e[e.WRAP_POLYGON=2]="WRAP_POLYGON",e[e.WRAP_SQUARE=3]="WRAP_SQUARE",e[e.WRAP_THROUGH=4]="WRAP_THROUGH",e[e.WRAP_TIGHT=5]="WRAP_TIGHT",e[e.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",e))(Vs||{}),Ws=(e=>(e[e.NAMED_STYLE_TYPE_UNSPECIFIED=0]="NAMED_STYLE_TYPE_UNSPECIFIED",e[e.NORMAL_TEXT=1]="NORMAL_TEXT",e[e.TITLE=2]="TITLE",e[e.SUBTITLE=3]="SUBTITLE",e[e.HEADING_1=4]="HEADING_1",e[e.HEADING_2=5]="HEADING_2",e[e.HEADING_3=6]="HEADING_3",e[e.HEADING_4=7]="HEADING_4",e[e.HEADING_5=8]="HEADING_5",e[e.HEADING_6=9]="HEADING_6",e))(Ws||{}),zs=(e=>(e[e.AUTO=0]="AUTO",e[e.AT_LEAST=1]="AT_LEAST",e[e.EXACT=2]="EXACT",e))(zs||{}),Ys=(e=>(e.NORMAL="normal",e.BOLD="bold",e.ITALIC="italic",e))(Ys||{}),Gs=(e=>(e[e.CHARACTER=0]="CHARACTER",e[e.COLUMN=1]="COLUMN",e[e.INSIDE_MARGIN=2]="INSIDE_MARGIN",e[e.LEFT_MARGIN=3]="LEFT_MARGIN",e[e.MARGIN=4]="MARGIN",e[e.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",e[e.PAGE=6]="PAGE",e[e.RIGHT_MARGIN=7]="RIGHT_MARGIN",e))(Gs||{}),Xs=(e=>(e[e.BOTTOM_MARGIN=0]="BOTTOM_MARGIN",e[e.INSIDE_MARGIN=1]="INSIDE_MARGIN",e[e.LINE=2]="LINE",e[e.MARGIN=3]="MARGIN",e[e.OUTSIDE_MARGIN=4]="OUTSIDE_MARGIN",e[e.PAGE=5]="PAGE",e[e.PARAGRAPH=6]="PARAGRAPH",e[e.TOP_MARGIN=7]="TOP_MARGIN",e))(Xs||{}),$s=(e=>(e[e.POINT=0]="POINT",e[e.LINE=1]="LINE",e[e.CHARACTER=2]="CHARACTER",e))($s||{}),js=(e=>(e[e.CENTER=0]="CENTER",e[e.INSIDE=1]="INSIDE",e[e.LEFT=2]="LEFT",e[e.OUTSIDE=3]="OUTSIDE",e[e.RIGHT=4]="RIGHT",e))(js||{}),Ks=(e=>(e[e.BOTTOM=0]="BOTTOM",e[e.CENTER=1]="CENTER",e[e.INSIDE=2]="INSIDE",e[e.OUTSIDE=3]="OUTSIDE",e[e.TOP=4]="TOP",e))(Ks||{});var Zs;!function(e){!function(t){var n="object"==typeof io?io:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),r=a(e);function a(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}typeof n.Reflect>"u"?n.Reflect=e:r=a(n.Reflect,r),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",a=n&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",i="function"==typeof Object.create,o={__proto__:[]}instanceof Array,s=!i&&!o,l={create:i?function(){return re(Object.create(null))}:o?function(){return re({__proto__:null})}:function(){return re({})},has:s?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:s?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},c=Object.getPrototypeOf(Function),u="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,h=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,d=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,p=new(u||"function"!=typeof WeakMap?ne():WeakMap);function m(e,t,n,r){if(P(n)){if(!z(e))throw new TypeError;if(!G(t))throw new TypeError;return C(e,t)}if(!z(e))throw new TypeError;if(!F(t))throw new TypeError;if(!F(r)&&!P(r)&&!L(r))throw new TypeError;return L(r)&&(r=void 0),E(e,t,n=W(n),r)}function _(e,t){function n(n,r){if(!F(n))throw new TypeError;if(!P(r)&&!X(r))throw new TypeError;M(e,t,n,r)}return n}function g(e,t,n,r){if(!F(n))throw new TypeError;return P(r)||(r=W(r)),M(e,t,n,r)}function f(e,t,n){if(!F(t))throw new TypeError;return P(n)||(n=W(n)),S(e,t,n)}function y(e,t,n){if(!F(t))throw new TypeError;return P(n)||(n=W(n)),D(e,t,n)}function v(e,t,n){if(!F(t))throw new TypeError;return P(n)||(n=W(n)),R(e,t,n)}function b(e,t,n){if(!F(t))throw new TypeError;return P(n)||(n=W(n)),N(e,t,n)}function x(e,t){if(!F(e))throw new TypeError;return P(t)||(t=W(t)),O(e,t)}function w(e,t){if(!F(e))throw new TypeError;return P(t)||(t=W(t)),k(e,t)}function T(e,t,n){if(!F(t))throw new TypeError;P(n)||(n=W(n));var r=A(t,n,!1);if(P(r)||!r.delete(e))return!1;if(r.size>0)return!0;var a=p.get(t);return a.delete(n),a.size>0||p.delete(t),!0}function C(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!P(r)&&!L(r)){if(!G(r))throw new TypeError;t=r}}return t}function E(e,t,n,r){for(var a=e.length-1;a>=0;--a){var i=(0,e[a])(t,n,r);if(!P(i)&&!L(i)){if(!F(i))throw new TypeError;r=i}}return r}function A(e,t,n){var r=p.get(e);if(P(r)){if(!n)return;r=new h,p.set(e,r)}var a=r.get(t);if(P(a)){if(!n)return;a=new h,r.set(t,a)}return a}function S(e,t,n){if(D(e,t,n))return!0;var r=J(t);return!L(r)&&S(e,r,n)}function D(e,t,n){var r=A(t,n,!1);return!P(r)&&U(r.has(e))}function R(e,t,n){if(D(e,t,n))return N(e,t,n);var r=J(t);return L(r)?void 0:R(e,r,n)}function N(e,t,n){var r=A(t,n,!1);if(!P(r))return r.get(e)}function M(e,t,n,r){A(n,r,!0).set(e,t)}function O(e,t){var n=k(e,t),r=J(e);if(null===r)return n;var a=O(r,t);if(a.length<=0)return n;if(n.length<=0)return a;for(var i=new d,o=[],s=0,l=n;s<l.length;s++){var c=l[s];i.has(c)||(i.add(c),o.push(c))}for(var u=0,h=a;u<h.length;u++){c=h[u];i.has(c)||(i.add(c),o.push(c))}return o}function k(e,t){var n=[],r=A(e,t,!1);if(P(r))return n;for(var a=j(r.keys()),i=0;;){var o=Z(a);if(!o)return n.length=i,n;var s=K(o);try{n[i]=s}catch(e){try{Q(a)}finally{throw e}}i++}}function I(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function P(e){return void 0===e}function L(e){return null===e}function B(e){return"symbol"==typeof e}function F(e){return"object"==typeof e?null!==e:"function"==typeof e}function H(e,t){switch(I(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",a=$(e,r);if(void 0!==a){var i=a.call(e,n);if(F(i))throw new TypeError;return i}return q(e,"default"===n?"number":n)}function q(e,t){if("string"===t){var n=e.toString;if(Y(n))if(!F(a=n.call(e)))return a;if(Y(r=e.valueOf))if(!F(a=r.call(e)))return a}else{var r;if(Y(r=e.valueOf))if(!F(a=r.call(e)))return a;var a,i=e.toString;if(Y(i))if(!F(a=i.call(e)))return a}throw new TypeError}function U(e){return!!e}function V(e){return""+e}function W(e){var t=H(e,3);return B(t)?t:V(t)}function z(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function Y(e){return"function"==typeof e}function G(e){return"function"==typeof e}function X(e){switch(I(e)){case 3:case 4:return!0;default:return!1}}function $(e,t){var n=e[t];if(null!=n){if(!Y(n))throw new TypeError;return n}}function j(e){var t=$(e,a);if(!Y(t))throw new TypeError;var n=t.call(e);if(!F(n))throw new TypeError;return n}function K(e){return e.value}function Z(e){var t=e.next();return!t.done&&t}function Q(e){var t=e.return;t&&t.call(e)}function J(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===c||t!==c)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var a=r.constructor;return"function"!=typeof a||a===e?t:a}function ee(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[a]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,a=n+1;a<r;a++)this._keys[a-1]=this._keys[a],this._values[a-1]=this._values[a];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,i)},t.prototype.entries=function(){return new n(this._keys,this._values,o)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[a]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function i(e,t){return t}function o(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[a]=function(){return this.keys()},e}()}function ne(){var e=16,n=l.create(),r=a();return function(){function e(){this._key=a()}return e.prototype.has=function(e){var t=i(e,!1);return void 0!==t&&l.has(t,this._key)},e.prototype.get=function(e){var t=i(e,!1);return void 0!==t?l.get(t,this._key):void 0},e.prototype.set=function(e,t){return i(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=i(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=a()},e}();function a(){var e;do{e="@@WeakMap@@"+c()}while(l.has(n,e));return n[e]=!0,e}function i(e,n){if(!t.call(e,r)){if(!n)return;Object.defineProperty(e,r,{value:l.create()})}return e[r]}function o(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function s(e){return"function"==typeof Uint8Array?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(e)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(e)):o(new Uint8Array(e),e):o(new Array(e),e)}function c(){var t=s(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<e;++r){var a=t[r];(4===r||6===r||8===r)&&(n+="-"),a<16&&(n+="0"),n+=a.toString(16).toLowerCase()}return n}}function re(e){return e.__=void 0,delete e.__,e}e("decorate",m),e("metadata",_),e("defineMetadata",g),e("hasMetadata",f),e("hasOwnMetadata",y),e("getMetadata",v),e("getOwnMetadata",b),e("getMetadataKeys",x),e("getOwnMetadataKeys",w),e("deleteMetadata",T)}(r)}()}(Zs||(Zs={}));const Qs=class{static register(e,t){let n=Qs.sMap.get(e);n?n.push(t):(n=new Array,n.push(t),Qs.sMap.set(e,n))}static getTable(e){var t;let n=new Array,r=e;for(;null!=r;){const e=null!=(t=Qs.sMap.get(r))?t:[];n=n.concat(e),r=Object.getPrototypeOf(r)}return n}};let Js=Qs;Qr(Js,"sMap",new Map);const el="MessageQueue";class tl{constructor(){Qr(this,"_messages"),this.load()}first(){return this._messages[0]}last(){return this._messages[this._messages.length-1]}size(){return this._messages.length}pop(){this._messages.shift(),this.save()}push(e){this._messages.push(e),this.save()}hasMessage(){return this._messages.length>0}isEmpty(){return!this.hasMessage()}save(){const e=JSON.stringify(this._messages);localStorage.setItem(el,e)}load(){const e=localStorage.getItem(el);e&&(this._messages=JSON.parse(e))}}class nl{static isMessageResponseReceive(e){return"message_response"===e.type}packMessage(e){return{changed:e,version:_a.generateRandomId()}}}var rl=Object.defineProperty,al=Object.getOwnPropertyDescriptor,il=(e,t,n,r)=>{for(var a,i=r>1?void 0:r?al(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&rl(t,n,i),i};const ol=class extends nl{constructor(){super(...arguments),Qr(this,"config"),Qr(this,"globalSendResolve"),Qr(this,"socket"),Qr(this,"status"),Qr(this,"messageQueue")}initialize(){this.messageQueue=new tl,this.status="wait",this.globalSendResolve=()=>{},this.config.socketEnable&&(this.socket=new Fo({url:this.config.socketUrl}),this.socket.on(Lo.MESSAGE,(e=>{this.checkupReceiveMessage(e.data)})),this.socket.on(Lo.ERROR,(()=>{})),this.socket.on(Lo.OPEN,(()=>{})),this.socket.on(Lo.CLOSE,(()=>{})),this.socket.on(Lo.RETRY,(()=>{})),this.socket.on(Lo.DESTROY,(()=>{})),this.socket.link())}getTopMessage(){return this.messageQueue.first()}popTopMessage(){this.messageQueue.pop()}serializeTopMessage(){var e;const t=this.getTopMessage();return null!=(e=JSON.stringify(t))?e:""}checkupReceiveMessage(e){ol.isMessageResponseReceive(e)&&this.getTopMessage().version===e.message.version&&(this.popTopMessage(),this.globalSendResolve())}pushMessageQueue(e){this.config.socketEnable&&(this.messageQueue.push(this.packMessage(e)),this.sendMessageQueue())}async sendTopMessage(){const e=this.serializeTopMessage();return this.socket.send(e),new Promise((e=>this.globalSendResolve=e))}async sendMessageQueue(){const{messageQueue:e,status:t}=this;if("wait"===t){for(this.status="work";e.hasMessage();)await this.sendTopMessage();this.status="wait"}return this.status}};let sl=ol;il([(e,t)=>{Js.register(e,t),Reflect.defineMetadata("AttributeValue",{},e,t)}],sl.prototype,"config",2),il([(e,t,n)=>{Js.register(e,t),Reflect.defineMetadata("PostConstruct",n,e,t)}],sl.prototype,"initialize",1);var ll={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana","微软雅黑","宋体","黑体","楷体","仿宋","新宋体","华文新魏","华文行楷","华文隶书"],defaultFontSize:10.5,unit:"pt"}},cl={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana"],defaultFontSize:9,unit:"pt"}};const ul=[0,0,0],hl=[255,255,255];var dl=(e=>(e.PointerMove="PointerMove",e.PointerDown="PointerDown",e.PointerUp="PointerUp",e.PointerOut="PointerOut",e.PointerLeave="PointerLeave",e.PointerOver="PointerOver",e.PointerEnter="PointerEnter",e.wheel="MouseWheel",e.KeyDown="KeyDown",e.KeyUp="KeyUp",e))(dl||{});const pl={lines:[],drawings:new Map,height:0,st:0,ed:0,marginLeft:0},ml=14;var _l=(e=>(e.DEFAULT="default",e.AUTO="auto",e.CROSSHAIR="crosshair",e.POINTER="pointer",e.MOVE="move",e.EAST_RESIZE="e-resize",e.NORTH_EAST_RESIZE="ne-resize",e.NORTH_WEST_RESIZE="nw-resize",e.NORTH_RESIZE="n-resize",e.SOUTH_EAST_RESIZE="se-resize",e.SOUTH_WEST_RESIZE="sw-resize",e.SOUTH_RESIZE="s-resize",e.WEST_RESIZE="w-resize",e.TEXT="text",e.WAIT="wait",e.HELP="help",e.CELL="cell",e.NONE="none",e.VERTICAL_TEXT="vertical-text",e.NO_DROP="no-drop",e.GRAB="grab",e.GRABBING="grabbing",e.ALL_SCROLL="all-scroll",e.COLUMN_RESIZE="col-resize",e.ROW_RESIZE="row-resize",e.PROGRESS="progress",e.NOT_ALLOWED="not-allowed",e.ZOOM_IN="zoom-in",e.ZOOM_OUT="zoom-out",e))(_l||{});const gl="rgb(0,0,0)";var fl=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(fl||{}),yl=(e=>(e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e))(yl||{}),vl=(e=>(e.ENGINE="Engine",e.SCENE="Scene",e.BASE_OBJECT="BaseObject",e.SCENE_VIEWER="SceneViewer",e.CANVAS="Canvas",e.VIEWPORT="Viewport",e.LAYER="Layer",e.GROUP="Group",e))(vl||{});const bl=e=>({sbr:.5,sbo:e,spr:.5,spo:e});class xl{static get globalFontMeasureCache(){return this._globalFontMeasureCache}static setFontMeasureCache(e,t,n){this._globalFontMeasureCache.has(e)||(this._globalFontMeasureCache[e]=new Map),this._globalFontMeasureCache[e][t]=n}static clearFontMeasureCache(e){var t;const n=e.split("/");if(1===n.length){const e=n[0];this._globalFontMeasureCache.delete(e)}else{if(2!==n.length)return!1;{const e=n[0],r=n[1];null==(t=this._globalFontMeasureCache.get(e))||t.delete(r)}}return!0}static getFontMeasureCache(e,t){var n;return null==(n=this._globalFontMeasureCache[e])?void 0:n[t]}static autoCleanFontMeasureCache(e=1e6){let t=0,n=!1;for(let r of this._globalFontMeasureCache){const[,a]=r;if(t+=a.size,t>e){n=!0;break}}if(n){let t=0;for(let n of this._globalFontMeasureCache){const[r,a]=n;if(t+=a.size,t>e/2){const n=t-e/2;this._clearMeasureCache(n,a);break}this._globalFontMeasureCache.delete(r)}return!0}return!1}static getBaselineOffsetInfo(e,t){if(0===this._fontDataMap.size)return bl(t);const n=e.split(",");for(let e of n){e=e.replace(/'/g,"");const n=this._fontDataMap.get(e);if(!n)continue;const{subscriptSizeRatio:r,subscriptOffset:a,superscriptSizeRatio:i,superscriptOffset:o}=n;return{sbr:r,sbo:a*t,spr:i,spo:o*t}}return bl(t)}static _clearMeasureCache(e,t){let n=0;for(let r of t){const[a]=r;if(n>e)break;t.delete(a),n++}return!0}static getTextSizeByDom(e,t){if(t in this._getTextHeightCache)return this._getTextHeightCache[t];let n=document.getElementById("universheetTextSizeTest");n||(n=document.createElement("span"),n.id="universheetTextSizeTest",document.getElementsByTagName("body")[0].appendChild(n)),n.style.cssText+=`float:left;white-space:nowrap;visibility:hidden;margin:0;padding:0;;${t}`,n.innerText=e;const r=n.getBoundingClientRect(),a={width:r.width,height:r.height};return this._getTextHeightCache[t]=a,a}static _getBoundingBoxByFont(e,t=28,n=""){const r=this._fontDataMap.get(e);if(!r)return;const{notDefWidth:a,ascender:i,descender:o,typoAscender:s,typoDescender:l,strikeoutPosition:c,subscriptSizeRatio:u,subscriptOffset:h,superscriptSizeRatio:d,superscriptOffset:p,hdmxData:m,glyphHorizonMap:_}=r,g=null==m?void 0:m.indexOf(Math.floor(t)),f=_.get(n.charCodeAt(0));let y=a;if(f){const{width:e,pixelsPerEm:t=[]}=f;y=g?t[g]:e}return{width:y*t,ba:i*t,bd:o*t,aba:s*t,abd:l*t,sp:c*t,sbr:u,sbo:h*t,spr:d,spo:p*t}}static _calculateBoundingBoxByMeasureText(e,t){const{width:n,fontBoundingBoxAscent:r,fontBoundingBoxDescent:a,actualBoundingBoxAscent:i,actualBoundingBoxDescent:o}=e;return{width:n,ba:r,bd:a,aba:i,abd:o,sp:(r+a)/2,sbr:.5,sbo:t,spr:.5,spo:t}}static getTextSize(e,t){const{fontString:n,fontSize:r,fontFamily:a}=t;let i=this._getBoundingBoxByFont(a,r);if(!i){const t=this.getMeasureText(e,n);i=this._calculateBoundingBoxByMeasureText(t,r)}return i}static getMeasureText(e,t){if(!this._context){const e=document.createElement("canvas");this._context=e.getContext("2d")}const n=this._context,r=this.getFontMeasureCache(t,e);if(null!=r)return r;n.font=t;const a=n.measureText(e),{width:i,fontBoundingBoxAscent:o,fontBoundingBoxDescent:s,actualBoundingBoxAscent:l,actualBoundingBoxDescent:c}=a,u={width:i,fontBoundingBoxAscent:o,fontBoundingBoxDescent:s,actualBoundingBoxAscent:l,actualBoundingBoxDescent:c};if(null==o||null==s||Number.isNaN(o)||Number.isNaN(s)){let e=this.getTextSizeByDom("0",t)[1];"top"===n.textBaseline?(u.fontBoundingBoxAscent=u.actualBoundingBoxAscent=e,u.fontBoundingBoxDescent=u.actualBoundingBoxDescent=0):"middle"===n.textBaseline?(u.fontBoundingBoxDescent=u.actualBoundingBoxDescent=e/2,u.fontBoundingBoxAscent=u.actualBoundingBoxAscent=e/2):(u.fontBoundingBoxDescent=u.actualBoundingBoxDescent=0,u.fontBoundingBoxAscent=u.actualBoundingBoxAscent=e)}return this.setFontMeasureCache(t,e,u),u}}xl._globalFontMeasureCache=new Map,xl._getTextHeightCache={},xl._fontDataMap=new Map;var wl=(e=>(e[e.SECTION=0]="SECTION",e[e.PAGE=1]="PAGE",e[e.COLUMN=2]="COLUMN",e))(wl||{}),Tl=(e=>(e[e.PARAGRAPH=0]="PARAGRAPH",e[e.BLOCK=1]="BLOCK",e))(Tl||{}),Cl=(e=>(e[e.LETTER=0]="LETTER",e[e.WORD=1]="WORD",e[e.LIST=2]="LIST",e[e.TAB=3]="TAB",e[e.IMAGE=4]="IMAGE",e[e.AT=5]="AT",e[e.MATH=6]="MATH",e[e.MULTI_LINE=7]="MULTI_LINE",e[e.CUSTOM=8]="CUSTOM",e))(Cl||{});class El{}El.DOM_DELTA_PIXEL=0,El.DOM_DELTA_LINE=1,El.DOM_DELTA_PAGE=2;var Al=(e=>(e[e.Generic=0]="Generic",e[e.Keyboard=1]="Keyboard",e[e.Mouse=2]="Mouse",e[e.Touch=3]="Touch",e))(Al||{}),Sl=(e=>(e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.LeftClick=2]="LeftClick",e[e.MiddleClick=3]="MiddleClick",e[e.RightClick=4]="RightClick",e[e.BrowserBack=5]="BrowserBack",e[e.BrowserForward=6]="BrowserForward",e[e.MouseWheelX=7]="MouseWheelX",e[e.MouseWheelY=8]="MouseWheelY",e[e.MouseWheelZ=9]="MouseWheelZ",e[e.DeltaHorizontal=10]="DeltaHorizontal",e[e.DeltaVertical=11]="DeltaVertical",e[e.FakeMove=12]="FakeMove",e))(Sl||{}),Dl=(e=>(e[e.translate=0]="translate",e[e.resize=1]="resize",e[e.scale=2]="scale",e[e.skew=3]="skew",e[e.flip=4]="flip",e[e.all=5]="all",e))(Dl||{});class Rl{constructor(e=30){this._enabled=!0,this._rollingFrameTime=new Nl(e)}sampleFrame(e=this.Now()){if(this._enabled){if(null!=this._lastFrameTimeMs){let t=e-this._lastFrameTimeMs;this._rollingFrameTime.add(t)}this._lastFrameTimeMs=e}}Now(){return window.performance&&window.performance.now?window.performance.now():Date.now()}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1e3/this._rollingFrameTime.average}get instantaneousFPS(){let e=this._rollingFrameTime.history(0);return 0===e?0:1e3/e}get isSaturated(){return this._rollingFrameTime.isSaturated()}enable(){this._enabled=!0}disable(){this._enabled=!1,this._lastFrameTimeMs=null}get isEnabled(){return this._enabled}reset(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}}class Nl{constructor(e){this._samples=new Array(e),this.reset()}add(e){let t;if(this.isSaturated()){let e=this._samples[this._pos];t=e-this.average,this.average-=t/(this._sampleCount-1),this._m2-=t*(e-this.average)}else this._sampleCount++;t=e-this.average,this.average+=t/this._sampleCount,this._m2+=t*(e-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=e,this._pos++,this._pos%=this._samples.length}history(e){if(e>=this._sampleCount||e>=this._samples.length)return 0;let t=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(t-e)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}_wrapPosition(e){let t=this._samples.length;return(e%t+t)%t}}class Ml{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return Ml.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new Ml(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new Ml(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new Ml(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new Ml(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new Ml(this.x*e,this.y*t)}divide(e){return new Ml(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new Ml(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new Ml(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new Ml(Math.floor(this.x),Math.floor(this.y))}fract(){return new Ml(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=Ml.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return Ml.NormalizeToRef(this,this),this}clone(){return new Ml(this.x,this.y)}static Zero(){return new Ml(0,0)}static One(){return new Ml(1,1)}static FromArray(e,t=0){return new Ml(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new Ml(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new Ml(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new Ml(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=Ml.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new Ml(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=Ml.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new Ml(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new Ml(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new Ml(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new Ml(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(Ml.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return Ml.CenterToRef(e,t,Ml.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=Ml.DistanceSquared(t,n);if(0===r)return Ml.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,Ml.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return Ml.Distance(e,o)}static create(e,t){return new Ml(e,t)}}const Ol=[1,0,0,1,0,0];class kl{constructor(e=Ol){this.dirty=!1,this._m=e&&e.slice()||Ol}static create(e=Ol){return new this(e)}reset(){this._m[0]=1,this._m[1]=0,this._m[2]=0,this._m[3]=1,this._m[4]=0,this._m[5]=0}copy(){return new kl(this._m)}copyInto(e){e._m[0]=this._m[0],e._m[1]=this._m[1],e._m[2]=this._m[2],e._m[3]=this._m[3],e._m[4]=this._m[4],e._m[5]=this._m[5]}applyPoint(e,t=!1){const n=this._m;let r=n[0]*e.x+n[2]*e.y,a=n[1]*e.x+n[3]*e.y;return t?new Ml(r,a):new Ml(r+n[4],a+n[5])}translate(e,t){return this._m[4]+=this._m[0]*e+this._m[2]*t,this._m[5]+=this._m[1]*e+this._m[3]*t,this}scale(e,t){return this._m[0]*=e,this._m[1]*=e,this._m[2]*=t,this._m[3]*=t,this}rotate(e){const t=Kl(e);let n=Math.cos(t),r=Math.sin(t),a=this._m[0]*n+this._m[2]*r,i=this._m[1]*n+this._m[3]*r,o=this._m[0]*-r+this._m[2]*n,s=this._m[1]*-r+this._m[3]*n;return this._m[0]=a,this._m[1]=i,this._m[2]=o,this._m[3]=s,this}getTranslation(){return{x:this._m[4],y:this._m[5]}}skew(e,t){let n=this._m[0]+this._m[2]*t,r=this._m[1]+this._m[3]*t,a=this._m[2]+this._m[0]*e,i=this._m[3]+this._m[1]*e;return this._m[0]=n,this._m[1]=r,this._m[2]=a,this._m[3]=i,this}multiply(e){let t=this._m[0]*e._m[0]+this._m[2]*e._m[1],n=this._m[1]*e._m[0]+this._m[3]*e._m[1],r=this._m[0]*e._m[2]+this._m[2]*e._m[3],a=this._m[1]*e._m[2]+this._m[3]*e._m[3],i=this._m[0]*e._m[4]+this._m[2]*e._m[5]+this._m[4],o=this._m[1]*e._m[4]+this._m[3]*e._m[5]+this._m[5];return this._m[0]=t,this._m[1]=n,this._m[2]=r,this._m[3]=a,this._m[4]=i,this._m[5]=o,this}invert(){let e=1/(this._m[0]*this._m[3]-this._m[1]*this._m[2]),t=this._m[3]*e,n=-this._m[1]*e,r=-this._m[2]*e,a=this._m[0]*e,i=e*(this._m[2]*this._m[5]-this._m[3]*this._m[4]),o=e*(this._m[1]*this._m[4]-this._m[0]*this._m[5]);return this._m[0]=t,this._m[1]=n,this._m[2]=r,this._m[3]=a,this._m[4]=i,this._m[5]=o,this}getMatrix(){return this._m}getMatrixByAccurate(e=3){return this._m.map((t=>ec(t,e)))}setAbsolutePosition(e){let t=this._m[0],n=this._m[1],r=this._m[2],a=this._m[3],i=this._m[4],o=this._m[5],s=(t*(e.y-o)-n*(e.x-i))/(t*a-n*r),l=(e.x-i-r*s)/t;return this.translate(l,s)}decompose(){let e=this._m[0],t=this._m[1],n=this._m[2],r=this._m[3],a=e*r-t*n,i={x:this._m[4],y:this._m[5],angle:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!==e||0!==t){let o=Math.sqrt(e*e+t*t);i.angle=t>0?Math.acos(e/o):-Math.acos(e/o),i.scaleX=o,i.scaleY=a/o,i.skewX=(e*n+t*r)/a,i.skewY=0}else if(0!==n||0!==r){let o=Math.sqrt(n*n+r*r);i.angle=Math.PI/2-(r>0?Math.acos(-n/o):-Math.acos(n/o)),i.scaleX=a/o,i.scaleY=o,i.skewX=0,i.skewY=(e*n+t*r)/a}return i.angle=jl(i.angle),i}makeBoundingBoxFromPoints(e){if(this)for(let t=0;t<e.length;t++)e[t]=this.applyPoint(e[t]);const t=[e[0].x,e[1].x,e[2].x,e[3].x],n=Math.min(...t),r=Math.max(...t)-n,a=[e[0].y,e[1].y,e[2].y,e[3].y],i=Math.min(...a);return{left:n,top:i,width:r,height:Math.max(...a)-i,points:e}}composeMatrix(e){const t=new kl([1,0,0,1,e.left||0,e.top||0]);return e.angle&&t.rotate(e.angle),(1!==e.scaleX||1!==e.scaleY||e.skewX||e.skewY||e.flipX||e.flipY)&&t.multiply(this._calcDimensionsMatrix(e)),this._m=t.getMatrix(),this}_calcDimensionsMatrix(e){var t,n;const r=null!=(t=e.scaleX)?t:1,a=null!=(n=e.scaleY)?n:1,i=new kl([e.flipX?-r:r,0,0,e.flipY?-a:a,0,0]);return e.skewX&&i.multiply(new kl([1,0,Math.tan(Kl(e.skewX)),1,0,0])),e.skewY&&i.multiply(new kl([1,Math.tan(Kl(e.skewY)),0,1,0,0])),i}clone(){return new kl([...this._m])}}function Il(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===fl.TOP?(r=s,a=l,i=c,o=l):t===fl.BOTTOM?(r=s,a=u,i=c,o=u):t===fl.LEFT?(r=s,a=l,i=s,o=u):t===fl.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function Pl(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function Ll(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function Bl(e,t,n,r,a=Ml.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}function Fl(e){return e>0?yl.DOWN:yl.UP}function Hl(e,t,n){const r=[];let a=0,i=0,o=0,s=0,l=0;const c=Fl(n),u=e.length;n=Math.abs(n);const h=Math.tan(n),d=Math.sin(n),p=Math.cos(n);if(c===yl.UP){let n=0;for(let a=0;a<u;a++){const s=e[a],{lineHeight:c=0}=s;n+=0===a?0:c;const u=(c/h+t)*d;r.push(n/h),u>i&&(i=u),0===a&&(o+=c*d,l+=c*p)}o+=n/d+t*p,l-=i}else{let n=0,l=-1;const c=[];for(let r=u-1;r>=0;r--){const a=e[r],{lineHeight:s=0}=a,m=s/h,_=(t+m)*d;c.unshift(s/h),_>i&&(i=_,n=m,l=r),o+=0===r?s*d:r===u-1?t*p+s/d:s/d}let m=e[l].lineHeight||0,_=0;for(let t=l+1;t<=u-1;t++){const n=e[t],{lineHeight:a=0}=n;m+=a,_+=c[t]||0,r[t]=-_}_=0;for(let t=l-1;t>=0;t--){const n=e[t],{lineHeight:i=0}=n;_+=c[t+1]||0,r[t]=_,a+=i}r[l]=0,1===u&&(o+=t*p),s=m/d-n*p}return{rotateTranslateXList:r,rotatedHeight:i,rotatedWidth:o,fixOffsetX:s,fixOffsetY:l,rotateTranslateY:a}}const ql=[new Ml(0,0),new Ml(1,1)];class Ul{constructor(e=ql){this._lines=e}intersection(e){if(this._lines.length<1||e.length<1)return;const t=[];for(let n=1;n<this._lines.length;n++){const r=this._lines[n-1],a=this._lines[n];for(let i=1;i<e.length;i++){const e=this._lines[n-1],i=this._lines[n],o=this._intersection({from:r,to:a},{from:e,to:i});o&&t.push(o)}}return t}_intersection(e,t){const n=e.from,r=e.to,a=t.from,i=t.to;let o=(n.x-a.x)*(r.y-a.y)-(n.y-a.y)*(r.x-a.x),s=(n.x-i.x)*(r.y-i.y)-(n.y-i.y)*(r.x-i.x);if(o*s>=0)return!1;let l=(a.x-n.x)*(i.y-n.y)-(a.y-n.y)*(i.x-n.x);if(l*(l+o-s)>=0)return!1;let c=l/(s-o),u=c*(r.x-n.x),h=c*(r.y-n.y);return new Ml(n.x+u,n.y+h)}}const Vl=Math.PI/180,Wl=180/Math.PI,zl="rgb(",Yl=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${zl+e.join(",")})`:"rgb(0,0,0)",Gl=(e,t)=>{if(_a.isNumber(e))return e;if(t&&e&&_a.isString(e)&&"%"===e.substr(e.length-1,1)){return t*(parseFloat(e)/100)}return 0},Xl=(e,t)=>(t||(t=window),t.requestPostAnimationFrame?t.requestPostAnimationFrame(e):t.requestAnimationFrame?t.requestAnimationFrame(e):t.msRequestAnimationFrame?t.msRequestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.mozRequestAnimationFrame?t.mozRequestAnimationFrame(e):t.oRequestAnimationFrame?t.oRequestAnimationFrame(e):window.setTimeout(e,16)),$l=()=>{let e=document.createElement("canvas");try{e.style=e.style||{}}catch(e){console.error(e)}return e},jl=e=>e*Wl,Kl=e=>e*Vl;function Zl(e){return Object.prototype.toString.apply(e)}function Ql(e){return"[object Function]"===Zl(e)}function Jl(e){return"[object String]"===Zl(e)}function ec(e,t){return t=10**t,Math.round(e*t)/t}function tc(e,t){return Math.round(e*t)/t}function nc(e,t){t||(t={fontList:["Arial"],defaultFontSize:10.5});const{fontList:n,defaultFontSize:r}=t;if(!e)return{fontString:`${r}pt  ${n[0]}`,fontSize:r,fontFamily:n[0]};let a=Ys.ITALIC;0!==e.it&&void 0!==e.it||(a=Ys.NORMAL);let i=Ys.BOLD;0!==e.bl&&void 0!==e.bl||(i=Ys.NORMAL);let o=r;e.fs&&(o=Math.ceil(e.fs));let s=n[0];if(e.ff){let t=e.ff;t=t.replace(/"/g,"").replace(/'/g,""),t.indexOf(" ")>-1&&(t=`"${t}"`),null==t&&(t=n[0]),s=t}const{va:l}=e;if(l===Oa.SUBSCRIPT||l===Oa.SUPERSCRIPT){const e=xl.getBaselineOffsetInfo(s,o),{sbr:t,spr:n}=e;o*=l===Oa.SUBSCRIPT?t:n}return{fontString:`${a} ${i} ${o}pt ${s}, "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif `,fontSize:o,fontFamily:s}}function rc(e){return!!/[\u2E80-\uA4CF]|[\uF900-\uFAFF]|[\uFE30-\uFE4F]|[\uFF00-\uFFEF]/gi.exec(e)}function ac(e){return!!/[\u0600-\u06FF]|[\u0750-\u0750]|[\u0870-\u08FF]|[\uFB50-\uFDFF]|[\uFE70-\uFEFF]/gi.exec(e)}function ic(e){return!!/[\u0180-\u024F]/gi.exec(e)}function oc(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}function sc(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}function lc(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=sc(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}function cc(e,t,n,r,a){const{startY:i,endY:o,startX:s,endX:l}=e;return e.startY=tc(i+n,a),e.endY=tc(o+n,a),e.startX=tc(s+t,r),e.endX=tc(l+t,r),{...e}}function uc(e,t){return!(e.left>t.right||e.top>t.bottom||t.left>e.right||t.top>e.bottom)}function hc(e,t,n,r,a,i){if(!i)return[];const o=i.getPluginManager().getPluginByName("documentCustomBlock");return o?o.dealWidthCustomBlock(e,t,n,r,a):[]}function dc(){let e=1,t=$l().getContext("2d");return e=(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1),e<1?1:Math.ceil(10*e)/10}class pc{constructor(e){this._pixelRatio=1,this._width=0,this._height=0,this.isCache=!1,e=e||{},this._canvasEle=$l(),this._canvasEle.style.padding="0",this._canvasEle.style.margin="0",this._canvasEle.style.border="0",this._canvasEle.style.background="transparent",this._canvasEle.style.position="absolute",this._canvasEle.style.top="0",this._canvasEle.style.left="0",this._canvasEle.tabIndex=1,this._canvasEle.style.touchAction="none",this._canvasEle.style.outline="0",this._context=this._canvasEle.getContext("2d"),this.setSize(e.width,e.height,e.pixelRatio)}getCanvasEle(){return this._canvasEle}getContext(){return this._context}getPixelRatio(){return this._pixelRatio}getWidth(){return this._width}getHeight(){return this._height}setSize(e,t,n){this._pixelRatio=n||dc(),e&&(this._width=e,this._canvasEle.width=e*this._pixelRatio,this._canvasEle.style.width=`${e}px`),t&&(this._height=t,this._canvasEle.height=t*this._pixelRatio,this._canvasEle.style.height=`${t}px`),this.getContext().setTransform(this._pixelRatio,0,0,this._pixelRatio,0,0)}setPixelRatio(e){0!==this._width&&0!==this._height&&(e<1&&(e=1),this.setSize(this._width,this._height,e))}clear(){this.getContext().clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}toDataURL(e,t){try{return this._canvasEle.toDataURL(e,t)}catch(e){try{return this._canvasEle.toDataURL()}catch(e){const{message:t}=e;return console.error(`Unable to get data URL. ${t} For more info read https://universheet.net/docs/Canvas.html.`),""}}}}class mc{constructor(e=100,t=100){this._canvas=new pc,this._scenes={},this._activeScene=null,this._renderingQueueLaunched=!1,this._activeRenderLoops=new Array,this.onInputChangedObservable=new aa,this.renderEvenInBackground=!0,this._usingSafari="safari"===_a.getBrowserType(),this._fps=60,this._deltaTime=0,this._performanceMonitor=new Rl,this.onBeginFrameObservable=new aa,this.onEndFrameObservable=new aa,this.onTransformChangeObservable=new aa,this.__pointer={},this.__mouseId=-1,this.__isUsingFirefox=-1!==navigator.userAgent.indexOf("Firefox"),this._canvasEle=this._canvas.getCanvasEle(),this._canvas.setSize(e,t),this._handleKeyboardAction(),this._handlePointerAction()}get width(){return this._canvas.getWidth()}get height(){return this._canvas.getHeight()}get classType(){return vl.ENGINE}getCanvas(){return this._canvas}getScenes(){return this._scenes}getScene(e){return this._scenes[e]}hasScene(e){return e in this._scenes}addScene(e){const t=e.sceneKey;return this.hasScene(t)&&console.warn("Scenes has similar key, it will be covered"),this._scenes[t]=e,e}setActiveScene(e){const t=this.getScene(e);return t&&(this._activeScene=t),t}hasActiveScene(){return!!this._activeScene}get activeScene(){return this._activeScene}setContainer(e){this._container=e,this._container.appendChild(this._canvasEle),this.resize()}resize(){if(!this._container)return;const{offsetWidth:e,offsetHeight:t}=this._container;this.resizeBySize(e,t)}resizeBySize(e,t){this._canvas.setSize(e,t),this.onTransformChangeObservable.notifyObservers({type:Dl.resize,value:{x:e,y:t}})}runRenderLoop(e){-1===this._activeRenderLoops.indexOf(e)&&(this._activeRenderLoops.push(e),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._renderFunction=this._renderLoop.bind(this),this._requestNewFrameHandler=Xl(this._renderFunction)))}get requestNewFrameHandler(){return this._requestNewFrameHandler}_renderLoop(){let e=!0;this.renderEvenInBackground||(e=!1),e&&(this.beginFrame(),this._renderFrame(),this.endFrame()),this._activeRenderLoops.length>0?this._requestNewFrameHandler=Xl(this._renderFunction):this._renderingQueueLaunched=!1}beginFrame(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this)}endFrame(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}getFps(){return this._fps}get frameId(){return this._frameId}getDeltaTime(){return this._deltaTime}_measureFps(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}_renderFrame(){for(let e=0;e<this._activeRenderLoops.length;e++){(0,this._activeRenderLoops[e])()}}_handleKeyboardAction(){this._canvasEle.addEventListener("keydown",(e=>{let t=e;t.deviceType=Al.Keyboard,t.inputIndex=e.keyCode,t.previousState=0,t.currentState=1,this.onInputChangedObservable.notifyObservers(t)})),this._canvasEle.addEventListener("keyup",(e=>{let t=e;t.deviceType=Al.Keyboard,t.inputIndex=e.keyCode,t.previousState=1,t.currentState=0,this.onInputChangedObservable.notifyObservers(t)}))}_handlePointerAction(){const e=(()=>{let e="pointer";return"undefined"==typeof window||window.PointerEvent||"undefined"==typeof navigator||navigator.pointerEnabled||(e="mouse"),!_a.isTablet()||_a.isIPhone()||document&&"ontouchend"in document||(e="mouse"),e})();this._canvasEle.addEventListener(`${e}move`,(e=>{const t=this.__getPointerType(e),n=this.__pointer[Sl.Horizontal],r=this.__pointer[Sl.Vertical],a=this.__pointer[Sl.DeltaHorizontal],i=this.__pointer[Sl.DeltaVertical];this.__pointer[Sl.Horizontal]=e.clientX,this.__pointer[Sl.Vertical]=e.clientY,this.__pointer[Sl.DeltaHorizontal]=e.movementX,this.__pointer[Sl.DeltaVertical]=e.movementY;let o=e;o.deviceType=t,n!==e.clientX&&(o.inputIndex=Sl.Horizontal,o.previousState=n,o.currentState=this.__pointer[Sl.Horizontal],this.onInputChangedObservable.notifyObservers(o)),r!==e.clientY&&(o.inputIndex=Sl.Vertical,o.previousState=r,o.currentState=this.__pointer[Sl.Vertical],this.onInputChangedObservable.notifyObservers(o)),0!==this.__pointer[Sl.DeltaHorizontal]&&(o.inputIndex=Sl.DeltaHorizontal,o.previousState=a,o.currentState=this.__pointer[Sl.DeltaHorizontal],this.onInputChangedObservable.notifyObservers(o)),0!==this.__pointer[Sl.DeltaVertical]&&(o.inputIndex=Sl.DeltaVertical,o.previousState=i,o.currentState=this.__pointer[Sl.DeltaVertical],this.onInputChangedObservable.notifyObservers(o)),this._usingSafari||-1===e.button||(o.inputIndex=e.button+2,o.previousState=this.__pointer[e.button+2],this.__pointer[e.button+2]=this.__pointer[e.button+2]?0:1,o.currentState=this.__pointer[e.button+2],this.onInputChangedObservable.notifyObservers(o))})),this._canvasEle.addEventListener(`${e}down`,(e=>{const t=this.__getPointerType(e),n=this.__pointer[Sl.Horizontal],r=this.__pointer[Sl.Vertical],a=this.__pointer[e.button+2];t===Al.Mouse?(-1===this.__mouseId&&(void 0===e.pointerId?this.__mouseId=this.__isUsingFirefox?0:1:this.__mouseId=e.pointerId),document.pointerLockElement||this._canvasEle.setPointerCapture(this.__mouseId)):e.pointerId&&!document.pointerLockElement&&this._canvasEle.setPointerCapture(e.pointerId),this.__pointer[Sl.Horizontal]=e.clientX,this.__pointer[Sl.Vertical]=e.clientY,this.__pointer[e.button+2]=1;let i=e;i.deviceType=t,n!==e.clientX&&(i.inputIndex=Sl.Horizontal,i.previousState=n,i.currentState=this.__pointer[Sl.Horizontal],this.onInputChangedObservable.notifyObservers(i),console.log("pointerDownEvent_clientX")),r!==e.clientY&&(i.inputIndex=Sl.Vertical,i.previousState=r,i.currentState=this.__pointer[Sl.Vertical],this.onInputChangedObservable.notifyObservers(i),console.log("pointerDownEvent_clientY")),i.inputIndex=e.button+2,i.previousState=a,i.currentState=this.__pointer[e.button+2],this.onInputChangedObservable.notifyObservers(i),console.log("pointerDownEvent_2",n,e.clientX,r,e.clientY,this.__pointer)})),this._canvasEle.addEventListener(`${e}up`,(e=>{const t=this.__getPointerType(e),n=this.__pointer[Sl.Horizontal],r=this.__pointer[Sl.Vertical],a=this.__pointer[e.button+2];this.__pointer[Sl.Horizontal]=e.clientX,this.__pointer[Sl.Vertical]=e.clientY,this.__pointer[e.button+2]=0;let i=e;i.deviceType=t,n!==e.clientX&&(i.inputIndex=Sl.Horizontal,i.previousState=n,i.currentState=this.__pointer[Sl.Horizontal],this.onInputChangedObservable.notifyObservers(i)),r!==e.clientY&&(i.inputIndex=Sl.Vertical,i.previousState=r,i.currentState=this.__pointer[Sl.Vertical],this.onInputChangedObservable.notifyObservers(i)),i.inputIndex=e.button+2,i.previousState=a,i.currentState=this.__pointer[e.button+2],t===Al.Mouse&&this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)?this._canvasEle.releasePointerCapture(this.__mouseId):e.pointerId&&this._canvasEle.hasPointerCapture(e.pointerId)&&this._canvasEle.releasePointerCapture(e.pointerId),this.onInputChangedObservable.notifyObservers(i),t!==Al.Mouse&&(this.__pointer={})})),this._canvasEle.addEventListener("blur",(e=>{this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)&&(this._canvasEle.releasePointerCapture(this.__mouseId),this.__mouseId=-1),this.__pointer={}})),this._canvasEle.addEventListener(this._getWheelEventName(),(e=>{const t=Al.Mouse;let n=this.__pointer[Sl.MouseWheelX],r=this.__pointer[Sl.MouseWheelY],a=this.__pointer[Sl.MouseWheelZ];this.__pointer[Sl.MouseWheelX]=e.deltaX||0,this.__pointer[Sl.MouseWheelY]=e.deltaY||e.wheelDelta||0,this.__pointer[Sl.MouseWheelZ]=e.deltaZ||0;let i=e;i.deviceType=t,0!==this.__pointer[Sl.MouseWheelX]&&(i.inputIndex=Sl.MouseWheelX,i.previousState=n,i.currentState=this.__pointer[Sl.MouseWheelX],this.onInputChangedObservable.notifyObservers(i)),0!==this.__pointer[Sl.MouseWheelY]&&(i.inputIndex=Sl.MouseWheelY,i.previousState=r,i.currentState=this.__pointer[Sl.MouseWheelY],this.onInputChangedObservable.notifyObservers(i)),0!==this.__pointer[Sl.MouseWheelZ]&&(i.inputIndex=Sl.MouseWheelZ,i.previousState=a,i.currentState=this.__pointer[Sl.MouseWheelZ],this.onInputChangedObservable.notifyObservers(i))}),!!this._getPassive()&&{passive:!1})}_getWheelEventName(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"}_getPassive(){let e=!1;const t=()=>{};try{const n={passive:{get(){e=!0}}};this._canvasEle.addEventListener("test",t,n),this._canvasEle.removeEventListener("test",t,n)}catch(e){}return e}__getPointerType(e){let t=Al.Mouse;return("touch"===e.pointerType||"pen"===e.pointerType||e.touches)&&(t=Al.Touch),t}}const _c=["top","left","width","height","angle","scaleX","scaleY","skewX","skewY","flipX","flipY","strokeWidth"];class gc{constructor(e){this._top=0,this._topOrigin=0,this._left=0,this._leftOrigin=0,this._width=0,this._widthOrigin=0,this._height=0,this._heightOrigin=0,this._angle=0,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._flipX=!1,this._flipY=!1,this._strokeWidth=0,this._zIndex=0,this._evented=!0,this._visible=!0,this._debounceParentDirty=!0,this._transform=new kl,this._dirty=!0,this._cursor=_l.DEFAULT,this.isInGroup=!1,this.onTransformChangeObservable=new aa,this.onPointerDownObserver=new aa,this.onPointerMoveObserver=new aa,this.onPointerUpObserver=new aa,this.onDblclickObserver=new aa,this.onMouseWheelObserver=new aa,this.onPointerOutObserver=new aa,this.onPointerLeaveObserver=new aa,this.onPointerOverObserver=new aa,this.onPointerEnterObserver=new aa,this.onIsAddedToParentObserver=new aa,this._oKey=e||((e="obj",t=4)=>{let n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),r="";for(let e=0;e<t;e++)r+=n[Math.round(Math.random()*(n.length-1))];return`${e}_${r}_${(new Date).getTime()}`})()}makeDirty(e=!0){return this._dirty=e,e&&(window.clearTimeout(this.__debounceParentTimeout),this.__debounceParentTimeout=window.setTimeout((()=>{var t;null==(t=this.parent)||t.makeDirty(e)}),0)),this}makeDirtyNoDebounce(e=!0){var t;return this._dirty=e,e&&(null==(t=this.parent)||t.makeDirty(e)),this}isDirty(){return this._dirty}get transform(){return this._transform}set transform(e){this._transform=e}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get widthOrigin(){return this._widthOrigin}get heightOrigin(){return this._heightOrigin}get classType(){return vl.BASE_OBJECT}translate(e,t){return void 0!==t&&(this.top=t),void 0!==e&&(this.left=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Dl.translate,value:{x:this._top,y:this._left}}),this}resize(e,t){return void 0!==e&&(this.width=e),void 0!==t&&(this.height=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Dl.resize,value:{x:this._width,y:this._height}}),this}scale(e,t){return void 0!==e&&(this.scaleX=e),void 0!==t&&(this.scaleY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Dl.scale,value:{x:this._scaleX,y:this._scaleY}}),this}skew(e,t){return void 0!==e&&(this.skewX=e),void 0!==t&&(this.skewY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Dl.skew,value:{x:this._skewX,y:this._skewY}}),this}flip(e,t){return void 0!==e&&(this.flipX=e),void 0!==t&&(this.flipY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Dl.flip,value:{x:this._flipX,y:this._flipY}}),this}transformByState(e){const t=Object.keys(e);if(0!==t.length)return t.forEach((t=>{void 0!==e[t]&&(this[t]=e[t])})),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Dl.all,value:e}),this}_setTransForm(){const e=kl.create().composeMatrix({left:this.left+this.strokeWidth/2,top:this.top+this.strokeWidth/2,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY});this.transform=e,this.debounceParentDirty?this.makeDirty(!0):this.makeDirtyNoDebounce(!0)}get top(){return this._top}set top(e){var t;this._topOrigin=e,this._top=Gl(e,null==(t=this._parent)?void 0:t.height)}get left(){return this._left}set left(e){var t;this._leftOrigin=e,this._left=Gl(e,null==(t=this._parent)?void 0:t.width)}get width(){return this._width}set width(e){var t;this._widthOrigin=e,this._width=Gl(e,null==(t=this._parent)?void 0:t.width)}get height(){return this._height}set height(e){var t;this._heightOrigin=e,this._height=Gl(e,null==(t=this._parent)?void 0:t.height)}get strokeWidth(){return this._strokeWidth}set strokeWidth(e){this._strokeWidth=e}get angle(){return this._angle}set angle(e){this._angle=e}get scaleX(){return this._scaleX}set scaleX(e){this._scaleX=e}get scaleY(){return this._scaleY}set scaleY(e){this._scaleY=e}get ancestorScaleX(){var e;let t=(null==(e=this.getParent())?void 0:e.ancestorScaleX)||1;return this.scaleX*t}get ancestorScaleY(){var e;let t=(null==(e=this.getParent())?void 0:e.ancestorScaleY)||1;return this.scaleY*t}get skewX(){return this._skewX}set skewX(e){this._skewX=e}get skewY(){return this._skewY}set skewY(e){this._skewY=e}get flipX(){return this._flipX}set flipX(e){this._flipX=e}get flipY(){return this._flipY}set flipY(e){this._flipY=e}get parent(){return this._parent}set parent(e){this._parent=e}getParent(){return this._parent}get oKey(){return this._oKey}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex=e}get evented(){return this._evented}set evented(e){this._evented=e}get visible(){return this._visible}set visible(e){this._visible=e}get debounceParentDirty(){return this._debounceParentDirty}set debounceParentDirty(e){this._debounceParentDirty=e}render(e,t){}isHit(e){const t=this._getInverseCoord(e);return t.x>=-this.strokeWidth/2&&t.x<=this.width+this.strokeWidth/2&&t.y>=-this.strokeWidth/2&&t.y<=this.height+this.strokeWidth/2}_getInverseCoord(e){return this._transform.clone().invert().applyPoint(e)}on(e,t){return this[`on${e}Observer`].add(t.bind(this))}off(e,t){this[`on${e}Observer`].remove(t)}clear(e){this[`on${e}Observer`].clear()}resizeCacheCanvas(){}scaleCacheCanvas(){}triggerPointerMove(e){var t,n;(null==(t=this.onPointerMoveObserver.notifyObservers(e))?void 0:t.stopPropagation)||null==(n=this._parent)||n.triggerPointerMove(e)}triggerPointerDown(e){var t,n;(null==(t=this.onPointerDownObserver.notifyObservers(e))?void 0:t.stopPropagation)||null==(n=this._parent)||n.triggerPointerDown(e)}triggerPointerUp(e){var t,n;(null==(t=this.onPointerUpObserver.notifyObservers(e))?void 0:t.stopPropagation)||null==(n=this._parent)||n.triggerPointerUp(e)}triggerDblclick(e){var t,n;(null==(t=this.onDblclickObserver.notifyObservers(e))?void 0:t.stopPropagation)||null==(n=this._parent)||n.triggerDblclick(e)}triggerMouseWheel(e){var t,n;(null==(t=this.onMouseWheelObserver.notifyObservers(e))?void 0:t.stopPropagation)||null==(n=this._parent)||n.triggerMouseWheel(e)}triggerPointerOut(e){var t,n;(null==(t=this.onPointerOutObserver.notifyObservers(e))?void 0:t.stopPropagation)||null==(n=this._parent)||n.triggerPointerOut(e)}triggerPointerLeave(e){var t,n;(null==(t=this.onPointerLeaveObserver.notifyObservers(e))?void 0:t.stopPropagation)||null==(n=this._parent)||n.triggerPointerLeave(e)}triggerPointerOver(e){var t;this.onPointerOverObserver.notifyObservers(e)||null==(t=this._parent)||t.triggerPointerOver(e)}triggerPointerEnter(e){var t,n;(null==(t=this.onPointerEnterObserver.notifyObservers(e))?void 0:t.stopPropagation)||null==(n=this._parent)||n.triggerPointerEnter(e)}dispose(){var e;this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onMouseWheelObserver.clear(),this.onPointerOutObserver.clear(),this.onPointerLeaveObserver.clear(),this.onPointerOverObserver.clear(),this.onPointerEnterObserver.clear(),this.onDblclickObserver.clear(),this.onIsAddedToParentObserver.clear(),null==(e=this.parent)||e.removeObject(this)}toJson(){const e={};return _c.forEach((t=>{this[t]&&(e[t]=this[t])})),e}getScene(){let e=this.parent;if(e.classType===vl.SCENE)return e;for(;e;){if(e.classType===vl.SCENE)return e;e=e.getParent()}}get cursor(){return this._cursor}set cursor(e){this.setCursor(e)}resetCursor(){this.setCursor(_l.DEFAULT)}setCursor(e){var t;this._cursor=e,null==(t=this.getScene())||t.setCursor(e)}getEngine(){let e=this.getParent();for(;null!=e;){if(e===vl.ENGINE)return e;e=e.getParent()}return null}}class fc{constructor(e,t=[],n=1){this._scene=e,this._objects=t,this._zIndex=n,this.addObjects(this._objects)}static create(e,t=[],n=1e3){return new this(e,t,n)}get scene(){return this._scene}get zIndex(){return this._zIndex}getObjectsByOrder(){const e=[];this._objects.sort(is);for(let t of this._objects)!t.isInGroup&&t.visible&&e.push(t);return e}getObjectsByOrderForPick(){const e=[];this._objects.sort(is);for(let t of this._objects)t.classType!==vl.GROUP&&t.visible&&e.push(t);return e}getObjects(){return this._objects}addObject(e){if(e.classType===vl.GROUP){const t=e.getObjects();for(let e of t)this.scene.getObject(e.oKey)||(this._objects.push(e),this.scene.setObjectBehavior(e))}return this._objects.push(e),this.scene.setObjectBehavior(e),this}removeObject(e){const t=this.getObjects(),n=t.length;if(e instanceof gc)for(let r=0;r<n;r++){if(t[r]===e)return void t.splice(r,1)}else for(let r=0;r<n;r++){if(t[r].oKey===e)return void t.splice(r,1)}}addObjects(e){return e.forEach((e=>{this.addObject(e)})),this}}const yc=class{constructor(e){this._alreadyAttached=!1,this._startingPosition=new Ml(1/0,1/0),this._doubleClickOccurred=0,this._scene=e}mouseLeaveEnterHandler(e,t){var n;if(null==e)null==(n=this._currentMouseEnterPicked)||n.triggerPointerLeave(t),this._currentMouseEnterPicked=null;else if(e!==this._currentMouseEnterPicked){const n=this._currentMouseEnterPicked;this._currentMouseEnterPicked=e,null==n||n.triggerPointerLeave(t),null==e||e.triggerPointerEnter(t)}}attachControl(e=!0,t=!0,n=!0,r=!0){const a=this._scene.getEngine();a&&(this._onPointerMove=e=>{var t;void 0===e.pointerId&&(e.pointerId=0);const n=null==(t=this._scene)?void 0:t.pick(Ml.FromArray([e.offsetX,e.offsetY]));null==n||n.triggerPointerMove(e),this.mouseLeaveEnterHandler(n,e),this._scene.onPointerMove&&this._scene.onPointerMove(e),this._scene.onPointerMoveObserver.hasObservers()&&this._scene.onPointerMoveObserver.notifyObservers(e)},this._onPointerDown=e=>{var t,n;void 0===e.pointerId&&(e.pointerId=0),null==(n=null==(t=this._scene)?void 0:t.pick(Ml.FromArray([e.offsetX,e.offsetY])))||n.triggerPointerDown(e),this._scene.onPointerDown&&this._scene.onPointerDown(e),this._scene.onPointerDownObserver.hasObservers()&&this._scene.onPointerDownObserver.notifyObservers(e)},this._onPointerUp=e=>{var t,n;void 0===e.pointerId&&(e.pointerId=0),null==(n=null==(t=this._scene)?void 0:t.pick(Ml.FromArray([e.offsetX,e.offsetY])))||n.triggerPointerUp(e),this._scene.onPointerUp&&this._scene.onPointerUp(e),this._scene.onPointerUpObserver.hasObservers()&&this._scene.onPointerUpObserver.notifyObservers(e),this._prePointerDoubleClick(e)},this._onMouseWheel=e=>{var t,n;null==(n=null==(t=this._scene)?void 0:t.pick(Ml.FromArray([e.offsetX,e.offsetY])))||n.triggerMouseWheel(e),this._scene.getViewports().forEach((t=>{t.onMouseWheelObserver.hasObservers()&&t.onMouseWheelObserver.notifyObservers(e)}))},this._onKeyDown=e=>{this._scene.onKeyDownObservable.hasObservers()&&this._scene.onKeyDownObservable.notifyObservers(e)},this._onKeyUp=e=>{this._scene.onKeyUpObservable.hasObservers()&&this._scene.onKeyUpObservable.notifyObservers(e)},this._onInputObserver=a.onInputChangedObservable.add((a=>{const i=a;a.deviceType===Al.Keyboard&&(1===a.currentState&&this._onKeyDown(i),0===a.currentState&&this._onKeyUp(i)),a.deviceType!==Al.Mouse&&a.deviceType!==Al.Touch||(e&&a.inputIndex>=Sl.LeftClick&&a.inputIndex<=Sl.RightClick&&1===a.currentState&&this._onPointerDown(i),t&&a.inputIndex>=Sl.LeftClick&&a.inputIndex<=Sl.RightClick&&0===a.currentState&&this._onPointerUp(i),!n||a.inputIndex!==Sl.Horizontal&&a.inputIndex!==Sl.Vertical&&a.inputIndex!==Sl.DeltaHorizontal&&a.inputIndex!==Sl.DeltaVertical?!r||a.inputIndex!==Sl.MouseWheelX&&a.inputIndex!==Sl.MouseWheelY&&a.inputIndex!==Sl.MouseWheelZ||this._onMouseWheel(i):this._onPointerMove(i))})),this._alreadyAttached=!0)}detachControl(){if(!this._alreadyAttached)return;const e=this._scene.getEngine();e&&(e.onInputChangedObservable.remove(this._onInputObserver),this._alreadyAttached=!1)}_isPointerSwiping(e,t){return Math.abs(this._startingPosition.x-e)>yc.DragMovementThreshold||Math.abs(this._startingPosition.y-t)>yc.DragMovementThreshold}_prePointerDoubleClick(e){var t,n;const{clientX:r,clientY:a}=e;if(0===this._doubleClickOccurred&&(this._startingPosition.x=r,this._startingPosition.y=a),this._doubleClickOccurred+=1,this._delayedTimeout=window.setTimeout((()=>{this._resetDoubleClickParam()}),yc.DoubleClickDelay),this._doubleClickOccurred<2)return;this._isPointerSwiping(r,a)?this._resetDoubleClickParam():(null==(n=null==(t=this._scene)?void 0:t.pick(Ml.FromArray([e.offsetX,e.offsetY])))||n.triggerDblclick(e),this._scene.onDblclick&&this._scene.onDblclick(e),this._scene.onDblclickObserver.hasObservers()&&this._scene.onDblclickObserver.notifyObservers(e),this._resetDoubleClickParam(),console.log("_prePointerDoubleClick",e))}_resetDoubleClickParam(){this._doubleClickOccurred=0,this._startingPosition.x=1/0,this._startingPosition.y=1/0,window.clearTimeout(this._delayedTimeout)}};let vc=yc;vc.DragMovementThreshold=10,vc.LongPressDelay=500,vc.DoubleClickDelay=300,vc.ExclusiveDoubleClickMode=!1;class bc{constructor(e,t,n){var r;if(this._parent=t,this._layers=[],this._sceneKey="",this._viewports=[],this._width=100,this._height=100,this._scaleX=1,this._scaleY=1,this._transform=new kl,this._isFirstDirty=!0,this._evented=!0,this._cursor=_l.DEFAULT,this.onPointerDownObserver=new aa,this.onPointerMoveObserver=new aa,this.onPointerUpObserver=new aa,this.onDblclickObserver=new aa,this.onMouseWheelObserver=new aa,this.onKeyDownObservable=new aa,this.onKeyUpObservable=new aa,this.onTransformChangeObservable=new aa,this._sceneKey=e,n&&this.transformByState(n),this._parent.classType===vl.ENGINE){const t=this._parent;t.addScene(this),t.hasActiveScene()&&t.setActiveScene(e),this._inputManager=new vc(this)}else if(this._parent.classType===vl.SCENE_VIEWER){this._parent.addObject(this)}null==(r=this._parent)||r.onTransformChangeObservable.add((e=>{this._resetViewportSize(),this._setTransForm()}))}attachControl(e=!0,t=!0,n=!0,r=!0){var a;if(this._parent.classType===vl.ENGINE)return null==(a=this._inputManager)||a.attachControl(e,t,n,r),this}detachControl(){var e;return null==(e=this._inputManager)||e.detachControl(),this}makeDirty(e=!0){var t;return this._viewports.forEach((t=>{t.makeDirty(e)})),this._parent.classType===vl.SCENE_VIEWER&&(null==(t=this._parent)||t.makeDirty(e)),this}makeDirtyNoParent(e=!0){return this._viewports.forEach((t=>{t.makeDirty(e)})),this}isDirty(){for(let e=0;e<this._viewports.length;e++){if(!0===this._viewports[e].isDirty())return!0}return!1}get cursor(){return this._cursor}set cursor(e){this.setCursor(e)}resetCursor(){this.setCursor(_l.DEFAULT)}setCursor(e){this._cursor=e;const t=this.getEngine();if(!t)return;t.getCanvas().getCanvasEle().style.cursor=e}get classType(){return vl.SCENE}get transform(){return this._transform}set transform(e){this._transform=e}get width(){return this._width}get height(){return this._height}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get ancestorScaleX(){const e=this.getParent();let t=1;return e.classType===vl.SCENE_VIEWER&&(t=e.ancestorScaleX),this._scaleX*t}get ancestorScaleY(){const e=this.getParent();let t=1;return e.classType===vl.SCENE_VIEWER&&(t=e.ancestorScaleY),this._scaleY*t}set width(e){this._width=e}set height(e){this._height=e}set scaleX(e){this._scaleX=e}set scaleY(e){this._scaleY=e}resize(e,t){return void 0!==e&&(this.width=e),void 0!==t&&(this.height=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Dl.resize,value:{width:this.width,height:this.height}}),this}scale(e,t){return void 0!==e&&(this.scaleX=e),void 0!==t&&(this.scaleY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Dl.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY}}),this}scaleBy(e,t){return void 0!==e&&(this.scaleX+=e),void 0!==t&&(this.scaleY+=t),this.scaleX=ec(this.scaleX,1),this.scaleY=ec(this.scaleY,1),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Dl.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY}}),this}transformByState(e){const t=Object.keys(e);0!==t.length&&(t.forEach((t=>{void 0!==e[t]&&(this[t]=e[t])})),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Dl.all,value:e}))}getParent(){return this._parent}getEngine(){if(this._parent.classType===vl.ENGINE)return this._parent;let e=this._parent;for(;e;){if(e===vl.ENGINE)return e;e=null==e?void 0:e.getParent()}return null}getLayers(){return this._layers}getLayer(e=1){for(let t of this._layers)if(t.zIndex===e)return t;return this._createDefaultLayer(e)}_createDefaultLayer(e=1){const t=fc.create(this,[],e);return this.addLayer(t),t}getLayerMaxZIndex(){let e=Number.MIN_VALUE;for(let t=0;t<this._layers.length;t++){const n=this._layers[t];n.zIndex>=e&&(e=n.zIndex)}return e}addLayer(...e){this._layers.push(...e)}addObject(e,t=1){var n;return null==(n=this.getLayer(t))||n.addObject(e),this}setObjectBehavior(e){e.parent||(e.parent=this),this.onTransformChangeObservable.add((t=>{e.scaleCacheCanvas()})),e.onIsAddedToParentObserver.notifyObservers(this)}addObjects(e,t=1){var n;return null==(n=this.getLayer(t))||n.addObjects(e),this}removeObject(e){const t=this.getLayers();for(let n of t)n.removeObject(e);return this}getAllObjects(){const e=[];this._layers.sort(is);for(let t of this._layers)e.push(...t.getObjectsByOrder());return e}getAllObjectsByOrder(e=!1){const t=[],n=e?os:is;this._layers.sort(n);for(let e of this._layers)t.push(...e.getObjectsByOrder().sort(n));return t}getAllObjectsByOrderForPick(e=!1){const t=[],n=e?os:is;this._layers.sort(n);for(let e of this._layers)t.push(...e.getObjectsByOrderForPick().sort(n));return t}getObject(e){for(let t of this._layers){const n=t.getObjectsByOrder();for(let t of n)if(t.oKey===e)return t}}addViewport(...e){return this._viewports.push(...e),this}removeViewport(){}getViewports(){return this._viewports}getViewport(e){for(let t of this._viewports)if(t.viewPortKey===e)return t}changeObjectOrder(){}get sceneKey(){return this._sceneKey}async requestRender(e){return new Promise(((t,n)=>{this.render(e),Xl(t)}))}renderObjects(e,t){return this.getAllObjectsByOrder().forEach((n=>{n.render(e,t)})),this}render(e){var t,n;this.isDirty()&&(!e&&(null==(t=this.getEngine())||t.getCanvas().clear()),null==(n=this.getViewports())||n.forEach((t=>t.render(e))))}_resetViewportSize(){this.getViewports().forEach((e=>{e.resetSize()}))}_setTransForm(){const e=kl.create().composeMatrix({scaleX:this.scaleX,scaleY:this.scaleY});this.transform=e,this.getViewports().forEach((e=>{e.resizeScrollBar()})),this.makeDirty(!0)}enableEvent(){this._evented=!0}disableEvent(){this._evented=!1}pick(e){const t=this._viewports.find((t=>t.isHit(e)));if(!this._evented||!t)return;const n=t.pickScrollBar(e);if(n)return n;const r=t.getRelativeVector(e);let a=null;const i=this.getAllObjectsByOrderForPick().reverse(),o=i.length;for(let e=0;e<o;e++){const t=i[e];if(!t.visible||!t.evented||t.classType===vl.GROUP)continue;let n=r;if(t.isInGroup&&t.parent.classType===vl.GROUP){const{cumLeft:e,cumTop:r}=this._getGroupCumLeftRight(t);n=n.clone().add(Ml.FromArray([-e,-r]))}if(t.isHit(n)){if(t.classType===vl.SCENE_VIEWER){const e=t.pick(n);a=e||t.scene}else a=t;break}if(t.classType===vl.SCENE_VIEWER){const e=t.pick(n);if(e){a=e;break}}}return a||this._parent.classType!==vl.ENGINE?a:this}_getGroupCumLeftRight(e){let t=e.parent,n=0,r=0;for(;t.classType===vl.GROUP;){const{left:e,top:a}=t;n+=e,r+=a,t=t.parent}return{cumLeft:n,cumTop:r}}on(e,t){return this[`on${e}Observer`].add(t.bind(this))}off(e,t){this[`on${e}Observer`].remove(t)}remove(e){this[`on${e}Observer`].clear()}triggerKeyDown(e){this.onKeyDownObservable.notifyObservers(e)}triggerKeyUp(e){this.onKeyUpObservable.notifyObservers(e)}triggerPointerUp(e){var t,n;(null==(t=this.onPointerUpObserver.notifyObservers(e))?void 0:t.stopPropagation)||this._parent.classType!==vl.SCENE_VIEWER||null==(n=this._parent)||n.triggerPointerUp(e)}triggerMouseWheel(e){var t,n;(null==(t=this.onMouseWheelObserver.notifyObservers(e))?void 0:t.stopPropagation)||this._parent.classType!==vl.SCENE_VIEWER||null==(n=this._parent)||n.triggerMouseWheel(e)}triggerPointerMove(e){var t,n;(null==(t=this.onPointerMoveObserver.notifyObservers(e))?void 0:t.stopPropagation)||this._parent.classType!==vl.SCENE_VIEWER||null==(n=this._parent)||n.triggerPointerMove(e)}triggerDblclick(e){var t,n;(null==(t=this.onDblclickObserver.notifyObservers(e))?void 0:t.stopPropagation)||this._parent.classType!==vl.SCENE_VIEWER||null==(n=this._parent)||n.triggerDblclick(e)}triggerPointerDown(e){var t,n;(null==(t=this.onPointerDownObserver.notifyObservers(e))?void 0:t.stopPropagation)||this._parent.classType!==vl.SCENE_VIEWER||null==(n=this._parent)||n.triggerPointerDown(e)}triggerPointerOut(e){var t;this._parent.classType===vl.SCENE_VIEWER&&(null==(t=this._parent)||t.triggerPointerOut(e))}triggerPointerLeave(e){var t;this._parent.classType===vl.SCENE_VIEWER&&(null==(t=this._parent)||t.triggerPointerLeave(e))}triggerPointerOver(e){var t;this._parent.classType===vl.SCENE_VIEWER&&(null==(t=this._parent)||t.triggerPointerOver(e))}triggerPointerEnter(e){var t;this._parent.classType===vl.SCENE_VIEWER&&(null==(t=this._parent)||t.triggerPointerEnter(e))}}class xc extends gc{constructor(e,t){super(e),this._initialProps(t)}get scene(){return this._childrenScene}get classType(){return vl.SCENE_VIEWER}render(e,t){var n;if(!this.visible)return this.makeDirty(!1),this;if(t){const e=this.transform.clone().invert().applyPoint(t.tl),n=this.transform.clone().invert().applyPoint(t.tr),r=this.transform.clone().invert().applyPoint(t.bl),a=this.transform.clone().invert().applyPoint(t.br),i=[e.x,n.x,r.x,a.x],o=[e.y,n.y,r.y,a.y],s=Math.max(...i),l=Math.min(...i),c=Math.max(...o),u=Math.min(...o);if(this.width+this.strokeWidth<l||s<0||this.height+this.strokeWidth<u||c<0)return this}const r=this.transform.getMatrix();return e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),null==(n=this._childrenScene)||n.makeDirtyNoParent(!0).render(e),e.restore(),this.makeDirty(!1),this}addObject(e){this._childrenScene=e}pick(e){if(void 0===this._childrenScene)return;const t=this.transform.clone().invert().applyPoint(e);return this._childrenScene.pick(t)}_initialProps(e){if(!e)return;const t=Object.keys(e);if(0===t.length)return;const n={};let r=!1;t.forEach((t=>{if(void 0===e[t])return!0;n[t]=e[t],r=!0})),r&&this.transformByState(n),this.makeDirty(!0)}}class wc{constructor(e,t,n){var r;this._dirty=!0,this._topOrigin=0,this._leftOrigin=0,this._bottomOrigin=0,this._rightOrigin=0,this._top=0,this._left=0,this._bottom=0,this._right=0,this._isWheelPreventDefaultX=!1,this._isWheelPreventDefaultY=!1,this._allowCache=!1,this.scrollX=0,this.scrollY=0,this._preScrollX=0,this._preScrollY=0,this.onMouseWheelObserver=new aa,this.onScrollAfterObserver=new aa,this.onScrollBeforeObserver=new aa,this._viewPortKey=e,this._scene=t,this.top=(null==n?void 0:n.top)||0,this.left=(null==n?void 0:n.left)||0,this.bottom=(null==n?void 0:n.bottom)||0,this.right=(null==n?void 0:n.right)||0,(null==n?void 0:n.width)&&(this.width=null==n?void 0:n.width,this._widthOrigin=this.width),(null==n?void 0:n.height)&&(this.height=null==n?void 0:n.height,this._heightOrigin=this.height),this._allowCache&&(this._cacheCanvas=new pc),this._isWheelPreventDefaultX=(null==n?void 0:n.isWheelPreventDefaultX)||!1,this._isWheelPreventDefaultY=(null==n?void 0:n.isWheelPreventDefaultY)||!1,this._resizeCacheCanvasAndScrollBar(),null==(r=this._scene)||r.getParent().onTransformChangeObservable.add((()=>{this._resizeCacheCanvasAndScrollBar()}))}get scene(){return this._scene}get width(){return this._width}set width(e){this._width=e}get height(){return this._height}set height(e){this._height=e}get viewPortKey(){return this._viewPortKey}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get bottomOrigin(){return this._bottomOrigin}get rightOrigin(){return this._rightOrigin}get top(){return this._top}set top(e){var t,n;this._topOrigin=e,this._top=Gl(e,null==(n=null==(t=this._scene)?void 0:t.getParent())?void 0:n.height)}get left(){return this._left}set left(e){var t;this._leftOrigin=e,this._left=Gl(e,null==(t=this.scene.getParent())?void 0:t.width)}get bottom(){return this._bottom}set bottom(e){var t;this._bottomOrigin=e,this._bottom=Gl(e,null==(t=this.scene.getParent())?void 0:t.height)}get right(){return this._right}set right(e){var t;this._rightOrigin=e,this._right=Gl(e,null==(t=this.scene.getParent())?void 0:t.width)}resetSize(){this._resizeCacheCanvasAndScrollBar(!0)}setScrollBar(e){this._scrollBar&&console.warn("Old scrollBar will be replaced "),this._scrollBar=e,this._resizeCacheCanvasAndScrollBar()}resize(e){const t=Object.keys(e);0!==t.length&&(this._width=void 0,this._height=void 0,t.forEach((t=>{void 0!==e[t]&&(this[t]=e[t])})),this._resizeCacheCanvasAndScrollBar())}resizeScrollBar(){this._resizeCacheCanvasAndScrollBar()}_resizeCacheCanvasAndScrollBar(e=!1){var t;const{width:n,height:r}=this._getViewPortSize(e);this.width=n,this.height=r;const a=this._scene.width*this._scene.scaleX,i=this._scene.height*this._scene.scaleY;null==(t=this._scrollBar)||t.resize(n,r,a,i),this.makeDirty(!0)}_getViewPortSize(e=!1){var t;const n=null==(t=this._scene)?void 0:t.getParent();let r,a;if(e||void 0===this._widthOrigin){const e=n.width;r=(n.classType===vl.SCENE_VIEWER?e*n.scaleX:e)-(this._left+this._right)}else r=this._widthOrigin;if(e||void 0===this._heightOrigin){const e=n.height;a=(n.classType===vl.SCENE_VIEWER?e*n.scaleY:e)-(this._top+this._bottom)}else a=this._heightOrigin;return{width:r,height:a}}makeDirty(e=!0){this._dirty=e}isDirty(){return this._dirty}scrollTo(e){return this._scroll(0,e)}scrollBy(e){return this._scroll(1,e)}_scrollRendered(){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY}_limitedScroll(){var e,t;if(!this._scrollBar)return;const n=(null==(e=this._scrollBar)?void 0:e.limitX)||1/0,r=(null==(t=this._scrollBar)?void 0:t.limitY)||1/0;let a=!0,i=!0;return this.scrollX<0?this.scrollX=0:this.scrollX>n?this.scrollX=n:a=!1,this.scrollY<0?this.scrollY=0:this.scrollY>r?this.scrollY=r:i=!1,{isLimitedX:a,isLimitedY:i}}_scroll(e,t){var n,r,a,i;const{x:o,y:s}=t;void 0!==o&&(1===e?this.scrollX+=o:this.scrollX=o),void 0!==s&&(1===e?this.scrollY+=s:this.scrollY=s);const l=this._limitedScroll();this.onScrollBeforeObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:o,y:s,limitX:null==(n=this._scrollBar)?void 0:n.limitX,limitY:null==(r=this._scrollBar)?void 0:r.limitY}),this._scrollBar?this._scrollBar.makeDirty(!0):this.makeDirty(!0);const c=this._transformScroll();return this.actualScrollX=c.x,this.actualScrollY=c.y,this.onScrollAfterObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:o,y:s,actualScrollX:c.x,actualScrollY:c.y,limitX:null==(a=this._scrollBar)?void 0:a.limitX,limitY:null==(i=this._scrollBar)?void 0:i.limitY}),l}_transformScroll(){let e=this.scrollX,t=this.scrollY;if(this._scrollBar){e/=this._scrollBar.ratioScrollX,t/=this._scrollBar.ratioScrollY;const{scaleX:n,scaleY:r}=this.scene;e=Math.round(e)/n,t=Math.round(t)/r}else void 0!==this.actualScrollX&&(e=this.actualScrollX),void 0!==this.actualScrollY&&(t=this.actualScrollY);return{x:e,y:t}}getScrollBar(){return this._scrollBar}updateScroll(e){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY;const{scrollX:t,scrollY:n,actualScrollX:r,actualScrollY:a}=e;return void 0!==t&&(this.scrollX=t),void 0!==n&&(this.scrollY=n),void 0!==r&&(this.actualScrollX=r),void 0!==a&&(this.actualScrollY=a),this}getScrollBarTransForm(e=!1){const t=kl.create();return!e&&this._allowCache||t.multiply(kl.create([1,0,0,1,this._left,this._top])),t}render(e){var t;const n=e||(null==(t=this._scene.getEngine())?void 0:t.getCanvas().getContext());if(!this.isDirty()&&this._allowCache)return void this._applyCache(n);let r=this._scene.transform.clone();r.multiply(kl.create([1,0,0,1,-this.actualScrollX||0,-this.actualScrollY||0]));let a=n;if(!a)return;this._allowCache&&(r.multiply(kl.create([1,0,0,1,-this.left/this._scene.scaleX,-this.top/this._scene.scaleY])),a=this._cacheCanvas.getContext(),this._cacheCanvas.clear());const i=r.getMatrix(),o=this.getScrollBarTransForm().getMatrix();a.save(),this._allowCache||(a.beginPath(),a.rect(this.left,this.top,this.width||0,this.height||0),a.clip()),a.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._scene.renderObjects(a,this._calViewportRelativeBounding()),a.restore(),this._scrollBar&&(a.save(),a.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this.drawScrollbar(a),a.restore()),this._allowCache&&this._applyCache(n),this.makeDirty(!1),this._scrollRendered()}_calViewportRelativeBounding(){var e,t,n,r;let a=null!=(t=null==(e=this._scrollBar)?void 0:e.ratioScrollX)?t:1,i=null!=(r=null==(n=this._scrollBar)?void 0:n.ratioScrollY)?r:1,o=this.left,s=(this.width||0)+this.left,l=this.top,c=(this.height||0)+this.top,u=0,h=0;null!=this._preScrollX&&(u=(this._preScrollX-this.scrollX)/a),null!=this._preScrollY&&(h=(this._preScrollY-this.scrollY)/i);const d={tl:Ml.FromArray([o,l]),tr:Ml.FromArray([s,l]),bl:Ml.FromArray([o,c]),br:Ml.FromArray([s,c]),dx:u,dy:h};return d.tl=this.getRelativeVector(d.tl),d.tr=this.getRelativeVector(d.tr),d.bl=this.getRelativeVector(d.bl),d.br=this.getRelativeVector(d.br),d}getRelativeVector(e){const t=this.scene.transform.clone().invert(),n=this._transformScroll();return t.applyPoint(e).add(Ml.FromArray([n.x,n.y]))}drawScrollbar(e){if(!this._scrollBar)return;const t=this._scene.getParent();(t.classType===vl.SCENE_VIEWER||t.classType===vl.ENGINE)&&this._scrollBar.render(e)}_applyCache(e){if(!e)return;const t=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*t,r=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,r,this.left,this.top,this.width||0,this.height||0)}onMouseWheel(e,t){if(!this._scrollBar)return;let n;if(e.inputIndex===Sl.MouseWheelX){const r=Math.abs(e.deltaX),a=this._scene.width;let i=(this.width||1)/a*r;n=e.deltaX>0?this.scrollBy({x:i}):this.scrollBy({x:-i}),this._scene.getParent().classType===vl.SCENE_VIEWER?(null==n?void 0:n.isLimitedX)||t.stopPropagation():this._isWheelPreventDefaultX?e.preventDefault():(null==n?void 0:n.isLimitedX)||e.preventDefault()}if(e.inputIndex===Sl.MouseWheelY){const r=Math.abs(e.deltaY),a=this._scene.height;let i=(this.height||1)/a*r;e.shiftKey?(n=e.deltaY>0?this.scrollBy({x:i}):this.scrollBy({x:-i}),this._scene.getParent().classType===vl.SCENE_VIEWER?(null==n?void 0:n.isLimitedX)||t.stopPropagation():this._isWheelPreventDefaultX?e.preventDefault():(null==n?void 0:n.isLimitedX)||e.preventDefault()):(n=e.deltaY>0?this.scrollBy({y:i}):this.scrollBy({y:-i}),this._scene.getParent().classType===vl.SCENE_VIEWER?(null==n?void 0:n.isLimitedY)||t.stopPropagation():this._isWheelPreventDefaultY?e.preventDefault():(null==n?void 0:n.isLimitedY)||e.preventDefault())}e.inputIndex,Sl.MouseWheelZ}isHit(e){const{width:t,height:n}=this._getViewPortSize();return e.x>=this.left&&e.x<=this.left+t&&e.y>=this.top&&e.y<=this.top+n}pickScrollBar(e){if(!this._scrollBar)return;const t=this.getScrollBarTransForm(!0).invert().applyPoint(e);return this._scrollBar.pick(t)}}class Tc extends gc{constructor(e,...t){super(e),this._objects=[],this.addObjects(...t)}set cursor(e){this.setCursor(e)}get classType(){return vl.GROUP}addObjects(...e){for(const t of e)this.addObject(t)}addObject(e){let t=e;if(Jl(e)){const n=this.getScene();if(t=null==n?void 0:n.getObject(e),!t)return void console.info("No object be added");t.parent=this,t.isInGroup=!0,t.groupKey=this.oKey,this._objects.push(t)}else e.parent=this,e.isInGroup=!0,e.groupKey=this.oKey,this._objects.push(e)}removeObject(e){const t=this.getObjects(),n=t.length;if(Jl(e))for(let r=0;r<n;r++){const n=t[r];if(n.oKey===e)return t.splice(r,1),void this.parent.removeObject(n)}else for(let r=0;r<n;r++){const n=t[r];if(n===e)return t.splice(r,1),void this.parent.removeObject(n)}}getObjectsByOrder(){const e=[];this._objects.sort(is);for(let t of this._objects)!t.isInGroup&&t.visible&&e.push(t);return e}getObjects(){return this._objects}render(e,t){e.save();const n=this.transform.getMatrix();e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._objects.sort(is);for(let n of this._objects)n.render(e,this._transformBounds(t));e.restore()}resize(e,t){return this}scale(e,t){return this}skew(e,t){return this}flip(e,t){return this}_transformBounds(e){return e}isHit(e){return!0}pick(e){}}const Cc=["hoverCursor","moveCursor","fillRule","globalCompositeOperation","allowCache","paintFirst","stroke","strokeScaleEnabled","fill","fillAfterStrokeEnabled","hitStrokeWidth","strokeLineJoin","strokeLineCap","shadowColor","shadowBlur","shadowOffset","shadowOffsetX","shadowOffsetY","shadowOpacity","shadowEnabled","shadowForStrokeEnabled","strokeDashArray","strokeDashOffset","strokeMiterLimit"];class Ec extends gc{constructor(e,t){super(e),this._moveCursor=null,this._fillRule="nonzero",this._globalCompositeOperation="source-over",this._allowCache=!1,this._allowCache&&(this._cacheCanvas=new pc,this.onTransformChangeObservable.add((()=>{this.resizeCacheCanvas()}))),this._initialProps(t)}get hoverCursor(){return this._hoverCursor}get moveCursor(){return this._moveCursor}get fillRule(){return this._fillRule}get globalCompositeOperation(){return this._globalCompositeOperation}get allowCache(){return this._allowCache}get paintFirst(){return this._paintFirst}get stroke(){return this._stroke}get strokeScaleEnabled(){return this._strokeScaleEnabled}get fill(){return this._fill}get fillAfterStrokeEnabled(){return this._fillAfterStrokeEnabled}get hitStrokeWidth(){return this._hitStrokeWidth}get strokeLineJoin(){return this._strokeLineJoin}get strokeLineCap(){return this._strokeLineCap}get shadowColor(){return this._shadowColor}get shadowBlur(){return this._shadowBlur}get shadowOffset(){return this._shadowOffset}get shadowOffsetX(){return this._shadowOffsetX}get shadowOffsetY(){return this._shadowOffsetY}get shadowOpacity(){return this._shadowOpacity}get shadowEnabled(){return this._shadowEnabled}get shadowForStrokeEnabled(){return this._shadowForStrokeEnabled}get strokeDashArray(){return this._strokeDashArray}get strokeDashOffset(){return this._strokeDashOffset}get strokeMiterLimit(){return this._strokeMiterLimit}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(t&&!this.isInGroup){const e=this.transform.clone().invert().applyPoint(t.tl),n=this.transform.clone().invert().applyPoint(t.tr),r=this.transform.clone().invert().applyPoint(t.bl),a=this.transform.clone().invert().applyPoint(t.br),i=[e.x,n.x,r.x,a.x],o=[e.y,n.y,r.y,a.y],s=Math.max(...i),l=Math.min(...i),c=Math.max(...o),u=Math.min(...o);if(this.width+this.strokeWidth<l||s<0||this.height+this.strokeWidth<u||c<0)return this}const n=this.transform.getMatrix();if(e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._allowCache){if(this.isDirty()){const e=this._cacheCanvas.getContext();this._cacheCanvas.clear(),e.save(),e.translate(this.strokeWidth/2,this.strokeWidth/2),this._draw(e),e.restore()}this._applyCache(e)}else this._draw(e);return e.restore(),this.makeDirty(!1),this}_draw(e){}_initialProps(e){if(!e)return;const t=Object.keys(e);if(0===t.length)return;const n={};let r=!1;t.forEach((t=>{if(void 0===e[t])return!0;_c.indexOf(t)>-1?(n[t]=e[t],r=!0):this[`_${t}`]=e[t]})),r&&this.transformByState(n),this.makeDirty(!0)}setProps(e){if(!e)return;const t=Object.keys(e);return 0!==t.length?(t.forEach((t=>{if(void 0===e[t])return!0;-1===_c.indexOf(t)&&(this[`_${t}`]=e[t])})),this.makeDirty(!0),this):void 0}resizeCacheCanvas(){var e;null==(e=this._cacheCanvas)||e.setSize(this.width+this.strokeWidth,this.height+this.strokeWidth),this.makeDirty(!0)}scaleCacheCanvas(){var e,t,n;let r=(null==(e=this.getParent())?void 0:e.ancestorScaleX)||1,a=(null==(t=this.getParent())?void 0:t.ancestorScaleX)||1;null==(n=this._cacheCanvas)||n.setPixelRatio(Math.max(r,a)*dc()),this.makeDirty(!0)}_applyCache(e){if(!e||!this._cacheCanvas)return;const t=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*t,r=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,r,-this.strokeWidth/2,-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth)}static _renderPaintInOrder(e,t){"stroke"===t.paintFirst?(this._renderStroke(e,t),this._renderFill(e,t)):(this._renderFill(e,t),this._renderStroke(e,t))}static _renderFill(e,t){t.fill&&(e.save(),this.__setFillStyles(e,t),"evenodd"===t.fillRule?e.fill("evenodd"):e.fill(),e.restore())}static _renderStroke(e,t){let{stroke:n,strokeWidth:r,shadowEnabled:a,shadowForStrokeEnabled:i,strokeScaleEnabled:o,scaleX:s,scaleY:l,parent:c}=t;if(n&&0!==r){if(a&&!i&&this.__removeShadow(e),e.save(),o&&c){let t=this.__getObjectScaling();e.scale(1/t.scaleX,1/t.scaleY)}else o&&(s=null!=s?s:1,l=null!=l?l:1,e.scale(1/s,1/l));this.__setLineDash(e),this.__setStrokeStyles(e,t),e.stroke(),e.restore()}}static __getObjectScaling(){return{scaleX:1,scaleY:1}}static __removeShadow(e){}static __setFillStyles(e,t){e.fillStyle=t.fill}static __setStrokeStyles(e,t){const{strokeWidth:n,strokeLineCap:r,strokeDashOffset:a,strokeLineJoin:i,strokeMiterLimit:o,stroke:s}=t;e.lineWidth=n,e.lineCap=r,e.lineDashOffset=a,e.lineJoin=i,e.miterLimit=o,e.strokeStyle=s}static __setLineDash(e){}static drawWith(e,t){}toJson(){const e={};return Cc.forEach((t=>{this[t]&&(e[t]=this[t])})),{...super.toJson(),...e}}}const Ac=["radius"];class Sc extends Ec{constructor(e,t){super(e,t),(null==t?void 0:t.radius)&&(this._radius=null==t?void 0:t.radius)}get radius(){return this._radius}_draw(e){Sc.drawWith(e,this)}static drawWith(e,t){let{radius:n,width:r,height:a}=t;if(n=null!=n?n:0,r=null!=r?r:30,a=null!=a?a:30,e.beginPath(),t.strokeDashArray&&e.setLineDash(t.strokeDashArray),n){let t=0,i=0,o=0,s=0;t=i=o=s=Math.min(n,r/2,a/2),e.moveTo(t,0),e.lineTo(r-i,0),e.arc(r-i,i,i,3*Math.PI/2,0,!1),e.lineTo(r,a-s),e.arc(r-s,a-s,s,0,Math.PI/2,!1),e.lineTo(o,a),e.arc(o,a-o,o,Math.PI/2,Math.PI,!1),e.lineTo(0,t),e.arc(t,t,t,Math.PI,3*Math.PI/2,!1)}else e.rect(0,0,r,a);e.closePath(),this._renderPaintInOrder(e,t)}toJson(){const e={};return Ac.forEach((t=>{this[t]&&(e[t]=this[t])})),{...super.toJson(),...e}}}const Dc=17;class Rc{constructor(e,t){this._thumbMargin=2,this._thumbLengthRatio=1,this._thumbBackgroundColor=Yl(ul,.2),this._thumbHoverBackgroundColor=Yl(ul,.35),this._thumbActiveBackgroundColor=Yl(ul,.4),this._barSize=14,this._barBackgroundColor=Yl(hl),this._barBorder=1,this._barBorderColor=Yl([218,220,224]),this._enableHorizontal=!0,this._enableVertical=!0,this._verticalMinusMiniThumb=0,this._horizontalMinusMiniThumb=0,this._isHorizonMove=!1,this._isVerticalMove=!1,e||console.warn("Missing viewport"),this._view=e,this.setProps(t),this._initialScrollRect(),this._view.setScrollBar(this)}get limitX(){return this._horizonThumbRect.visible?this._horizontalBarWidth-this._horizontalThumbWidth:0}get limitY(){return this._verticalThumbRect.visible?this._verticalBarHeight-this._verticalThumbHeight:0}setProps(e){if(!e)return;const t=Object.keys(e);0!==t.length&&t.forEach((t=>{void 0!==e[t]&&(this[`_${t}`]=e[t])}))}_initialScrollRect(){this._enableHorizontal&&(this._horizonBarRect=new Sc("__horizonBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._horizonThumbRect=new Sc("__horizonThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableVertical&&(this._verticalBarRect=new Sc("__verticalBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._verticalThumbRect=new Sc("__verticalThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableHorizontal&&this._enableVertical&&(this._placeholderBarRect=new Sc("__placeholderBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor})),this.__initialEvent()}__initialEvent(){const e=this._mainScene||this._view.scene,t=(e,t)=>(n,r)=>{if(this._isHorizonMove||this._isVerticalMove)return;t.setProps({fill:e}),this.makeViewDirty(!0)};this._enableHorizontal&&(this._horizonThumbRect.on(dl.PointerEnter,t(this._thumbHoverBackgroundColor,this._horizonThumbRect)),this._horizonThumbRect.on(dl.PointerLeave,t(this._thumbBackgroundColor,this._horizonThumbRect)),this._horizonBarRect.on(dl.PointerDown,((e,t)=>{const n=e;this._view.scrollTo({x:n.offsetX-this._view.left-this._horizontalThumbWidth/2}),t.stopPropagation()})),this._horizonThumbRect.on(dl.PointerDown,((e,t)=>{const n=e;this._isHorizonMove=!0,this._lastX=n.offsetX,this._lastY=n.offsetY,this._horizonThumbRect.setProps({fill:this._thumbActiveBackgroundColor}),this.makeViewDirty(!0),t.stopPropagation()})),e.on(dl.PointerMove,((e,t)=>{const n=e;this._isHorizonMove&&(this._view.scrollBy({x:n.offsetX-this._lastX}),this._lastX=n.offsetX)})),e.on(dl.PointerUp,((e,t)=>{const n=this._horizonThumbRect;this._isHorizonMove=!1,n.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)}))),this._enableVertical&&(this._verticalThumbRect.on(dl.PointerEnter,t(this._thumbHoverBackgroundColor,this._verticalThumbRect)),this._verticalThumbRect.on(dl.PointerLeave,t(this._thumbBackgroundColor,this._verticalThumbRect)),this._verticalBarRect.on(dl.PointerDown,((e,t)=>{const n=e;this._view.scrollTo({y:n.offsetY-this._view.top-this._verticalThumbHeight/2}),t.stopPropagation()})),this._verticalThumbRect.on(dl.PointerDown,((e,t)=>{const n=e,r=this._verticalThumbRect;this._isVerticalMove=!0,this._lastX=n.offsetX,this._lastY=n.offsetY,r.setProps({fill:this._thumbActiveBackgroundColor}),this.makeViewDirty(!0),t.stopPropagation()})),e.on(dl.PointerMove,((e,t)=>{const n=e;this._isVerticalMove&&(this._view.scrollBy({y:n.offsetY-this._lastY}),this._lastY=n.offsetY)})),e.on(dl.PointerUp,((e,t)=>{const n=this._verticalThumbRect;this._isVerticalMove=!1,n.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)})))}render(e,t=0,n=0){let{scrollX:r,scrollY:a}=this._view;e.save();const i=new kl([1,0,0,1,t,n]).getMatrix();e.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._horizonBarRect.render(e),this._horizonThumbRect.translate(r).render(e),this._verticalBarRect.render(e),this._verticalThumbRect.translate(void 0,a).render(e),this._placeholderBarRect.render(e),e.restore()}resize(e=0,t=0,n=0,r=0){var a,i,o,s,l,c,u,h,d,p,m;0===e&&0===e||(this._enableHorizontal&&(this._horizontalMinusMiniThumb=0,this._horizontalBarWidth=e-this._barSize,this._horizontalThumbWidth=this._horizontalBarWidth*(this._horizontalBarWidth-this._barBorder)/n*this._thumbLengthRatio,this._horizontalThumbWidth<Dc&&(this._horizontalMinusMiniThumb=Dc-this._horizontalThumbWidth,this._horizontalThumbWidth=Dc),null==(a=this._horizonBarRect)||a.transformByState({left:0,top:t-this._barSize,width:this._horizontalBarWidth,height:this._barSize-this._barBorder}),this._horizontalThumbWidth>=e?null==(i=this._horizonThumbRect)||i.setProps({visible:!1}):((null==(o=this._horizonThumbRect)?void 0:o.visible)||null==(s=this._horizonThumbRect)||s.setProps({visible:!0}),null==(l=this._horizonThumbRect)||l.transformByState({left:this._view.scrollX,top:t-this._barSize+this._thumbMargin,width:this._horizontalThumbWidth,height:this._barSize-2*this._thumbMargin}))),this._enableVertical&&(this._verticalMinusMiniThumb=0,this._verticalBarHeight=t-this._barSize,this._verticalThumbHeight=this._verticalBarHeight*(this._verticalBarHeight-this._barBorder)/r*this._thumbLengthRatio,this._verticalThumbHeight<Dc&&(this._verticalMinusMiniThumb=Dc-this._verticalThumbHeight,this._verticalThumbHeight=Dc),null==(c=this._verticalBarRect)||c.transformByState({left:e-this._barSize,top:0,width:this._barSize-this._barBorder,height:this._verticalBarHeight}),this._verticalThumbHeight>=t?null==(u=this._verticalThumbRect)||u.setProps({visible:!1}):((null==(h=this._verticalThumbRect)?void 0:h.visible)||null==(d=this._verticalThumbRect)||d.setProps({visible:!0}),null==(p=this._verticalThumbRect)||p.transformByState({left:e-this._barSize+this._thumbMargin,top:this._view.scrollY,width:this._barSize-2*this._thumbMargin,height:this._verticalThumbHeight}))),this._enableHorizontal&&this._enableVertical&&(null==(m=this._placeholderBarRect)||m.transformByState({left:e-this._barSize,top:t-this._barSize,width:this._barSize-this._barBorder,height:this._barSize-this._barBorder})))}get ratioScrollX(){return void 0===this._horizontalThumbWidth||void 0===this._horizontalBarWidth?1:(this._horizontalThumbWidth-this._horizontalMinusMiniThumb)/this._horizontalBarWidth}get ratioScrollY(){return void 0===this._verticalThumbHeight||void 0===this._verticalBarHeight?1:(this._verticalThumbHeight-this._verticalMinusMiniThumb)/this._verticalBarHeight}get barSize(){return this._barSize}get barBorder(){return this._barBorder}makeDirty(e){var t,n,r,a,i;null==(t=this._horizonBarRect)||t.makeDirty(e),null==(n=this._horizonThumbRect)||n.makeDirty(e),null==(r=this._verticalBarRect)||r.makeDirty(e),null==(a=this._verticalThumbRect)||a.makeDirty(e),null==(i=this._placeholderBarRect)||i.makeDirty(e),this.makeViewDirty(e)}makeViewDirty(e){this._view.makeDirty(e);const t=this._view.scene.getParent();t.classType===vl.SCENE_VIEWER&&t.makeDirty(!0)}pick(e){var t,n,r,a;return(null==(t=this._horizonThumbRect)?void 0:t.isHit(e))?this._horizonThumbRect:(null==(n=this._verticalThumbRect)?void 0:n.isHit(e))?this._verticalThumbRect:(null==(r=this._horizonBarRect)?void 0:r.isHit(e))?this._horizonBarRect:(null==(a=this._verticalBarRect)?void 0:a.isHit(e))?this._verticalBarRect:null}}class Nc extends Ec{constructor(e){super(void 0,e),this._props={autoWidth:!0,autoHeight:!0,...e},e.image?(this._native=e.image,this._init()):e.url&&(this._native=document.createElement("img"),this._native.src=e.url,this._native.onload=()=>{var t;null==(t=e.success)||t.call(e),this._init(),this.makeDirty(!0)},this._native.onerror=()=>{e.fail?e.fail():(this._native.src="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTMwNC4xMjggNDU2LjE5MmM0OC42NCAwIDg4LjA2NC0zOS40MjQgODguMDY0LTg4LjA2NHMtMzkuNDI0LTg4LjA2NC04OC4wNjQtODguMDY0LTg4LjA2NCAzOS40MjQtODguMDY0IDg4LjA2NCAzOS40MjQgODguMDY0IDg4LjA2NCA4OC4wNjR6bTAtMTE2LjIyNGMxNS4zNiAwIDI4LjE2IDEyLjI4OCAyOC4xNiAyOC4xNnMtMTIuMjg4IDI4LjE2LTI4LjE2IDI4LjE2LTI4LjE2LTEyLjI4OC0yOC4xNi0yOC4xNiAxMi4yODgtMjguMTYgMjguMTYtMjguMTZ6IiBmaWxsPSIjZTZlNmU2Ii8+PHBhdGggZD0iTTg4Ny4yOTYgMTU5Ljc0NEgxMzYuNzA0Qzk2Ljc2OCAxNTkuNzQ0IDY0IDE5MiA2NCAyMzIuNDQ4djU1OS4xMDRjMCAzOS45MzYgMzIuMjU2IDcyLjcwNCA3Mi43MDQgNzIuNzA0aDE5OC4xNDRMNTAwLjIyNCA2ODguNjRsLTM2LjM1Mi0yMjIuNzIgMTYyLjMwNC0xMzAuNTYtNjEuNDQgMTQzLjg3MiA5Mi42NzIgMjE0LjAxNi0xMDUuNDcyIDE3MS4wMDhoMzM1LjM2QzkyNy4yMzIgODY0LjI1NiA5NjAgODMyIDk2MCA3OTEuNTUyVjIzMi40NDhjMC0zOS45MzYtMzIuMjU2LTcyLjcwNC03Mi43MDQtNzIuNzA0em0tMTM4Ljc1MiA3MS42OHYuNTEySDg1Ny42YzE2LjM4NCAwIDMwLjIwOCAxMy4zMTIgMzAuMjA4IDMwLjIwOHYzOTkuODcyTDY3My4yOCA0MDguMDY0bDc1LjI2NC0xNzYuNjR6TTMwNC42NCA3OTIuMDY0SDE2NS44ODhjLTE2LjM4NCAwLTMwLjIwOC0xMy4zMTItMzAuMjA4LTMwLjIwOHYtOS43MjhsMTM4Ljc1Mi0xNjQuMzUyIDEwNC45NiAxMjQuNDE2LTc0Ljc1MiA3OS44NzJ6bTgxLjkyLTM1NS44NGwzNy4zNzYgMjI4Ljg2NC0uNTEyLjUxMi0xNDIuODQ4LTE2OS45ODRjLTMuMDcyLTMuNTg0LTkuMjE2LTMuNTg0LTEyLjI4OCAwTDEzNS42OCA2NTIuOFYyNjIuMTQ0YzAtMTYuMzg0IDEzLjMxMi0zMC4yMDggMzAuMjA4LTMwLjIwOGg0NzQuNjI0TDM4Ni41NiA0MzYuMjI0em01MDEuMjQ4IDMyNS42MzJjMCAxNi44OTYtMTMuMzEyIDMwLjIwOC0yOS42OTYgMzAuMjA4SDY4MC45Nmw1Ny4zNDQtOTMuMTg0LTg3LjU1Mi0yMDIuMjQgNy4xNjgtNy42OCAyMjkuODg4IDI3Mi44OTZ6IiBmaWxsPSIjZTZlNmU2Ii8+PC9zdmc+",this._init(),this.makeDirty(!0))})}static drawWith(e,t){if(t._native.complete){const{width:n,height:r}=t;e.drawImage(t._native,0,0,n,r)}}static fromURL(e,t){return new Nc({url:e,success:t})}_draw(e){Nc.drawWith(e,this)}_init(){this._props.autoWidth&&this.resize(this._native.width,void 0),this._props.autoHeight&&this.resize(void 0,this._native.height)}}const Mc=["dataArray"];class Oc extends Ec{constructor(e,t){super(e,t),this.pathLength=0,this._fixLeft=0,this._fixTop=0,(null==t?void 0:t.data)?this._dataArray=Oc.parsePathData(t.data):(null==t?void 0:t.dataArray)&&(this._dataArray=t.dataArray);for(let e=0;e<this.dataArray.length;++e)this.pathLength+=this.dataArray[e].pathLength;this._setFixBoundingBox()}get dataArray(){return this._dataArray}_draw(e){Oc.drawWith(e,this)}static drawWith(e,t){const n=t.dataArray;if(n){e.beginPath();for(let t=0;t<n.length;t++){let r=n[t].command,a=n[t].points;switch(r){case"L":e.lineTo(a[0],a[1]);break;case"M":e.moveTo(a[0],a[1]);break;case"C":e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"Q":e.quadraticCurveTo(a[0],a[1],a[2],a[3]);break;case"A":{const t=a[0],n=a[1],r=a[2],i=a[3],o=a[4],s=a[5],l=a[6],c=a[7],u=r>i?r:i,h=r>i?1:r/i,d=r>i?i/r:1;e.translate(t,n),e.rotate(l),e.scale(h,d),e.arc(0,0,u,o,o+s,!!(1-c)),e.scale(1/h,1/d),e.rotate(-l),e.translate(-t,-n);break}case"z":e.closePath()}}this._renderPaintInOrder(e,t)}}_setFixBoundingBox(){const{left:e,top:t,width:n,height:r}=this._getSelfRect(),a=this.width/n,i=this.height/r;this.transformByState({left:this.left-e*a,top:this.top-t*i,scaleX:a,scaleY:i,width:n,height:r}),this._fixLeft=e,this._fixTop=t}toJson(){const e={};return Mc.forEach((t=>{this[t]&&(e[t]=this[t])})),{...super.toJson(),...e}}getRect(){const{left:e,top:t,width:n,height:r}=this._getSelfRect();return{left:e*this.scaleX+this.left,top:t*this.scaleX+this.top,width:n*this.scaleX,height:r*this.scaleY}}_getSelfRect(){let e=[];this.dataArray.forEach((t=>{if("A"===t.command){let n=t.points[4],r=t.points[5],a=t.points[4]+r,i=Math.PI/180;if(Math.abs(n-a)<i&&(i=Math.abs(n-a)),r<0)for(let r=n-i;r>a;r-=i){const n=Oc.getPointOnEllipticalArc(t.points[0],t.points[1],t.points[2],t.points[3],r,0);e.push(n.x,n.y)}else for(let r=n+i;r<a;r+=i){const n=Oc.getPointOnEllipticalArc(t.points[0],t.points[1],t.points[2],t.points[3],r,0);e.push(n.x,n.y)}}else if("C"===t.command)for(let n=0;n<=1;n+=.01){const r=Oc.getPointOnCubicBezier(n,t.start.x,t.start.y,t.points[0],t.points[1],t.points[2],t.points[3],t.points[4],t.points[5]);e.push(r.x,r.y)}else e=e.concat(t.points)}));let t,n,r=e[0],a=e[0],i=e[1],o=e[1];for(let s=0;s<e.length/2;s++)t=e[2*s],n=e[2*s+1],isNaN(t)||(r=Math.min(r,t),a=Math.max(a,t)),isNaN(n)||(i=Math.min(i,n),o=Math.max(o,n));return{left:r,top:i,width:a-r,height:o-i}}getLength(){return this.pathLength}getPointAtLength(e){let t,n=0,r=this.dataArray.length;if(!r)return null;for(;n<r&&e>this.dataArray[n].pathLength;)e-=this.dataArray[n].pathLength,++n;if(n===r)return t=this.dataArray[n-1].points.slice(-2),{x:t[0],y:t[1]};if(e<.01)return t=this.dataArray[n].points.slice(0,2),{x:t[0],y:t[1]};let a=this.dataArray[n],i=a.points;switch(a.command){case"L":return Oc.getPointOnLine(e,a.start.x,a.start.y,i[0],i[1]);case"C":return Oc.getPointOnCubicBezier(e/a.pathLength,a.start.x,a.start.y,i[0],i[1],i[2],i[3],i[4],i[5]);case"Q":return Oc.getPointOnQuadraticBezier(e/a.pathLength,a.start.x,a.start.y,i[0],i[1],i[2],i[3]);case"A":{let t=i[0],n=i[1],r=i[2],o=i[3],s=i[4],l=i[5],c=i[6];return s+=l*e/a.pathLength,Oc.getPointOnEllipticalArc(t,n,r,o,s,c)}}return null}static getLineLength(e,t,n,r){return Math.sqrt((n-e)*(n-e)+(r-t)*(r-t))}static getPointOnLine(e,t,n,r,a,i,o){void 0===i&&(i=t),void 0===o&&(o=n);let s=(a-n)/(r-t+1e-8),l=Math.sqrt(e*e/(1+s*s));r<t&&(l*=-1);let c,u=s*l;if(r===t)c={x:i,y:o+u};else if((o-n)/(i-t+1e-8)===s)c={x:i+l,y:o+u};else{let h,d,p=this.getLineLength(t,n,r,a),m=(i-t)*(r-t)+(o-n)*(a-n);m/=p*p,h=t+m*(r-t),d=n+m*(a-n);let _=this.getLineLength(i,o,h,d),g=Math.sqrt(e*e-_*_);l=Math.sqrt(g*g/(1+s*s)),r<t&&(l*=-1),u=s*l,c={x:h+l,y:d+u}}return c}static getPointOnCubicBezier(e,t,n,r,a,i,o,s,l){function c(e){return e*e*e}function u(e){return 3*e*e*(1-e)}function h(e){return 3*e*(1-e)*(1-e)}function d(e){return(1-e)*(1-e)*(1-e)}return{x:s*c(e)+i*u(e)+r*h(e)+t*d(e),y:l*c(e)+o*u(e)+a*h(e)+n*d(e)}}static getPointOnQuadraticBezier(e,t,n,r,a,i,o){function s(e){return e*e}function l(e){return 2*e*(1-e)}function c(e){return(1-e)*(1-e)}return{x:i*s(e)+r*l(e)+t*c(e),y:o*s(e)+a*l(e)+n*c(e)}}static getPointOnEllipticalArc(e,t,n,r,a,i){let o=Math.cos(i),s=Math.sin(i),l=n*Math.cos(a),c=r*Math.sin(a);return{x:e+(l*o-c*s),y:t+(l*s+c*o)}}static parsePathData(e){if(!e)return[];let t=e,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(let e=0,r=n.length;e<r;e++)t=t.replace(new RegExp(n[e],"g"),`|${n[e]}`);let r,a=t.split("|"),i=[],o=[],s=0,l=0,c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;for(let e=1,t=a.length;e<t;e++){let t=a[e],n=t.charAt(0);for(t=t.slice(1),o.length=0;r=c.exec(t);)o.push(r[0]);let u=[];for(let e=0,t=o.length;e<t;e++){if("00"===o[e]){u.push(0,0);continue}let t=parseFloat(o[e]);isNaN(t)?u.push(0):u.push(t)}for(;u.length>0&&!isNaN(u[0]);){let e,t,r,a,o,c,h,d,p,m,_,g=[],f=s,y=l;switch(n){case"l":s+=u.shift()||0,l+=u.shift()||0,e="L",g.push(s,l);break;case"L":s=u.shift()||0,l=u.shift()||0,g.push(s,l);break;case"m":{let t=u.shift()||0,r=u.shift()||0;if(s+=t,l+=r,e="M",i.length>2&&"z"===i[i.length-1].command)for(let e=i.length-2;e>=0;e--)if("M"===i[e].command){s=i[e].points[0]+t,l=i[e].points[1]+r;break}g.push(s,l),n="l";break}case"M":s=u.shift()||0,l=u.shift()||0,e="M",g.push(s,l),n="L";break;case"h":s+=u.shift()||0,e="L",g.push(s,l);break;case"H":s=u.shift()||0,e="L",g.push(s,l);break;case"v":l+=u.shift()||0,e="L",g.push(s,l);break;case"V":l=u.shift()||0,e="L",g.push(s,l);break;case"C":g.push(u.shift()||0,u.shift()||0,u.shift()||0,u.shift()||0),s=u.shift()||0,l=u.shift()||0,g.push(s,l);break;case"c":g.push(s+(u.shift()||0),l+(u.shift()||0),s+(u.shift()||0),l+(u.shift()||0)),s+=u.shift()||0,l+=u.shift()||0,e="C",g.push(s,l);break;case"S":r=s,a=l,t=i[i.length-1],"C"===t.command&&(r=s+(s-t.points[2]),a=l+(l-t.points[3])),g.push(r,a,u.shift()||0,u.shift()||0),s=u.shift()||0,l=u.shift()||0,e="C",g.push(s,l);break;case"s":r=s,a=l,t=i[i.length-1],"C"===t.command&&(r=s+(s-t.points[2]),a=l+(l-t.points[3])),g.push(r,a,s+(u.shift()||0),l+(u.shift()||0)),s+=u.shift()||0,l+=u.shift()||0,e="C",g.push(s,l);break;case"Q":g.push(u.shift()||0,u.shift()||0),s=u.shift()||0,l=u.shift()||0,g.push(s,l);break;case"q":g.push(s+(u.shift()||0),l+(u.shift()||0)),s+=u.shift()||0,l+=u.shift()||0,e="Q",g.push(s,l);break;case"T":r=s,a=l,t=i[i.length-1],"Q"===t.command&&(r=s+(s-t.points[0]),a=l+(l-t.points[1])),s=u.shift()||0,l=u.shift()||0,e="Q",g.push(r,a,s,l);break;case"t":r=s,a=l,t=i[i.length-1],"Q"===t.command&&(r=s+(s-t.points[0]),a=l+(l-t.points[1])),s+=u.shift()||0,l+=u.shift()||0,e="Q",g.push(r,a,s,l);break;case"A":o=u.shift()||0,c=u.shift()||0,h=u.shift()||0,d=u.shift()||0,p=u.shift()||0,m=s,_=l,s=u.shift()||0,l=u.shift()||0,e="A",g=this.convertEndpointToCenterParameterization(m,_,s,l,d,p,o,c,h);break;case"a":o=u.shift()||0,c=u.shift()||0,h=u.shift()||0,d=u.shift()||0,p=u.shift()||0,m=s,_=l,s+=u.shift()||0,l+=u.shift()||0,e="A",g=this.convertEndpointToCenterParameterization(m,_,s,l,d,p,o,c,h)}i.push({command:e||n,points:g,start:{x:f,y},pathLength:this.calcLength(f,y,e||n,g)})}"z"!==n&&"Z"!==n||i.push({command:"z",points:[],start:{x:0,y:0},pathLength:0})}return i}static calcLength(e,t,n,r){let a,i,o,s,l=Oc;switch(n){case"L":return l.getLineLength(e,t,r[0],r[1]);case"C":for(a=0,i=l.getPointOnCubicBezier(0,e,t,r[0],r[1],r[2],r[3],r[4],r[5]),s=.01;s<=1;s+=.01)o=l.getPointOnCubicBezier(s,e,t,r[0],r[1],r[2],r[3],r[4],r[5]),a+=l.getLineLength(i.x,i.y,o.x,o.y),i=o;return a;case"Q":for(a=0,i=l.getPointOnQuadraticBezier(0,e,t,r[0],r[1],r[2],r[3]),s=.01;s<=1;s+=.01)o=l.getPointOnQuadraticBezier(s,e,t,r[0],r[1],r[2],r[3]),a+=l.getLineLength(i.x,i.y,o.x,o.y),i=o;return a;case"A":{a=0;let e=r[4],t=r[5],n=r[4]+t,c=Math.PI/180;if(Math.abs(e-n)<c&&(c=Math.abs(e-n)),i=l.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],e,0),t<0)for(s=e-c;s>n;s-=c)o=l.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],s,0),a+=l.getLineLength(i.x,i.y,o.x,o.y),i=o;else for(s=e+c;s<n;s+=c)o=l.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],s,0),a+=l.getLineLength(i.x,i.y,o.x,o.y),i=o;return o=l.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],n,0),a+=l.getLineLength(i.x,i.y,o.x,o.y),a}}return 0}static convertEndpointToCenterParameterization(e,t,n,r,a,i,o,s,l){let c=l*(Math.PI/180),u=Math.cos(c)*(e-n)/2+Math.sin(c)*(t-r)/2,h=-1*Math.sin(c)*(e-n)/2+Math.cos(c)*(t-r)/2,d=u*u/(o*o)+h*h/(s*s);d>1&&(o*=Math.sqrt(d),s*=Math.sqrt(d));let p=Math.sqrt((o*o*(s*s)-o*o*(h*h)-s*s*(u*u))/(o*o*(h*h)+s*s*(u*u)));a===i&&(p*=-1),isNaN(p)&&(p=0);let m=p*o*h/s,_=p*-s*u/o,g=(e+n)/2+Math.cos(c)*m-Math.sin(c)*_,f=(t+r)/2+Math.sin(c)*m+Math.cos(c)*_,y=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),v=(e,t)=>(e[0]*t[0]+e[1]*t[1])/(y(e)*y(t)),b=(e,t)=>(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(v(e,t)),x=b([1,0],[(u-m)/o,(h-_)/s]),w=[(u-m)/o,(h-_)/s],T=[(-1*u-m)/o,(-1*h-_)/s],C=b(w,T);return v(w,T)<=-1&&(C=Math.PI),v(w,T)>=1&&(C=0),0===i&&C>0&&(C-=2*Math.PI),1===i&&C<0&&(C+=2*Math.PI),[g,f,o,s,x,C,c,i]}}const kc=["radius"];class Ic extends Ec{constructor(e,t){super(e,t),this._radius=(null==t?void 0:t.radius)||10,this._setFixBoundingBox()}get radius(){return this._radius}_setFixBoundingBox(){this.transformByState({width:2*this._radius,height:2*this._radius})}_draw(e){Ic.drawWith(e,this)}static drawWith(e,t){let{radius:n}=t;n=null!=n?n:10,e.beginPath(),t.strokeDashArray&&e.setLineDash(t.strokeDashArray),e.beginPath(),e.arc(n,n,n||0,0,2*Math.PI,!1),e.closePath(),this._renderPaintInOrder(e,t)}toJson(){const e={};return kc.forEach((t=>{this[t]&&(e[t]=this[t])})),{...super.toJson(),...e}}}class Pc{constructor(e){this._dirty=!0,this._context=e,this._localeInitial()}get dirty(){return this._dirty}_localeInitial(){if(!this._context)return;const e=this._context.getLocale(),t=e.getObject("renderFont");t||e.load({en:cl,zh:ll}),this._fontLocale=t}getFontLocale(){return this._fontLocale}getContext(){return this._context}makeDirty(e){this._dirty=e}}class Lc{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return oc(e)}}const Bc=Ss.create(),Fc=Ss.create(),Hc=Ss.create(),qc=Ss.create();class Uc extends gc{constructor(){super(...arguments),this._extensions=new Map}register(...e){for(let t of e)t.parent=this,this._extensions.set(t.uKey,t)}unRegister(...e){for(let t of e)this._extensions.delete(t)}getExtensionsByOrder(){const e=Array.from(this._extensions.values());return e.sort(is),e}getExtensionByKey(e){return this._extensions.get(e)}get extensions(){return this._extensions}draw(e,t){}}function Vc(e,t,n,r,a=0,i=0,o=!1,s,l,c){const{lineHeight:u=15.6,lineTop:h=0,contentHeight:d=0,paddingLeft:p=0,paddingRight:m=0,paddingTop:_=0,paddingBottom:g=0,marginTop:f=0,spaceBelowApply:y=0}=n,v=function(e,t){return{blockId:t,type:e,divides:[],lineHeight:0,contentHeight:0,top:0,asc:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0,spaceBelowApply:0,divideLen:0,st:-1,ed:-1,lineIndex:0,paragraphStart:!1}}(t,e);v.lineIndex=a,v.paragraphStart=jc(i,o),v.contentHeight=d,v.top=h,v.lineHeight=u,v.paddingTop=_,v.paddingBottom=g,v.marginTop=f,v.spaceBelowApply=y,v.divides=function(e,t,n,r,a,i,o,s){const l=[];return l.push({left:0,width:r},{left:n-a,width:a}),null==o||o.forEach(((r,a)=>{const i=zc(r,e,t,n);i&&l.push(i)})),null==s||s.forEach(((r,a)=>{const i=zc(r,e,t,n);i&&l.push(i)})),null==i||i.forEach(((r,a)=>{const i=zc(r,e,t,n);i&&l.push(i)})),function(e,t){t.sort(((e,t)=>e.left>t.left?1:-1));const n=[];let r=0;const a=t.length;for(let i=0;i<a;i++){const o=t[i],{left:s,width:l}=o;if(s>r){let t=s-r;t=t<e?t:e-r;const a=$c(r,t);n.push(a)}if(r=Math.max(s+l,r),i===a-1&&s+l<e){const t=$c(s+l,e-s-l);n.push(t)}}return n}(n,l)}(u,h,r,p,m,s,l,c);for(let e of v.divides)e.parent=v;return v}function Wc(e,t,n,r){const{aTop:a,height:i,aLeft:o,width:s,angle:l=0,drawingOrigin:c}=e,{layoutType:u,distT:h=0,distB:d=0}=c;if(u!==Vs.WRAP_TOP_AND_BOTTOM)return;if(0===l){const e=a-h;if(e+(i+d)<n||e>t+n)return;return e+i}let{top:p=0,height:m=0}=Yc(l,o,s,a,i);return p-=h,m+=d,p+m<n||p>t+n?void 0:p+m}function zc(e,t,n,r){const{aTop:a,height:i,aLeft:o,width:s,angle:l=0,drawingOrigin:c}=e,{layoutType:u}=c;if(u===Vs.WRAP_NONE||u===Vs.WRAP_TOP_AND_BOTTOM)return;if(u===Vs.WRAP_POLYGON){const{start:e=[0,0],lineTo:a}=c;if(!a)return;let i=[];i.push(new Ml(e[0],e[1]));for(let e=0;e<a.length;e++){const t=a[e];i.push(new Ml(t[0],t[1]))}if(0!==l){const e=(new kl).rotate(l);for(let t=0;t<i.length;t++){const n=i[t];i[t]=e.applyPoint(n)}}return Gc(i,n,t,r)}if(0===l)return Xc(a,i,o,s,n,t,r,c);const h=Yc(l,o,s,a,i);if(u===Vs.WRAP_SQUARE){const{left:e,width:a,top:i,height:o}=h;return Xc(i,o,e,a,n,t,r,c)}return Gc(h.points,n,t,r)}function Yc(e,t,n,r,a){const i=(new kl).rotate(e),o=new Ml(t,r),s=new Ml(t,r+a),l=new Ml(t+n,r),c=new Ml(t+n,r+a);return i.makeBoundingBoxFromPoints([o,s,l,c])}function Gc(e,t,n,r){const a=new Ul(e),i=a.intersection([new Ml(0,t),new Ml(r,t)]),o=a.intersection([new Ml(0,t+n),new Ml(r,t+n)]);if(!i&&!o)return;const s=function(e,t=0){const n=[];for(let r=0;r<e.length;r++){const a=e[r];0===t?n.push(a.x):n.push(a.y)}return{max:Math.max(...n),min:Math.min(...n)}}([...e,...i||[],...o||[]]);return{left:s.min,width:s.max}}function Xc(e,t,n,r,a,i,o,s){const{layoutType:l,wrapText:c=Us.BOTH_SIDES,distL:u=0,distR:h=0,distT:d=0,distB:p=0}=s,m=e-(l===Vs.WRAP_SQUARE?d:0);if(m+(t+(l===Vs.WRAP_SQUARE?p:0))<a||m>i+a)return;let _=n-u,g=r+h,f=function(e,t,n,r){let a=0;e===Us.LEFT?a=1:e===Us.RIGHT?a=2:e===Us.LARGEST&&(a=t>r-t-n?1:2);return a}(c,_,g,o);return 1===f?g=o-_:2===f&&(_=0,g=n+r+h),{left:_,width:g}}function $c(e,t){return{spanGroup:[],width:t,left:e,paddingLeft:0,isFull:!1,st:0,ed:0}}function jc(e,t){return 0===e&&!0===t}function Kc(e=[],t=Fs.NONE,n=0,r=0,a=1/0,i=1/0){const o=[];let s=0,l=0;if(0===e.length)o.push(Qc(r,a,0,Fs.NONE));else for(let n=0;n<e.length;n++){const{width:i,paddingEnd:c}=e[n];n===e.length-1?(s=a!==1/0?a-s:i,l=0):(l=c,s=i),o.push(Qc(r,s,l,t)),r+=s+l}const c={columns:o,colCount:(null==e?void 0:e.length)||1,height:i,top:n,st:0,ed:0};return o.forEach((e=>{e.parent=c})),c}function Zc(e,t){e.isFull=t}function Qc(e,t,n,r){return{lines:[],left:e,width:t,height:0,spaceWidth:n,separator:r,st:0,ed:0,drawingLRIds:[],isFull:!1}}function Jc(e,t,n,r,a){var i,o;if(!e||!t)return;const{listId:s,nestingLevel:l=0,textStyle:c}=e,u=t[s];if(!u||!u.nestingLevel)return eu(s,null==(i=null==n?void 0:n[l])?void 0:i.startIndexItem,r);if(!u.nestingLevel[l])return eu(s,null==(o=null==n?void 0:n[l])?void 0:o.startIndexItem,r);const h=function(e,t,n,r,a,i,o){var s,l;const c=n[t],{bulletAlignment:u,glyphFormat:h,textStyle:d,startNumber:p,glyphType:m,glyphSymbol:_,indentFirstLine:g,hanging:f,indentStart:y}=c,v={...a,...d},b=nc(v,i);let x;x=_||function(e,t,n,r,a){var i;const o=e.split("%"),s=[o[0]];for(let e=1;e<o.length;e++){const l=o[e],{level:c,suffix:u}=nu(l);let h=(null==(i=null==r?void 0:r[c])?void 0:i.startIndexItem)||1;c!==t&&null!==(null==r?void 0:r[c])&&(h-=1);const d=tu(h,n[c],a);s.push(d,u)}return s.join("")}(h,t,n,r,o);const w=xl.getTextSize(x,b),T=null!=(l=null==(s=null==r?void 0:r[t])?void 0:s.startIndexItem)?l:1;return{listId:e,symbol:x,ts:v,fontStyle:b,startIndexItem:T+1,bBox:w,nestingLevel:c,bulletAlign:u,bulletType:!_&&!!m,indentFirstLine:g,hanging:f,indentStart:y}}(s,l,u.nestingLevel,n,c,r,a);return h}function eu(e,t=1,n){return{listId:e,symbol:"●",ts:{ff:(null==n?void 0:n.fontList[0])||"Arial",fs:(null==n?void 0:n.defaultFontSize)||9},startIndexItem:t,bBox:{width:8.4560546875,ba:7,bd:-1,aba:7,abd:-1,sp:-2,sbr:.5,sbo:0,spr:.5,spo:0},indentFirstLine:0,hanging:21,indentStart:0}}function tu(e=1,t,n){const{startNumber:r,glyphType:a,glyphSymbol:i}=t;return i||(a?function(e,t,n,r){if(!(n in ks))return function(e,t,n,r){if(!r)return"";const a=r.getPluginManager().getPluginByName("documentCustomBullet");return a?a.dealWidthCustomBulletOrderedSymbol(e,t,n):""}(e,t,n,r);return function(e,t,n){if(n===ks.DECIMAL)return ru(e,t);if(n===ks.ZERO_DECIMAL)return function(e,t){const n=e+t;if(n<10)return`0${n}`;return n.toString()}(e,t);if(n===ks.UPPER_ALPHA)return function(e,t){return rs(e+t-1,!0)}(e,t);if(n===ks.ALPHA)return function(e,t){return rs(e+t-1,!1)}(e,t);if(n===ks.UPPER_ROMAN)return function(e,t){return au(e+t,!0)}(e,t);if(n===ks.ROMAN)return function(e,t){return au(e+t,!1)}(e,t);return ru(e,t)}(e,t,n)}(e,r,a,n):"●")}function nu(e){if(""===e)return{level:0,suffix:""};const t=e.split("");let n="",r="",a=!1;const i=/[0-9]/g;return t.forEach((e=>{!a&&i.test(`${n}${e}`)?n+=e:(a=!0,r+=e)})),{level:parseInt(n)-1,suffix:r}}function ru(e,t){return(e+t).toString()}function au(e,t=!1){let n={m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1};t&&(n={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1});let r="";for(let t in n)for(;e>=n[t];)r+=t,e-=n[t];return r}function iu(e,t,n,r){return ac(e)?function(e,t,n,r){const a=[e];let i=t;for(let e=t+1;e<n.length;e++){const t=n[e];if(!ac(t))break;a.unshift(t),i=e}return{charIndex:i,spanGroup:[wu(a.join(""),r)]}}(e,t,n,r):ic(e)?function(e,t,n,r){const a=[e];let i=t;for(let e=t+1;e<n.length;e++){const t=n[e];if(!ic(t))break;a.push(t),i=e}return{charIndex:i,spanGroup:[xu(a.join(""),r)]}}(e,t,n,r):rc(e)?void 0:function(e,t,n,r){const{pageWidth:a=1/0}=r,i=wu(e,r),o=[i];let s=i.width,l=t;for(let e=t+1;e<n.length;e++){const t=n[e];if(rc(t))break;{const n=wu(t,r),i=n.width;if(s+i>a)break;o.push(n),s+=i,l=e}}return{charIndex:l,spanGroup:o}}(e,t,n,r)}function ou(e,t,n,r,a=0,i=!1){if(jc(a,i))if(r.bulletSkeleton){const{bulletSkeleton:o,paragraphStyle:s={}}=r,{gridType:l=Ls.LINES,charSpace:c=0,defaultTabStop:u=1}=n,{snapToGrid:h=ka.TRUE}=s,d=Nu(c,u,l,h);!function(e,t,n){const{hanging:r,indentStart:a}=e,{hanging:i,indentStart:o}=t;void 0===r&&(e.hanging=i);void 0===a&&(e.indentStart=Ru(o||0,n)-Ru(i||0,n))}(s,o,d);const p=function(e,t,n){const{bBox:r,symbol:a,ts:i,fontStyle:o,bulletAlign:s=Is.START,bulletType:l=!1}=t,c=r.width,u=Math.ceil(c/n);let h=(u<2?2:u)*n,d=0;l&&(s===Is.CENTER?(d=-c/2,h-=d):s===Is.END&&(d=-c,h-=d));const p=function(e,t){const{ba:n,bd:r}=e.bBox,{ba:a,bd:i}=t.bBox;if(n+r>a+i)return e.bBox;return t.bBox}(e,t);return{content:a,ts:i,fontStyle:o,width:h,paddingLeft:0,bBox:p,left:d,spanType:Cl.LIST}}(e[0],o,d);lu([p,...e],t,n,r,a,i)}else lu(e,t,n,r,a,i);else su(e,t,n,r,a,i);return[...t]}function su(e,t,n,r,a=0,i=!1,o){var s,l;const c=Cu(t),u=Su(c);if(u){const h=function(e){const t=e.length;let n=0;for(let r=0;r<t;r++){n+=e[r].width}return n}(e),d=u.divide,p=null==(s=null==d?void 0:d.spanGroup)?void 0:s[d.spanGroup.length-1],m=(null==p?void 0:p.width)||0,_=(null==p?void 0:p.left)||0,g=function(e){const{width:t,marginLeft:n,marginRight:r}=e;return t-n-r}(c);if(m+_+h>d.width){!function(e,t){e.isFull=t}(d,!0);const s=function(e){var t;const n=null==(t=e.parent)?void 0:t.parent;if(n)return n}(d);h>g?function(e){if(e.sections.length>1)return!1;const t=Eu(e),n=t.columns.length;for(let e=0;e<n;e++){if(!Du(t.columns[e]))return!1}return!0}(c)?(d.spanGroup.push(...e),function(e=[]){for(let t=0;t<e.length;t++){Zc(e[t],!0)}}(null==(l=null==s?void 0:s.parent)?void 0:l.columns)):uu(e,t,n,r,a,i,o):s&&h>s.width?(Zc(s,!0),Du(s)?d.spanGroup.push(...e):cu(e,t,n,r,a,i,o)):u.isLast?lu(e,t,n,r,a,i,o):su(e,t,n,r,a,i,o)}else{const o=d.parent,s=function(e){const t=e.length;let n,r=-1/0;for(let a=0;a<t;a++){const t=e[a],{ba:i,bd:o}=t.bBox;r<i+o&&(n={boundingBoxAscent:i,boundingBoxDescent:o}),r=i+o}return n}(e);if(o&&s){const{paragraphLineGapDefault:l,linePitch:c,lineSpacing:u,spacingRule:h,snapToGrid:d,gridType:p}=Ou(n,r),{boundingBoxAscent:m,boundingBoxDescent:_}=s,g=m+_,{contentHeight:f}=hu(g,l,c,p,u,h,d);if(o.contentHeight<f){const s=function(e){const t=e.divides,n=t.length,r=[];for(let e=0;e<n;e++){const n=t[e];r.push(...n.spanGroup)}return r}(o),l=s.length;let c=[],u=1;s[0].spanType===Cl.LIST&&l>2?(c=[s[0],s[1]],u=2):c=[s[0]];const h=o.parent;null==h||h.lines.pop(),lu(c,t,n,r,a,i,m+_);for(let e=u;e<s.length;e++)su([s[e]],t,n,r,a,i);return void su(e,t,n,r,a,i)}}!function(e,t=0){const n=e.length;let r;for(let a=0;a<n;a++){const n=e[a];n.left=r?r.left+r.width:t,r=n}}(e,m+_);for(let t of e)t.parent=d;d.spanGroup.push(...e)}}else lu(e,t,n,r,a,i,o)}function lu(e,t,n,r,a=0,i=!1,o){var s,l,c,u,h;let d=Cu(t),p=Au(d);p&&p.column||(uu(e,t,n,r,a),d=Cu(t),p=Au(d));const m=p.column,_=function(e){return e.lines[e.lines.length-1]}(m),{ba:g,bd:f}=e[0].bBox,y=o||g+f,{paragraphStyle:v={},paragraphAffectSkeDrawings:b,skeHeaders:x,skeFooters:w,blockAnchor:T,blockId:C}=r,{namedStyleType:E=Ws.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:A=Ra.UNSPECIFIED,direction:S,spaceAbove:D=0,spaceBelow:R=0,borderBetween:N,borderTop:M,borderBottom:O,borderLeft:k,borderRight:I,indentFirstLine:P=0,hanging:L=0,indentStart:B=0,indentEnd:F=0,tabStops:H=[],keepLines:q=ka.FALSE,keepNext:U=ka.FALSE,wordWrap:V=ka.FALSE,widowControl:W=ka.FALSE,shading:z}=v,{paragraphLineGapDefault:Y,linePitch:G,lineSpacing:X,spacingRule:$,snapToGrid:j,gridType:K}=Ou(n,r),Z=jc(a,i),{paddingTop:Q,paddingBottom:J,contentHeight:ee,lineSpacingApply:te}=hu(y,Y,G,K,X,$,j),{marginTop:ne,spaceBelowApply:re}=function(e=0,t=0,n=0,r,a){let i=0,o=0;if(!r)return{marginTop:i,spaceBelowApply:o};if(i=Ru(t,e),o=Ru(n,e),a){const{spaceBelowApply:e}=a;e>i&&(i=0,a.lineHeight+=e,a.marginBottom=e)}return{marginTop:i,spaceBelowApply:o}}(te,D,R,Z,_),ae=ne+Q+ee+J;let ie=m.parent;ie||(ie=Eu(d));const oe=((null==_?void 0:_.lineHeight)||0)+((null==_?void 0:_.top)||0),{width:se,headerId:le,footerId:ce}=d,ue=null==(l=null==(s=null==x?void 0:x.get(le))?void 0:s.get(se))?void 0:l.skeDrawings,he=null==(u=null==(c=null==w?void 0:w.get(ce))?void 0:c.get(se))?void 0:u.skeDrawings;!function(e,t,n,r,a){var i;if(!a)return;const o=null==(i=n.parent)?void 0:i.parent;if(!o)return;const s=new Map,l=function(e){const t=e.parent;if(!t)return!1;const n=null==t?void 0:t.columns;if(!n)return!1;for(let e=n.length-1;e>=0;e--){const t=n[e].lines,r=t.length;if(!(r<=0))for(let e=r-1;e>=0;e--){if(t[e].paragraphStart)return!1}}return!0}(n);a.forEach((a=>{if(!a)return;const{initialState:i,drawingOrigin:c}=a;if(i||!c)return;const{objectProperties:u}=c,{positionH:h,positionV:d,size:p,angle:m}=u,{width:_=0,height:g=0}=p;a.aLeft=function(e,t,n,r,a=!1){const{relativeFrom:i,align:o,posOffset:s,percent:l}=e;if(null!=o)if(o===js.INSIDE||o===js.OUTSIDE)i===Gs.MARGIN||Gs.PAGE;else{if(i===Gs.COLUMN){const{width:e,left:n}=t;let a=0;return o===js.LEFT?a=n:o===js.RIGHT?a=n+e-r:o===js.CENTER&&(a=n+e/2-r/2),a}if(i===Gs.LEFT_MARGIN);else if(i===Gs.MARGIN);else if(i===Gs.RIGHT_MARGIN);else if(i===Gs.INSIDE_MARGIN);else if(i===Gs.OUTSIDE_MARGIN);else if(i===Gs.PAGE){const{width:e}=n;let t=0;return o===js.RIGHT?t=e-r:o===js.CENTER&&(t=e/2-r/2),t}}else{if(s){const{width:e,marginLeft:o,marginRight:l}=n,c=e-l;let u=0;return i===Gs.COLUMN?u=(a?0:(null==t?void 0:t.left)||0)+s:i===Gs.LEFT_MARGIN||(i===Gs.MARGIN?u=s+o:i===Gs.RIGHT_MARGIN||i===Gs.INSIDE_MARGIN||i===Gs.OUTSIDE_MARGIN||i===Gs.PAGE&&(u=s)),u+r>c&&(u=c-r),u}if(l){const{width:e,marginLeft:t,marginRight:r}=n;if(i===Gs.LEFT_MARGIN);else if(i===Gs.MARGIN);else if(i===Gs.RIGHT_MARGIN);else if(i===Gs.INSIDE_MARGIN);else if(i===Gs.OUTSIDE_MARGIN);else if(i===Gs.PAGE)return l*e}}}(h,n,o,_,l)||0,a.aTop=function(e,t,n,r,a,i,o=!1){const{relativeFrom:s,align:l,posOffset:c,percent:u}=e;if(null!=l){if(s===Xs.LINE){let e=0;return l===Ks.BOTTOM?e=n+r-a:l===Ks.TOP?e=n:l===Ks.CENTER&&(e=n+r/2-a/2),e}if(s===Xs.TOP_MARGIN);else if(s===Xs.MARGIN);else if(s===Xs.BOTTOM_MARGIN);else if(s===Xs.INSIDE_MARGIN);else if(s===Xs.OUTSIDE_MARGIN);else if(s===Xs.PAGE){const{height:e}=t;let n=0;return l===Ks.BOTTOM?n=e-a:l===Ks.CENTER&&(n=e/2-a/2),n}}else{if(c){let e=0;return s===Xs.LINE?e=n||0+c:s===Xs.TOP_MARGIN||s===Xs.MARGIN||s===Xs.BOTTOM_MARGIN||s===Xs.INSIDE_MARGIN||s===Xs.OUTSIDE_MARGIN||(s===Xs.PAGE?e=c:s===Xs.PARAGRAPH&&(e=(o?0:i||n)+c)),e}if(u){const{height:e,marginBottom:n,marginTop:r}=t;if(s===Xs.TOP_MARGIN);else if(s===Xs.MARGIN);else if(s===Xs.BOTTOM_MARGIN);else if(s===Xs.INSIDE_MARGIN);else if(s===Xs.OUTSIDE_MARGIN);else if(s===Xs.PAGE)return u*e}}}(d,o,e,t,g,r,l)||0,a.width=_,a.height=g,a.angle=m,a.initialState=!0,s.set(a.objectId,a)})),o.skeDrawings=new Map([...o.skeDrawings,...s])}(oe,ae,m,null==(h=null==T?void 0:T.get(C))?void 0:h.top,b);const de=function(e=15.6,t=0,n=0,r,a,i){let o=t;return null==a||a.forEach((n=>{const r=Wc(n,e,t);r&&(o=Math.max(o,r))})),null==i||i.forEach((n=>{const r=Wc(n,e,t);r&&(o=Math.max(o,r))})),null==r||r.forEach((n=>{const r=Wc(n,e,t);r&&(o=Math.max(o,r))})),o}(ae,oe,a,d.skeDrawings,ue,he);if(ae+de>ie.height&&m.lines.length>0&&d.sections.length>1)return Zc(m,!0),void cu(e,t,n,r,a,i,o);const pe=_?_.lineIndex+1:0,{charSpace:me,defaultTabStop:_e}=function(e,t){const{paragraphStyle:n={}}=t,{charSpace:r=0,gridType:a=Ls.LINES,defaultTabStop:i=36,documentTextStyle:o={}}=e,{fs:s=ml}=o,{snapToGrid:l=ka.TRUE}=n;return{charSpace:r,documentFontSize:s,defaultTabStop:i,gridType:a,snapToGrid:l}}(n,r),ge=Nu(me,_e,K,j),{paddingLeft:fe,paddingRight:ye,changeBulletWidth:ve}=function(e,t=0,n=0,r=0,a=0,i){const{spanType:o=Cl.LETTER,bBox:s}=e;let l=Ru(t,i),c=Ru(n,i),u=Ru(r,i),h=Ru(a,i),d=u,p=h,m={state:!1,hangingNumber:0};if(o===Cl.LIST){const{width:e}=s;l>0?d+=l:c>0&&c>e&&(m.state=!0,m.hangingNumber=c)}else d+=c;return{paddingLeft:d,paddingRight:p,changeBulletWidth:m}}(e[0],P,L,B,F,ge);ve.state&&(e[0].width=ve.hangingNumber);const be=Vc(C,Tl.PARAGRAPH,{lineHeight:ae,contentHeight:ee,lineTop:de,paddingLeft:fe,paddingRight:ye,paddingTop:Q,paddingBottom:J,marginTop:ne,spaceBelowApply:re},m.width,pe,a,i,d.skeDrawings,ue,he);m.lines.push(be),be.parent=m,function(e,t,n,r){if(r)if(r.has(e)){const n=r.get(e);null==n||n.elements.push(t)}else r.set(e,{elements:[t],blockId:e,top:n})}(C,_,oe,T),su(e,t,n,r,a,i,o)}function cu(e,t,n,r,a=0,i=!1,o){const s=function(e){const t=Eu(e),n=t.columns.length;for(let e=0;e<n;e++){if(!t.columns[e].isFull)return!1}return!0}(Cu(t));!0===s?uu(e,t,n,r,a,i,o):lu(e,t,n,r,a,i,o)}function uu(e,t,n,r,a=0,i=!1,o){const s=Cu(t),{skeHeaders:l,skeFooters:c}=r;t.push(gu(n,{skeHeaders:l,skeFooters:c},null==s?void 0:s.pageNumber)),cu(e,t,n,r,a,i,o)}function hu(e,t,n,r,a,i,o){let s=t,l=t;if(r===Ls.DEFAULT||o===ka.FALSE)return i===zs.AUTO?{paddingTop:s,paddingBottom:l,contentHeight:a*e,lineSpacingApply:e}:{paddingTop:s,paddingBottom:l,contentHeight:Math.max(a,e),lineSpacingApply:a};let c=0;return c=i===zs.AUTO?a*n:a,e+2*t<c&&(s=l=(c-e)/2),{paddingTop:s,paddingBottom:l,contentHeight:e,lineSpacingApply:c}}function du(e,t,n,r,a,i){const{pageNumberStart:o,pageSize:s={w:1/0,h:1/0},marginRight:l=0,marginLeft:c=0,columnProperties:u=[],columnSeparatorType:h=Fs.NONE,contentDirection:d,sectionType:p,sectionTypeNext:m,textDirection:_,lists:g,drawings:f={},fontLocale:y}=r,{elements:v,elementOrder:b,paragraphStyle:x={},bullet:w}=t,{skeHeaders:T,skeFooters:C,skeListLevel:E,blockAnchor:A}=a,S={blockId:e,paragraphStyle:x,skeHeaders:T,skeFooters:C,blockAnchor:A},D=[n];let R=n;const N=new Map,M=function(e,t){if(!e||!t)return;const{listId:n,nestingLevel:r}=e,a=null==t?void 0:t.get(n);let i=r;i<0&&(i=0);const o=[];for(let e=i;e>=0;e--){const t=null==a?void 0:a[e];o[e]=t||null}return o}(w,E),O=Jc(w,g,M,y,i);return function(e,t,n){if(!e||!t)return;const{listId:r,nestingLevel:a}=e,i=[...(null==n?void 0:n.get(r))||[]];i[a]=t,i.splice(a+1),null==n||n.set(r,i)}(w,O,E),S.bulletSkeleton=O,b.forEach(((e,t)=>{const{elementId:n,paragraphElementType:i}=e;let o=[];if(i===qs.TEXT_RUN){const e=v[n],{tr:a,st:i,ed:s}=e;if(!a)return!1;o=function(e,t=0,n,r,a,i){const{ct:o="",ts:s={},tab:l=!1}=e,c=nc(s,i),{paragraphStyle:u={}}=a,{gridType:h=Ls.LINES,charSpace:d=0,documentTextStyle:p={},defaultTabStop:m=10.5,pageSize:_={width:1/0,height:1/0},marginLeft:g=0,marginRight:f=0}=n,{namedStyleType:y=Ws.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:v=Ra.UNSPECIFIED,lineSpacing:b=1,spacingRule:x=zs.AUTO,snapToGrid:w=ka.TRUE,direction:T,spaceAbove:C=0,spaceBelow:E=0,borderBetween:A,borderTop:S,borderBottom:D,borderLeft:R,borderRight:N,indentFirstLine:M=0,hanging:O=0,indentStart:k=0,indentEnd:I=0,tabStops:P=[],keepLines:L=ka.FALSE,keepNext:B=ka.FALSE,wordWrap:F=ka.FALSE,widowControl:H=ka.FALSE,shading:q}=u;let U=[r];const V=_.width||1/0-g-f,W={...p,...s},z={fontStyle:c,textStyle:W,charSpace:d,gridType:h,snapToGrid:w,pageWidth:V};if(l){const e=Nu(d,m,h,w);return U=ou([(Y=z,G=e,Tu(Cl.TAB," ",Y,G))],U,n,a,t,!0),U}var Y,G;const X=o.split("");for(let e=0;e<X.length;e++){const r=X[e],i=iu(r,e,X,z);let o=[];if(i){const{charIndex:t,spanGroup:n}=i;e=t,o=n}else{const e=xu(r,z);o.push(e)}U=ou(o,U,n,a,t,0===e)}return function(e,t){for(let n of e){const{sections:e}=n;for(let n of e){const{columns:e}=n;for(let n of e){const{lines:e}=n;for(let n of e)t&&Ql(t)&&t(n)}}}}(U,(e=>{!function(e,t){if(t===Ra.UNSPECIFIED||t===Ra.LEFT)return;const{divides:n}=e,r=n.length;for(let e=0;e<r;e++){const r=n[e],{width:a,spanGroup:i}=r,o=Iu(r);a!==1/0&&(t===Ra.CENTER?r.paddingLeft=(a-o)/2:t===Ra.RIGHT?r.paddingLeft=a-o:Ra.JUSTIFIED)}}(e,v)})),U}(a,t,r,R,{...S,paragraphAffectSkeDrawings:N},y)}else if(i===qs.DRAWING){const e=f[n];e.layoutType===Vs.INLINE?o=[]:N.set(n,function(e){return{objectId:e.objectId,aLeft:0,aTop:0,width:0,height:0,angle:0,initialState:!1,drawingOrigin:e}}(e))}else if(i===qs.PAGE_BREAK)o=[gu(r,a,pu(R),wl.PAGE)],N.clear();else if(i===qs.COLUMN_BREAK){const e=Au(R);e&&!e.isLast?Zc(e.column,!0):o=[gu(r,a,pu(R),wl.COLUMN)]}R=function(e,t){const n=e.slice(-1)[0],r=t[0];if(n===r){if(1===t.length)return n;t.unshift()}return e.push(...t),e.slice(-1)[0]}(D,o)})),D}function pu(e){return e.pageNumber+1}function mu(e,t,n,r,a,i){const o=[],s=new Map;for(let l of e){const{paragraph:e,table:c,tableOfContents:u,blockType:h,customBlock:d,blockId:p}=l;if(null==a?void 0:a.get(p))continue;let m=[],_=t;o.length>0&&(_=o[o.length-1]),h===Ps.PARAGRAPH&&e?m=du(l.blockId,e,_,n,r,i):h===Ps.TABLE&&c||h===Ps.SECTION_BREAK&&u||h===Ps.CUSTOM&&(m=hc(l.blockId,d,_,n,r,i)),0===m.length&&(m=[]),ku(m),_u(o,m),s.set(p,!0)}return{pages:o,renderedBlockIdMap:s}}function _u(e,t){e[e.length-1]===t[0]&&t.splice(0,1),e.push(...t)}function gu(e,t,n=1,r=wl.SECTION){var a,i,o,s;const l={sections:[],headerId:"",footerId:"",pageNumber:1,pageNumberStart:1,verticalAlign:!1,angle:0,width:0,height:0,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,breakType:wl.SECTION,st:0,ed:0,skeDrawings:new Map},{pageNumberStart:c=1,pageSize:u={width:1/0,height:1/0},headerIds:h={},footerIds:d={},useFirstPageHeaderFooter:p,useEvenPageHeaderFooter:m,footers:_,headers:g,columnProperties:f=[],columnSeparatorType:y,marginTop:v=0,marginBottom:b=0,marginHeader:x=0,marginFooter:w=0,marginLeft:T=0,marginRight:C=0,renderConfig:E={}}=e,{skeHeaders:A,skeFooters:S}=t,{width:D=1/0,height:R=1/0}=u;l.pageNumber=n,l.pageNumberStart=c,l.renderConfig=E;const N=l.sections,M=N[N.length-1],{marginTop:O,marginBottom:k,marginLeft:I,marginRight:P}=l,L=D-I-P,B=R-O-k;let F=O;M&&(F=M.top+M.height);const H=Kc(f,y,F,I,L,B-F);H.parent=l,N.push(H),l.marginLeft=T,l.marginRight=C,l.breakType=r,l.width=D,l.height=R;const{defaultHeaderId:q,evenPageHeaderId:U,firstPageHeaderId:V}=h,{defaultFooterId:W,evenPageFooterId:z,firstPageFooterId:Y}=d;let G,X,$=null!=q?q:"",j=null!=W?W:"";return n===c&&p?($=null!=V?V:"",j=null!=Y?Y:""):n%2==0&&m&&($=null!=U?U:"",j=null!=z?z:""),$&&((null==(a=A.get($))?void 0:a.has(D))?G=null==(i=A.get($))?void 0:i.get(D):g&&(G=fu(g[$],e,t),A.set($,new Map([[D,G]]))),l.headerId=$),j&&((null==(o=S.get(j))?void 0:o.has(D))?X=null==(s=S.get(j))?void 0:s.get(D):_&&(X=fu(_[j],e,t),S.set($,new Map([[D,X]]))),l.footerId=j),l.marginTop=yu(v,x,G),l.marginBottom=yu(b,w,X),l}function fu(e,t,n,r=!0){const{body:a}=e,{lists:i,headers:o,footers:s,fontLocale:l,pageSize:c,marginLeft:u=0,marginRight:h=0,drawings:d,marginTop:p=0,marginBottom:m=0,marginHeader:_=0,marginFooter:g=0}=t,f={lists:i,headers:o,footers:s,pageSize:{width:((null==c?void 0:c.width)||1/0)-u-h,height:1/0},fontLocale:l,drawings:d},{blockElements:y,blockElementOrder:v}=a,b=[];v.forEach((e=>{const t=y[e];b.push(t)}));const x=gu(f,n),w=mu(b,x,f,n)[0],T=w.sections[0].columns[0],C=T.height||0,{skeDrawings:E,st:A,ed:S}=w,D={lines:T.lines,skeDrawings:E,height:C,st:A,ed:S,marginLeft:u,marginRight:h};return r?{...D,marginTop:vu(p,_,C)}:{...D,marginBottom:bu(m,g,C)}}function yu(e,t,n){return n&&0!==n.lines.length?Math.max(e,t,(null==n?void 0:n.height)||0):e}function vu(e,t,n){const r=Math.max(e,t);return n>r?0:r-n}function bu(e,t,n){const r=Math.max(e,t);return n>r?0:r-n}function xu(e,t,n){return Tu(Cl.WORD,e,t,n)}function wu(e,t,n){return Tu(Cl.LETTER,e,t,n)}function Tu(e,t,n,r){const{fontStyle:a,textStyle:i,charSpace:o=1,gridType:s=Ls.LINES,snapToGrid:l=ka.FALSE}=n,c=xl.getTextSize(t,a),{width:u=0}=c;let h=null!=r?r:u,d=0;if(Mu(s,l)){h=Math.ceil(u/o)*o,s===Ls.LINES_AND_CHARS&&(d=(h-u)/2)}return{content:t,ts:i,fontStyle:a,width:h,bBox:c,paddingLeft:d,left:0,spanType:e}}function Cu(e){return null==e?void 0:e[e.length-1]}function Eu(e){var t;return null==(t=null==e?void 0:e.sections)?void 0:t[e.sections.length-1]}function Au(e){const t=Eu(e);for(let e=0;e<t.columns.length;e++){const n=t.columns[e];if(!n.isFull)return{column:n,isLast:e===t.columns.length-1,index:e}}}function Su(e){const t=function(e){var t;const n=null==(t=Au(e))?void 0:t.column.lines;return null==n?void 0:n[n.length-1]}(e);if(t)for(let e=0;e<t.divides.length;e++){const n=t.divides[e];if(!n.isFull)return{divide:n,isLast:e===t.divides.length-1,index:e}}}function Du(e){const t=e.lines;if(t.length>1)return!1;return function(e){if(!e)return!0;for(let t=0;t<e.divides.length;t++){const n=e.divides[t].spanGroup.length;if(n>1)return!1;if(1===n){const n=e.divides[t].spanGroup[0],{spanType:r}=n;if(r!==Cl.TAB&&r!==Cl.LIST)return!1}}return!0}(t[t.length-1])}function Ru(e,t){if(e instanceof Object){const{v:n,u:r}=e;return r===$s.POINT?n:n*t}return e}function Nu(e=0,t,n=Ls.LINES,r=ka.TRUE){let a=1;return Mu(n,r)&&(a=e),a*=t,a}function Mu(e=Ls.LINES,t=ka.FALSE){return t===ka.TRUE&&(e===Ls.LINES_AND_CHARS||e===Ls.SNAP_TO_CHARS)}function Ou(e,t){const{paragraphStyle:n={}}=t,{linePitch:r=15.6,gridType:a=Ls.LINES,paragraphLineGapDefault:i=3}=e,{lineSpacing:o=1,spacingRule:s=zs.AUTO,snapToGrid:l=ka.TRUE}=n;return{paragraphLineGapDefault:i,linePitch:r,gridType:a,lineSpacing:o,spacingRule:s,snapToGrid:l}}function ku(e){const t=e[0],{st:n}=t;let r=n;for(let t of e){const{sections:e}=t;let n=r,a=n,i=0,o=-1/0,s=0;for(let t of e){const{columns:e}=t;let r=i,l=n,c=0,u=-1/0;for(let t of e){const{lines:e}=t;let n=c,r=n,i=0,s=0,h=-1/0,d=null;for(let t of e){const{divides:e,lineHeight:n}=t;let o=i,c=o,u=0,p=0,m=0;s+=n;const _=e.length;for(let t=0;t<_;t++){const n=e[t],{spanGroup:i}=n;let o=u,s=o;for(let e of i){const i=e.spanType===Cl.LIST?0:e.count||1;a+=i,l+=i,r+=i,c+=i,s+=i;const o=e.bBox,{ba:u}=o;m=Math.max(m,u),t===_-1&&n.width===1/0&&(p+=e.width)}t===_-1&&(n.width===1/0?n.width=p:p+=n.width,p+=n.left),n.st=o,n.ed=s}t.st=o,t.ed=c,t.width=p,t.asc=m,h=Math.max(h,p),t.top=((null==d?void 0:d.top)||0)+((null==d?void 0:d.lineHeight)||0),d=t}t.st=n,t.ed=r,t.height=s,t.width===1/0&&(t.width=h),o=Math.max(o,h),u=Math.max(u,t.height)}t.st=r,t.ed=l,t.height=u,s+=u}t.st=n,t.ed=a,t.height=s,t.width=o,r=a}}function Iu(e){const t=e.spanGroup;let n=0;for(let e of t)n+=e.width;return n}class Pu extends Pc{constructor(e,t){super(t),this._renderedBlockIdMap=new Map,this._left=0,this._top=0,this._documentData=e}get left(){return this._left}get top(){return this._top}calculate(e){this.dirty&&(this._skeleton=this._createSkeleton(e))}getSkeleton(){return this._skeleton}setPosition(e,t){return this._left=e,this._top=t,this}updateDocumentDataPageSize(e,t){const n=this._documentData.documentStyle;if(!n.pageSize)return e=null!=e?e:1/0,t=null!=t?t:1/0,void(n.pageSize={width:e,height:t});void 0!==e&&(n.pageSize.width=e),void 0!==t&&(n.pageSize.height=t)}getLastPageSize(e=0){if(!this._skeleton)return;const{pages:t}=this._skeleton,n=t[t.length-1];if(0===e){const{width:e,height:t}=n;return{width:e,height:t}}let r=0,a=0;const i=Fl(e),o=[];!function(e,t){for(let n of e){const{sections:e}=n;for(let n of e){const{columns:e}=n;for(let n of e)t&&Ql(t)&&t(n)}}}([n],(t=>{const{lines:n,width:r,spaceWidth:i}=t,{rotatedHeight:s,rotatedWidth:l}=Hl(n,r,e);a+=s,o.push({rotatedWidth:l,spaceWidth:i})}));const s=Math.tan(e),l=Math.sin(e),c=o.length;for(let e=0;e<c;e++){const{rotatedWidth:t,spaceWidth:n}=o[e];0===e&&(r+=t),(i===yl.UP&&0===e||i===yl.DOWN&&e===c-1)&&(r+=(t+n/l)/s)}return{width:r,height:a}}__getContentMapArr(){const{body:e}=this._documentData;if(!e)return[];const{blockElements:t,blockElementOrder:n}=e;if(!t||0===n.length)return[];const r=[];let a={blockElements:[],sectionBreak:void 0};return n.forEach((e=>{const n=t[e],{sectionBreak:i}=n;i?(a.sectionBreak=i,r.push(a),a={blockElements:[],sectionBreak:void 0}):a.blockElements.push(n)})),a.sectionBreak||(a.sectionBreak={columnProperties:[],columnSeparatorType:Fs.NONE,sectionType:Bs.SECTION_TYPE_UNSPECIFIED},r.push(a)),r}_createSkeleton(e){var t;const n=this.__getContentMapArr(),r={width:1/0,height:1/0},{documentStyle:a,footers:i,headers:o,lists:s,drawings:l}=this._documentData,{pageNumberStart:c=1,pageSize:u=r,defaultHeaderId:h,defaultFooterId:d,evenPageHeaderId:p,evenPageFooterId:m,firstPageHeaderId:_,firstPageFooterId:g,useFirstPageHeaderFooter:f,useEvenPageHeaderFooter:y,marginTop:v=0,marginBottom:b=0,marginRight:x=0,marginLeft:w=0,marginHeader:T=0,marginFooter:C=0,charSpace:E=0,linePitch:A=15.6,gridType:S=Ls.LINES,paragraphLineGapDefault:D=3,defaultTabStop:R=10.5,textStyle:N={fs:10.5},renderConfig:M={horizontalAlign:Ra.UNSPECIFIED,verticalAlign:Na.UNSPECIFIED,centerAngle:0,vertexAngle:0,wrapStrategy:Ma.UNSPECIFIED}}=a,O=this.__getNullSke();if(0===n.length)return O;const k={footers:i,headers:o,lists:s,drawings:l,charSpace:E,linePitch:A,gridType:S,fontLocale:this.getFontLocale(),paragraphLineGapDefault:D,defaultTabStop:R,documentTextStyle:N},{skeHeaders:I,skeFooters:P,skeListLevel:L,blockAnchor:B}=O,F={skeHeaders:I,skeFooters:P,skeListLevel:L,blockAnchor:B},H=[];O.pages=H;for(let e=0;e<n.length;e++){const r=n[e];if(!r.sectionBreak)continue;const{pageNumberStart:a=c,pageSize:i=u,marginTop:o=v,marginBottom:s=b,marginRight:l=x,marginLeft:E=w,marginHeader:A=T,marginFooter:S=C,defaultHeaderId:D=h,defaultFooterId:R=d,evenPageHeaderId:N=p,evenPageFooterId:O=m,firstPageHeaderId:I=_,firstPageFooterId:P=g,useFirstPageHeaderFooter:L=f,useEvenPageHeaderFooter:B=y,columnProperties:q=[],columnSeparatorType:U=Fs.NONE,contentDirection:V,sectionType:W,textDirection:z,renderConfig:Y=M}=r.sectionBreak,G=n[e+1],X=null==(t=null==G?void 0:G.sectionBreak)?void 0:t.sectionType,$={defaultHeaderId:D,evenPageHeaderId:N,firstPageHeaderId:I},j={defaultFooterId:R,evenPageFooterId:O,firstPageFooterId:P};null===i.width&&(i.width=1/0),null===i.height&&(i.height=1/0);const K={pageNumberStart:a,pageSize:i,marginTop:o,marginBottom:s,marginRight:l,marginLeft:E,marginHeader:A,marginFooter:S,headerIds:$,footerIds:j,useFirstPageHeaderFooter:L,useEvenPageHeaderFooter:B,columnProperties:q,columnSeparatorType:U,contentDirection:V,sectionType:W,sectionTypeNext:X,textDirection:z,renderConfig:Y,...k};let Z=Cu(H);W===Bs.CONTINUOUS?this.__addNewSectionByContinuous(Z,q,U):Z=gu(K,F,null==Z?void 0:Z.pageNumber);const Q=this.getContext(),J=mu(r.blockElements,Z,K,F,this._renderedBlockIdMap,Q);X===Bs.CONTINUOUS&&q.length;const{pages:ee,renderedBlockIdMap:te}=J;ee.forEach((e=>{})),H.push(...ee)}return O}__addNewSectionByContinuous(e,t,n){const r=e.sections,a=r[r.length-1],{width:i,height:o,marginTop:s,marginBottom:l,marginLeft:c,marginRight:u}=e,h=i-c-u,d=o-s-l,p=((null==a?void 0:a.top)||0)+((null==a?void 0:a.height)||0),m=Kc(t,n,p,h,d-p);m.parent=e,r.push(m)}__getNullSke(){return{pages:[],left:0,top:0,st:0,skeHeaders:new Map,skeFooters:new Map,skeListLevel:new Map,blockAnchor:new Map}}static create(e,t){return new Pu(e,t)}}class Lu extends Uc{constructor(e,t,n=!1){super(e),this._skeleton=t,this._allowCache=n,this._allowCache&&(this._cacheCanvas=new pc),this.onIsAddedToParentObserver.add((e=>{var t;null==(t=null==e?void 0:e.getEngine())||t.onTransformChangeObservable.add((e=>{this.resizeCacheCanvas()})),this.resizeCacheCanvas()}))}getSkeleton(){return this._skeleton}render(e,t){if(!this.visible)return this.makeDirty(!1),this;this._skeleton&&(e.save(),this._draw(e,t),e.restore())}_getBounding(e){}_draw(e,t){}changeSkeleton(e){return this._skeleton=e,this}getParentScale(){if(!this.parent)return{scaleX:1,scaleY:1};let{scaleX:e=1,scaleY:t=1}=this.parent;return this.parent.classType===vl.SCENE&&(e=this.parent.ancestorScaleX||1,t=this.parent.ancestorScaleY||1),{scaleX:e,scaleY:t}}}var Bu=(e=>(e[e.SPAN=0]="SPAN",e[e.LINE=1]="LINE",e))(Bu||{});class Fu extends Lc{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}qc.add(new class extends Fu{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=Ml.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||gl;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});qc.add(new class extends Fu{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=Ml.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});qc.add(new class extends Fu{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=oc(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=Ml.create(0,0),centerPoint:f=Ml.create(0,0),alignOffset:y=Ml.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||gl;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=tc(o+1-.5,d),i=Bl(g.addByPoint(l,a),f,b,x,y),s=Bl(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||gl;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=tc(h-.5,d),i=Bl(g.addByPoint(l,a),f,b,x,y),o=Bl(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||gl;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=tc(-1.5,d),i=Bl(g.addByPoint(l,a),f,b,x,y),o=Bl(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});qc.add(new class extends Fu{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=Ml.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||gl;r!==this._preBorderStyle&&(Pl(e,r),e.lineWidth=Ll(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||gl,this._preBorderColor=i),Il(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(fl.TOP,t),n&&i.set(fl.BOTTOM,n),r&&i.set(fl.LEFT,r),a&&i.set(fl.RIGHT,a),i}});class Hu extends Lu{constructor(e,t,n=!0){super(e,t,n),this._translateX=0,this._translateY=0,this._translateSaveList=[],this.isCalculateSkeleton=!0,this._initialDefaultExtension(),this.makeDirty(!0)}_draw(e,t){this.draw(e,t)}_translateBy(e=0,t=0){this._translateX=e,this._translateY=t}_translate(e=0,t=0){this._translateX+=e,this._translateY+=t}_translateSave(){this._translateSaveList.push({x:this._translateX,y:this._translateY})}_translateRestore(){const e=this._translateSaveList.pop();e&&(this._translateX=e.x,this._translateY=e.y)}_horizontalHandler(e,t,n,r){let a=0;return a=r===Ra.CENTER?(this.width-e)/2:r===Ra.RIGHT?this.width-e-n:t,a}_verticalHandler(e,t,n,r){let a=0;return a=r===Na.MIDDLE?(this.height-e)/2:r===Na.BOTTOM?this.height-e-n:t,a}_startRotation(e,t){e.rotate(t||0)}_resetRotation(e,t){e.rotate(-t||0)}_initialDefaultExtension(){qc.getData().forEach((e=>{this.register(e)}))}draw(e,t){const n=this.getSkeleton();if(!n)return;this._translateBy(0,0);const r=n.getSkeleton(),{pages:a}=r,i=this.getParentScale(),o=this.getExtensionsByOrder(),s=oc(i);for(let e of o)e.clearCache();for(let t of a){const{sections:n,marginTop:r=0,marginBottom:a=0,marginLeft:l=0,marginRight:c=0,width:u,height:h,renderConfig:d={}}=t,{verticalAlign:p=Na.TOP,horizontalAlign:m=Ra.LEFT,centerAngle:_=0,vertexAngle:g=0,wrapStrategy:f=Ma.UNSPECIFIED,isRotateNonEastAsian:y=ka.FALSE}=d,v=this._horizontalHandler(u,l,c,m),b=this._verticalHandler(h,r,a,p),x=Ml.create(v,b),w=Kl(_),T=Kl(g),C=T-w;this._startRotation(e,C);for(let t of n){const{columns:n,top:u=0}=t;this._translate(0,u);for(let t of n){const{lines:n,width:u,left:h}=t;this._translate(h,0);const _=n.length;let g,y,C,E=null;if(0!==T){const{rotateTranslateXList:e,rotatedHeight:t,rotatedWidth:i,fixOffsetX:o,fixOffsetY:s,rotateTranslateY:h}=Hl(n,u,T);let d=i;t>this.height&&f!==Ma.WRAP&&(f===Ma.OVERFLOW||T>0)&&(d=this.height/Math.tan(Math.abs(T))),g=this._horizontalHandler(d,l,c,m),y=this._verticalHandler(t,r,a,p);let _=y-s;t>this.height&&(_=T<0?this.height-(t+s):-s),C=Ml.create(g+o,_),this._translate(0,-h),E=e}else g=v,y=b,C=x;for(let t=0;t<_;t++){const r=n[t],{divides:a,top:l,marginBottom:c=0,marginTop:u=0,paddingTop:h=0,paddingBottom:p=0,asc:m=0,type:_,lineHeight:g=0}=r;let f=m+u+h;const y=f*Math.sin(w),v=f*Math.cos(w);if(_===Tl.BLOCK)for(let t of o)t.type===Bu.LINE&&(t.extensionOffset={alignOffset:C,renderConfig:d},t.draw(e,i,r));else{this._translateSave();const n=l+u+h;this._translate(0,n),E&&this._translate(E[t]);const r=a.length;for(let t=0;t<r;t++){const n=a[t],{spanGroup:r,left:l,paddingLeft:c}=n;this._translateSave(),this._translate(l+c,0);for(let t of r){if(!t.content||0===t.content.length)continue;const{width:n,left:r}=t,a=Ml.create(tc(this._translateX,s),tc(this._translateY,s)),l=Ml.create(tc(n/2,s),tc(g/2,s)),c=Bl(a.addByPoint(tc(r,s),0),l,w,T,C),u=Bl(a.addByPoint(tc(r+y,s),tc(v,s)),l,w,T,C),h={originTranslate:a,spanStartPoint:c,spanPointWithFont:u,centerPoint:l,alignOffset:C,renderConfig:d};for(let n of o)n.type===Bu.SPAN&&(n.extensionOffset=h,n.draw(e,i,t))}this._translateRestore()}this._translateRestore()}}}}this._resetRotation(e,C)}}}class qu extends Uc{constructor(e,t){super(e),this._skeleton=t}getSkeleton(){return this._skeleton}updateSkeleton(e){this._skeleton=e}render(e,t){if(!this.visible)return this.makeDirty(!1),this;e.save(),this._draw(e,t),e.restore()}getParentScale(){let{scaleX:e=1,scaleY:t=1}=this.parent;return this.parent.classType===vl.SCENE_VIEWER&&(e=this.parent.ancestorScaleX||1,t=this.parent.ancestorScaleY||1),{scaleX:e,scaleY:t}}_getBounding(e,t,n){const r=e.length,a=t.length;if(!n)return{startRow:0,endRow:r-1,startColumn:0,endColumn:a-1};let i=-1,o=-1,s=-1,l=-1;return i=sa(e,n.tl.y),o=sa(e,n.bl.y),-1===i&&(i=0),-1===o&&(o=r-1),o>=r&&(o=r-1),s=sa(t,n.tl.x),l=sa(t,n.tr.x),-1===s&&(s=0),-1===l&&(l=a-1),l>=a&&(l=a-1),{startRow:i-1,endRow:o+1,startColumn:s-1,endColumn:l+1}}_draw(e,t){}}class Uu extends qu{_draw(e,t){this.draw(e,t)}}class Vu extends Lc{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return lc(e,t,n,r,a)}}Bc.add(new class extends Vu{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||Yl([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=tc(a,p),o=tc(o,p),s=tc(s,d),c=tc(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});Bc.add(new class extends Vu{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=tc(i,_),s=tc(s,_),c=tc(c,m),h=tc(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(Pl(e,u),e.lineWidth=Ll(u)/g,f=u),d!==y&&(e.strokeStyle=d||gl,y=d),Il(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===fl.TOP||t===fl.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===fl.LEFT&&e>r&&e<=i||t===fl.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});Bc.add(new class extends Vu{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=Yl([217,217,217]);let y=tc(m,f),v=tc(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=tc(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=tc(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=tc(n[o-1]||0,t),h=tc(n[s],t),d=tc(r[l-1]||0,t),p=tc(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});Bc.add(new class extends Vu{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=tc(o,g),c=tc(c,g),h=tc(h,_),p=tc(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=tc(o[t-1]||0,i),c=tc(o[n],i),u=tc(s[r-1]||0,i),h=tc(s[a],i);e.rect(u,l,h-u,c-l)}});Fc.add(new class extends Vu{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=Yl([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=Yl([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=Yl([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=tc(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(tc(a,m),0),e.lineTo(tc(a,m),p),e.stroke()}});Hc.add(new class extends Vu{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=Yl([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=Yl([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=Yl([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=tc(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=tc(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});class Wu extends qu{constructor(e,t,n=!0){super(e,t),this._allowCache=n,this._cacheOffsetX=0,this._cacheOffsetY=0,this._documents=new Hu("__SHEET_EXTENSION_FONT_DOCUMENT_INSTANCE__"),this._allowCache&&(this._cacheCanvas=new pc),this.onIsAddedToParentObserver.add((e=>{var t;null==(t=null==e?void 0:e.getEngine())||t.onTransformChangeObservable.add((e=>{this.resizeCacheCanvas()})),this.resizeCacheCanvas(),this._addMakeDirtyToScroll()})),this._initialDefaultExtension(),this.makeDirty(!0)}get borderAuxiliaryExtension(){return this._borderAuxiliaryExtension}get backgroundExtension(){return this._backgroundExtension}get borderExtension(){return this._borderExtension}get fontExtension(){return this._fontExtension}getDocuments(){return this._documents}_draw(e,t){this.draw(e,t)}draw(e,t){const n=this.getSkeleton();if(!n)return;const r=this.getParentScale();n.calculate(t);const a=oc(r),{rowTitleWidth:i,columnTitleHeight:o}=n;e.translate(tc(i,a)-.5/a,tc(o,a)-.5/a),this._calculateOverflow();const s=this.getExtensionsByOrder();for(let t of s)t.draw(e,r,n)}isHit(e){const t=this._getInverseCoord(e),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:r,columnTitleHeight:a}=n;return t.x>r&&t.y>a}getNoMergeCellPositionByIndex(e,t){const n=this.getSkeleton();if(!n)return;const{rowHeightAccumulation:r,columnWidthAccumulation:a,rowTitleWidth:i,columnTitleHeight:o}=n,{scaleX:s=1,scaleY:l=1}=this.getParentScale();let{startY:c,endY:u,startX:h,endX:d}=sc(e,t,r,a);return c=tc(c+o,l),u=tc(u+o,l),h=tc(h+i,s),d=tc(d+i,s),{startY:c,endY:u,startX:h,endX:d}}calculateCellIndexByPosition(e,t,n){const r=this.getSkeleton();if(!r)return;const{x:a,y:i}=n,{rowHeightAccumulation:o,columnWidthAccumulation:s,rowTitleWidth:l,columnTitleHeight:c,dataMergeCacheAll:u}=r;e+=a-l;let h=sa(o,t+=i-c),d=sa(s,e);if(-1===h){h=o[o.length-1]<=t?o.length-1:0}if(-1===d){d=s[s.length-1]<=e?s.length-1:0}const{scaleX:p=1,scaleY:m=1}=this.getParentScale();let{isMerged:_,startY:g,endY:f,startX:y,endX:v,mergeInfo:b,isMergedMainCell:x}=lc(h,d,o,s,u);return g=tc(g+c,m),f=tc(f+c,m),y=tc(y+l,p),v=tc(v+l,p),b=cc(b,l,c,p,m),{row:h,column:d,startY:g,endY:f,startX:y,endX:v,isMerged:_,isMergedMainCell:x,mergeInfo:b}}getCellByIndex(e,t){const n=this.getSkeleton();if(!n)return;const{scaleX:r=1,scaleY:a=1}=this.getParentScale(),{rowHeightAccumulation:i,columnWidthAccumulation:o,rowTitleWidth:s,columnTitleHeight:l,dataMergeCacheAll:c}=n;let{isMerged:u,startY:h,endY:d,startX:p,endX:m,mergeInfo:_,isMergedMainCell:g}=lc(e,t,i,o,c);return h=tc(h+l,a),d=tc(d+l,a),p=tc(p+s,r),m=tc(m+s,r),_=cc(_,s,l,r,a),{row:e,column:t,startY:h,endY:d,startX:p,endX:m,isMerged:u,isMergedMainCell:g,mergeInfo:_}}getAncestorScrollXY(e,t){let n=this.getParent(),r=0,a=0;for(;n;){if(n.classType===vl.SCENE){const i=n.getViewports().find((n=>n.isHit(Ml.FromArray([e,t]))));if(i){r+=i.actualScrollX||0,a+=i.actualScrollY||0}}n=(null==n?void 0:n.getParent)&&(null==n?void 0:n.getParent())}return{x:r,y:a}}getSelectionBounding(e,t,n,r){var a;return null==(a=this.getSkeleton())?void 0:a.getMergeBounding(e,t,n,r)}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(this._allowCache){if(this._cacheOffsetX=0,this._cacheOffsetY=0,this.isDirty()){let n=t;const r=this._cacheCanvas.getContext();if(n){const{dx:e=0,dy:t=0}=n;this._cacheOffsetX=e,this._cacheOffsetY=t}this._cacheCanvas.clear(),r.save(),r.setTransform(e.getTransform()),this._draw(r,n),r.restore(),this._boundsCache=t}this._applyCache(e)}else e.save(),this._draw(e,t),e.restore();return this.makeDirty(!1),this}resizeCacheCanvas(){const e=this._getAncestorSize();if(!e)return;const{width:t,height:n}=e,r=this.getSkeleton();r&&(r.rowTitleWidth,r.columnTitleHeight),this._cacheCanvas.setSize(t,n),this.makeDirty(!0)}_getAncestorSize(){const e=this._getAncestorParent();if(e){if(e.classType===vl.ENGINE){const t=e.getCanvas();return{width:t.getWidth(),height:t.getHeight()}}return e.classType===vl.SCENE_VIEWER?{width:e.width,height:e.height}:void 0}}_getAncestorParent(){let e=this.parent;for(;e;){if(e.classType===vl.ENGINE||e.classType===vl.SCENE_VIEWER)return e;e=(null==e?void 0:e.getParent)&&(null==e?void 0:e.getParent())}}_applyCache(e){e&&(e.save(),e.setTransform(1,0,0,1,0,0),e.drawImage(this._cacheCanvas.getCanvasEle(),0,0),e.restore())}_initialDefaultExtension(){Bc.getData().sort(is).forEach((e=>{this.register(e)})),this._borderAuxiliaryExtension=this.getExtensionByKey("DefaultBorderAuxiliaryExtension"),this._backgroundExtension=this.getExtensionByKey("DefaultBackgroundExtension"),this._borderExtension=this.getExtensionByKey("DefaultBorderExtension"),this._fontExtension=this.getExtensionByKey("DefaultFontExtension")}_addMakeDirtyToScroll(){this._hasScrollViewportOperator(this,(e=>{e.onScrollBeforeObserver.add((()=>{this.makeDirty(!0)}))}))}_hasScrollViewportOperator(e,t){let n=e.getParent();for(;n;){if(n.classType===vl.SCENE){const e=n.getViewports();this._getHasScrollViewports(e);for(let n of e)n&&t(n)}n=(null==n?void 0:n.getParent)&&(null==n?void 0:n.getParent())}}_getHasScrollViewports(e){const t=[];for(let n of e){n.getScrollBar()&&t.push(n)}return t}_calculateOverflow(){const e=new ha,t=this.getSkeleton();if(!t)return;const n=t.getColumnCount(),{stylesCache:r,rowHeightAccumulation:a,columnWidthAccumulation:i,dataMergeCache:o}=t,{font:s}=r;s&&Object.keys(s).forEach((r=>{s[r].forEach(((r,s)=>{s.forEach(((s,l)=>{let{documentSkeleton:c,angle:u=0,verticalAlign:h,horizontalAlign:d,wrapStrategy:p}=l;const m=t.getCellData().getValue(r,s),_=this.getSkeleton();if(!_)return!0;const{t:g=Ia.STRING}=m||{};if(p===Ma.OVERFLOW&&g!==Ia.NUMBER&&g!==Ia.BOOLEAN&&d!==Ra.JUSTIFIED){let l=c.getLastPageSize(u);if(!l)return!0;if(0!==u){let{startY:e,endY:t,startX:n,endX:c}=lc(r,s,a,i,o);const h=c-n,d=t-e;l.height>d&&(l={width:d/Math.tan(Math.abs(u))+h,height:d})}const h=t.getOverflowPosition(l,d,r,s,n),{startColumn:p,endColumn:m}=h;e.setValue(r,s,{startRow:r,endRow:r,startColumn:p,endColumn:m})}else if(p===Ma.WRAP&&0!==u){let{startY:t,endY:n}=lc(r,s,a,i,o);const l=n-t;c.updateDocumentDataPageSize(l),c.calculate();const h=c.getLastPageSize(Kl(Math.abs(u)));if(!h)return!0;const{startColumn:p,endColumn:m}=_.getOverflowPosition(h,d,r,s,_.getColumnCount());e.setValue(r,s,{startRow:r,endRow:r,startColumn:p,endColumn:m})}}))}))})),t.setOverflowCache(e)}_differentBounds(e){if(!this._boundsCache)return e;const{tl:t,tr:n,bl:r,br:a,dx:i,dy:o}=e,{tl:s,tr:l,bl:c,br:u,dx:h,dy:d}=this._boundsCache,p={tl:t,tr:n,bl:r,br:a,dx:0,dy:0};return t.x===s.x?(t.y>s.y?(p.tl=c,p.tr=u):(p.bl=s,p.br=l),p.dy=s.y-t.y):t.y===s.y&&(t.x>s.x?(p.tl=l,p.bl=u):(p.tr=s,p.br=c),p.dx=s.x-t.x),p}_checkSheetDifferentBounds(e,t){const{tl:n,tr:r,bl:a,br:i}=e,{tl:o,tr:s,bl:l,br:c}=t;return n.x===o.x&&r.x===s.x&&a.x===l.x&&i.x===c.x?n.y>=o.y&&n.y<=l.y||a.y>=o.y&&a.y<=l.y:n.y===o.y&&r.y===s.y&&a.y===l.y&&i.y===c.y&&(n.x>=o.x&&n.x<=s.x||r.x>=o.x&&(r.x,s.x),!0)}}class zu extends Uu{constructor(e,t){super(e,t),this._initialDefaultExtension(),this.makeDirty(!0)}get rowTitleLayoutExtension(){return this._rowTitleLayoutExtension}draw(e,t){const n=this.getSkeleton();if(!n)return;const r=this.getParentScale();n.calculate(t);const a=oc(r),{columnTitleHeight:i}=n;e.translate(-.5/a,tc(i,a)-.5/a);const o=this.getExtensionsByOrder();for(let t of o)t.draw(e,r,n)}isHit(e){const t=this._getInverseCoord(e),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:r,columnTitleHeight:a}=n;return t.x>=0&&t.x<=r&&t.y>a}_initialDefaultExtension(){Fc.getData().forEach((e=>{this.register(e)})),this._rowTitleLayoutExtension=this.getExtensionByKey("DefaultRowTitleLayoutExtension")}}class Yu extends Uu{constructor(e,t){super(e,t),this._initialDefaultExtension(),this.makeDirty(!0)}get columnTitleLayoutExtension(){return this._columnTitleLayoutExtension}_initialDefaultExtension(){Hc.getData().forEach((e=>{this.register(e)})),this._columnTitleLayoutExtension=this.getExtensionByKey("DefaultColumnTitleLayoutExtension")}draw(e,t){const n=this.getSkeleton();if(!n)return;const r=this.getParentScale();n.calculate(t);const a=oc(r),{rowTitleWidth:i}=n;e.translate(tc(i,a)-.5/a,-.5/a);const o=this.getExtensionsByOrder();for(let t of o)t.draw(e,r,n)}isHit(e){const t=this._getInverseCoord(e),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:r,columnTitleHeight:a}=n;return t.x>r&&t.y>=0&&t.y<=a}}class Gu extends Pc{constructor(e,t,n,r){super(r),this._config=e,this._cellData=t,this._styles=n,this._rowTitleWidth=0,this._columnTitleHeight=0,this.updateMatrix(),this.updateDataMergeCacheAll()}getWorksheetConfig(){return this._config}getCellData(){return this._cellData}getsStyles(){return this._styles}get rowHeightAccumulation(){return this._rowHeightAccumulation}get rowTotalHeight(){return this._rowTotalHeight}get columnWidthAccumulation(){return this._columnWidthAccumulation}get columnTotalWidth(){return this._columnTotalWidth}get rowTitleWidth(){return this._rowTitleWidth}get columnTitleHeight(){return this._columnTitleHeight}get rowColumnSegment(){return this._rowColumnSegment}get dataMergeCache(){return this._dataMergeCache}get stylesCache(){return this._stylesCache}get overflowCache(){return this._overflowCache}setOverflowCache(e){this._overflowCache=e}calculate(e){if(!this._config)return;if(this.dirty&&this.updateMatrix(),!this._rowHeightAccumulation||!this._columnWidthAccumulation)return;const{mergeData:t}=this._config;return this._rowColumnSegment=this.getRowColumnSegment(e),this._dataMergeCache=t&&this._getMergeCells(t,this._rowColumnSegment),this._stylesCache=this._calculateStylesCache(),this}updateMatrix(){if(!this.dirty)return;const{rowData:e,columnData:t,defaultRowHeight:n,defaultColumnWidth:r,rowCount:a,columnCount:i,rowTitle:o,columnTitle:s}=this._config,{rowTotalHeight:l,rowHeightAccumulation:c}=this._generateRowMatrixCache(a,e,n),{columnTotalWidth:u,columnWidthAccumulation:h}=this._generateColumnMatrixCache(i,t,r);return this._rowTitleWidth=o.hidden!==ka.TRUE?o.width:0,this._columnTitleHeight=s.hidden!==ka.TRUE?s.height:0,this._rowTotalHeight=l,this._rowHeightAccumulation=c,this._columnTotalWidth=u,this._columnWidthAccumulation=h,this.makeDirty(!0),this}updateDataMergeCacheAll(){const{mergeData:e}=this._config;this._dataMergeCacheAll=e&&this._getMergeCells(e)}getRowColumnSegment(e){return this._getBounding(this._rowHeightAccumulation,this._columnWidthAccumulation,e)}getMergeBounding(e,t,n,r){const a=this._dataMergeCacheAll;if(!a)return{startRow:e,startColumn:t,endRow:n,endColumn:r};let i=!0,o=new ha;for(;i;)i=!1,a.forEach(((a,s)=>{s.forEach(((s,l)=>{if(!l||o.getValue(a,s))return!0;const{startRow:c,startColumn:u,endRow:h,endColumn:d}=l;uc({left:t,top:e,right:r,bottom:n},{left:u,top:c,right:d,bottom:h})&&(e=Math.min(e,c),t=Math.min(t,u),n=Math.max(n,h),r=Math.max(r,d),o.setValue(a,s,!0),i=!0)}))}));return{startRow:e,startColumn:t,endRow:n,endColumn:r}}appendToOverflowCache(e,t,n,r){this._overflowCache.setValue(e,t,{startRow:e,endRow:e,startColumn:n,endColumn:r})}getColumnCount(){return this._columnWidthAccumulation.length}get dataMergeCacheAll(){return this._dataMergeCacheAll}_generateRowMatrixCache(e,t,n){let r=0;const a=[],i=new ca(t);for(let t=0;t<e;t++){let e=n;if(null!=i.get(t)){const n=i.get(t);if(!n)continue;null!=n.h?e=n.h:null!=n.ah&&(e=n.ah),n.hd===ka.TRUE&&(e=0)}r+=e,a.push(r)}return{rowTotalHeight:r,rowHeightAccumulation:a}}_generateColumnMatrixCache(e,t,n){let r=0;const a=[],i=new ca(t);for(let t=0;t<e;t++){let e=n;if(null!=i.get(t)){const n=i.get(t);if(!n)continue;null!=n.w&&(e=n.w),n.hd===ka.TRUE&&(e=0)}r+=e,a.push(r)}return{columnTotalWidth:r,columnWidthAccumulation:a}}_getBounding(e,t,n){const r=e.length,a=t.length;if(!n)return{startRow:0,endRow:r-1,startColumn:0,endColumn:a-1};let i=-1,o=-1,s=-1,l=-1;return i=sa(e,n.tl.y-this.columnTitleHeight),o=sa(e,n.bl.y-this.columnTitleHeight),-1===i&&(i=0),-1===o&&(o=r-1),o>=r&&(o=r-1),s=sa(t,n.tl.x-this.rowTitleWidth),l=sa(t,n.tr.x-this.rowTitleWidth),-1===s&&(s=0),-1===l&&(l=a-1),l>=a&&(l=a-1),{startRow:i-1,endRow:o+1,startColumn:s-1,endColumn:l+1}}getOverflowPosition(e,t,n,r,a){const{width:i,height:o}=e;let s=r,l=r;return t===Ra.CENTER?(s=this._getOverflowBound(n,r,0,i/2),l=this._getOverflowBound(n,r,a-1,i/2)):t===Ra.RIGHT?s=this._getOverflowBound(n,r,0,i):l=this._getOverflowBound(n,r,a-1,i),{startColumn:s,endColumn:l}}_getOverflowBound(e,t,n,r){let a=0;if(t>n){const i=this._columnWidthAccumulation.length-1;for(let o=t;o>=n;o--){const n=o;if(!So(this._cellData.getValue(e,n))&&n!==t||this._intersectMergeRange(e,n))return n===t?n:n+1>i?i:n+1;const{startX:s,endX:l}=sc(e,n,this.rowHeightAccumulation,this.columnWidthAccumulation);if(a+=l-s,r<a)return n}return t}for(let i=t;i<=n;i++){const n=i;if(!So(this._cellData.getValue(e,n))&&n!==t||this._intersectMergeRange(e,n))return n===t?n:n-1<0?0:n-1;const{startX:o,endX:s}=sc(e,n,this.rowHeightAccumulation,this.columnWidthAccumulation);if(a+=s-o,r<a)return n}return n}_intersectMergeRange(e,t){const n=this.dataMergeCache;let r=!1;return null==n||n.forEach(((n,a)=>{null==a||a.forEach(((n,a)=>{const{startRow:i,endRow:o,startColumn:s,endColumn:l}=a;if(e>=i&&e<=o&&t>=s&&t<=l)return r=!0,!1}))})),r}_calculateStylesCache(){const e={background:{},font:{},border:new ha},t=this.getFontLocale(),n=this._dataMergeCache,r=this._rowColumnSegment,a=this.columnWidthAccumulation,i=this._styles,o=this._cellData,{startRow:s,endRow:l,startColumn:c,endColumn:u}=r;for(let n=s;n<=l;n++){for(let r=c;r<=u;r++)this.__setCellCache(n,r,{cache:e,styles:i,cellData:o,skipBackgroundAndBorder:!1},t);for(let r=0;r<c;r++)this.__setCellCache(n,r,{cache:e,styles:i,cellData:o,skipBackgroundAndBorder:!0},t);for(let r=u+1;r<a.length;r++)this.__setCellCache(n,r,{cache:e,styles:i,cellData:o,skipBackgroundAndBorder:!0},t)}return n&&n.forEach(((n,r)=>{r.forEach(((r,a)=>{if(!a)return!0;this.__setCellCache(n,r,{cache:e,styles:i,cellData:o,skipBackgroundAndBorder:!1},t)}))})),e}__setCellCache(e,t,n,r){const{cache:a,skipBackgroundAndBorder:i=!1,styles:o,cellData:s}=n;if(!s)return!0;const l=s.getValue(e,t);if(!l)return!0;const c=o&&o.get(l.s);if(!i&&c&&c.bg&&c.bg.rgb){const n=c.bg.rgb;a.background[n]||(a.background[n]=new ha);a.background[n].setValue(e,t,n)}!i&&c&&c.bd&&(this.___setBorderProps(e,t,fl.TOP,c,a),this.___setBorderProps(e,t,fl.BOTTOM,c,a),this.___setBorderProps(e,t,fl.LEFT,c,a),this.___setBorderProps(e,t,fl.RIGHT,c,a));const u=l.m||l.v;let h,d="document";const p=this._getOtherStyle(c),m=p.textRotation||{a:0,v:ka.FALSE},_=p.horizontalAlign||Ra.UNSPECIFIED,g=p.verticalAlign||Na.UNSPECIFIED,f=p.wrapStrategy||Ma.UNSPECIFIED;if(l.p){a.font[d]||(a.font[d]=new ha);let{a:e=0,v:t=ka.FALSE}=m,n=0,r=e;t===ka.TRUE&&(n=90,r=90),h=this._updateRenderConfigAndHorizon(l.p,_,{horizontalAlign:_,verticalAlign:g,centerAngle:n,vertexAngle:r,wrapStrategy:f})}else if(u){const e=this._getFontFormat(c);d=nc(e,r).fontString,a.font[d]||(a.font[d]=new ha),h=this._getDocumentDataByStyle(u.toString(),e,p)}const y=a.font[d];let{a:v,v:b=ka.FALSE}=m;if(b===ka.TRUE&&(v=90),h){const n=Pu.create(h,this.getContext());0!==v&&f===Ma.WRAP||n.calculate(),y.setValue(e,t,{documentSkeleton:n,angle:v,verticalAlign:g,horizontalAlign:_,wrapStrategy:f,content:null==u?void 0:u.toString()})}}_updateRenderConfigAndHorizon(e,t,n){var r;if(!n)return;if(!(null==(r=e.body)?void 0:r.blockElements))return;e.documentStyle||(e.documentStyle={}),e.documentStyle.renderConfig=n;const a=e.body.blockElements,i=Object.keys(e.body.blockElements);for(let e of i){const n=a[e];if(n.blockType===Ps.PARAGRAPH){if(!n.paragraph)continue;n.paragraph.paragraphStyle||(n.paragraph.paragraphStyle={}),n.paragraph.paragraphStyle.horizontalAlign=t}}return e}_getDocumentDataByStyle(e,t,n){const r=e.length-1,{textRotation:a={a:0,v:ka.FALSE},textDirection:i=Sa.UNSPECIFIED,paddingData:o={t:0,r:2,b:0,l:2},horizontalAlign:s=Ra.UNSPECIFIED,verticalAlign:l=Na.UNSPECIFIED,wrapStrategy:c=Ma.UNSPECIFIED}=n,{a:u=0,v:h=ka.FALSE}=a,{t:d,r:p,b:m,l:_}=o;Hs.NORMAL;let g=0,f=u;h===ka.TRUE&&(g=90,f=90,Hs.TBRL);return{documentId:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:r,blockType:Ps.PARAGRAPH,paragraph:{paragraphStyle:{horizontalAlign:s},elements:{oneElement:{eId:"oneElement",st:0,ed:r,et:qs.TEXT_RUN,tr:{ct:e,ts:t}}},elementOrder:[{elementId:"oneElement",paragraphElementType:qs.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:d,marginBottom:m,marginRight:p,marginLeft:_,renderConfig:{horizontalAlign:s,verticalAlign:l,centerAngle:g,vertexAngle:f,wrapStrategy:c}}}}___setBorderProps(e,t,n,r,a){var i;const o=null==(i=r.bd)?void 0:i[n];if(!o||!a.border)return!0;const s=Do(o.cl)||gl,l=a.border;l.getValue(e,t)||l.setValue(e,t,{[n]:{}}),l.getValue(e,t)[n]={type:n,style:o.s,color:s}}_getFontFormat(e){if(!e)return{};const{ff:t,fs:n,it:r,bl:a,ul:i,st:o,ol:s,cl:l,bg:c,bd:u}=e;return{ff:t,fs:n,it:r,bl:a,ul:i,st:o,ol:s,cl:l}}_getOtherStyle(e){if(!e)return{};const{tr:t,td:n,ht:r,vt:a,tb:i,pd:o}=e;return{textRotation:t,textDirection:n,horizontalAlign:r,verticalAlign:a,wrapStrategy:i,paddingData:o}}_getMergeCells(e,t){const n=this.columnWidthAccumulation.length-1;if(t)t={startRow:t.startRow,endRow:t.endRow,endColumn:n,startColumn:0};else{t={startRow:0,startColumn:0,endRow:this.rowHeightAccumulation.length-1,endColumn:n}}const{startRow:r,startColumn:a,endRow:i,endColumn:o}=t,s=new ha;for(let t=0;t<e.length;t++){const{startRow:n,endRow:l,startColumn:c,endColumn:u}=e[t];for(let e=r;e<=i;e++){let t=!1;for(let r=a;r<=o;r++)if(e>=n&&e<=l&&r>=c&&r<=u){s.setValue(n,c,{startRow:n,endRow:l,startColumn:c,endColumn:u}),t=!0;break}if(t)break}}return s}static create(e,t,n,r){return new Gu(e,t,n,r)}}const Xu=["text","richText"];class $u extends gc{constructor(e,t,n){super(t),this._allowCache=!1,(null==n?void 0:n.richText)?this._documentData=n.richText:this._documentData=this.convertToDocumentData((null==n?void 0:n.text)||""),this._allowCache&&(this._cacheCanvas=new pc,this.onTransformChangeObservable.add((()=>{this.resizeCacheCanvas()}))),this._context=e,this._documentSkeleton=Pu.create(this._documentData,this._context),this._documents=new Hu(`${this.oKey}_DOCUMENTS`,this._documentSkeleton),this._initialProps(n)}get documentData(){return this._documentData}convertToDocumentData(e){const t=e.length;return{documentId:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:t,blockType:Ps.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:t,et:qs.TEXT_RUN,tr:{ct:e}}},elementOrder:[{elementId:"oneElement",paragraphElementType:qs.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0}}}}_initialProps(e){this._documentSkeleton.updateDocumentDataPageSize(null==e?void 0:e.width,null==e?void 0:e.height),this._documentSkeleton.calculate();const t=this._documentSkeleton.getLastPageSize();this.transformByState({width:(null==t?void 0:t.width)||0,height:(null==t?void 0:t.height)||0,left:(null==e?void 0:e.left)||0,top:(null==e?void 0:e.top)||0,angle:null==e?void 0:e.angle}),this.setProps(e),this.makeDirty(!0)}setProps(e){if(!e)return;const t=Object.keys(e);return 0!==t.length?(t.forEach((t=>{if(void 0===e[t])return!0;-1===Xu.indexOf(t)&&(this[`_${t}`]=e[t])})),this.makeDirty(!0),this):void 0}_draw(e){this._documents.render(e)}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(t&&!this.isInGroup){const e=this.transform.clone().invert().applyPoint(t.tl),n=this.transform.clone().invert().applyPoint(t.tr),r=this.transform.clone().invert().applyPoint(t.bl),a=this.transform.clone().invert().applyPoint(t.br),i=[e.x,n.x,r.x,a.x],o=[e.y,n.y,r.y,a.y],s=Math.max(...i),l=Math.min(...i),c=Math.max(...o),u=Math.min(...o);if(this.width+this.strokeWidth<l||s<0||this.height+this.strokeWidth<u||c<0)return this}const n=this.transform.getMatrix();if(e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._allowCache){if(this.isDirty()){const e=this._cacheCanvas.getContext();this._cacheCanvas.clear(),e.save(),e.translate(this.strokeWidth/2,this.strokeWidth/2),this._draw(e),e.restore()}this._applyCache(e)}else this._draw(e);return e.restore(),this.makeDirty(!1),this}_applyCache(e){if(!e||!this._cacheCanvas)return;const t=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*t,r=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,r,-this.strokeWidth/2,-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth)}getContext(){return this._context}toJson(){const e={};return Xu.forEach((t=>{this[t]&&(e[t]=this[t])})),{...super.toJson(),...e}}}class ju extends Ts{constructor(){super(ti.BASE_RENDER),this._engine=new mc}static create(){return new ju}installTo(e){e.installPlugin(this)}getEngine(){return this._engine}}var Ku=Object.defineProperty,Zu=(e,t,n)=>(((e,t,n)=>{t in e?Ku(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),Qu=(e=>(e[e.OBSERVER_ACTION=1]="OBSERVER_ACTION",e[e.SERVER_ACTION=2]="SERVER_ACTION",e[e.UNDO_ACTION=3]="UNDO_ACTION",e[e.DEFAULT_ACTION=3]="DEFAULT_ACTION",e))(Qu||{});class Ju{constructor(e,t){Zu(this,"_observers"),Zu(this,"_doActionData"),Zu(this,"_oldActionData"),Zu(this,"_operation"),this._doActionData=e,this._observers=t,this._operation=1}getDoActionData(){return this._doActionData}getOldActionDaa(){return this._oldActionData}hasOperation(e){return(this._operation&e)===e}addOperation(e){this._operation|=e}removeOperation(e){this._operation&=~e}}class eh extends Ju{constructor(e,t,n){super(e,n),Zu(this,"_workbook"),this._workbook=t}getWorkSheet(){const{_workbook:e,_doActionData:t}=this,{sheetId:n}=t;return e.getSheetBySheetId(n)}getWorkBook(){return this._workbook}}class th{constructor(e=!1){Zu(this,"skipNextObservers"),Zu(this,"lastReturnValue"),Zu(this,"isStopPropagation",!1),this.initialize(e)}initialize(e=!1){return this.skipNextObservers=e,this}stopPropagation(){this.isStopPropagation=!0}}class nh{constructor(e){Zu(this,"_willBeUnregistered",!1),Zu(this,"unregisterOnNextCall",!1),this.callback=e}}class rh{constructor(e){Zu(this,"_observers",new Array),Zu(this,"_eventState"),Zu(this,"_onObserverAdded"),this._eventState=new th,e&&(this._onObserverAdded=e)}get observers(){return this._observers}add(e,t=!1,n=!1){if(!e)return null;const r=new nh(e);return r.unregisterOnNextCall=n,t?this._observers.unshift(r):this._observers.push(r),this._onObserverAdded&&this._onObserverAdded(r),r}addOnce(e){return this.add(e,void 0,!0)}remove(e){return!(!e||-1===this._observers.indexOf(e))&&(this._deferUnregister(e),!0)}removeCallback(e){for(let t=0;t<this._observers.length;t++){const n=this._observers[t];if(!n._willBeUnregistered&&n.callback===e)return this._deferUnregister(n),!0}return!1}_deferUnregister(e){e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout((()=>{this._remove(e)}),0)}_remove(e){if(!e)return!1;const t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)}makeObserverTopPriority(e){this._remove(e),this._observers.unshift(e)}makeObserverBottomPriority(e){this._remove(e),this._observers.push(e)}notifyObservers(e){if(!this._observers.length)return null;const t=this._eventState;t.skipNextObservers=!1,t.lastReturnValue=e,t.isStopPropagation=!1;let n=!1;for(let r=0;r<this._observers.length;r++){const a=this._observers[r];if(!a._willBeUnregistered&&(t.lastReturnValue=a.callback(e,t),a.unregisterOnNextCall&&this._deferUnregister(a),t.isStopPropagation&&(n=!0),t.skipNextObservers))return{lastReturnValue:t.lastReturnValue,stopPropagation:n}}return{lastReturnValue:t.lastReturnValue,stopPropagation:n}}notifyObserversWithPromise(e){let t=Promise.resolve(e);if(!this._observers.length)return t;const n=this._eventState;n.skipNextObservers=!1;for(let r=0;r<this._observers.length;r++){const a=this._observers[r];n.skipNextObservers||a._willBeUnregistered||(t=t.then((()=>a.callback(e,n))),a.unregisterOnNextCall&&this._deferUnregister(a))}return t.then((()=>e))}notifyObserver(e,t){if(e._willBeUnregistered)return;const n=this._eventState;return n.skipNextObservers=!1,e.callback(t,n),e.unregisterOnNextCall&&this._deferUnregister(e),{lastReturnValue:n.lastReturnValue,stopPropagation:n.isStopPropagation}}hasObservers(){return this._observers.length>0}clear(){this._observers=new Array,this._onObserverAdded=null}clone(){const e=new rh;return e._observers=this._observers.slice(0),e}}const ah=e=>null!=e;class ih{constructor(...e){if(Zu(this,"_array"),Zu(this,"_length"),hh.hasLength(e,1)){if(hh.isObject(e[0]))return this._array=e[0],void(this._length=ih.getMaxLength(this._array));if(hh.isNumber(e[0]))return this._array={},void(this._length=e[0])}if(hh.hasLength(e,2)){const t=e[0],n=e[1];return this._array=t,void(this._length=n)}hh.hasLength(e,0)&&(this._array={},this._length=0)}static getMaxLength(e){if(e){const t=Object.keys(e);if(t.length)return Math.max(...t)+1}return 0}obtain(e,t){var n;return null!=(n=this._array[e])?n:t}getKeys(){return Object.keys(this._array)}get(e){return this._array[e]}set(e,t){if(ah(t)){const n=this._length;this._array[e]=t,e>=n&&(this._length=e+1)}}pop(){const e=this._length,t=this._array;if(e>0){const n=e-1,r=t[n];return n>0&&(delete t[n],this._length--),r}return null}push(e){if(ah(e)){let t=this._length;this._array[t++]=e,this._length=t}}first(){return this._array[0]}last(){const e=this._length-1;return this._array[e]}shift(){const e=this._length;if(e>0){const t=this._array[0],n=e-1;let r;for(let e=0;e<n;e++)r=this._array[e+1],ah(r)&&(this._array[e]=r);return this._length--,delete this._array[n],t}return null}unshift(e){if(ah(e)){const t=this._length,n=this._array,r=t+1;let a=n[0];for(let e=1;e<r;e++){const t=this._array[e];ah(a)&&(n[e]=a),a=t}n[0]=e,this._length=r}}clear(){this._array={},this._length=0}getLength(){return this._length}getSizeOf(){const e=this._array;return Object.keys(e).length}toJSON(){return this._array}toArray(){const e=new Array,t=this._array,n=Object.keys(t),r=n.length;for(let a=0;a<r;a++){const r=+n[a];e[r]=t[r]}return e}forEach(e){const t=this._array,n=Object.keys(t),r=n.length;for(let a=0;a<r;a++){const r=+n[a];if(!1===e(r,t[r]))return this}return this}clone(e){const t=new ih;return e?this.forEach(((n,r)=>{t.set(n,e(r))})):this.forEach(((e,n)=>{t.set(e,n)})),t}isEmpty(){const e=this._array;return 0===Object.keys(e).length}delete(e){this.splice(e,1)}includes(e){const t=this._array,n=Object.keys(t),r=n.length;for(let a=0;a<r;a++){if(t[+n[a]]===e)return!0}return!1}slice(e,t){const n=this._array;if(this._length>0){const r={};let a=0;for(let i=e;i<t;i++){const e=n[i];ah(e)&&(r[a]=n[i],a++)}return new ih(r,a)}return new ih}concat(e){const t=this._array,n=Object.keys(t),r=n.length,a=e._array,i=Object.keys(a),o=i.length,s=new ih(r+o),l=s._array;let c=0;for(let e=0;e<r;e++,c++){const r=n[e];l[c]=t[r]}for(let e=0;e<o;e++,c++){const t=i[e];l[c]=a[t]}return s}find(e){const t=this._array,n=Object.keys(t),r=n.length;for(let a=0;a<r;a++){const r=+n[a],i=t[r];if(!0===e(r,i))return i}return null}splice(e,t){const n=this._length;if(n>0){const r=e+t,a=this._array;let i=0;const o={};for(let t=e;t<r;t++){const e=a[t];ah(e)&&(delete a[t],o[i]=e,i++)}const s=r-e,l=n;if(this._length-=s,this._length<=0)this._array={},this._length=0;else for(let e=r;e<l;e++){const t=a[e];ah(t)&&(a[e-s]=a[e],delete a[e])}return new ih(o,i)}return new ih}findIndex(e){const t=this._array,n=Object.keys(t),r=n.length;for(let a=0;a<r;a++){const r=+n[a];if(!0===e(r,t[r]))return a}return-1}map(e){const t=this._array,n=Object.keys(t),r=n.length,a={};for(let i=0;i<r;i++){const r=t[+n[i]];a[i]=e(r)}return new ih(a)}filter(e){const t=this._array,n=Object.keys(t),r=n.length,a={};let i=0;for(let o=0;o<r;o++){const r=+n[o],s=t[r];e(r,s)&&(a[i]=s,i++)}return new ih(a,i)}insert(e,t){const n=this._length,r=this._array;for(let t=n-1;t>=e;t--)r[t+1]=r[t];return r[e]=t,this._length=n+1,this}inserts(e,t){const n=t._array,r=t._length,a=this._array;for(let t=this._length-1;t>=e;t--){const e=a[t];ah(e)&&(delete a[t],a[t+r]=e)}for(let t=0;t<r;t++){const r=n[t];ah(r)&&(a[t+e]=n[t])}return this._length+=r,this}[Symbol.iterator](){return new oh(this)}}class oh{constructor(e){Zu(this,"_array"),Zu(this,"_keys"),Zu(this,"_cursor"),this._array=e,this._keys=e.getKeys(),this._cursor=0}next(){const e=this._array,t=this._keys,n=this._cursor;if(n<t.length){const r=t[n],a=e.get(+r);return this._cursor++,{value:a,done:!1}}return{value:null,done:!0}}[Symbol.iterator](){return new oh(this._array)}}class sh{constructor(e={}){Zu(this,"_matrix"),hh.isAssignableFrom(e,sh)?this._matrix=e._matrix:hh.isAssignableFrom(e,ih)?this._matrix=e:hh.isPlainObject(e)&&(this._matrix=new ih(e))}getMatrix(){return this._matrix}forEach(e){const t=this._matrix.getKeys(),n=t.length;for(let r=0;r<n;r++){const n=+t[r];if(!1===e(n,this.getRow(n)))return this}return this}forValue(e){const t=this._matrix.getKeys(),n=t.length;for(let r=0;r<n;r++){const n=+t[r],a=this.getRow(n),i=a.getKeys(),o=i.length;for(let t=0;t<o;t++){const r=+i[t];if(!1===e(n,r,a.get(r)))return this}}return this}swapRow(e,t){const n=this._matrix.get(e),r=this._matrix.get(t);this._matrix.set(t,n),this._matrix.set(e,r)}getRow(e){const{_matrix:t}=this;let n=t.get(e);return hh.isAssignableFrom(n,ih)?n:hh.isPlainObject(n)?(n=new ih(n),t.set(e,n),n):void 0}getRowOrCreate(e){const t=this.getRow(e);if(t)return t;const n=new ih;return this._matrix.set(e,n),n}reset(){this._matrix=new ih({})}hasValue(){const e=this._matrix;for(const t of e)if(!t.isEmpty())return!0;return!1}getValue(e,t){const n=this.getRow(e);return n?n.get(t):null}setValue(e,t,n){this.getRowOrCreate(e).set(t,n)}deleteValue(e,t){const n=this.getRow(e);n&&n.delete(t)}spliceRows(e,t){const n=this._matrix.splice(e,t);return new sh(n)}pushRow(e){this._matrix.push(e)}insertRow(e,t){this._matrix.insert(e,t)}insertRows(e,t){this._matrix.inserts(e,t._matrix)}spliceColumns(e,t){const n=new sh;return this._matrix.forEach(((r,a)=>{var i;for(let a=e;a<e+t;a++)n.setValue(r,a-e,this.getValue(r,a));null==(i=this._matrix.get(r))||i.splice(e,t)})),n}insertColumns(e,t){const n=t.getRow(0).getLength();this._matrix.forEach(((r,a)=>{var i,o;for(let s=e;s<e+n;s++)null==(i=t.getRow(r))||i.get(s-e),a.insert(s,null==(o=t.getRow(r))?void 0:o.get(s-e))}))}getFragments(e,t,n,r){const a=new sh;for(let i=e;i<=t;i++){const e=new ih;for(let t=n;t<=r;t++){const n=this.getValue(i,t);e.push(n)}a.pushRow(e)}return a}getSizeOf(){return this._matrix.getSizeOf()}getLength(){return this._matrix.getLength()}getRange(){const e=this.getSizeOf();let t=0;const n=this.getLength();for(let e=0;e<n;e++){const n=this.getRow(e);if(n){const e=n.getSizeOf();n.getSizeOf()>t&&(t=e-1)}}return{startRow:0,startColumn:0,endRow:e,endColumn:t}}toArray(){return this._matrix.toArray().map((e=>e.toArray()))}toJSON(){const{_matrix:e}=this;return e.toJSON()}getData(){const e=JSON.stringify(this);return JSON.parse(e)}getArrayData(){let e=0,t=0,n=!1,r=!1;const a=new sh;return this.forEach(((i,o)=>{n||(n=!0,e=i),o.forEach(((n,o)=>{r?n<t&&(t=n):(r=!0,t=n);const s=this.getValue(i,n);a.setValue(i-e,n-t,s)}))})),a.getData()}getDataRange(){let e=0,t=0,n=0,r=!1,a=!1;this.forEach(((i,o)=>{r||(r=!0,e=i);const s=o.getLength()-1;s>n&&(n=s),o.forEach(((e,n)=>{a?e<t&&(t=e):(a=!0,t=e)}))}));const i=e+this.getSizeOf()-1;return{startRow:e,startColumn:t,endRow:i,endColumn:n}}}const lh=/^-ms-/,ch=/-([a-z])/g,uh=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];class hh{static stringAt(e){let t="",n=e;for(;n>=uh.length;)n/=uh.length,n-=1,t+=uh[n%uh.length];return t+=uh[e%uh.length],t}static getEnvironment(){const{appVersion:e}=navigator,t=this.getSystemType();return{app_version:e,os:t,os_version:t,device_id:"",platform:"web"}}static indexAt(e){let t=0;for(let n=0;n<e.length-1;n+=1){const r=e.charCodeAt(n)-65,a=e.length-1-n;t+=uh.length**a+uh.length*r}return t+=e.charCodeAt(e.length-1)-65,t}static deleteBlank(e){return hh.isString(e)?e.replace(/\s/g,""):e}static getSystemType(){const e=navigator.userAgent,t="Win32"===navigator.platform||"Windows"===navigator.platform,n="Mac68K"===navigator.platform||"MacPPC"===navigator.platform||"Macintosh"===navigator.platform||"MacIntel"===navigator.platform;if(n)return"Mac";if("X11"===navigator.platform&&!t&&!n)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(t){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Windows 2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"Windows XP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Windows 2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"Windows Vista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Windows 7";if(e.indexOf("Windows NT 10")>-1||e.indexOf("Windows 10")>-1)return"Windows 10";if(e.indexOf("Windows NT 11")>-1||e.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const e=navigator.userAgent,t=e.indexOf("Opera")>-1,n=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!t,r=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,a=e.indexOf("Edge")>-1,i=e.indexOf("Firefox")>-1,o=e.indexOf("Safari")>-1&&-1===e.indexOf("Chrome"),s=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(n){new RegExp("MSIE (\\d+\\.\\d+);").test(e);const t=parseFloat(RegExp.$1);return 7===t?"IE7":8===t?"IE8":9===t?"IE9":10===t?"IE10":"0"}return i?"FF":t?"Opera":o?"Safari":s?"Chrome":a?"Edge":r?"IE11":"Unknown browser"}static generateRandomId(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return`${e()+e()}-${e()}-${e()}-${e()}-${e()}${e()}${e()}`}static getClassName(e){return e.constructor.name}static deepMerge(e,...t){function n(e,t){e.forEach(((e,a)=>{var i,o;if(hh.isArray(e)){const r=null!=(i=t[a])?i:[];return t[a]=r,void n(e,r)}if(hh.isObject(e)){const n=null!=(o=t[a])?o:{};return t[a]=n,void r(e,n)}t[a]=e}))}function r(e,t){Object.keys(e).forEach((a=>{var i,o;const s=e[a];if(hh.isObject(s)){const e=null!=(i=t[a])?i:{};return t[a]=e,void r(s,e)}if(hh.isArray(s)){const e=null!=(o=t[a])?o:[];return t[a]=e,void n(s,e)}t[a]=s}))}return t.forEach((t=>t&&function(t){Object.keys(t).forEach((a=>{var i,o;const s=t[a];if(hh.isArray(s)){const t=null!=(i=e[a])?i:[];return e[a]=t,void n(s,t)}if(hh.isObject(s)){const t=null!=(o=e[a])?o:{};return e[a]=t,void r(s,t)}e[a]=s}))}(t))),e}static numberFixed(e,t){return Number(Number(e).toFixed(t))}static diffValue(e,t){function n(r,a){return hh.getValueType(r)===hh.getValueType(a)&&(hh.isArray(r)?function(r,a){if(e.length!==t.length)return!1;for(let e=0,t=r.length;e<t;e++){if(!n(r[e],a[e]))return!1}return!0}(r,a):hh.isObject(r)?function(e,t){const r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(const i of r){if(!a.includes(i))return!1;if(!n(e[i],t[i]))return!1}return!0}(r,a):hh.isDate(r)?r.getTime()===a.getTime():hh.isRegExp(r)?r.toString()===a.toString():r===a)}return n(e,t)}static deepClone(e){if(!this.isDefine(e))return e;if(this.isRegExp(e))return new RegExp(e);if(this.isDate(e))return new Date(e);if(this.isArray(e)){const t=[];return e.forEach(((e,n)=>{t[n]=hh.deepClone(e)})),t}if(this.isObject(e)){const t={};return Object.keys(e).forEach((n=>{const r=e[n];t[n]=hh.deepClone(r)})),Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}return e}static getLanguage(){return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||"en-US"}static getValueType(e){return Object.prototype.toString.apply(e)}static isDefine(e){return null!=e}static isBlank(e){return!this.isDefine(e)||!!this.isString(e)&&""===e.trim()}static isAssignableFrom(e,t){return e instanceof t}static isBoolean(e){return"[object Boolean]"===this.getValueType(e)}static isPlainObject(e){return!!this.isDefine(e)&&Object.getPrototypeOf(e)===Object.getPrototypeOf({})}static isFunction(e){return"[object Function]"===this.getValueType(e)}static isDate(e){return"[object Date]"===this.getValueType(e)}static isRegExp(e){return"[object RegExp]"===this.getValueType(e)}static isArray(e){return"[object Array]"===this.getValueType(e)}static isString(e){return"[object String]"===this.getValueType(e)}static isNumber(e){return"[object Number]"===this.getValueType(e)}static isObject(e){return"[object Object]"===this.getValueType(e)}static isEmptyObject(e){for(const t in e)return!1;return!0}static isMobile(){let e=0,t=0;return document.body.clientWidth&&(e=document.body.clientWidth),document.body.clientHeight&&(t=document.body.clientHeight),this.isAndroid()||this.isIPhone()||this.isTablet()||e<350&&t<500}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isWeChat(){const e=navigator.userAgent.toLowerCase();return"micromessenger"===String(e.match(/MicroMessenger/i))}static isAndroid(){const e=navigator.userAgent;return e.indexOf("Android")>-1||e.indexOf("Linux")>-1}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isIEBrowser(){return this.getBrowserType().startsWith("IE")}static itCount(e){return t=>{for(let n=0;n<e;n++)t&&t()}}static hasLength(e,t){return!!hh.isDefine(e)&&(hh.isDefine(t)?e.length===t:e.length>0)}static capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}static fCamelCase(e,t){return t.toUpperCase()}static camelCase(e){return e.replace(lh,"ms-").replace(ch,this.fCamelCase)}static removeNull(e){if(this.isObject(e)){const t={};return Object.keys(e).forEach((t=>{const n=e[t];null==n?delete e[t]:hh.removeNull(n)})),t}return e}static fillTwoDimensionalArray(e,t,n){return new Array(e).fill(n).map((e=>new Array(t).fill(n)))}static fillObjectMatrix(e,t,n){const r=new sh;for(let a=0;a<e;a++)for(let e=0;e<t;e++)r.setValue(a,e,n);return r.getData()}static numToWord(e){let t="";for(;e>0;){let n=e%26;n=0===n?n=26:n,t=String.fromCharCode(96+n)+t,e=(e-n)/26}return t.toLocaleUpperCase()}static ABCatNum(e){if(null==e||0===e.length)return NaN;const t=e.toLowerCase().split(""),n=t.length;let r=0,a=0;for(let e=0;e<n;e++)a=t[e].charCodeAt(0)-96,r+=a*26**(n-e-1);return 0===r?NaN:r-1}static chatAtABC(e){const t="a".charCodeAt(0),n="z".charCodeAt(0)-t+1;let r="";for(;e>=0;)r=String.fromCharCode(e%n+t)+r,e=Math.floor(e/n)-1;return r.toUpperCase()}static randSort(e){for(let t=0,n=e.length;t<n;t++){const r=parseInt((Math.random()*n).toString()),a=e[r];e[r]=e[t],e[t]=a}return e}static commonExtend(e,t){let n={};for(let t in e)n[t]=e[t];for(let e in t)null!=t[e]&&(n[e]=t[e]);return n}}var dh=(e=>(e[e.DEFAULT_SERIES=0]="DEFAULT_SERIES",e[e.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",e))(dh||{}),ph=(e=>(e[e.NONE=0]="NONE",e[e.THIN=1]="THIN",e[e.HAIR=2]="HAIR",e[e.DOTTED=3]="DOTTED",e[e.DASHED=4]="DASHED",e[e.DASH_DOT=5]="DASH_DOT",e[e.DASH_DOT_DOT=6]="DASH_DOT_DOT",e[e.DOUBLE=7]="DOUBLE",e[e.MEDIUM=8]="MEDIUM",e[e.MEDIUM_DASHED=9]="MEDIUM_DASHED",e[e.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",e[e.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",e[e.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",e[e.THICK=13]="THICK",e))(ph||{}),mh=(e=>(e.TOP="top",e.BOTTOM="bottom",e.LEFT="left",e.RIGHT="right",e.NONE="none",e.ALL="all",e.OUTSIDE="outside",e.INSIDE="inside",e.HORIZONTAL="horizontal",e.VERTICAL="vertical",e))(mh||{}),_h=(e=>(e[e.UNSUPPORTED=0]="UNSUPPORTED",e[e.RGB=1]="RGB",e[e.HEX=2]="HEX",e[e.THEME=3]="THEME",e))(_h||{}),gh=(e=>(e[e.PASTE_NORMAL=0]="PASTE_NORMAL",e[e.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",e[e.PASTE_FORMAT=2]="PASTE_FORMAT",e[e.PASTE_FORMULA=3]="PASTE_FORMULA",e[e.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",e[e.PASTE_VALUES=5]="PASTE_VALUES",e[e.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",e[e.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",e))(gh||{}),fh=(e=>(e[e.COLUMNS=0]="COLUMNS",e[e.ROWS=1]="ROWS",e))(fh||{}),yh=(e=>(e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.TOP=2]="TOP",e[e.BOTTOM=3]="BOTTOM",e))(yh||{}),vh=(e=>(e[e.NUMBER_FORMAT_TYPE_UNSPECIFIED=0]="NUMBER_FORMAT_TYPE_UNSPECIFIED",e[e.TEXT=1]="TEXT",e[e.NUMBER=2]="NUMBER",e[e.PERCENT=3]="PERCENT",e[e.CURRENCY=4]="CURRENCY",e[e.DATE=5]="DATE",e[e.TIME=6]="TIME",e[e.DATE_TIME=7]="DATE_TIME",e[e.SCIENTIFIC=8]="SCIENTIFIC",e))(vh||{}),bh=(e=>(e.EN="en",e.ZH="zh",e))(bh||{}),xh=(e=>(e[e.GRID=0]="GRID",e[e.KANBAN=1]="KANBAN",e[e.GANTT=2]="GANTT",e))(xh||{}),wh=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",e[e.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",e))(wh||{}),Th=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LEFT=1]="LEFT",e[e.CENTER=2]="CENTER",e[e.RIGHT=3]="RIGHT",e[e.JUSTIFIED=4]="JUSTIFIED",e))(Th||{}),Ch=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.TOP=1]="TOP",e[e.MIDDLE=2]="MIDDLE",e[e.BOTTOM=3]="BOTTOM",e))(Ch||{}),Eh=(e=>(e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.OVERFLOW=1]="OVERFLOW",e[e.CLIP=2]="CLIP",e[e.WRAP=3]="WRAP",e))(Eh||{}),Ah=(e=>(e[e.NORMAL=0]="NORMAL",e[e.SUBSCRIPT=1]="SUBSCRIPT",e[e.SUPERSCRIPT=2]="SUPERSCRIPT",e))(Ah||{}),Sh=(e=>(e[e.FALSE=0]="FALSE",e[e.TRUE=1]="TRUE",e))(Sh||{}),Dh=(e=>(e[e.DARK1=0]="DARK1",e[e.LIGHT1=1]="LIGHT1",e[e.DARK2=2]="DARK2",e[e.LIGHT2=3]="LIGHT2",e[e.ACCENT1=4]="ACCENT1",e[e.ACCENT2=5]="ACCENT2",e[e.ACCENT3=6]="ACCENT3",e[e.ACCENT4=7]="ACCENT4",e[e.ACCENT5=8]="ACCENT5",e[e.ACCENT6=9]="ACCENT6",e[e.HYPERLINK=10]="HYPERLINK",e[e.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",e))(Dh||{}),Rh=(e=>(e.OFFICE="Office",e.OFFICE_2007_2010="Office 2007-2010",e.GRAYSCALE="Grayscale",e.BLUE_WARM="Blue Warm",e.BLUE="Blue",e.BLUE_II="Blue II",e.BLUE_GREEN="Blue Green",e.GREEN="Green",e.GREEN_YELLOW="Green Yellow",e.YELLOW="Yellow",e.YELLOW_ORANGE="Yellow Orange",e.ORANGE="Orange",e.ORANGE_RED="Orange Red",e.RED_ORANGE="Red Orange",e.RED="Red",e.RED_VIOLET="Red Violet",e.VIOLET="Violet",e.VIOLET_II="Violet II",e.MEDIAN="Median",e.PAPER="Paper",e.MARQUEE="Marquee",e.SLIPSTREAM="Slipstream",e.Aspect="Aspect",e))(Rh||{});class Nh{constructor(){Zu(this,"_themeValue"),Zu(this,"_themeColors"),Zu(this,"_themeTint"),Zu(this,"_rgbValue"),Zu(this,"_colorType"),this._colorType=_h.UNSUPPORTED,this._themeColors=Rh.OFFICE,this._themeTint=0}asRgbColor(){return new Ph(this._rgbValue,this)}asThemeColor(){return new Bh(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case _h.THEME:return this.asThemeColor();case _h.RGB:return this.asRgbColor();case _h.UNSUPPORTED:throw Error("unsupported color type")}}setRgbColor(e){return this._colorType=_h.RGB,this._rgbValue=e,this}setThemeColors(e){this._colorType=_h.THEME,this._themeColors=e}setThemeTint(e){this._colorType=_h.THEME,this._themeTint=e}setThemeColor(e){return this._colorType=_h.THEME,this._themeValue=e,this}getColorType(){return this._colorType}}const Mh={[Rh.OFFICE]:{[Dh.ACCENT1]:"#4472C4",[Dh.ACCENT2]:"#ED7D31",[Dh.ACCENT3]:"#A5A5A5",[Dh.ACCENT4]:"#70AD47",[Dh.ACCENT5]:"#5B9BD5",[Dh.ACCENT6]:"#70AD47",[Dh.DARK1]:"#000000",[Dh.DARK2]:"#44546A",[Dh.LIGHT1]:"#FFFFFF",[Dh.LIGHT2]:"#E7E6E6",[Dh.HYPERLINK]:"#0563C1",[Dh.FOLLOWED_HYPERLINK]:"#954F72"}};class Oh{constructor(e){Zu(this,"_builder"),this._builder=e}static rgbColorToHexValue(e){return`#${((1<<24)+(e.getRed()<<16)+(e.getGreen()<<8)+e.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(e){e?e.indexOf("#")>-1&&(e=e.substring(1)):e="#000000";let t=+`0x${e[0]}${e[1]}`,n=+`0x${e[2]}${e[3]}`,r=+`0x${e[4]}${e[5]}`;return(new Nh).setRgbColor(`rgb(${t},${n},${r})`).asRgbColor()}static hexToRgbString(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((e,t,n,r)=>t+t+n+n+r+r));const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);let n=null;if(t){n=`rgba(${parseInt(t[1],16)},${parseInt(t[2],16)},${parseInt(t[3],16)})`}return n}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new Oh(this._builder)}equals(e){return!1}}class kh{constructor(e){Zu(this,"_saturation"),Zu(this,"_hue"),Zu(this,"_lightness"),Zu(this,"_alpha");const t=e.getRed()/255,n=e.getGreen()/255,r=e.getBlue()/255,a=e.getAlpha()/255,i=Math.min(t,Math.min(n,r)),o=Math.max(t,Math.max(n,r)),s=o-i;if(o===i)return this._hue=0,this._saturation=0,void(this._lightness=o);this._lightness=(i+o)/2,this._lightness<.5?this._saturation=s/(o+i):this._saturation=s/(2-o-i),t===o&&(this._hue=(n-r)/s),n===o&&(this._hue=2+(r-t)/s),r===o&&(this._hue=4+(t-n)/s),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=a}asRgbColor(){const e=new Nh;if(0===this._saturation)return e.setRgbColor(`rgba(${255*this._lightness},${255*this._lightness},${255*this._lightness},${255*this._alpha})`),e.asRgbColor();let t;t=this._lightness<.5?this._lightness*(1+this._saturation):this._lightness+this._saturation-this._lightness*this._saturation;const n=2*this._lightness-t,r=this._hue/360,a=r+1/3,i=this.setColor(t,n,a),o=this.setColor(t,n,r),s=r-1/3,l=this.setColor(t,n,s);return e.setRgbColor(`rgba(${Math.round(255*i)},${Math.round(255*o)},${Math.round(255*l)},${255*this._alpha})`),e.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(e,t,n){let r;return n<0&&(n+=1),n>1&&(n-=1),r=6*n<1?t+6*(e-t)*n:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t,r}setLightness(e){this._lightness=e}}const Ih=class extends Oh{constructor(e,t){super(t),Zu(this,"_cssString"),Zu(this,"_red"),Zu(this,"_green"),Zu(this,"_blue"),Zu(this,"_alpha");let n=e.match(Ih.RGBA_EXTRACT);if(n){const t=+n[1],r=+n[2],a=+n[3],i=+n[4];return this._cssString=e,this._red=t,this._green=r,this._blue=a,void(this._alpha=i)}if(n=e.match(Ih.RGB_EXTRACT),n){const t=+n[1],r=+n[2],a=+n[3];return this._cssString=e,this._red=t,this._green=r,this._blue=a,void(this._alpha=1)}throw new Error("Invalid rgba or rgb color")}asHexString(){return Oh.rgbColorToHexValue(this)}getRed(){let e=this._red+Ih.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getGreen(){let e=this._green+Ih.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getBlue(){let e=this._blue+Ih.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getAlpha(){return this._alpha}getColorType(){return _h.RGB}clone(){return new Ih(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(e){return e instanceof Ih&&(e._red===this._red&&e._blue===this._blue&&e._green===this._green&&e._alpha===this._alpha)}getCssString(){return this._cssString}};let Ph=Ih;Zu(Ph,"RGB_COLOR_AMT",0),Zu(Ph,"RGBA_EXTRACT",new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*")),Zu(Ph,"RGB_EXTRACT",new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*"));const Lh=class extends Oh{constructor(e,t,n,r){super(r),Zu(this,"_themeColorType"),Zu(this,"_themeTint"),Zu(this,"_themeColors"),this._themeColorType=e,this._themeTint=t,this._themeColors=n}lumValue(e,t){if(null==e)return t;let n;return n=e<0?t*(1+e):t*(1-e)+(255-255*(1-e)),n}asRgbColor(){const e=Mh[this._themeColors];if(null==e)throw new Error("not find themeColors type");const t=e.get(this._themeColorType);if(null==t)throw new Error("not find themeColors value");let n;if(Lh._cacheThemeColor.has(this._themeColors)){if(n=Lh._cacheThemeColor.get(this._themeColors),n.has(this._themeColorType))return n.get(this._themeColorType)}else n=new Map,Lh._cacheThemeColor.set(this._themeColors,n);const r=new kh(Oh.hexValueToRgbColor(t));r.setLightness(this.lumValue(this._themeTint,255*r.getLightness())/255);const a=r.asRgbColor();return n.set(this._themeColorType,a),a}clone(){return new Lh(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(e){return e instanceof Lh&&e._themeColorType===this._themeColorType}getColorType(){return _h.THEME}getThemeColorType(){return this._themeColorType}};let Bh=Lh;Zu(Bh,"_cacheThemeColor",new Map);var Fh=(e=>(e.INSERT_ROW_DATA_ACTION="InsertRowDataAction",e.REMOVE_ROW_DATA_ACTION="RemoveRowDataAction",e.INSERT_ROW_ACTION="InsertRowAction",e.REMOVE_ROW_ACTION="RemoveRowAction",e.SET_RANGE_STYLE_ACTION="SetRangeStyleAction",e.SET_RANGE_FORMULA_ACTION="SetRangeFormulaAction",e.SET_RANGE_FORMAT_ACTION="SetRangeFormatAction",e.SET_SELECTION_ACTION="SetSelectionActivateAction",e.SET_RANGE_DATA_ACTION="SetRangeDataAction",e.SET_RANGE_FORMATTED_VALUE_ACTION="SetRangeFormattedValueAction",e.SET_RANGE_NOTE_ACTION="SetRangeNoteAction",e.DELETE_RANGE_ACTION="DeleteRangeAction",e.INSERT_SHEET_ACTION="InsertSheetAction",e.REMOVE_SHEET_ACTION="RemoveSheetAction",e.CLEAR_RANGE_ACTION="ClearRangeAction",e.INSERT_RANGE_ACTION="InsertRangeAction",e.SET_TAB_COLOR_ACTION="SetTabColorAction",e.HIDE_SHEET_ACTION="SetWorkSheetHideAction",e.SET_WORKSHEET_ACTIVATE_ACTION="SetWorkSheetActivateAction",e.INSERT_COLUMN_ACTION="InsertColumnAction",e.INSERT_COLUMN_DATA_ACTION="InsertColumnDataAction",e.REMOVE_COLUMN_ACTION="RemoveColumnAction",e.REMOVE_COLUMN_DATA_ACTION="RemoveColumnDataAction",e.SET_HIDE_ROW_ACTION="SetRowHideAction",e.SET_HIDE_COLUMN_ACTION="SetColumnHideAction",e.SET_SHOW_ROW_ACTION="SetRowShowAction",e.SET_SHOW_COLUMN_ACTION="SetColumnShowAction",e.ADD_MERGE_ACTION="AddMergeAction",e.REMOVE_MERGE_ACTION="RemoveMergeAction",e.SET_WORKSHEET_NAME_ACTION="SetWorkSheetNameAction",e.SET_WORKSHEET_STATUS_ACTION="SetWorkSheetStatusAction",e.SET_BORDER_ACTION="SetBorderAction",e.SET_COLUMN_WIDTH_ACTION="SetColumnWidthAction",e.SET_ROW_HEIGHT_ACTION="SetRowHeightAction",e.SET_HIDDEN_GRIDLINES_ACTION="SetHiddenGridlinesAction",e.SET_RIGHT_TO_LEFT_ACTION="SetRightToLeftAction",e.DELETE_BANDING_ACTION="DeleteBandingAction",e.SET_BANDING_ACTION="SetBandingAction",e.ADD_BANDING_ACTION="AddBandingAction",e.DELETE_NAMED_RANGE_ACTION="DeleteNamedRangeAction",e.SET_NAMED_RANGE_ACTION="SetNamedRangeAction",e.ADD_NAMED_RANGE_ACTION="AddNamedRangeAction",e.SET_SHEET_ORDER_ACTION="SetSheetOrderAction",e.SET_ZOOM_RATIO_ACTION="SetZoomRatioAction",e))(Fh||{});const Hh={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1};Sh.FALSE,bh.EN;const qh={type:xh.GRID,name:"",id:"",tabColor:"",hidden:Sh.FALSE,freezeColumn:-1,rowCount:1e3,columnCount:100,freezeRow:-1,zoomRatio:1,scrollTop:0,scrollLeft:0,defaultColumnWidth:73,defaultRowHeight:19,mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},status:Sh.FALSE,showGridlines:Sh.TRUE,rowTitle:{width:46,hidden:Sh.FALSE},columnTitle:{height:20,hidden:Sh.FALSE},selections:["A1"],rightToLeft:Sh.FALSE,pluginMeta:{}},Uh={ff:"Times New Roman",fs:14,it:Sh.FALSE,bl:Sh.FALSE,ul:{s:Sh.FALSE},st:{s:Sh.FALSE},ol:{s:Sh.FALSE},tr:{a:0,v:Sh.FALSE},td:wh.UNSPECIFIED,cl:{rgb:"#000"},bg:{rgb:"#fff"},ht:Th.UNSPECIFIED,vt:Ch.UNSPECIFIED,tb:Eh.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0}},Vh="set",Wh="insert",zh="remove",Yh={modifier:["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Symbol","SymbolLock"],legacyModifier:["Hyper","Super"],whiteSpace:["Enter","Tab"],navigation:["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home","PageDown","PageUp"],editing:["Backspace","Clear","Copy","CrSel","Cut","Delete","EraseEof","ExSel","Insert","Paste","Redo","Undo"],ui:["Accept","Again","Attn","Cancel","ContextMenu","Escape","Execute","Find","Help","Pause","Play","Props","Select","ZoomIn","ZoomOut"],device:["BrightnessDown","BrightnessUp","Eject","LogOff","Power","PowerOff","PrintScreen","Hibernate","Standby","WakeUp"],imeCompositionKeys:["AllCandidates","Alphanumeric","CodeInput","Compose","Convert","Dead","FinalMode","GroupFirst","GroupLast","GroupNext","GroupPrevious","ModeChange","NextCandidate","NonConvert","PreviousCandidate","Process","SingleCandidate"],koreanSpecific:["HangulMode","HanjaMode","JunjaMode"],japaneseSpecific:["Eisu","Hankaku","Hiragana","HiraganaKatakana","KanaMode","KanjiMode","Katakana","Romaji","Zenkaku","ZenkakuHankaku"],commonFunction:["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Soft1","Soft2","Soft3","Soft4"],multimedia:["ChannelDown","ChannelUp","Close","MailForward","MailReply","MailSend","MediaClose","MediaFastForward","MediaPause","MediaPlay","MediaPlayPause","MediaRecord","MediaRewind","MediaStop","MediaTrackNext","MediaTrackPrevious","New","Open","Print","Save","SpellCheck"],multimediaNumpad:["Key11","Key12"],audio:["AudioBalanceLeft","AudioBalanceRight","AudioBassBoostDown","AudioBassBoostToggle","AudioBassBoostUp","AudioFaderFront","AudioFaderRear","AudioSurroundModeNext","AudioTrebleDown","AudioTrebleUp","AudioVolumeDown","AudioVolumeUp","AudioVolumeMute","MicrophoneToggle","MicrophoneVolumeDown","MicrophoneVolumeUp","MicrophoneVolumeMute"],speech:["SpeechCorrectionList","SpeechInputToggle"],application:["LaunchApplication1","LaunchApplication2","LaunchCalendar","LaunchContacts","LaunchMail","LaunchMediaPlayer","LaunchMusicPlayer","LaunchPhone","LaunchScreenSaver","LaunchSpreadsheet","LaunchWebBrowser","LaunchWebCam","LaunchWordProcessor"],browser:["BrowserBack","BrowserFavorites","BrowserForward","BrowserHome","BrowserRefresh","BrowserSearch","BrowserStop"],mobilePhone:["AppSwitch","Call","Camera","CameraFocus","EndCall","GoBack","GoHome","HeadsetHook","LastNumberRedial","Notification","MannerMode","VoiceDial"],tv:["TV","TV3DMode","TVAntennaCable","TVAudioDescription","TVAudioDescriptionMixDown","TVAudioDescriptionMixUp","TVContentsMenu","TVDataService","TVInput","TVInputComponent1","TVInputComponent2","TVInputComposite1","TVInputComposite2","TVInputHDMI1","TVInputHDMI2","TVInputHDMI3","TVInputHDMI4","TVInputVGA1","TVMediaContext","TVNetwork","TVNumberEntry","TVPower","TVRadioService","TVSatellite","TVSatelliteBS","TVSatelliteCS","TVSatelliteToggle","TVTerrestrialAnalog","TVTerrestrialDigital","TVTimer"],mediaControls:["AVRInput","AVRPower","ColorF0Red","ColorF1Green","ColorF2Yellow","ColorF3Blue","ColorF4Grey","ColorF5Brown","ClosedCaptionToggle","Dimmer","DisplaySwap","DVR","Exit","FavoriteClear0","FavoriteClear1","FavoriteClear2","FavoriteClear3","FavoriteRecall0","FavoriteRecall1","FavoriteRecall2","FavoriteRecall3","FavoriteStore0","FavoriteStore1","FavoriteStore2","FavoriteStore3","Guide","GuideNextDay","GuidePreviousDay","Info","InstantReplay","Link","ListProgram","LiveContent","Lock","MediaApps","MediaAudioTrack","MediaLast","MediaSkipBackward","MediaSkipForward","MediaStepBackward","MediaStepForward","MediaTopMenu","NavigateIn","NavigateNext","NavigateOut","NavigatePrevious","NextFavoriteChannel","NextUserProfile","OnDemand","Pairing","PinPDown","PinPMove","PinPToggle","PinPUp","PlaySpeedDown","PlaySpeedReset","PlaySpeedUp","RandomToggle","RcLowBattery","RecordSpeedNext","RfBypass","ScanChannelsToggle","ScreenModeNext","Settings","SplitScreenToggle","STBInput","STBPower","Subtitle","Teletext","VideoModeNext","Wink","ZoomToggle"]};class Gh{constructor(e,t){Zu(this,"_columnData"),Zu(this,"_workSheet"),this._workSheet=e,this._columnData=new ih(t)}getColumnData(){return this._columnData}getColumnDatas(e,t){const n=new ih;for(let r=e;r<e+t;r++){const e=this.getColumnOrCreate(r);n.push(e)}return n}getSize(){return this._columnData.getLength()}getColumnWidth(...e){const{_workSheet:t}=this,{_columnData:n}=this,r=t.getConfig();let a=0;if(1===e.length)a=n.obtain(e[0],{hd:Sh.FALSE,w:r.defaultColumnWidth}).w;else if(2===e.length)for(let t=e[0];t<e[0]+e[1];t++){a+=n.obtain(t,{hd:Sh.FALSE,w:r.defaultColumnWidth}).w}return a}setColumnWidth(e,t){const n=this._workSheet.getContext(),r=this._workSheet.getCommandManager(),a={sheetId:this._workSheet.getSheetId(),actionName:Fh.SET_COLUMN_WIDTH_ACTION,columnIndex:e,columnWidth:t},i=new Np(n.getWorkBook(),a);r.invoke(i)}getColumn(e){const t=this._columnData.get(e);if(t)return t}getColumnOrCreate(e){const{_workSheet:t}=this,{_columnData:n}=this,r=t.getConfig(),a=n.get(e);if(a)return a;const i={w:r.defaultColumnWidth,hd:Sh.FALSE};return this._columnData.set(e,i),i}}function Xh(e,t){for(let n=0;n<t.length;n++)e.add(t[n]);return[]}function $h(e,t){let n=[];for(let r=0;r<t.length;r++)n=n.concat(e.remove(t[r]));return n}class jh{constructor(e,t,n,r,a){Zu(this,"operation"),Zu(this,"type"),Zu(this,"value"),Zu(this,"key"),Zu(this,"attribute"),this.operation=e,this.type=t,this.attribute=n,this.key=r,this.value=a}getData(){return this.toJSON()}toJSON(){return{operation:this.operation,key:this.key,value:this.value,type:this.type,attribute:this.attribute}}}class Kh extends jh{constructor(e,t="",n="",r=""){super(e,"worksheet",t,n,r)}}function Zh(e,t){e.push(t)}function Qh(e,t){return e.find(((n,r)=>n.namedRangeId===t?(e.splice(r,1),n):null))}function Jh(e,t,n,r){const{startRow:a,endRow:i,startColumn:o,endColumn:s}=r,l=i-a+1,c=s-o+1,u=e.rowCount,h=e.columnCount,d=new sh;if(n===fh.ROWS)for(let e=a;e<=u;e++)for(let n=o;n<=s;n++){if(e<=i){const r=t.getValue(e,n);d.setValue(e,n,r)}const r=t.getValue(e+l,n);r?t.setValue(e,n,hh.deepClone(r)):t.getValue(e,n)&&(t.deleteValue(e,n),n--)}else if(n===fh.COLUMNS)for(let e=a;e<=i;e++)for(let n=o;n<=h;n++){if(n<=s){const r=t.getValue(e,n);d.setValue(e,n,r)}else for(let r=0;r<=s;r++){const a=t.getValue(e,n);d.setValue(e,n+r,a)}const r=t.getValue(e,n+c);if(r)t.setValue(e,n,hh.deepClone(r));else if(t.getValue(e,n)){for(let r=0;r<=s;r++)t.deleteValue(e,n);break}}return d.getData()}function ed(e,t){const n=e.getConfig(),r=n.hidden;return n.hidden=t,r}function td(e=0,t=1,n){new ih(n).inserts(e,new ih(t))}function nd(e,t,n){new sh(n).insertColumns(e,new sh(t))}function rd(e,t,n){new sh(n).insertRows(e,new sh(t))}function ad(e,t,n,r,a){const{startRow:i,endRow:o,startColumn:s,endColumn:l}=r,c=o-i+1,u=l-s+1,h=e.rowCount,d=e.columnCount;if(n===fh.ROWS){for(let e=h;e>=i;e--)for(let n=s;n<=l;n++){const r=t.getValue(e,n);t.setValue(e+c,n,r)}for(let e=o;e>=i;e--)for(let n=s;n<=l;n++)t.setValue(e,n,a[e-i][n-s])}else if(n===fh.COLUMNS){for(let e=i;e<=o;e++)for(let n=d;n>=s;n--){const r=t.getValue(e,n);t.setValue(e,n+u,r)}for(let e=i;e<=o;e++)for(let n=l;n>=s;n--)t.setValue(e,n,a[e-i][n-s])}}function id(e=0,t=1,n){new ih(n).inserts(e,new ih(t))}function od(e,t,n){const r=e.getWorksheets(),a=e.getConfig(),{sheets:i,sheetOrder:o}=a;if(i[n.id])throw new Error(`Insert Sheet fail ${n.id} is already exist`);return i[n.id]=n,o.splice(t,0,n.id),r.set(n.id,new hp(e.getContext(),n)),n.id}function sd(e,t,n){const r=new ih(n),a=new ih,i=e+t;for(let t=e;t<i;t++){const n=r.splice(e,1);n.getLength()&&a.set(t,n.first())}return a.getLength()}function ld(e,t,n){return new sh(n).spliceColumns(e,t).toJSON()}function cd(e,t,n){const r=new ih(n),a=new ih,i=e+t;for(let t=e;t<i;t++){const n=r.splice(e,1);n.getLength()&&a.set(t,n.first())}return a.getLength()}function ud(e,t,n){return new sh(n).spliceRows(e,t).toJSON()}function hd(e,t){const n=e.getWorksheets(),r=e.getConfig(),{sheets:a}=r;if(null==a[t])throw new Error(`Remove Sheet fail ${t} is not exist`);const i=a[t],o=r.sheetOrder.findIndex((e=>e===t));return delete a[t],r.sheetOrder.splice(o,1),n.delete(t),{index:o,sheet:i}}function dd(e,t,n){const r=new sh(n),a=new sh;return r.forEach(((n,r)=>{r.forEach(((r,i)=>{const o=e.getValue(n,r);if(o){const e=t.get(o.s);e&&a.setValue(n,r,e),o.s=t.setValue(i)}}))})),a.toJSON()}function pd(e=0,t,n){for(let r=e;r<e+t;r++){n.getColumnOrCreate(r).hd=1}}function md(e=0,t,n){for(let r=e;r<e+t;r++){const e=n.getColumn(r);e&&(e.hd=0)}}function _d(e=0,t,n){const r=[];for(let a=e;a<e+t.length;a++){const e=n.getColumnOrCreate(a);r[a]=e.w,e.w=t[a]}return r}function gd(e,t){const n=e.getConfig(),r=0===n.showGridlines;return n.showGridlines=t?0:1,r}function fd(e=0,t,n){for(let r=e;r<e+t;r++){const e=n.getRowOrCreate(r);e&&(e.hd=1)}}function yd(e,t){return e.find(((n,r)=>n.namedRangeId===t.namedRangeId?(e[r]=t,n):null))}function vd(e,t,n,r){const{startRow:a,endRow:i,startColumn:o,endColumn:s}=n,l=new sh;for(let n=a;n<=i;n++)for(let i=o;i<=s;i++){const s=e.getValue(n,i)||{},c=s.s?r.get(s.s):null;null==c&&delete s.s;const u=wd(c,t[n-a][i-o]);u&&hh.removeNull(u),hh.isEmptyObject(u)?delete s.s:s.s=r.setValue(u),s.p&&Td(s.p,t[n-a][i-o]),e.setValue(n,i,s),l.setValue(n-a,i-o,bd(c,t[n-a][i-o]))}return l.getData()}function bd(e,t){return function(e,t){if(!t||!Object.keys(t).length)return e;const n=hh.deepClone(e)||{};for(const e in t)"bd"===e?n[e]=xd(n[e]||{},t[e]):e in n||(n[e]=null);return n}(e,t)}function xd(e,t){if(!t||!Object.keys(t).length)return e;for(const n in t)n in e||(e[n]=null);return e}function wd(e,t,n=!1){if(!t)return t;const r=hh.deepClone(e)||{};for(const e in t)n&&["bd","tr","td","ht","vt","tb","pd"].includes(e)||(e in r&&"bd"===e?r[e]=Object.assign(r[e],t[e]):(r[e]=t[e],"cl"in r&&["ul","ol","st"].includes(e)&&(r[e].cl=r.cl)));return r}function Td(e,t){var n;null==(n=e.body)||n.blockElementOrder.forEach((n=>{var r,a;if(0===(null==(r=e.body)?void 0:r.blockElements[n].blockType)){const r=null==(a=e.body)?void 0:a.blockElements[n].paragraph;null==r||r.elementOrder.forEach((({elementId:e,paragraphElementType:n})=>{r.elements[e].tr||(r.elements[e].tr={});const a=r.elements[e].tr;a.ts||(a.ts={});const i=wd(a.ts,t,!0);i&&hh.removeNull(i),hh.isEmptyObject(i)?delete a.ts:a.ts=i}))}}))}function Cd(e,t,n,r,a){let i;isNaN(parseInt(Object.keys(t)[0]))||(i=new sh(t));const o=new sh,{startRow:s,endRow:l,startColumn:c,endColumn:u}=n;if(a){for(let n=s;n<=l;n++)for(let r=c;r<=u;r++){const s=i?i.getValue(n,r):t,l=e.getValue(n,r),c={};a.contentsOnly&&(c.m=null==l?void 0:l.m,c.v=null==l?void 0:l.v),a.formatOnly&&(c.v=null==l?void 0:l.v,c.m=null==l?void 0:l.m),o.setValue(n,r,c||{}),e.setValue(n,r,s||{})}return o.getData()}for(let n=s;n<=l;n++)for(let a=c;a<=u;a++){const s=i?i.getValue(n,a):t,l=e.getValue(n,a)||{};if(!s){e.setValue(n,a,s),o.setValue(n,a,l);continue}const c=l.s?r.get(l.s):null,u=bd(c,null==s?void 0:s.s),h=hh.deepClone(l);h.s=u,o.setValue(n,a,h),null==c&&delete l.s;const d=wd(c,null==s?void 0:s.s);d&&hh.removeNull(d),hh.isEmptyObject(d)?delete l.s:l.s=r.setValue(d),s.p&&(l.p=s.p),s.v&&(l.v=s.v),s.m?l.m=s.m:l.m=String(l.v),s.t&&(l.t=s.t),e.setValue(n,a,l)}return o.getData()}function Ed(e,t,n){const r=new sh(t),a=new sh;for(let t=n.startRow;t<=n.endRow;t++)for(let a=n.startColumn;a<=n.endColumn;a++){const n=r.getValue(t,a);if(n){JSON.parse(n);const r=e.getValue(t,a),i=hh.deepClone(r||{});e.setValue(t,a,i||{})}else{const n=e.getValue(t,a),r=hh.deepClone(n||{});e.setValue(t,a,r||{})}}return a.getData()}function Ad(e,t,n){const r=new sh(t),a=new sh;for(let t=n.startRow;t<=n.endRow;t++)for(let a=n.startColumn;a<=n.endColumn;a++){const n=r.getValue(t,a),i=e.getValue(t,a),o=hh.deepClone(i||{});o.f=n,e.setValue(t,a,o||{})}return a.getData()}function Sd(e,t,n){const r=new sh(t),a=new sh;for(let t=n.startRow;t<=n.endRow;t++)for(let a=n.startColumn;a<=n.endColumn;a++){const n=r.getValue(t,a),i=e.getValue(t,a),o=hh.deepClone(i||{});o.n=n,e.setValue(t,a,o||{})}return a.getData()}function Dd(e,t,n){const r=new sh(t),a=new sh;for(let t=n.startRow;t<=n.endRow;t++)for(let i=n.startColumn;i<=n.endColumn;i++){const n=r.getValue(t,i),o=e.getValue(t,i);a.setValue(t,i,o&&o.v||"");const s=hh.deepClone(o||{});s.v=n,s.m=`${n}`,e.setValue(t,i,s||{})}return a.getData()}function Rd(e,t){const n=e.getConfig(),r=n.rightToLeft;return n.rightToLeft=t,r}function Nd(e=0,t,n){const r=[];for(let a=e;a<e+t.length;a++){const e=n.getRowOrCreate(a);r[a]=e.h,e.h=t[a]}return r}function Md(e,t,n,r){var a,i,o;const s=e.getSelection(),l=null==(a=s.getActiveRangeList())?void 0:a.getRangeList(),c=null==(i=s.getActiveRange())?void 0:i.getRangeData(),u=null==(o=s.getCurrentCell())?void 0:o.getRangeData();return s.setRanges(t,n,r),{activeRangeList:l,activeRange:c,currentCell:u}}function Od(e,t,n){const r=e.getConfig(),a=r.sheetOrder.findIndex((e=>e===t)),i=r.sheetOrder.filter((e=>e!==t));return i.splice(n,0,t),r.sheetOrder=i,a}function kd(e=0,t,n){for(let r=e;r<e+t;r++){const e=n.getRow(r);e&&(e.hd=0)}}function Id(e,t){const n=e.getConfig(),r=n.tabColor;return n.tabColor=t,r}function Pd(e,t){const n=e.getContext().getWorkBook().getActiveSheet();let r="";const a=Sh.FALSE;n&&(r=n.getSheetId());const i=e.getContext().getWorkBook().getSheets(),o=e.getSheetId();return i.forEach((e=>{e.getSheetId()===o?e.getConfig().status=Sh.TRUE:e.getConfig().status=Sh.FALSE})),{oldSheetId:r,status:a}}function Ld(e,t){const n=e.getConfig(),r=n.name;return n.name=t,r}function Bd(e,t){const n=e.getConfig(),r=n.status;return n.status=t,r}function Fd(e,t,n){const r=e.getSheetBySheetId(t);if(r){const e=r.getConfig().zoomRatio;return r.getConfig().zoomRatio=n,e}return 1}class Hd extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new Kh(Vh)]},this._oldActionData={...e,cellValue:this.do(),convertor:[new Kh(Wh)]},this.validate()}do(){const e=this.getWorkSheet(),t=Jh({rowCount:e.getConfig().rowCount,columnCount:e.getConfig().columnCount},e.getCellMatrix(),this._doActionData.shiftDimension,this._doActionData.rangeData);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t,shiftDimension:n}=this._doActionData;this._oldActionData={sheetId:e,actionName:Fh.INSERT_RANGE_ACTION,shiftDimension:n,rangeData:t,cellValue:this.do(),convertor:[new Kh(Wh)]}}undo(){const e=this.getWorkSheet(),{shiftDimension:t,rangeData:n,cellValue:r}=this._oldActionData;e&&(ad({rowCount:e.getConfig().rowCount,columnCount:e.getConfig().columnCount},e.getCellMatrix(),t,n,r),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class qd extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet().getColumnManager();td(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnData().toJSON()),this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet().getColumnManager();this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this}),sd(this._oldActionData.columnIndex,this._oldActionData.columnCount,e.getColumnData().toJSON())}validate(){return!1}}class Ud extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet().getRowManager();id(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowData().toJSON()),this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet().getRowManager();this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this}),cd(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getRowData().toJSON())}validate(){return!1}}class Vd extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,columnCount:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet().getColumnManager(),t=sd(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnData().toJSON());return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet().getColumnManager();td(this._oldActionData.columnIndex,this._oldActionData.columnCount,e.getColumnData().toJSON()),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Wd extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new Kh(zh)]},this._oldActionData={...e,rowCount:this.do(),convertor:[new Kh(zh)]},this.validate()}do(){const e=this.getWorkSheet().getRowManager(),t=cd(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowData().toJSON());return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet().getRowManager();id(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getRowData().toJSON()),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class zd extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,order:this.do(),convertor:[]},this.validate()}do(){const e=Od(this.getWorkSheet().getContext().getWorkBook(),this._doActionData.sheetId,this._doActionData.order);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){Od(this.getWorkSheet().getContext().getWorkBook(),this._oldActionData.sheetId,this._oldActionData.order),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Yd{constructor(...e){if(Zu(this,"startRow"),Zu(this,"startColumn"),Zu(this,"endRow"),Zu(this,"endColumn"),hh.hasLength(e,0))return this.startRow=0,this.startColumn=0,this.endRow=0,void(this.endColumn=0);if(hh.hasLength(e,1)){const t=e[0];return this.startRow=t.startRow,this.startColumn=t.startColumn,this.endRow=t.endRow,void(this.endColumn=t.endColumn)}if(hh.hasLength(e,4)){const t=e[0],n=e[1],r=e[2],a=e[3];this.startRow=t,this.startColumn=n,this.endRow=r,this.endColumn=a}}intersects(e){const t=this.startRow,n=this.endRow,r=this.startColumn,a=this.endColumn,i=e.startRow,o=e.endRow,s=e.startColumn,l=e.endColumn,c=Math.abs(r+a-s-l),u=Math.abs(r-a)+Math.abs(s-l),h=Math.abs(t+n-i-o),d=Math.abs(t-n)+Math.abs(i-o);return c<=u&&h<=d}union(e){const{startRow:t,startColumn:n,endRow:r,endColumn:a}=this;return new Yd(e.startRow<this.startRow?e.startRow:t,e.startColumn<n?e.startColumn:n,e.endRow>r?e.endRow:r,e.endColumn>a?e.endColumn:a)}getData(){return{startRow:this.startRow,startColumn:this.startColumn,endRow:this.endRow,endColumn:this.endColumn}}equals(e){return this.endRow===e.endRow&&this.endColumn===e.endColumn&&this.startRow===e.startRow&&this.startColumn===e.startColumn}}const Gd=class{static checkup(e,...t){if(e.length!==t.length)return!1;const n=e.length;for(let r=0;r<n;r++){const n=e[r],a=t[r];switch(a){case Gd.BOOLEAN_TYPE:if(!hh.isBoolean(n))return!1;break;case Gd.NUMBER_TYPE:if(!hh.isNumber(n))return!1;break;case Gd.STRING_TYPE:if(!hh.isString(n))return!1;break;case Gd.FUNCTION_TYPE:if(!hh.isFunction(n))return!1;break;case Gd.OBJECT_TYPE:if(!hh.isPlainObject(n))return!1;break;default:if(!hh.isAssignableFrom(n,a))return!1}}return!0}};let Xd=Gd;Zu(Xd,"STRING_TYPE",1),Zu(Xd,"NUMBER_TYPE",2),Zu(Xd,"BOOLEAN_TYPE",3),Zu(Xd,"FUNCTION_TYPE",4),Zu(Xd,"OBJECT_TYPE",5);class $d{constructor(e,t){Zu(this,"_rectangleList"),Zu(this,"_worksheet"),this._worksheet=e,this._rectangleList=t,Tp.getCommandInjectorObservers().add((e=>{let t=e.include(Ud),n=e.include(qd),r=e.include(Wd),a=e.include(Vd),i=e.include(Hd);if(t){const e=t.getDoActionData();if(e.sheetId===this._worksheet.getSheetId()){const t=hh.deepClone(this._rectangleList);for(let n=0;n<t.length;n++){const r=t[n],a=e.rowCount;e.rowIndex>r.endRow||(e.rowIndex>=r.startRow&&e.rowIndex<=r.endRow||(r.startRow+=a),r.endRow+=a)}this.modifyMerge(this._rectangleList,t)}}if(n){const e=n.getDoActionData();if(e.sheetId===this._worksheet.getSheetId()){const t=hh.deepClone(this._rectangleList);for(let n=0;n<t.length;n++){const r=t[n],a=e.columnCount;e.columnIndex>r.endColumn||(e.columnIndex>=r.startColumn&&e.columnIndex<=r.endColumn||(r.startColumn+=a),r.endColumn+=a)}this.modifyMerge(this._rectangleList,t)}}if(r){const e=r.getDoActionData();if(e.sheetId===this._worksheet.getSheetId()&&e.sheetId===this._worksheet.getSheetId()){const t=hh.deepClone(this._rectangleList);for(let n=0;n<t.length;n++){const r=t[n],a=e.rowCount;e.rowIndex>r.endRow||(e.rowIndex>=r.startRow&&e.rowIndex<=r.endRow||(r.startRow-=a),r.endRow-=a)}this.modifyMerge(this._rectangleList,t)}}if(a){const e=a.getDoActionData();if(e.sheetId===this._worksheet.getSheetId()&&e.sheetId===this._worksheet.getSheetId()){const t=hh.deepClone(this._rectangleList);for(let n=0;n<t.length;n++){const r=t[n],a=e.columnCount;e.columnIndex>r.endColumn||(e.columnIndex>=r.startColumn&&e.columnIndex<=r.endColumn||(r.startColumn-=a),r.endColumn-=a)}this.modifyMerge(this._rectangleList,t)}}if(i){const e=i.getDoActionData();if(e.sheetId===this._worksheet.getSheetId()){const t=hh.deepClone(this._rectangleList),n=this.getByRowColumn(e.rangeData.startRow,e.rangeData.endRow,e.rangeData.startColumn,e.rangeData.endColumn);if(n&&n.forEach((e=>{const n=new Yd(e);for(let e=0;e<t.length;e++){const r=t[e];n.intersects(new Yd(r))&&t.splice(e,1)}})),e.shiftDimension)for(let n=0;n<t.length;n++){const r=t[n];if(r.endRow>=e.rangeData.startRow){if(r.endColumn<e.rangeData.startColumn)continue;if(r.startColumn>e.rangeData.endColumn)continue;if(!(r.startColumn>=e.rangeData.startColumn&&r.endColumn<=e.rangeData.endColumn))return;{const t=e.rangeData.endRow-e.rangeData.startRow;r.startRow-=t,r.endRow-=t}}}else for(let n=0;n<t.length;n++){const r=t[n];if(r.startColumn>e.rangeData.endColumn){if(r.endRow<e.rangeData.startRow)continue;if(r.startRow>e.rangeData.endRow)continue;if(!(r.startRow>=e.rangeData.startRow&&r.endRow<=e.rangeData.endRow))return;{const t=e.rangeData.endColumn-e.rangeData.startColumn;r.startColumn-=t,r.endColumn-=t}}}this.modifyMerge(this._rectangleList,t)}}}))}getMergeData(){return this._rectangleList}getByRowColumn(...e){const{_rectangleList:t}=this;let n;Xd.checkup(e,Xd.NUMBER_TYPE,Xd.NUMBER_TYPE,Xd.NUMBER_TYPE,Xd.NUMBER_TYPE)?n=new Yd(e[0],e[2],e[1],e[3]):Xd.checkup(e,Xd.NUMBER_TYPE,Xd.NUMBER_TYPE)&&(n=new Yd(e[0],e[1],e[0],e[1]));const r=[];for(let e=0;e<t.length;e++){const a=t[e];n.intersects(new Yd(a))&&r.push(a)}return r.length?r:null}remove(e){const{_rectangleList:t}=this,{length:n}=t,r=new Yd(e),a=[],i=[];for(let e=0;e<n;e++){const n=t[e];r.intersects(new Yd(n))?i.push(n):a.push(n)}return this._rectangleList=a,i}size(){return this._rectangleList.length}add(e){const t=this.remove(e);return this._rectangleList.push(e),t}union(e){const{_rectangleList:t}=this,{length:n}=t;let r=new Yd(e);for(let e=0;e<n;e++){const n=t[e];r=r.union(new Yd(n))}return r.getData()}getMergedRanges(e){const{_rectangleList:t}=this,{length:n}=t,r=[];for(let a=0;a<n;a++){const n=t[a];new Yd(e).intersects(new Yd(n))&&r.push(n)}return r}modifyMerge(e,t){const n=this._worksheet.getCommandManager(),r=this._worksheet.getContext(),a={actionName:Fh.REMOVE_MERGE_ACTION,sheetId:this._worksheet.getSheetId(),rectangles:e},i={actionName:Fh.ADD_MERGE_ACTION,sheetId:this._worksheet.getSheetId(),rectangles:t},o=new Np(r.getWorkBook(),a,i);n.invoke(o)}}var jd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof n.g<"u"?n.g:typeof self<"u"?self:{},Kd={exports:{}};!function(e,t){e.exports=function(){var e=1e3,t=6e4,n=36e5,r="millisecond",a="second",i="minute",o="hour",s="day",l="week",c="month",u="quarter",h="year",d="date",p="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,_=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},f=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},y={s:f,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),a=n%60;return(t<=0?"+":"-")+f(r,2,"0")+":"+f(a,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),a=t.clone().add(r,c),i=n-a<0,o=t.clone().add(r+(i?-1:1),c);return+(-(r+(n-a)/(i?a-o:o-a))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:h,w:l,d:s,D:d,h:o,m:i,s:a,ms:r,Q:u}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},v="en",b={};b[v]=g;var x=function(e){return e instanceof E},w=function e(t,n,r){var a;if(!t)return v;if("string"==typeof t){var i=t.toLowerCase();b[i]&&(a=i),n&&(b[i]=n,a=i);var o=t.split("-");if(!a&&o.length>1)return e(o[0])}else{var s=t.name;b[s]=t,a=s}return!r&&a&&(v=a),a||!r&&v},T=function(e,t){if(x(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new E(n)},C=y;C.l=w,C.i=x,C.w=function(e,t){return T(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var E=function(){function g(e){this.$L=w(e.locale,null,!0),this.parse(e)}var f=g.prototype;return f.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(C.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(m);if(r){var a=r[2]-1||0,i=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],a,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)):new Date(r[1],a,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},f.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},f.$utils=function(){return C},f.isValid=function(){return this.$d.toString()!==p},f.isSame=function(e,t){var n=T(e);return this.startOf(t)<=n&&n<=this.endOf(t)},f.isAfter=function(e,t){return T(e)<this.startOf(t)},f.isBefore=function(e,t){return this.endOf(t)<T(e)},f.$g=function(e,t,n){return C.u(e)?this[t]:this.set(n,e)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(e,t){var n=this,r=!!C.u(t)||t,u=C.p(e),p=function(e,t){var a=C.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return r?a:a.endOf(s)},m=function(e,t){return C.w(n.toDate()[e].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},_=this.$W,g=this.$M,f=this.$D,y="set"+(this.$u?"UTC":"");switch(u){case h:return r?p(1,0):p(31,11);case c:return r?p(1,g):p(0,g+1);case l:var v=this.$locale().weekStart||0,b=(_<v?_+7:_)-v;return p(r?f-b:f+(6-b),g);case s:case d:return m(y+"Hours",0);case o:return m(y+"Minutes",1);case i:return m(y+"Seconds",2);case a:return m(y+"Milliseconds",3);default:return this.clone()}},f.endOf=function(e){return this.startOf(e,!1)},f.$set=function(e,t){var n,l=C.p(e),u="set"+(this.$u?"UTC":""),p=(n={},n[s]=u+"Date",n[d]=u+"Date",n[c]=u+"Month",n[h]=u+"FullYear",n[o]=u+"Hours",n[i]=u+"Minutes",n[a]=u+"Seconds",n[r]=u+"Milliseconds",n)[l],m=l===s?this.$D+(t-this.$W):t;if(l===c||l===h){var _=this.clone().set(d,1);_.$d[p](m),_.init(),this.$d=_.set(d,Math.min(this.$D,_.daysInMonth())).$d}else p&&this.$d[p](m);return this.init(),this},f.set=function(e,t){return this.clone().$set(e,t)},f.get=function(e){return this[C.p(e)]()},f.add=function(r,u){var d,p=this;r=Number(r);var m=C.p(u),_=function(e){var t=T(p);return C.w(t.date(t.date()+Math.round(e*r)),p)};if(m===c)return this.set(c,this.$M+r);if(m===h)return this.set(h,this.$y+r);if(m===s)return _(1);if(m===l)return _(7);var g=(d={},d[i]=t,d[o]=n,d[a]=e,d)[m]||1,f=this.$d.getTime()+r*g;return C.w(f,this)},f.subtract=function(e,t){return this.add(-1*e,t)},f.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||p;var r=e||"YYYY-MM-DDTHH:mm:ssZ",a=C.z(this),i=this.$H,o=this.$m,s=this.$M,l=n.weekdays,c=n.months,u=function(e,n,a,i){return e&&(e[n]||e(t,r))||a[n].slice(0,i)},h=function(e){return C.s(i%12||12,e,"0")},d=n.meridiem||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r},m={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:C.s(s+1,2,"0"),MMM:u(n.monthsShort,s,c,3),MMMM:u(c,s),D:this.$D,DD:C.s(this.$D,2,"0"),d:String(this.$W),dd:u(n.weekdaysMin,this.$W,l,2),ddd:u(n.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(i),HH:C.s(i,2,"0"),h:h(1),hh:h(2),a:d(i,o,!0),A:d(i,o,!1),m:String(o),mm:C.s(o,2,"0"),s:String(this.$s),ss:C.s(this.$s,2,"0"),SSS:C.s(this.$ms,3,"0"),Z:a};return r.replace(_,(function(e,t){return t||m[e]||a.replace(":","")}))},f.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},f.diff=function(r,d,p){var m,_=C.p(d),g=T(r),f=(g.utcOffset()-this.utcOffset())*t,y=this-g,v=C.m(this,g);return v=(m={},m[h]=v/12,m[c]=v,m[u]=v/3,m[l]=(y-f)/6048e5,m[s]=(y-f)/864e5,m[o]=y/n,m[i]=y/t,m[a]=y/e,m)[_]||y,p?v:C.a(v)},f.daysInMonth=function(){return this.endOf(c).$D},f.$locale=function(){return b[this.$L]},f.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=w(e,t,!0);return r&&(n.$L=r),n},f.clone=function(){return C.w(this.$d,this)},f.toDate=function(){return new Date(this.valueOf())},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},g}(),A=E.prototype;return T.prototype=A,[["$ms",r],["$s",a],["$m",i],["$H",o],["$W",s],["$M",c],["$y",h],["$D",d]].forEach((function(e){A[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),T.extend=function(e,t){return e.$i||(e(t,E,T),e.$i=!0),T},T.locale=w,T.isDayjs=x,T.unix=function(e){return T(1e3*e)},T.en=b[v],T.Ls=b,T.p={},T}()}(Kd);const Zd=Kd.exports;var Qd={exports:{}};!function(e){!function(t,n){e.exports?e.exports=n():t.numeral=n()}(jd,(function(){var e,t,n={},r={},a={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},i={currentLocale:a.currentLocale,zeroFormat:a.zeroFormat,nullFormat:a.nullFormat,defaultFormat:a.defaultFormat,scalePercentBy100:a.scalePercentBy100};function o(e,t){this._input=e,this._value=t}return e=function(r){var a,s,l,c;if(e.isNumeral(r))a=r.value();else if(0===r||typeof r>"u")a=0;else if(null===r||t.isNaN(r))a=null;else if("string"==typeof r)if(i.zeroFormat&&r===i.zeroFormat)a=0;else if(i.nullFormat&&r===i.nullFormat||!r.replace(/[^0-9]+/g,"").length)a=null;else{for(s in n)if((c="function"==typeof n[s].regexps.unformat?n[s].regexps.unformat():n[s].regexps.unformat)&&r.match(c)){l=n[s].unformat;break}a=(l=l||e._.stringToNumber)(r)}else a=Number(r)||null;return new o(r,a)},e.version="2.0.6",e.isNumeral=function(e){return e instanceof o},e._=t={numberToFormat:function(t,n,a){var i,o,s,l,c,u,h,d,p=r[e.options.currentLocale],m=!1,_=!1,g="",f=1e12,y=1e9,v=1e6,b="",x=!1;if(t=t||0,s=Math.abs(t),e._.includes(n,"(")?(m=!0,n=n.replace(/[\(|\)]/g,"")):(e._.includes(n,"+")||e._.includes(n,"-"))&&(u=e._.includes(n,"+")?n.indexOf("+"):t<0?n.indexOf("-"):-1,n=n.replace(/[\+|\-]/g,"")),e._.includes(n,"a")&&(o=!!(o=n.match(/a(k|m|b|t)?/))&&o[1],e._.includes(n," a")&&(g=" "),n=n.replace(new RegExp(g+"a[kmbt]?"),""),s>=f&&!o||"t"===o?(g+=p.abbreviations.trillion,t/=f):s<f&&s>=y&&!o||"b"===o?(g+=p.abbreviations.billion,t/=y):s<y&&s>=v&&!o||"m"===o?(g+=p.abbreviations.million,t/=v):(s<v&&s>=1e3&&!o||"k"===o)&&(g+=p.abbreviations.thousand,t/=1e3)),e._.includes(n,"[.]")&&(_=!0,n=n.replace("[.]",".")),l=t.toString().split(".")[0],c=n.split(".")[1],h=n.indexOf(","),i=(n.split(".")[0].split(",")[0].match(/0/g)||[]).length,c?(e._.includes(c,"[")?(c=(c=c.replace("]","")).split("["),b=e._.toFixed(t,c[0].length+c[1].length,a,c[1].length)):b=e._.toFixed(t,c.length,a),l=b.split(".")[0],b=e._.includes(b,".")?p.delimiters.decimal+b.split(".")[1]:"",_&&0===Number(b.slice(1))&&(b="")):l=e._.toFixed(t,0,a),g&&!o&&Number(l)>=1e3&&g!==p.abbreviations.trillion)switch(l=String(Number(l)/1e3),g){case p.abbreviations.thousand:g=p.abbreviations.million;break;case p.abbreviations.million:g=p.abbreviations.billion;break;case p.abbreviations.billion:g=p.abbreviations.trillion}if(e._.includes(l,"-")&&(l=l.slice(1),x=!0),l.length<i)for(var w=i-l.length;w>0;w--)l="0"+l;return h>-1&&(l=l.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+p.delimiters.thousands)),0===n.indexOf(".")&&(l=""),d=l+b+(g||""),m?d=(m&&x?"(":"")+d+(m&&x?")":""):u>=0?d=0===u?(x?"-":"+")+d:d+(x?"-":"+"):x&&(d="-"+d),d},stringToNumber:function(e){var t,n,a,o=r[i.currentLocale],s=e,l={thousand:3,million:6,billion:9,trillion:12};if(i.zeroFormat&&e===i.zeroFormat)n=0;else if(i.nullFormat&&e===i.nullFormat||!e.replace(/[^0-9]+/g,"").length)n=null;else{for(t in n=1,"."!==o.delimiters.decimal&&(e=e.replace(/\./g,"").replace(o.delimiters.decimal,".")),l)if(a=new RegExp("[^a-zA-Z]"+o.abbreviations[t]+"(?:\\)|(\\"+o.currency.symbol+")?(?:\\))?)?$"),s.match(a)){n*=Math.pow(10,l[t]);break}n*=(e.split("-").length+Math.min(e.split("(").length-1,e.split(")").length-1))%2?1:-1,e=e.replace(/[^0-9\.]+/g,""),n*=Number(e)}return n},isNaN:function(e){return"number"==typeof e&&isNaN(e)},includes:function(e,t){return-1!==e.indexOf(t)},insert:function(e,t,n){return e.slice(0,n)+t+e.slice(n)},reduce:function(e,t){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var n,r=Object(e),a=r.length>>>0,i=0;if(3===arguments.length)n=arguments[2];else{for(;i<a&&!(i in r);)i++;if(i>=a)throw new TypeError("Reduce of empty array with no initial value");n=r[i++]}for(;i<a;i++)i in r&&(n=t(n,r[i],i,r));return n},multiplier:function(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)},correctionFactor:function(){var e=Array.prototype.slice.call(arguments);return e.reduce((function(e,n){var r=t.multiplier(n);return e>r?e:r}),1)},toFixed:function(e,t,n,r){var a,i,o,s,l=e.toString().split("."),c=t-(r||0);return a=2===l.length?Math.min(Math.max(l[1].length,c),t):c,o=Math.pow(10,a),s=(n(e+"e+"+a)/o).toFixed(a),r>t-a&&(i=new RegExp("\\.?0{1,"+(r-(t-a))+"}$"),s=s.replace(i,"")),s}},e.options=i,e.formats=n,e.locales=r,e.locale=function(e){return e&&(i.currentLocale=e.toLowerCase()),i.currentLocale},e.localeData=function(e){if(!e)return r[i.currentLocale];if(e=e.toLowerCase(),!r[e])throw new Error("Unknown locale : "+e);return r[e]},e.reset=function(){for(var e in a)i[e]=a[e]},e.zeroFormat=function(e){i.zeroFormat="string"==typeof e?e:null},e.nullFormat=function(e){i.nullFormat="string"==typeof e?e:null},e.defaultFormat=function(e){i.defaultFormat="string"==typeof e?e:"0.0"},e.register=function(e,t,n){if(t=t.toLowerCase(),this[e+"s"][t])throw new TypeError(t+" "+e+" already registered.");return this[e+"s"][t]=n,n},e.validate=function(t,n){var r,a,i,o,s,l,c,u;if("string"!=typeof t&&(t+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",t)),(t=t.trim()).match(/^\d+$/))return!0;if(""===t)return!1;try{c=e.localeData(n)}catch{c=e.localeData(e.locale())}return i=c.currency.symbol,s=c.abbreviations,r=c.delimiters.decimal,a="."===c.delimiters.thousands?"\\.":c.delimiters.thousands,(null===(u=t.match(/^[^\d]+/))||(t=t.substr(1),u[0]===i))&&(null===(u=t.match(/[^\d]+$/))||(t=t.slice(0,-1),u[0]===s.thousand||u[0]===s.million||u[0]===s.billion||u[0]===s.trillion))&&(l=new RegExp(a+"{2}"),!t.match(/[^\d.,]/g)&&(!((o=t.split(r)).length>2)&&(o.length<2?!!o[0].match(/^\d+.*\d$/)&&!o[0].match(l):1===o[0].length?!!o[0].match(/^\d+$/)&&!o[0].match(l)&&!!o[1].match(/^\d+$/):!!o[0].match(/^\d+.*\d$/)&&!o[0].match(l)&&!!o[1].match(/^\d+$/))))},e.fn=o.prototype={clone:function(){return e(this)},format:function(t,r){var a,o,s,l=this._value,c=t||i.defaultFormat;if(r=r||Math.round,0===l&&null!==i.zeroFormat)o=i.zeroFormat;else if(null===l&&null!==i.nullFormat)o=i.nullFormat;else{for(a in n)if(c.match(n[a].regexps.format)){s=n[a].format;break}o=(s=s||e._.numberToFormat)(l,c,r)}return o},value:function(){return this._value},input:function(){return this._input},set:function(e){return this._value=Number(e),this},add:function(e){var n=t.correctionFactor.call(null,this._value,e);return this._value=t.reduce([this._value,e],(function(e,t,r,a){return e+Math.round(n*t)}),0)/n,this},subtract:function(e){var n=t.correctionFactor.call(null,this._value,e);return this._value=t.reduce([e],(function(e,t,r,a){return e-Math.round(n*t)}),Math.round(this._value*n))/n,this},multiply:function(e){return this._value=t.reduce([this._value,e],(function(e,n,r,a){var i=t.correctionFactor(e,n);return Math.round(e*i)*Math.round(n*i)/Math.round(i*i)}),1),this},divide:function(e){return this._value=t.reduce([this._value,e],(function(e,n,r,a){var i=t.correctionFactor(e,n);return Math.round(e*i)/Math.round(n*i)})),this},difference:function(t){return Math.abs(e(this._value).subtract(t).value())}},e.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),e.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(t,n,r){var a,i=e._.includes(n," BPS")?" ":"";return t*=1e4,n=n.replace(/\s?BPS/,""),a=e._.numberToFormat(t,n,r),e._.includes(a,")")?((a=a.split("")).splice(-1,0,i+"BPS"),a=a.join("")):a=a+i+"BPS",a},unformat:function(t){return+(1e-4*e._.stringToNumber(t)).toFixed(15)}}),function(){var t={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},n={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},r=t.suffixes.concat(n.suffixes.filter((function(e){return t.suffixes.indexOf(e)<0}))),a=r.join("|");a="("+a.replace("B","B(?!PS)")+")",e.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(a)},format:function(r,a,i){var o,s,l,c=e._.includes(a,"ib")?n:t,u=e._.includes(a," b")||e._.includes(a," ib")?" ":"";for(a=a.replace(/\s?i?b/,""),o=0;o<=c.suffixes.length;o++)if(s=Math.pow(c.base,o),l=Math.pow(c.base,o+1),null===r||0===r||r>=s&&r<l){u+=c.suffixes[o],s>0&&(r/=s);break}return e._.numberToFormat(r,a,i)+u},unformat:function(r){var a,i,o=e._.stringToNumber(r);if(o){for(a=t.suffixes.length-1;a>=0;a--){if(e._.includes(r,t.suffixes[a])){i=Math.pow(t.base,a);break}if(e._.includes(r,n.suffixes[a])){i=Math.pow(n.base,a);break}}o*=i||1}return o}})}(),e.register("format","currency",{regexps:{format:/(\$)/},format:function(t,n,r){var a,i,o,s=e.locales[e.options.currentLocale],l={before:n.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:n.match(/([\+|\-|\)|\s|\$]*)$/)[0]};for(n=n.replace(/\s?\$\s?/,""),a=e._.numberToFormat(t,n,r),t>=0?(l.before=l.before.replace(/[\-\(]/,""),l.after=l.after.replace(/[\-\)]/,"")):t<0&&!e._.includes(l.before,"-")&&!e._.includes(l.before,"(")&&(l.before="-"+l.before),o=0;o<l.before.length;o++)switch(i=l.before[o],i){case"$":a=e._.insert(a,s.currency.symbol,o);break;case" ":a=e._.insert(a," ",o+s.currency.symbol.length-1)}for(o=l.after.length-1;o>=0;o--)switch(i=l.after[o],i){case"$":a=o===l.after.length-1?a+s.currency.symbol:e._.insert(a,s.currency.symbol,-(l.after.length-(1+o)));break;case" ":a=o===l.after.length-1?a+" ":e._.insert(a," ",-(l.after.length-(1+o)+s.currency.symbol.length-1))}return a}}),e.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(t,n,r){var a=("number"!=typeof t||e._.isNaN(t)?"0e+0":t.toExponential()).split("e");return n=n.replace(/e[\+|\-]{1}0/,""),e._.numberToFormat(Number(a[0]),n,r)+"e"+a[1]},unformat:function(t){var n=e._.includes(t,"e+")?t.split("e+"):t.split("e-"),r=Number(n[0]),a=Number(n[1]);return a=e._.includes(t,"e-")?a*=-1:a,e._.reduce([r,Math.pow(10,a)],(function(t,n,r,a){var i=e._.correctionFactor(t,n);return t*i*(n*i)/(i*i)}),1)}}),e.register("format","ordinal",{regexps:{format:/(o)/},format:function(t,n,r){var a=e.locales[e.options.currentLocale],i=e._.includes(n," o")?" ":"";return n=n.replace(/\s?o/,""),i+=a.ordinal(t),e._.numberToFormat(t,n,r)+i}}),e.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(t,n,r){var a,i=e._.includes(n," %")?" ":"";return e.options.scalePercentBy100&&(t*=100),n=n.replace(/\s?\%/,""),a=e._.numberToFormat(t,n,r),e._.includes(a,")")?((a=a.split("")).splice(-1,0,i+"%"),a=a.join("")):a=a+i+"%",a},unformat:function(t){var n=e._.stringToNumber(t);return e.options.scalePercentBy100?.01*n:n}}),e.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(e,t,n){var r=Math.floor(e/60/60),a=Math.floor((e-60*r*60)/60),i=Math.round(e-60*r*60-60*a);return r+":"+(a<10?"0"+a:a)+":"+(i<10?"0"+i:i)},unformat:function(e){var t=e.split(":"),n=0;return 3===t.length?(n+=60*Number(t[0])*60,n+=60*Number(t[1]),n+=Number(t[2])):2===t.length&&(n+=60*Number(t[0]),n+=Number(t[1])),Number(n)}}),e}))}(Qd);const Jd=Qd.exports,ep={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"};function tp(e){return null!==e&&""!==e.toString().replace(/\s/g,"")&&"boolean"!=typeof e&&!Number.isNaN(e)}let np=new Date("2017-02-19T19:06:09.000Z");Number.isNaN(np.getFullYear())&&(np=new Date("2/19/17"));const rp=2017===np.getFullYear();const ap=new Date(1900,2,1,0,0,0);function ip(e){let t=null,n={},r=e;if(null===e)return null;if(/^-?[0-9]{1,}[,][0-9]{3}(.[0-9]{1,2})?$/.test(e)){t=e,r=Number(e.split(".")[0].replace(",",""));let a="#,##0";if(e.split(".")[1]){a="#,##0.";for(let t=0;t<e.split(".")[1].length;t++)a+=0}n={fa:a,t:"n"}}else if("'"===e.toString().substr(0,1))t=e.toString().substr(1),n={fa:"@",t:"s"};else if("TRUE"===e.toString().toUpperCase())t="TRUE",n={fa:"General",t:"b"},r=!0;else if("FALSE"===e.toString().toUpperCase())t="FALSE",n={fa:"General",t:"b"},r=!1;else if(function(e){let t=!1;for(const n in ep)if(e===ep[n]){t=!0;break}return t}(e))t=e.toString(),n={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(e))t=e.toString(),n={fa:"@",t:"s"};else if(tp(e)&&Math.abs(parseFloat(e))>0&&(Math.abs(parseFloat(e))>=1e11||Math.abs(parseFloat(e))<1e-9)){r=Jd(e).value();const a=r.toExponential();if(a.indexOf(".")>-1){let e=a.split(".")[1].split("e")[0].length;e>5&&(e=5),n={fa:`#0.${new Array(e+1).join("0")}E+00`,t:"n"}}else n={fa:"#0.E+00",t:"n"};t=op.format(n.fa,r)}else if(e.toString().indexOf("%")>-1){const a=e.toString().indexOf("%");let i=e.toString().substr(0,a);const o=i.replace(/,/g,"");if(a===e.toString().length-1&&tp(o))if(i.indexOf(".")>-1)if(i.indexOf(".")===i.lastIndexOf(".")){const a=i.split(".")[0];let o=i.split(".")[1].length;if(o>9&&(o=9),a.indexOf(",")>-1){let i=!0,s=a.split(",");for(let e=1;e<s.length;e++)if(s[e].length<3){i=!1;break}i?(n={fa:`#,##0.${new Array(o+1).join("0")}%`,t:"n"},r=Jd(e).value(),t=op.format(n.fa,r)):(t=e.toString(),n={fa:"@",t:"s"})}else n={fa:`0.${new Array(o+1).join("0")}%`,t:"n"},r=Jd(e).value(),t=op.format(n.fa,r)}else t=e.toString(),n={fa:"@",t:"s"};else if(i.indexOf(",")>-1){let a=!0,o=i.split(",");for(let e=1;e<o.length;e++)if(o[e].length<3){a=!1;break}a?(n={fa:"#,##0%",t:"n"},r=Jd(e).value(),t=op.format(n.fa,r)):(t=e.toString(),n={fa:"@",t:"s"})}else n={fa:"0%",t:"n"},r=Jd(e).value(),t=op.format(n.fa,r);else t=e.toString(),n={fa:"@",t:"s"}}else if(e.toString().indexOf(".")>-1)if(e.toString().indexOf(".")===e.toString().lastIndexOf(".")){const a=e.toString().split(".")[0];let i=e.toString().split(".")[1],o=i.length;if(o>9&&(o=9),a.indexOf(",")>-1){let i=!0,s=a.split(",");for(let e=1;e<s.length;e++)if(!tp(s[e])||s[e].length<3){i=!1;break}i?(n={fa:`#,##0.${new Array(o+1).join("0")}`,t:"n"},r=Jd(e).value(),t=op.format(n.fa,r)):(t=e.toString(),n={fa:"@",t:"s"})}else tp(a)&&tp(i)?(n={fa:`0.${new Array(o+1).join("0")}`,t:"n"},r=Jd(e).value(),t=op.format(n.fa,r)):(t=e.toString(),n={fa:"@",t:"s"})}else t=e.toString(),n={fa:"@",t:"s"};else tp(e)?(t=e.toString(),n={fa:"General",t:"n"},r=parseFloat(e)):function(e){return!(null===e||e.toString().length<5||!function(e){if(!/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(e)&&!/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(e))return!1;const t=RegExp.$1,n=RegExp.$2,r=RegExp.$3;return!(t<1900||n>12||r>31||2===n&&(29===new Date(t,1,29).getDate()&&r>29||29!==new Date(t,1,29).getDate()&&r>28))}(e))}(e)&&(e.toString().indexOf(".")>-1||e.toString().indexOf(":")>-1||e.toString().length<16)?(r=function(e,t){let n=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());const r=Date.UTC(1899,11,31,0,0,0);return t?n-=1262304e5:e>=ap&&(n+=864e5),(n-r)/864e5}(function(e,t){const n=new Date(e);if(rp)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917===np.getFullYear()&&!Number.isNaN(n.getFullYear())){const t=n.getFullYear();return e.indexOf(`${t}`)>-1||n.setFullYear(n.getFullYear()+100),n}const r=e.match(/\d+/g)||["2017","2","19","0","0","0"];let a=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-60*a.getTimezoneOffset()*1e3)),a}(e.toString().replace(/-/g,"/"))),r.toString().indexOf(".")>-1?e.toString().length>18?n.fa="yyyy-MM-dd hh:mm:ss":e.toString().length>11?n.fa="yyyy-MM-dd hh:mm":n.fa="yyyy-MM-dd":n.fa="yyyy-MM-dd",n.t="d",t=op.format(n.fa,r)):(t=e,n.fa="General",n.t="g");return[t,n,r]}const op={format(e,t){}};class sp{static getApplyData(e,t,n,r,a){const i=this,o=[];i.applyType=r,i.direction=a;const s=Math.floor(n/t),l=n%t,c=e.number,u=[];if(c)for(let e=0;e<c.length;e++){const o=i.getLenS(c[e].index,l),h=c[e].index.length*s+o;let d;d=1===r?i.getDataByType(c[e].data,h,a,r,"number"):"2"===r?i.getDataByType(c[e].data,h,a,r):i.getDataByType(c[e].data,h,a,"0");const p=i.getDataIndex(t,n,c[e].index);u.push({data:d,index:p})}const h=e.extendNumber,d=[];if(h)for(let e=0;e<h.length;e++){const o=i.getLenS(h[e].index,l),c=h[e].index.length*s+o;let u;u="1"===r||"3"===r?i.getDataByType(h[e].data,c,a,r,"extendNumber"):"2"===r?i.getDataByType(h[e].data,c,a,r):i.getDataByType(h[e].data,c,a,"0");const p=i.getDataIndex(t,n,h[e].index);d.push({data:u,index:p})}const p=e.date,m=[];if(p)for(let e=0;e<p.length;e++){const o=i.getLenS(p[e].index,l),c=p[e].index.length*s+o;let u;u="1"===r||"3"===r?i.getDataByType(p[e].data,c,a,r,"date"):"8"===r?i.getDataByType(p[e].data,c,a,"0"):i.getDataByType(p[e].data,c,a,r);const h=i.getDataIndex(t,n,p[e].index);m.push({data:u,index:h})}const _=e.chnNumber,g=[];if(_)for(let e=0;e<_.length;e++){const o=i.getLenS(_[e].index,l),c=_[e].index.length*s+o;let u;u="1"===r||"3"===r?i.getDataByType(_[e].data,c,a,r,"chnNumber"):"2"===r||"8"===r?i.getDataByType(_[e].data,c,a,r):i.getDataByType(_[e].data,c,a,"0");const h=i.getDataIndex(t,n,_[e].index);g.push({data:u,index:h})}const f=e.chnWeek2,y=[];if(f)for(let e=0;e<f.length;e++){const o=i.getLenS(f[e].index,l),c=f[e].index.length*s+o;let u;u="1"===r||"3"===r?i.getDataByType(f[e].data,c,a,r,"chnWeek2"):"2"===r?i.getDataByType(f[e].data,c,a,r):i.getDataByType(f[e].data,c,a,"0");const h=i.getDataIndex(t,n,f[e].index);y.push({data:u,index:h})}const v=e.chnWeek3,b=[];if(v)for(let e=0;e<v.length;e++){const o=i.getLenS(v[e].index,l),c=v[e].index.length*s+o;let u;u="1"===r||"3"===r?i.getDataByType(v[e].data,c,a,r,"chnWeek3"):"2"===r?i.getDataByType(v[e].data,c,a,r):i.getDataByType(v[e].data,c,a,"0");const h=i.getDataIndex(t,n,v[e].index);b.push({data:u,index:h})}const x=e.other,w=[];if(x)for(let e=0;e<x.length;e++){const o=i.getLenS(x[e].index,l),c=x[e].index.length*s+o;let u;u="2"===r||"3"===r?i.getDataByType(x[e].data,c,a,r):i.getDataByType(x[e].data,c,a,"0");const h=i.getDataIndex(t,n,x[e].index);w.push({data:u,index:h})}for(let e=1;e<=n;e++){if(u.length>0)for(let t=0;t<u.length;t++)e in u[t].index&&o.push(u[t].data[u[t].index[e]]);if(d.length>0)for(let t=0;t<d.length;t++)e in d[t].index&&o.push(d[t].data[d[t].index[e]]);if(m.length>0)for(let t=0;t<m.length;t++)e in m[t].index&&o.push(m[t].data[m[t].index[e]]);if(g.length>0)for(let t=0;t<g.length;t++)e in g[t].index&&o.push(g[t].data[g[t].index[e]]);if(y.length>0)for(let t=0;t<y.length;t++)e in y[t].index&&o.push(y[t].data[y[t].index[e]]);if(b.length>0)for(let t=0;t<b.length;t++)e in b[t].index&&o.push(b[t].data[b[t].index[e]]);if(w.length>0)for(let t=0;t<w.length;t++)e in w[t].index&&o.push(w[t].data[w[t].index[e]])}return o}static getCopyData(e,t,n,r,a,i){const o=this,s=[];let l=0,c=0,u=0,h=0;i===yh.BOTTOM||i===yh.TOP?(l=r,c=a,u=t,h=n):(i===yh.RIGHT||i===yh.LEFT)&&(l=t,c=n,u=r,h=a);for(let t=l;t<=c;t++){const t={};let n=[],r=[],a="",i=null,l=null,c=!0;for(let s=u,d=0;s<=h;s++,d++){const p=e[d];let m;if(p&&p.v&&!p.f)if(p.fm&&p.fm.t===vh.NUMBER)m="number",i=null,l=null;else if(p.fm&&p.fm.t===vh.DATE)m="date",i=null,l=null;else if(o.isExtendNumber(p.m)[0]){m="extendNumber";const e=o.isExtendNumber(p.m);null===i||null===l?(c=!0,i=e[2],l=e[3]):e[2]!==i||e[3]!==l?(c=!1,i=e[2],l=e[3]):c=!0}else o.isChnNumber(p.m)?(m="chnNumber",i=null,l=null):o.isChnWeek2(p.m)?(m="chnWeek2",i=null,l=null):o.isChnWeek3(p.m)?(m="chnWeek3",i=null,l=null):(m="other",i=null,l=null);else m="other",i=null,l=null;"extendNumber"===m?s===u?u===h?(a=m,n.push(p),r.push(s-u+1),t[a]=[],t[a].push({data:n,index:r})):(a=m,n.push(p),r.push(s-u+1)):s===h?a===m&&c?(n.push(p),r.push(s-u+1),a in t||(t[a]=[]),t[a].push({data:n,index:r})):(a in t||(t[a]=[]),t[a].push({data:n,index:r}),a=m,n=[],n.push(p),r=[],r.push(s-u+1),a in t||(t[a]=[]),t[a].push({data:n,index:r})):a===m&&c?(n.push(p),r.push(s-u+1)):(a in t||(t[a]=[]),t[a].push({data:n,index:r}),a=m,n=[],n.push(p),r=[],r.push(s-u+1)):s===u?u===h?(a=m,n.push(p),r.push(s-u+1),t[a]=[],t[a].push({data:n,index:r})):(a=m,n.push(p),r.push(s-u+1)):s===h?a===m?(n.push(p),r.push(s-u+1),a in t||(t[a]=[]),t[a].push({data:n,index:r})):(a in t||(t[a]=[]),t[a].push({data:n,index:r}),a=m,n=[],n.push(p),r=[],r.push(s-u+1),a in t||(t[a]=[]),t[a].push({data:n,index:r})):a===m?(n.push(p),r.push(s-u+1)):(a in t||(t[a]=[]),t[a].push({data:n,index:r}),a=m,n=[],n.push(p),r=[],r.push(s-u+1))}s.push(t)}return s}static ChineseToNumber(e){const t=this;let n=0,r=0,a=0,i=!1;const o=e.split("");for(let e=0;e<o.length;e++){const s=t.chnNumChar[o[e]];if(typeof s<"u")a=s,e===o.length-1&&(r+=a);else{const s=t.chnNameValue[o[e]].value;i=t.chnNameValue[o[e]].secUnit,i?(r=(r+a)*s,n+=r,r=0):r+=a*s,a=0}}return n+r}static NumberToChinese(e){const t=this;let n=0,r="",a="",i=!1;if(0===e)return t.chnNumChar2[0];for(;e>0;){const o=e%1e4;i&&(a=t.chnNumChar2[0]+a),r=t.SectionToChinese(o),r+=0!==o?t.chnUnitSection[n]:t.chnUnitSection[0],a=r+a,i=o<1e3&&o>0,e=Math.floor(e/1e4),n++}return a}static SectionToChinese(e){const t=this;let n="",r="",a=0,i=!0;for(;e>0;){const o=e%10;0===o?i||(i=!0,r=t.chnNumChar2[o]+r):(i=!1,n=t.chnNumChar2[o],n+=t.chnUnitChar[a],r=n+r),a++,e=Math.floor(e/10)}return r}static getLenS(e,t){let n=0;for(let r=0;r<e.length&&e[r]<=t;r++)n++;return n}static getDataByType(e,t,n,r,a){const i=this;let o=[];if(r===dh.ALTERNATE_SERIES)(n===yh.TOP||n===yh.LEFT)&&e.reverse(),o=i.FillCopy(e,t);else if(r===dh.DEFAULT_SERIES)if("number"===a)o=i.FillSeries(e,t,n);else if("extendNumber"===a)if(1===e.length){let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1),o=i.FillExtendNumber(e,t,r)}else{const r=[];for(let t=0;t<e.length;t++){const n=e[t].m;r.push(Number(i.isExtendNumber(n)[1]))}if((n===yh.TOP||n===yh.LEFT)&&(e.reverse(),r.reverse()),i.isEqualDiff(r)){const n=r[1]-r[0];o=i.FillExtendNumber(e,t,n)}else o=i.FillCopy(e,t)}else if("date"===a)if(1===e.length){let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1),o=i.FillDays(e,t,r)}else{(n===yh.TOP||n===yh.LEFT)&&e.reverse();const r=i.judgeDate(e);if(r[0]&&r[3]){const n=Zd(e[1].m).diff(Zd(e[0].m),"months");o=i.FillMonths(e,t,n)}else if(!r[0]&&r[2]){const n=Zd(e[1].m).diff(Zd(e[0].m),"days");o=i.FillDays(e,t,n)}else o=i.FillCopy(e,t)}else if("chnNumber"===a)if(1===e.length)if("日"===e[0].m||i.ChineseToNumber(e[0].m)<7){let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1),o=i.FillChnWeek(e,t,r)}else{let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1),o=i.FillChnNumber(e,t,r)}else{let r=!1;for(let t=0;t<e.length;t++)if("日"===e[t].m){r=!0;break}const a=[];let s=0;for(let t=0;t<e.length;t++)"日"===e[t].m?0===t?a.push(0):(s++,a.push(7*s)):r&&i.ChineseToNumber(e[t].m)>0&&i.ChineseToNumber(e[t].m)<7?a.push(i.ChineseToNumber(e[t].m)+7*s):a.push(i.ChineseToNumber(e[t].m));if((n===yh.TOP||n===yh.LEFT)&&(e.reverse(),a.reverse()),i.isEqualDiff(a))if(r||a[a.length-1]<6&&a[0]>0||a[0]<6&&a[a.length-1]>0){const n=a[1]-a[0];o=i.FillChnWeek(e,t,n)}else{const n=a[1]-a[0];o=i.FillChnNumber(e,t,n)}else o=i.FillCopy(e,t)}else if("chnWeek2"===a)if(1===e.length){let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1),o=i.FillChnWeek2(e,t,r)}else{const r=[];let a=0;for(let t=0;t<e.length;t++){const n=e[t].m.substr(e[t].m.length-1,1);"周日"===e[t].m?0===t?r.push(0):(a++,r.push(7*a)):r.push(i.ChineseToNumber(n)+7*a)}if((n===yh.TOP||n===yh.LEFT)&&(e.reverse(),r.reverse()),i.isEqualDiff(r)){const n=r[1]-r[0];o=i.FillChnWeek2(e,t,n)}else o=i.FillCopy(e,t)}else if("chnWeek3"===a)if(1===e.length){let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1),o=i.FillChnWeek3(e,t,r)}else{const r=[];let a=0;for(let t=0;t<e.length;t++){const n=e[t].m.substr(e[t].m.length-1,1);"星期日"===e[t].m?0===t?r.push(0):(a++,r.push(7*a)):r.push(i.ChineseToNumber(n)+7*a)}if((n===yh.TOP||n===yh.LEFT)&&(e.reverse(),r.reverse()),i.isEqualDiff(r)){const n=r[1]-r[0];o=i.FillChnWeek3(e,t,n)}else o=i.FillCopy(e,t)}else(n===yh.TOP||n===yh.LEFT)&&e.reverse(),o=i.FillCopy(e,t);else if("2"===r)(n===yh.TOP||n===yh.LEFT)&&e.reverse(),o=i.FillOnlyFormat(e,t);else if("3"===r){const r=i.getDataByType(e,t,n,"1",a);o=i.FillWithoutFormat(r)}else if("4"===r)if(1===e.length){let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1),o=i.FillDays(e,t,r)}else if(2===e.length){(n===yh.TOP||n===yh.LEFT)&&e.reverse();const r=Zd(e[1].m).diff(Zd(e[0].m),"days");o=i.FillDays(e,t,r)}else{(n===yh.TOP||n===yh.LEFT)&&e.reverse();const r=i.judgeDate(e);if(r[0]&&r[3]){const n=Zd(e[1].m).diff(Zd(e[0].m),"months");o=i.FillMonths(e,t,n)}else if(!r[0]&&r[2]){const n=Zd(e[1].m).diff(Zd(e[0].m),"days");o=i.FillDays(e,t,n)}else o=i.FillCopy(e,t)}else if("5"===r)if(1===e.length){let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1);const a=Math.round(1.5*t);for(let n=1;n<=a;n++){const a={...e[n]},i=Zd(a.m).add(n,"days").day();if(0===i||6===i)continue;const s=Zd(a.m).add(r*n,"days").format("YYYY-MM-DD");if(a.m=s,a.v=ip(s)[2],o.push(a),o.length===t)break}}else if(2===e.length)if(Zd(e[1].m).date()===Zd(e[0].m).date()&&0!==Zd(e[1].m).diff(Zd(e[0].m),"months")){(n===yh.TOP||n===yh.LEFT)&&e.reverse();const r=Zd(e[1].m).diff(Zd(e[0].m),"months");for(let n=1;n<=t;n++){const t={...e[(n-1)%e.length]},a=Zd(e[e.length-1]).add(r*n,"months").day();let i;i=0===a?Zd(e[e.length-1]).add(r*n,"months").subtract(2,"days").format("YYYY-MM-DD"):6===a?Zd(e[e.length-1]).add(r*n,"months").subtract(1,"days").format("YYYY-MM-DD"):Zd(e[e.length-1]).add(r*n,"months").format("YYYY-MM-DD"),t.m=i,t.v=ip(i)[2],o.push(t)}}else if(Math.abs(Zd(e[1].m).diff(Zd(e[0].m)))>7){let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1,e.reverse());let a=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,i={...e[t]},s=Math.ceil(n/e.length);0===t&&(a=Zd(i.m).add(r*s,"months").diff(Zd(i.m),"days"));const l=Zd(i.m).add(a,"days").day();let c;c=0===l?Zd(i.m).add(a,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?Zd(i.m).add(a,"days").subtract(1,"days").format("YYYY-MM-DD"):Zd(i.m).add(a,"days").format("YYYY-MM-DD"),i.m=c,i.v=ip(c)[2],o.push(i)}}else{let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=7:(n===yh.TOP||n===yh.LEFT)&&(r=-7,e.reverse());let a=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,i={...e[t]},s=Math.ceil(n/e.length);0===t&&(a=Zd(i.m).add(r*s,"days").diff(Zd(i.m),"days"));const l=Zd(i.m).add(a,"days").day();let c;c=0===l?Zd(i.m).add(a,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?Zd(i.m).add(a,"days").subtract(1,"days").format("YYYY-MM-DD"):Zd(i.m).add(a,"days").format("YYYY-MM-DD"),i.m=c,i.v=ip(c)[2],o.push(i)}}else{const r=i.judgeDate(e);if(r[0]&&r[3]){(n===yh.TOP||n===yh.LEFT)&&e.reverse();const r=Zd(e[1].m).diff(Zd(e[0].m),"months");for(let n=1;n<=t;n++){const t={...e[(n-1)%e.length]},a=Zd(e[e.length-1].m).add(r*n,"months").day();let i;i=0===a?Zd(e[e.length-1].m).add(r*n,"months").subtract(2,"days").format("YYYY-MM-DD"):6===a?Zd(e[e.length-1].m).add(r*n,"months").subtract(1,"days").format("YYYY-MM-DD"):Zd(e[e.length-1].m).add(r*n,"months").format("YYYY-MM-DD"),t.m=i,t.v=ip(i)[2],o.push(t)}}else if(!r[0]&&r[2])if(Math.abs(Zd(e[1].m).diff(Zd(e[0].m)))>7){let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1,e.reverse());let a=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,i={...e[t]},s=Math.ceil(n/e.length);0===t&&(a=Zd(i.m).add(r*s,"months").diff(Zd(i.m),"days"));const l=Zd(i.m).add(a,"days").day();let c;c=0===l?Zd(i.m).add(a,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?Zd(i.m).add(a,"days").subtract(1,"days").format("YYYY-MM-DD"):Zd(i.m).add(a,"days").format("YYYY-MM-DD"),i.m=c,i.v=ip(c)[2],o.push(i)}}else{let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=7:(n===yh.TOP||n===yh.LEFT)&&(r=-7,e.reverse());let a=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,i={...e[t]},s=Math.ceil(n/e.length);0===t&&(a=Zd(i.m).add(r*s,"days").diff(Zd(i.m),"days"));const l=Zd(i.m).add(a,"days").day();let c;c=0===l?Zd(i.m).add(a,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?Zd(i.m).add(a,"days").subtract(1,"days").format("YYYY-MM-DD"):Zd(i.m).add(a,"days").format("YYYY-MM-DD"),i.m=c,i.v=ip(c)[2],o.push(i)}}else(n===yh.TOP||n===yh.LEFT)&&e.reverse(),o=i.FillCopy(e,t)}else if("6"===r)if(1===e.length){let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1),o=i.FillMonths(e,t,r)}else if(2===e.length)if(Zd(e[1].m).date()===Zd(e[0].m).date()&&0!==Zd(e[1].m).diff(Zd(e[0].m),"months")){(n===yh.TOP||n===yh.LEFT)&&e.reverse();const r=Zd(e[1].m).diff(Zd(e[0].m),"months");o=i.FillMonths(e,t,r)}else{let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1,e.reverse());let a=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,i={...e[t]},s=Math.ceil(n/e.length);0===t&&(a=Zd(i.m).add(r*s,"months").diff(Zd(i.m),"days"));const l=Zd(i.m).add(a,"days").format("YYYY-MM-DD");i.m=l,i.v=ip(l)[2],o.push(i)}}else{const r=i.judgeDate(e);if(r[0]&&r[3]){(n===yh.TOP||n===yh.LEFT)&&e.reverse();const r=Zd(e[1].m).diff(Zd(e[0].m),"months");o=i.FillMonths(e,t,r)}else if(!r[0]&&r[2]){let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1,e.reverse());let a=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,i={...e[t]},s=Math.ceil(n/e.length);0===t&&(a=Zd(i.m).add(r*s,"months").diff(Zd(i.m),"days"));const l=Zd(i.m).add(a,"days").format("YYYY-MM-DD");i.m=l,i.v=ip(l)[2],o.push(i)}}else(n===yh.TOP||n===yh.LEFT)&&e.reverse(),o=i.FillCopy(e,t)}else if("7"===r)if(1===e.length){let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1),o=i.FillYears(e,t,r)}else if(2===e.length)if(Zd(e[1].m).date()===Zd(e[0].m).date()&&Zd(e[1].m).month()===Zd(e[0].m).month()&&0!==Zd(e[1].m).diff(Zd(e[0].m),"years")){(n===yh.TOP||n===yh.LEFT)&&e.reverse();const r=Zd(e[1].m).diff(Zd(e[0].m),"years");o=i.FillYears(e,t,r)}else{let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1,e.reverse());let a=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,i={...e[t]},s=Math.ceil(n/e.length);0===t&&(a=Zd(i.m).add(r*s,"years").diff(Zd(i.m),"days"));const l=Zd(i.m).add(a,"days").format("YYYY-MM-DD");i.m=l,i.v=ip(l)[2],o.push(i)}}else{const r=i.judgeDate(e);if(r[0]&&r[1]&&r[4]){(n===yh.TOP||n===yh.LEFT)&&e.reverse();const r=Zd(e[1].m).diff(Zd(e[0].m),"years");o=i.FillYears(e,t,r)}else if(r[0]&&r[3]||r[2]){let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1,e.reverse());let a=0;for(let n=1;n<=t;n++){const t=(n-1)%e.length,i={...e[t]},s=Math.ceil(n/e.length);0===t&&(a=Zd(i.m).add(r*s,"years").diff(Zd(i.m),"days"));const l=Zd(i.m).add(a,"days").format("YYYY-MM-DD");i.m=l,i.v=ip(l)[2],o.push(i)}}else(n===yh.TOP||n===yh.LEFT)&&e.reverse(),o=i.FillCopy(e,t)}else if("8"===r)if(1===e.length){let r=0;n===yh.BOTTOM||n===yh.RIGHT?r=1:(n===yh.TOP||n===yh.LEFT)&&(r=-1),o=i.FillChnNumber(e,t,r)}else{const r=[];for(let t=0;t<e.length;t++)r.push(i.ChineseToNumber(e[t].m));if((n===yh.TOP||n===yh.LEFT)&&(e.reverse(),r.reverse()),i.isEqualDiff(r)){const n=r[1]-r[0];o=i.FillChnNumber(e,t,n)}else o=i.FillCopy(e,t)}return o}static getDataIndex(e,t,n){const r={},a=Math.floor(t/e),i=t%e;let o=0;if(a>0){for(let t=1;t<=a;t++)for(let a=0;a<n.length;a++)r[n[a]+(t-1)*e]=o,o++;for(let t=0;t<n.length&&n[t]<=i;t++)r[n[t]+e*a]=o,o++}else for(let e=0;e<n.length&&n[e]<=i;e++)r[n[e]]=o,o++;return r}static FillCopy(e,t){const n=[];for(let r=1;r<=t;r++){const t={...e[(r-1)%e.length]};n.push(t)}return n}static FillSeries(e,t,n){const r=this,a=[],i=[];for(let t=0;t<e.length;t++)i.push(Number(e[t].v));if(e.length>2&&r.isEqualRatio(i))for(let r=1;r<=t;r++){const t={...e[(r-1)%e.length]};let i;n===yh.BOTTOM||n===yh.RIGHT?i=Number(e[e.length-1].v)*(Number(e[1].v)/Number(e[0].v))**r:(n===yh.TOP||n===yh.LEFT)&&(i=Number(e[0].v)/(Number(e[1].v)/Number(e[0].v))**r),t.v=i,t.m=i,a.push(t)}else{const o=r.getXArr(e.length);for(let s=1;s<=t;s++){const t={...e[(s-1)%e.length]};let l;n===yh.BOTTOM||n===yh.RIGHT?l=r.forecast(e.length+s,i,o):(n===yh.TOP||n===yh.LEFT)&&(l=r.forecast(1-s,i,o)),t.v=l,t.m=l,a.push(t)}}return a}static FillExtendNumber(e,t,n){const r=[],a=/0|([1-9]+[0-9]*)/g;for(let i=1;i<=t;i++){const t={...e[(i-1)%e.length]},o=e[e.length-1].m,s=o.match(a),l=s[s.length-1],c=Math.abs(Number(l)+n*i),u=o.lastIndexOf(l),h=o.substr(0,u)+c.toString()+o.substr(u+l.length);t.v=h,t.m=h,r.push(t)}return r}static FillOnlyFormat(e,t){const n=[];for(let r=1;r<=t;r++){const t={...e[(r-1)%e.length]};delete t.f,delete t.m,delete t.v,n.push(t)}return n}static FillWithoutFormat(e){const t=[];for(let n=0;n<e.length;n++){const r={...e[n]};let a;a=null===r.f?{m:r.v.toString(),v:r.v}:{f:r.f,m:r.v.toString(),v:r.v},t.push(a)}return t}static FillDays(e,t,n){const r=[];for(let a=1;a<=t;a++){const t={...e[(a-1)%e.length]};let i=void t.v;i=Zd(i).add(n*a,"days").format("YYYY-MM-DD"),t.v=ip(i)[2],t.m=(t.fm.f,void t.v),r.push(t)}return r}static FillMonths(e,t,n){const r=[];for(let a=1;a<=t;a++){const t={...e[(a-1)%e.length]};let i=void t.v;i=Zd(i).add(n*a,"months").format("YYYY-MM-DD"),t.v=ip(i)[2],t.m=(t.fm.f,void t.v),r.push(t)}return r}static FillYears(e,t,n){const r=[];for(let a=1;a<=t;a++){const t={...e[(a-1)%e.length]};let i=void t.v;i=Zd(i).add(n*a,"years").format("YYYY-MM-DD"),t.v=ip(i)[2],t.m=(t.fm.t,void t.v),r.push(t)}return r}static FillChnWeek(e,t,n){const r=this,a=[];for(let i=1;i<=t;i++){const t={...e[(i-1)%e.length]};let o;o="日"===e[e.length-1].m?7+n*i:r.ChineseToNumber(e[e.length-1].m)+n*i,o<0&&(o=7*Math.ceil(Math.abs(o)/7)+o);const s=o%7;0===s?(t.m="日",t.v="日"):1===s?(t.m="一",t.v="一"):2===s?(t.m="二",t.v="二"):3===s?(t.m="三",t.v="三"):4===s?(t.m="四",t.v="四"):5===s?(t.m="五",t.v="五"):6===s&&(t.m="六",t.v="六"),a.push(t)}return a}static FillChnWeek2(e,t,n){const r=this,a=[];for(let i=1;i<=t;i++){const t={...e[(i-1)%e.length]};let o;if("周日"===e[e.length-1].m)o=7+n*i;else{const t=e[e.length-1].m,a=t.substr(t.length-1,1);o=r.ChineseToNumber(a)+n*i}o<0&&(o=7*Math.ceil(Math.abs(o)/7)+o);const s=o%7;0===s?(t.m="周日",t.v="周日"):1===s?(t.m="周一",t.v="周一"):2===s?(t.m="周二",t.v="周二"):3===s?(t.m="周三",t.v="周三"):4===s?(t.m="周四",t.v="周四"):5===s?(t.m="周五",t.v="周五"):6===s&&(t.m="周六",t.v="周六"),a.push(t)}return a}static FillChnWeek3(e,t,n){const r=this,a=[];for(let i=1;i<=t;i++){const t={...e[(i-1)%e.length]};let o;if("星期日"===e[e.length-1].m)o=7+n*i;else{const t=e[e.length-1].m,a=t.substr(t.length-1,1);o=r.ChineseToNumber(a)+n*i}o<0&&(o=7*Math.ceil(Math.abs(o)/7)+o);const s=o%7;0===s?(t.m="星期日",t.v="星期日"):1===s?(t.m="星期一",t.v="星期一"):2===s?(t.m="星期二",t.v="星期二"):3===s?(t.m="星期三",t.v="星期三"):4===s?(t.m="星期四",t.v="星期四"):5===s?(t.m="星期五",t.v="星期五"):6===s&&(t.m="星期六",t.v="星期六"),a.push(t)}return a}static FillChnNumber(e,t,n){const r=this,a=[];for(let i=1;i<=t;i++){const t={...e[(i-1)%e.length]},o=r.ChineseToNumber(e[e.length-1].m)+n*i;let s;s=o<=0?"零":r.NumberToChinese(o),t.v=s,t.m=s.toString(),a.push(t)}return a}static isEqualDiff(e){let t=!0;const n=e[1]-e[0];for(let r=1;r<e.length;r++)if(e[r]-e[r-1]!==n){t=!1;break}return t}static isChnNumber(e){const t=this;let n=!0;if(1===e.length)n="日"===e||e in t.chnNumChar;else{const r=e.split("");for(let e=0;e<r.length;e++)if(!(r[e]in t.chnNumChar)&&!(r[e]in t.chnNameValue)){n=!1;break}}return n}static isExtendNumber(e){const t=/0|([1-9]+[0-9]*)/g,n=t.test(e);if(n){const r=e.match(t),a=r[r.length-1],i=e.lastIndexOf(a),o=e.substr(0,i),s=e.substr(i+a.length);return[n,Number(a),o,s]}return[n]}static isChnWeek1(e){let t;return t=1===e.length&&("日"===e||this.ChineseToNumber(e)<7),t}static isChnWeek2(e){let t;return t=2===e.length&&("周一"===e||"周二"===e||"周三"===e||"周四"===e||"周五"===e||"周六"===e||"周日"===e),t}static isChnWeek3(e){let t;return t=3===e.length&&("星期一"===e||"星期二"===e||"星期三"===e||"星期四"===e||"星期五"===e||"星期六"===e||"星期日"===e),t}static isEqualRatio(e){let t=!0;const n=e[1]/e[0];for(let r=1;r<e.length;r++)if(e[r]/e[r-1]!==n){t=!1;break}return t}static getXArr(e){const t=[];for(let n=1;n<=e;n++)t.push(n);return t}static forecast(e,t,n){function r(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}const a=r(n),i=r(t);let o,s=0,l=0;for(let e=0;e<n.length;e++)s+=(n[e]-a)*(t[e]-i),l+=(n[e]-a)*(n[e]-a);o=0===l?1:s/l;const c=i-o*a;return Math.round(1e5*(c+o*e))/1e5}static judgeDate(e){let t=!0,n=!0,r=!0,a=!0,i=!0;const o=Zd(e[0].m).date(),s=Zd(e[0].m).month(),l=Zd(e[1].m).diff(Zd(e[0].m),"days"),c=Zd(e[1].m).diff(Zd(e[0].m),"months"),u=Zd(e[1].m).diff(Zd(e[0].m),"years");for(let h=1;h<e.length;h++)Zd(e[h].m).date()!==o&&(t=!1),Zd(e[h].m).month()!==s&&(n=!1),Zd(e[h].m).diff(Zd(e[h-1].m),"days")!==l&&(r=!1),Zd(e[h].m).diff(Zd(e[h-1].m),"months")!==c&&(a=!1),Zd(e[h].m).diff(Zd(e[h-1].m),"years")!==u&&(i=!1);return 0===l&&(r=!1),0===c&&(a=!1),0===u&&(i=!1),[t,n,r,a,i]}}Zu(sp,"applyType"),Zu(sp,"direction"),Zu(sp,"chnNumChar"),Zu(sp,"chnNameValue"),Zu(sp,"chnNumChar2"),Zu(sp,"chnUnitChar"),Zu(sp,"chnUnitSection");let lp=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),"");class cp{constructor(e,t){Zu(this,"_rangeListId"),Zu(this,"_commandManager"),Zu(this,"_workbook"),Zu(this,"_context"),Zu(this,"_worksheet"),Zu(this,"_rangeList"),this._context=e.getContext(),this._workbook=this._context.getWorkBook(),this._commandManager=this._context.getCommandManager(),this._worksheet=e,this._rangeList=[],t.forEach((e=>{this._rangeList.push(this._context.getWorkBook().transformRangeType(e).rangeData)})),-1===this._rangeList[0].startRow&&console.error("Invalid range,default set startRow -1")}getRangeList(){return this._rangeList}activate(){return-1===this._rangeList[0].startRow?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this._rangeList}),this)}setValue(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:a}=this;const i=t.map((t=>{let{startRow:n,startColumn:r,endRow:i,endColumn:o}=t,s=new sh;for(let t=n;t<=i;t++)for(let t=r;t<=o;t++)s.setValue(n,r,{m:`${e}`,v:e});return{sheetId:a.getSheetId(),actionName:Fh.SET_RANGE_DATA_ACTION,cellValue:s.getData(),rangeData:t}}));let o=new Np(n.getWorkBook(),...i);return r.invoke(o),this}clear(...e){const{_context:t,_worksheet:n,_commandManager:r,_rangeList:a}=this;let i={formatOnly:!0,contentsOnly:!0,commentsOnly:!0,validationsOnly:!0,skipFilteredRows:!0};Xd.checkup(e,Xd.OBJECT_TYPE)&&(i=e[0]);const o=a.map((e=>({sheetId:n.getSheetId(),actionName:Fh.CLEAR_RANGE_ACTION,options:i,rangeData:e})));let s=new Np(t.getWorkBook(),...o);return r.invoke(s),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}clearNote(){return this.clear({commentsOnly:!0})}_setStyle(e,t){let{_rangeList:n,_context:r,_commandManager:a,_worksheet:i}=this;const o=n.map((n=>{let{startRow:r,startColumn:a,endRow:o,endColumn:s}=n;const l={[t]:e},c=hh.fillObjectMatrix(o-r+1,s-a+1,l);return{sheetId:i.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:c,rangeData:n}}));let s=new Np(r.getWorkBook(),...o);return a.invoke(s),this}setBackground(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:a}=this;const i=t.map((t=>{let{startRow:n,startColumn:r,endRow:i,endColumn:o}=t;const s={bg:{rgb:e}},l=hh.fillObjectMatrix(i-n+1,o-r+1,s);return{sheetId:a.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:l,rangeData:t}}));let o=new Np(n.getWorkBook(),...i);return r.invoke(o),this}setBackgroundRGB(e,t,n){const r=`RGB(${e},${t},${n})`;let{_rangeList:a,_context:i,_commandManager:o,_worksheet:s}=this;const l=a.map((e=>{let{startRow:t,startColumn:n,endRow:a,endColumn:i}=e;const o={bg:{rgb:r}},l=hh.fillObjectMatrix(a-t+1,i-n+1,o);return{sheetId:s.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:l,rangeData:e}}));let c=new Np(i.getWorkBook(),...l);return o.invoke(c),this}setFontColor(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:a}=this;const i=t.map((t=>{let{startRow:n,startColumn:r,endRow:i,endColumn:o}=t;const s={cl:{rgb:e}},l=hh.fillObjectMatrix(i-n+1,o-r+1,s);return{sheetId:a.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:l,rangeData:t}}));let o=new Np(n.getWorkBook(),...i);return r.invoke(o),this}setFontFamily(e){return this._setStyle(e,"ff")}setUnderline(e){const t={s:e?Sh.TRUE:Sh.FALSE};return this._setStyle(t,"ul")}setOverline(e){const t={s:e?Sh.TRUE:Sh.FALSE};return this._setStyle(t,"ol")}setStrikeThrough(e){const t={s:e?Sh.TRUE:Sh.FALSE};return this._setStyle(t,"st")}setFontSize(e){return this._setStyle(e,"fs")}setFontStyle(e){const t=e?Sh.TRUE:Sh.FALSE;return this._setStyle(t,"it")}setFontWeight(e){const t=e?Sh.TRUE:Sh.FALSE;return this._setStyle(t,"bl")}setFormula(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:a}=this;const i=t.map((t=>{let{startRow:n,startColumn:r,endRow:i,endColumn:o}=t,s=new sh;for(let t=n;t<=i;t++)for(let n=r;n<=o;n++)s.setValue(t,n,e);return{sheetId:a.getSheetId(),actionName:Fh.SET_RANGE_FORMULA_ACTION,cellFormula:s.getData(),rangeData:t}}));let o=new Np(n.getWorkBook(),...i);return r.invoke(o),this}setHorizontalAlignment(e){return this._setStyle(e,"ht")}setTextDirection(e){return this._setStyle(e,"td")}setTextRotation(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:a}=this;const i=t.map((t=>{let{startRow:n,startColumn:r,endRow:i,endColumn:o}=t;const s={tr:{v:0,a:Number(e)}},l=hh.fillObjectMatrix(i-n+1,o-r+1,s);return{sheetId:a.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:l,rangeData:t}}));let o=new Np(n.getWorkBook(),...i);return r.invoke(o),this}setVerticalAlignment(e){return this._setStyle(e,"vt"),this}setVerticalText(e){let{_rangeList:t,_context:n,_commandManager:r,_worksheet:a}=this;const i=t.map((t=>{let{startRow:n,startColumn:r,endRow:i,endColumn:o}=t;const s={tr:{v:e,a:0}},l=hh.fillObjectMatrix(i-n+1,o-r+1,s);return{sheetId:a.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:l,rangeData:t}}));let o=new Np(n.getWorkBook(),...i);return r.invoke(o),this}setWrap(e){return this._setStyle(e,"tb")}setWrapStrategy(e){return this._setStyle(e,"tb")}trimWhitespace(){let{_rangeList:e,_context:t,_commandManager:n,_worksheet:r}=this;const a=e.map((e=>{let{startRow:t,startColumn:n,endRow:a,endColumn:i}=e;const o=this._worksheet.getCellMatrix(),s=/\s+/g;let l=new sh;for(let e=t;e<a+1;e++)for(let t=n;t<i+1;t++){const n=o.getValue(e,t).m.replace(s,"");l.setValue(e,t,n||"")}return{sheetId:r.getSheetId(),actionName:Fh.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:l.getData(),rangeData:e}}));let i=new Np(t.getWorkBook(),...a);return n.invoke(i),this}}class up{constructor(e,t){Zu(this,"_rowData"),Zu(this,"_workSheet"),this._workSheet=e,this._rowData=new ih(t)}getRowData(){return this._rowData}getRowDatas(e,t){const n=new ih;for(let r=e;r<e+t;r++){const e=this.getRowOrCreate(r);n.push(e)}return n}getRowHeight(...e){const{_workSheet:t}=this,{_rowData:n}=this,r=t.getConfig();let a=0;if(1===e.length)a=n.obtain(e[0],{hd:Sh.FALSE,h:r.defaultRowHeight}).h;else if(2===e.length)for(let t=e[0];t<e[0]+e[1];t++){a+=n.obtain(t,{hd:Sh.FALSE,h:r.defaultRowHeight}).h}return a}setRowHeight(e,t){const n=this._workSheet.getContext(),r=this._workSheet.getCommandManager(),a={sheetId:this._workSheet.getSheetId(),actionName:Fh.SET_ROW_HEIGHT_ACTION,rowIndex:e,rowHeight:t},i=new Np(n.getWorkBook(),a);r.invoke(i)}getRow(e){const{_rowData:t}=this;return t.get(e)}getSize(){return this._rowData.getLength()}getRowOrCreate(e){const{_workSheet:t}=this,{_rowData:n}=this,r=n.get(e);if(r)return r;const a=t.getConfig(),i={hd:Sh.FALSE,h:a.defaultRowHeight};return n.set(e,i),i}}class hp{constructor(...e){var t;if(Zu(this,"_commandManager"),Zu(this,"_selection"),Zu(this,"_context"),Zu(this,"_workbook"),Zu(this,"_config"),Zu(this,"_initialized"),Zu(this,"_merges"),Zu(this,"_sheetId"),Zu(this,"_cellData"),Zu(this,"_rowManager"),Zu(this,"_columnManager"),hh.hasLength(e,1)){e=[e[0],hh.commonExtend({},qh)]}if(hh.hasLength(e,2)){this._context=e[0],this._config=hh.commonExtend(qh,e[1]);const{columnData:n,rowData:r,cellData:a}=this._config;this._sheetId=null!=(t=this._config.id)?t:lp(6),this._initialized=!1,this._cellData=new sh(a),this._workbook=this._context.getWorkBook(),this._commandManager=this._context.getCommandManager(),this._rowManager=new up(this,r),this._columnManager=new Gh(this,n),this._initialize()}}_initialize(){this._merges=new $d(this,this._config.mergeData)}getCellMatrix(){return this._cellData}activate(){if(this._config.status===Sh.TRUE)return this;const{_context:e,_commandManager:t}=this,n=e.getContextObserver("onBeforeChangeActiveSheetObservable"),r=e.getContextObserver("onAfterChangeActiveSheetObservable"),a={sheetId:this._sheetId,actionName:Fh.SET_WORKSHEET_ACTIVATE_ACTION,status:Sh.TRUE},i=new Np(e.getWorkBook(),a);return n.notifyObservers({sheet:this}),t.invoke(i),r.notifyObservers({sheet:this}),this}setConfig(e){return this._config=hh.commonExtend(qh,e),this}getRowManager(){return this._rowManager}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}setName(e){const{_context:t,_commandManager:n,_sheetId:r}=this,a=t.getContextObserver("onBeforeChangeSheetNameObservable"),i=t.getContextObserver("onAfterChangeSheetNameObservable"),o={actionName:Fh.SET_WORKSHEET_NAME_ACTION,sheetName:e,sheetId:r},s=t.getWorkBook().getSheets();for(let t=0;t<s.length;t++){const n=s[t];if(n!==this&&n.getName()===e)return console.warn("Duplicate name"),this}a.notifyObservers();const l=new Np(t.getWorkBook(),o);return n.invoke(l),i.notifyObservers({name:e,sheet:this}),this}getName(){return this._config.name}clone(){const{_config:e,_context:t}=this,n=hh.deepClone(e);return new hp(t,n)}getContext(){return this._context}getMerges(){return this._merges}getCommandManager(){return this._commandManager}getSheetData(){return[]}getRange(...e){return hh.hasLength(e,1)?new dp(this,e[0]):hh.hasLength(e,2)?new dp(this,{row:[e[0],e[0]],column:[e[1],e[1]]}):hh.hasLength(e,3)?new dp(this,{row:[e[0],e[2]],column:[e[1],e[1]]}):hh.hasLength(e,4)?new dp(this,{row:[e[0],e[2]],column:[e[1],e[3]]}):void 0}getRangeList(e){return new cp(this,e)}getStatus(){const{_config:e}=this;return e.status}setStatus(e){const{_context:t,_commandManager:n,_sheetId:r}=this,a={actionName:Fh.SET_WORKSHEET_STATUS_ACTION,sheetId:r,sheetStatus:e},i=new Np(t.getWorkBook(),a);return n.invoke(i),this}getZoomRatio(){return this._config.zoomRatio||1}setZoomRatio(e){const{_context:t,_sheetId:n,_commandManager:r}=this,a={actionName:Fh.SET_ZOOM_RATIO_ACTION,sheetId:n,zoom:e},i=new Np(t.getWorkBook(),a);r.invoke(i),t.getContextObserver("onZoomRatioSheetObservable").notifyObservers({zoomRatio:e})}getSelection(){return this._selection}copy(e){const{_config:t,_context:n}=this,r=hh.deepClone(t);return r.name=e,r.status=Sh.FALSE,r.id=lp(),new hp(n,r)}getConfig(){return this._config.mergeData=this._merges.getMergeData(),this._config}insertRows(...e){let t=0,n=1;hh.hasLength(e,1)&&(t=e[0]),hh.hasLength(e,2)&&(t=e[0],n=e[1]);const{_context:r,_commandManager:a,_sheetId:i}=this,o={actionName:Fh.INSERT_ROW_DATA_ACTION,sheetId:i,rowIndex:t,rowData:new sh(new ih(n)).toJSON()},s={actionName:Fh.INSERT_ROW_ACTION,sheetId:i,rowIndex:t,rowCount:n},l=new Np(r.getWorkBook(),o,s);return a.invoke(l),this}insertRowAfter(...e){let t=0,n=1;hh.hasLength(e,1)&&(t=e[0]+1),hh.hasLength(e,2)&&(t=e[0]+1,n=e[1]);const{_context:r,_commandManager:a,_sheetId:i}=this,o={actionName:Fh.INSERT_ROW_DATA_ACTION,sheetId:i,rowIndex:t,rowData:new sh(new ih(n)).toJSON()},s={actionName:Fh.INSERT_ROW_ACTION,sheetId:i,rowIndex:t,rowCount:n},l=new Np(r.getWorkBook(),o,s);return a.invoke(l),this}insertRowBefore(...e){let t=0,n=1;hh.hasLength(e,1)&&(t=e[0]-1),hh.hasLength(e,2)&&(t=e[0]-1,n=e[1]),t<0&&(t=0);const{_context:r,_commandManager:a,_sheetId:i}=this,o={actionName:Fh.INSERT_ROW_DATA_ACTION,sheetId:i,rowIndex:t,rowData:new sh(new ih(n)).toJSON()},s={actionName:Fh.INSERT_ROW_ACTION,sheetId:i,rowIndex:t,rowCount:n},l=new Np(r.getWorkBook(),o,s);return a.invoke(l),this}insertColumns(...e){let t=0,n=1;hh.hasLength(e,1)&&(t=e[0]),hh.hasLength(e,2)&&(t=e[0],n=e[1]);const{_context:r,_commandManager:a,_sheetId:i}=this,o=new sh;this._cellData.forEach((e=>{for(let r=t;r<t+n;r++)o.setValue(e,r-t,{})}));const s={actionName:Fh.INSERT_COLUMN_DATA_ACTION,sheetId:i,columnIndex:t,columnData:o.toJSON()},l={actionName:Fh.INSERT_COLUMN_ACTION,sheetId:i,columnIndex:t,columnCount:n},c=new Np(r.getWorkBook(),l,s);return a.invoke(c),this}insertColumnBefore(...e){let t=0,n=1;hh.hasLength(e,1)&&(t=e[0]-1),hh.hasLength(e,2)&&(t=e[0]-1,n=e[1]),t<0&&(t=0);const{_context:r,_commandManager:a,_sheetId:i}=this,o=new sh;this._cellData.forEach((e=>{for(let r=t;r<t+n;r++)o.setValue(e,r-t,{})}));const s={actionName:Fh.INSERT_COLUMN_DATA_ACTION,sheetId:i,columnIndex:t,columnData:o.toJSON()},l={actionName:Fh.INSERT_COLUMN_ACTION,sheetId:i,columnIndex:t,columnCount:n},c=new Np(r.getWorkBook(),l,s);return a.invoke(c),this}insertColumnAfter(...e){let t=0,n=1;hh.hasLength(e,1)&&(t=e[0]+1),hh.hasLength(e,2)&&(t=e[0]+1,n=e[1]);const{_context:r,_commandManager:a,_sheetId:i}=this,o=new sh;this._cellData.forEach((e=>{for(let r=t;r<t+n;r++)o.setValue(e,r-t,{})}));const s={actionName:Fh.INSERT_COLUMN_DATA_ACTION,sheetId:i,columnIndex:t,columnData:o.toJSON()},l={actionName:Fh.INSERT_COLUMN_ACTION,sheetId:i,columnIndex:t,columnCount:n},c=new Np(r.getWorkBook(),s,l);return a.invoke(c),this}clear(...e){const{_context:t,_commandManager:n}=this,r={startRow:0,endRow:this.getConfig().rowCount-1,startColumn:0,endColumn:this.getConfig().columnCount-1};let a={formatOnly:!0,contentsOnly:!0};Xd.checkup(e,Xd.OBJECT_TYPE)&&(a=e[0]);const i={sheetId:this._sheetId,actionName:Fh.CLEAR_RANGE_ACTION,options:a,rangeData:r},o=new Np(t.getWorkBook(),i);return n.invoke(o),this}setTabColor(e){const{_context:t,_commandManager:n}=this,r=t.getContextObserver("onSheetTabColorChangeObservable"),a={sheetId:this._sheetId,actionName:Fh.SET_TAB_COLOR_ACTION,color:e},i=new Np(t.getWorkBook(),a);return n.invoke(i),r.notifyObservers(),this}hideSheet(){const{_context:e,_workbook:t,_commandManager:n}=this;if(!this._config.hidden){const r=e.getContextObserver("onHideSheetObservable"),a={sheetId:this._sheetId,actionName:Fh.HIDE_SHEET_ACTION,hidden:Sh.TRUE},i=new Np(t,a);if(n.invoke(i),this.getStatus()===Sh.TRUE){const e=t.getSheetIndex(this),n=t.nextSheet(e);n&&n.activate()}r.notifyObservers({sheet:this})}return this}showSheet(){if(!this._config.hidden)return this;const{_context:e,_commandManager:t}=this,n={sheetId:this._sheetId,actionName:Fh.HIDE_SHEET_ACTION,hidden:Sh.FALSE},r=new Np(e.getWorkBook(),n);return t.invoke(r),e.getContextObserver("onShowSheetObservable").notifyObservers({sheet:this}),this}setCommandManager(e){return this._commandManager=e,this}setActiveSelection(...e){const t=e[0];return t?this._selection.setSelection({selection:t}):this._selection.setSelection()}getFrozenRows(){return this._config.freezeRow}getFrozenColumns(){return this._config.freezeColumn}getMaxColumns(){const{_config:e}=this,{columnCount:t}=e;return t}getMaxRows(){const{_config:e}=this,{rowCount:t}=e;return t}getType(){const{_config:e}=this,{type:t}=e;return t}clearContents(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({contentsOnly:!0}),this}clearFormats(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({formatOnly:!0}),this}clearNotes(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({commentsOnly:!0}),this}deleteColumn(e){const{_context:t,_commandManager:n,_sheetId:r}=this,a={actionName:Fh.REMOVE_COLUMN_DATA_ACTION,sheetId:r,columnCount:1,columnIndex:e},i={actionName:Fh.REMOVE_COLUMN_ACTION,sheetId:r,columnCount:1,columnIndex:e},o=new Np(t.getWorkBook(),a,i);return n.invoke(o),this}deleteColumns(e,t){const{_context:n,_commandManager:r,_sheetId:a}=this,i={actionName:Fh.REMOVE_COLUMN_DATA_ACTION,sheetId:a,columnCount:t,columnIndex:e},o={actionName:Fh.REMOVE_COLUMN_ACTION,sheetId:a,columnCount:t,columnIndex:e},s=new Np(n.getWorkBook(),i,o);return r.invoke(s),this}deleteRow(e){const{_context:t,_commandManager:n,_sheetId:r}=this,a={actionName:Fh.REMOVE_ROW_DATA_ACTION,sheetId:r,rowCount:1,rowIndex:e},i={actionName:Fh.REMOVE_ROW_ACTION,sheetId:r,rowCount:1,rowIndex:e},o=new Np(t.getWorkBook(),a,i);return n.invoke(o),this}deleteRows(e,t){const{_context:n,_commandManager:r,_sheetId:a}=this,i={actionName:Fh.REMOVE_ROW_DATA_ACTION,sheetId:a,rowCount:t,rowIndex:e},o={actionName:Fh.REMOVE_ROW_ACTION,sheetId:a,rowCount:t,rowIndex:e},s=new Np(n.getWorkBook(),i,o);return r.invoke(s),this}getRowCount(){return this._config.rowCount}getColumnCount(){return this._config.columnCount}setBorderStyle(e,t,n){const{_commandManager:r,_sheetId:a}=this,i=this.getContext(),o=this.getCellMatrix(),s=i.getWorkBook(),l=s.getStyles(),c=this.getRange({startRow:e.startRow-1,startColumn:e.startColumn,endRow:e.startRow-1,endColumn:e.endColumn}),u=this.getRange({startRow:e.startRow,startColumn:e.startColumn-1,endRow:e.startRow,endColumn:e.endColumn-1}),h=this.getRange({startRow:e.endRow+1,startColumn:e.startColumn,endRow:e.endRow+1,endColumn:e.endColumn}),d=this.getRange({startRow:e.startRow,startColumn:e.endColumn+1,endRow:e.startRow,endColumn:e.endColumn+1}),p=this.getRange(e),m=new sh,_=new sh,g=new sh,f=new sh,y=new sh;c.forEach(((e,t)=>{const n=o.getValue(e,t);if(n){const r=l.get(n.s);if(r){const n=hh.deepClone(r);n.bd&&delete n.bd.b,m.setValue(e,t,n)}}})),h.forEach(((e,t)=>{const n=o.getValue(e,t);if(n){const r=l.get(n.s);if(r){const n=hh.deepClone(r);n.bd&&delete n.bd.t,g.setValue(e,t,n)}}})),u.forEach(((e,t)=>{const n=o.getValue(e,t);if(n){const r=l.get(n.s);if(r){const n=hh.deepClone(r);n.bd&&delete n.bd.r,_.setValue(e,t,n)}}})),d.forEach(((e,t)=>{const n=o.getValue(e,t);if(n){const r=l.get(n.s);if(r){const n=hh.deepClone(r);n.bd&&delete n.bd.l,f.setValue(e,t,n)}}})),p.forEach(((e,n)=>{y.setValue(e,n,t)}));const v=[];if(n.includes(yh.TOP)){const e={sheetId:a,actionName:Fh.SET_BORDER_ACTION,styles:g.toJSON()};v.push(e)}if(n.includes(yh.BOTTOM)){const e={sheetId:a,actionName:Fh.SET_BORDER_ACTION,styles:m.toJSON()};v.push(e)}if(n.includes(yh.LEFT)){const e={sheetId:a,actionName:Fh.SET_BORDER_ACTION,styles:f.toJSON()};v.push(e)}if(n.includes(yh.RIGHT)){const e={sheetId:a,actionName:Fh.SET_BORDER_ACTION,styles:_.toJSON()};v.push(e)}const b={sheetId:a,actionName:Fh.SET_BORDER_ACTION,styles:y.toJSON()};v.push(b);const x=new Np(s,...v);return r.invoke(x),this}setCurrentCell(e){return e.activateAsCurrentCell()}getActiveCell(){return this.getSelection().getCurrentCell()}getActiveRange(){return this.getSelection().getActiveRange()}getActiveRangeList(){return this.getSelection().getActiveRangeList()}getIndex(){const e=this._context.getWorkBook().getSheets().findIndex((e=>e&&e.getSheetId()===this._sheetId));return e>-1?e+1:null}getParent(){return this._context.getWorkBook()}isSheetHidden(){return this._config.hidden}setActiveRange(e){return this.getSelection().setSelection(e)}setActiveRangeList(e){const t=this.getSelection();return t.setSelection(e),t.getActiveRangeList()}hideRow(e){const t=e.getRangeData(),n=t.startRow,r=t.endRow-t.startRow+1,{_context:a,_commandManager:i,_sheetId:o}=this,s={actionName:Fh.SET_HIDE_ROW_ACTION,sheetId:o,rowCount:r,rowIndex:n},l=new Np(a.getWorkBook(),s);return i.invoke(l),this}hideRows(...e){const t=--e[0];let n=1;e[1]&&(n=e[1]);const{_context:r,_commandManager:a,_sheetId:i}=this,o={actionName:Fh.SET_HIDE_ROW_ACTION,sheetId:i,rowCount:n,rowIndex:t},s=new Np(r.getWorkBook(),o);return a.invoke(s),this}hideColumn(e){const t=e.getRangeData(),n=t.startColumn,r=t.endColumn-t.startColumn+1,{_context:a,_commandManager:i,_sheetId:o}=this,s={actionName:Fh.SET_HIDE_COLUMN_ACTION,sheetId:o,columnCount:r,columnIndex:n},l=new Np(a.getWorkBook(),s);return i.invoke(l),this}hideColumns(...e){const t=e[0];let n=1;e[1]&&(n=e[1]);const{_context:r,_commandManager:a,_sheetId:i}=this,o={actionName:Fh.SET_HIDE_COLUMN_ACTION,sheetId:i,columnCount:n,columnIndex:t},s=new Np(r.getWorkBook(),o);return a.invoke(s),this}unhideRow(e){const t=e.getRangeData(),n=t.startRow,r=t.endRow-t.startRow+1,{_context:a,_commandManager:i,_sheetId:o}=this,s={actionName:Fh.SET_SHOW_ROW_ACTION,sheetId:o,rowCount:r,rowIndex:n},l=new Np(a.getWorkBook(),s);return i.invoke(l),this}unhideColumn(e){const t=e.getRangeData(),n=t.startColumn,r=t.endColumn-t.startColumn+1,{_context:a,_commandManager:i,_sheetId:o}=this,s={actionName:Fh.SET_SHOW_COLUMN_ACTION,sheetId:o,columnCount:r,columnIndex:n},l=new Np(a.getWorkBook(),s);return i.invoke(l),this}showColumns(...e){const t=e[0];let n=1;e[1]&&(n=e[1]);const{_context:r,_commandManager:a,_sheetId:i}=this,o={actionName:Fh.SET_SHOW_COLUMN_ACTION,sheetId:i,columnCount:n,columnIndex:t},s=new Np(r.getWorkBook(),o);return a.invoke(s),this}showRows(...e){const t=--e[0];let n=1;e[1]&&(n=e[1]);const{_context:r,_commandManager:a,_sheetId:i}=this,o={actionName:Fh.SET_SHOW_ROW_ACTION,sheetId:i,rowCount:n,rowIndex:t},s=new Np(r.getWorkBook(),o);return a.invoke(s),this}hasHiddenGridlines(){const{_config:e}=this,{showGridlines:t}=e;return 0===t}getTabColor(){const{_config:e}=this,{tabColor:t}=e;return t}getColumnWidth(e){return this.getColumnManager().getColumnWidth(e)}getRowHeight(e){return this.getRowManager().getRowHeight(e)}setColumnWidth(...e){let t,n=[];if(hh.hasLength(e,2)&&(t=e[0],n=[e[1]]),hh.hasLength(e,3)){t=e[0];for(let t=0;t<e[1];t++)n.push(e[2])}return this.getColumnManager().setColumnWidth(t,n),this}setRowHeights(e,t,n){const r=[];for(let e=0;e<t;e++)r.push(n);return this.getRowManager().setRowHeight(e,r),this}setRowHeight(e,t){const n=[t];return this.getRowManager().setRowHeight(e,n),this}setHiddenGridlines(e){const{_context:t,_commandManager:n,_sheetId:r}=this,a={actionName:Fh.SET_HIDDEN_GRIDLINES_ACTION,hideGridlines:e,sheetId:r},i=new Np(t.getWorkBook(),a);return n.invoke(i),this}isRightToLeft(){const{_config:e}=this,{rightToLeft:t}=e;return t}setRightToLeft(e){const{_context:t,_commandManager:n,_sheetId:r}=this,a={actionName:Fh.SET_RIGHT_TO_LEFT_ACTION,rightToLeft:e,sheetId:r},i=new Np(t.getWorkBook(),a);return n.invoke(i),this}getPluginMeta(e){return this._config.pluginMeta[e]}setPluginMeta(e,t){this._config.pluginMeta[e]=t}copyTo(e){const t=this._context.getWorkBook().getSheets()[e];if(!t)return this;const n=hh.deepClone(this._config);return n.sheetId=t.getConfig().id,t.setConfig(n),t}getLastRow(){return this._cellData.getLength()}getLastColumn(){return this._cellData.getRange().endColumn}getSheetValues(e,t,n,r){return new dp(this,{startRow:e,startColumn:t,endRow:e+n-1,endColumn:t+r-1}).getValues()}getDataRange(){return new dp(this,this._cellData.getRange())}moveRows(e,t){const{startRow:n}=e.getRangeData(),{endRow:r}=e.getRangeData(),a=this._cellData.spliceRows(n,r-n+1);return this._cellData.insertRows(t,a),this}moveColumns(e,t){const n=e.getRangeData().startColumn,r=e.getRangeData().endColumn,a=this._cellData.spliceColumns(n,r-n+1);return this._cellData.insertColumns(t,a),this}}class dp{constructor(e,t){Zu(this,"_commandManager"),Zu(this,"_context"),Zu(this,"_rangeData"),Zu(this,"_worksheet"),this._context=e.getContext(),this._commandManager=this._context.getCommandManager(),this._rangeData=this._context.getWorkBook().transformRangeType(t).rangeData,this._worksheet=e,Object.values(this._rangeData).includes(-1)&&console.error("Invalid range,default set index -1")}static foreach(e,t){const{startRow:n,startColumn:r,endRow:a,endColumn:i}=e;for(let e=n;e<=a;e++)for(let n=r;n<=i;n++)t(e,n)}getRangeData(){return this._rangeData}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData,a=[];for(let i=e;i<=t;i++){const e=[];for(let t=n;t<=r;t++)e.push(this.getMatrix().getValue(i,t)||null);a.push(e)}return a}getMatrix(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData,a=this._worksheet.getCellMatrix(),i=new sh;for(let o=e;o<=t;o++)for(let e=n;e<=r;e++)i.setValue(o,e,a.getValue(o,e)||null);return i}getMatrixObject(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData,a=this._worksheet.getCellMatrix(),i=new sh;for(let o=e;o<=t;o++)for(let t=n;t<=r;t++)i.setValue(o-e,t-n,a.getValue(o,t)||{});return i}getDisplayValue(){const e=this.getValue();return e&&e.p?e.p:e&&e.m?e.m:""}getDisplayValues(){return this.getValues().map((e=>e.map((e=>e&&e.p?e.p:e&&e.m?e.m:""))))}getA1Notation(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData;let a,i;return n<r?(a=hh.numToWord(n+1)+(e+1),i=hh.numToWord(r+1)+(t+1)):(a=hh.numToWord(r+1)+(t+1),i=hh.numToWord(n+1)+(e+1)),a===i?`${a}`:`${a}:${i}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){return this.getValues().map((e=>e.map((e=>{var t,n,r;const a=this._context.getWorkBook().getStyles();let i=null==(t=Uh.bg)?void 0:t.rgb;return null!=e&&e.s&&(i=null==(r=null==(n=a.get(null==e?void 0:e.s))?void 0:n.bg)?void 0:r.rgb),i}))))}getCell(e,t){const{startRow:n,endRow:r,startColumn:a,endColumn:i}=this._rangeData,o={startRow:n+e,endRow:n+e,startColumn:a+t,endColumn:a+t};return new dp(this._worksheet,o)}getColumn(){return this._rangeData.startColumn}getObjectValue(e={}){return this.getObjectValues(e)[0][0]}getObjectValues(e={}){const{startRow:t,endRow:n,startColumn:r,endColumn:a}=this._rangeData,i=this._worksheet.getCellMatrix().getFragments(t,n,r,a).getData();if(e.isIncludeStyle){const e=this._context.getWorkBook().getStyles();for(let o=0;o<=n-t;o++)for(let t=0;t<=a-r;t++){if(!i[o][t])continue;const n=i[o][t].s;n&&(i[o][t].s=e.get(n))}}return i}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){return this.getValues().map((e=>e.map((e=>{var t,n,r;const a=this._context.getWorkBook().getStyles();return(null==e?void 0:e.s)&&(null==(n=null==(t=a.get(e.s))?void 0:t.cl)?void 0:n.rgb)||(null==(r=Uh.cl)?void 0:r.rgb)}))))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){return this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getStrikeThrough(){return this.getStrikeThroughs()[0][0]}_getStyles(e){return this.getValues().map((t=>t.map((t=>{const n=this._context.getWorkBook().getStyles();return(null==t?void 0:t.s)&&n.get(t.s)[e]||Uh[e]}))))}getFontSize(){return this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getFontStyle(){return this.getFontStyles()[0][0]}getFontStyles(){return this._getStyles("it")}getFontWeight(){return this.getFontWeights()[0][0]}getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_rangeData:e,_worksheet:t}=this,{startRow:n,endRow:r}=e;let a=0;for(let e=0;e<=r-n;e++){a+=t.getRowHeight(e)}return a}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._rangeData.endColumn}getLastRow(){return this._rangeData.endRow}getMergedRanges(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData;return this._worksheet.getMerges().getMergedRanges({startRow:e,endRow:t,startColumn:n,endColumn:r}).map((e=>new dp(this._worksheet,e)))}getNextDataCell(e){const{_worksheet:t}=this,{startRow:n,endRow:r,startColumn:a,endColumn:i}=this._rangeData,o=t.getMaxRows(),s=t.getMaxColumns();if(e===yh.BOTTOM){for(let e=0;e<o-a;e++)this._worksheet.getCellMatrix().getValue(n+e,a)&&t.getRange(n+e,a,n+e,a);return t.getRange(o,a,o,a)}if(e===yh.TOP){for(let e=0;e<n;e++)this._worksheet.getCellMatrix().getValue(n-e,a)&&t.getRange(n-e,a,n-e,n);return t.getRange(0,a,0,a)}if(e===yh.RIGHT){for(let e=0;e<s-a;e++)this._worksheet.getCellMatrix().getValue(n,a+e)&&t.getRange(n,a+e,n,a+e);return t.getRange(n,s,n,s)}if(e===yh.LEFT){for(let e=0;e<o-a;e++)this._worksheet.getCellMatrix().getValue(n,a-e)&&t.getRange(n,a-e,n,a-e);return t.getRange(n,0,n,0)}return t.getRange(Hh)}getNumColumns(){const{startColumn:e,endColumn:t}=this._rangeData;return t-e+1}getNumRows(){const{startRow:e,endRow:t}=this._rangeData;return t-e+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map((e=>e.map((e=>(null==e?void 0:e.p)||""))))}getRowIndex(){return this._rangeData.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){return this.getValues().map((e=>e.map((e=>{const t=this._context.getWorkBook().getStyles();return e&&e.s?t.get(e.s):null}))))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_rangeData:e,_worksheet:t}=this,{startColumn:n,endColumn:r}=e;let a=0;for(let e=0;e<=r-n;e++)a+=t.getColumnWidth(e);return a}getWrap(){return this.getWraps()[0][0]}getWraps(){return this._getStyles("tb")}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}isBlank(){return this.getValues().some((e=>e.some((e=>""===(null==e?void 0:e.m)))))}isPartOfMerge(){const{startRow:e,endRow:t,startColumn:n,endColumn:r}=this._rangeData;return!!this._worksheet.getMerges().getByRowColumn(e,t,n,r)}_setStyle(e,t){const{_context:n,_worksheet:r,_commandManager:a}=this,{startRow:i,endRow:o,startColumn:s,endColumn:l}=this._rangeData,c={[t]:e},u=hh.fillObjectMatrix(o-i+1,l-s+1,c),h={sheetId:r.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new Np(n.getWorkBook(),h);return a.invoke(d),this}_setStyles(e,t){const{_context:n,_worksheet:r,_commandManager:a}=this,{startRow:i,endRow:o,startColumn:s,endColumn:l}=this._rangeData,c=new sh;for(let n=0;n<o-i+1;n++)for(let r=0;r<l-s+1;r++)c.setValue(n,r,{[t]:e[n][r]});const u={sheetId:r.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:c.getData(),rangeData:this._rangeData},h=new Np(n.getWorkBook(),u);return a.invoke(h),this}setBackground(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={bg:{rgb:e}},c=hh.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new Np(t.getWorkBook(),u);return r.invoke(h),this}setBackgrounds(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l=new sh;for(let t=0;t<i-a+1;t++)for(let n=0;n<s-o+1;n++)l.setValue(t,n,{bg:{rgb:e[t][n]}});const c={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},u=new Np(t.getWorkBook(),c);return r.invoke(u),this}setBackgroundRGB(e,t,n){const{_context:r,_worksheet:a,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:l,endColumn:c}=this._rangeData,u={bg:{rgb:`RGB(${e},${t},${n})`}},h=hh.fillObjectMatrix(s-o+1,c-l+1,u),d={sheetId:a.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},p=new Np(r.getWorkBook(),d);return i.invoke(p),this}setFontColors(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l=new sh;for(let t=0;t<i-a+1;t++)for(let n=0;n<s-o+1;n++)l.setValue(t,n,{cl:{rgb:e[t][n]}});const c={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},u=new Np(t.getWorkBook(),c);return r.invoke(u),this}setFontFamilies(e){return this._setStyles(e,"ff"),this}setUnderline(e){return this._setStyle(e,"ul"),this}setOverline(e){return this._setStyle(e,"ol"),this}setStrikeThrough(e){return this._setStyle(e,"st"),this}setUnderlines(e){return this._setStyles(e,"ul"),this}setOverlines(e){return this._setStyles(e,"ol"),this}setStrikeThroughs(e){return this._setStyles(e,"st"),this}setFontSizes(e){return this._setStyles(e,"fs"),this}setFontStyle(e){return this._setStyle(e,"it"),this}setFontStyles(e){return this._setStyles(e,"it"),this}setFontWeight(e){return this._setStyle(e,"bl"),this}setFontWeights(e){return this._setStyles(e,"bl"),this}setFormula(e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:a}=this,{startRow:i,startColumn:o,endRow:s,endColumn:l}=t,c=new sh;for(let t=i;t<=s;t++)for(let n=o;n<=l;n++)c.setValue(t,n,e);const u={sheetId:a.getSheetId(),actionName:Fh.SET_RANGE_FORMULA_ACTION,cellFormula:c.getData(),rangeData:this._rangeData},h=new Np(n.getWorkBook(),u);return r.invoke(h),this}setFormulas(e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:a}=this,{startRow:i,startColumn:o,endRow:s,endColumn:l}=t,c=new sh;for(let t=0;t<=s-i;t++)for(let n=0;n<=l-o;n++)c.setValue(t+i,n+o,e[t][n]);const u={sheetId:a.getSheetId(),actionName:Fh.SET_RANGE_FORMULA_ACTION,cellFormula:c.getData(),rangeData:this._rangeData},h=new Np(n.getWorkBook(),u);return r.invoke(h),this}setHorizontalAlignments(e){return this._setStyles(e,"ht"),this}setTextDirections(e){return this._setStyles(e,"td"),this}setTextRotation(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={tr:{v:0,a:Number(e)}},c=hh.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new Np(t.getWorkBook(),u);return r.invoke(h),this}setTextRotations(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l=new sh;for(let t=0;t<i-a+1;t++)for(let n=0;n<s-o+1;n++)l.setValue(t,n,{tr:{v:0,a:e[t][n]}});l.getData();const c={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},u=new Np(t.getWorkBook(),c);return r.invoke(u),this}setTextStyle(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={...e},c=hh.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new Np(t.getWorkBook(),u);return r.invoke(h),this}setTextStyles(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l=new sh;for(let t=0;t<i-a+1;t++)for(let n=0;n<s-o+1;n++)l.setValue(t,n,{...e[t][n]});const c={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},u=new Np(t.getWorkBook(),c);return r.invoke(u),this}setVerticalAlignments(e){return this._setStyles(e,"vt"),this}setVerticalText(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={tr:{v:e,a:90}},c=hh.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new Np(t.getWorkBook(),u);return r.invoke(h),this}setWrap(e){return this._setStyle(e,"tb"),this}setWrapStrategies(e){return this._setStyles(e,"tb"),this}setWraps(e){return this._setStyles(e,"tb"),this}autoFill(e,t){const{_worksheet:n,_context:r,_commandManager:a}=this,{startRow:i,endRow:o,startColumn:s,endColumn:l}=this._rangeData,{startRow:c,endRow:u,startColumn:h,endColumn:d}=e._rangeData;let p=yh.BOTTOM,m=0,_=0;const g=i,f=o,y=s,v=l,b=c,x=u,w=h,T=d,C=new sh;if(p=w===y&&T===v?x>f?yh.BOTTOM:yh.TOP:T>v?yh.RIGHT:yh.LEFT,p===yh.BOTTOM||p===yh.TOP){m=f-g+1,_=x-b+1;for(let e=0;e<=l-s;e++){const n=this.getColumnMatrix(e).toArray();sp.getCopyData(n,g,f,y,v,p).forEach((n=>{sp.getApplyData(n,m,_,t,p).forEach(((t,n)=>{C.setValue(n,e,t)}))}))}}else if(p===yh.RIGHT||p===yh.LEFT){_=T-w,m=v-y;for(let e=0;e<=o-i;e++){const n=this.getRowMatrix(e).toArray();sp.getCopyData(n,g,f,y,v,p).forEach((e=>{sp.getApplyData(e,m,_,t,p)}))}}const E={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_DATA_ACTION,cellValue:C.getData(),rangeData:e._rangeData},A=new Np(r.getWorkBook(),E);return a.invoke(A),this}getDataRegion(...e){const{startRow:t,endRow:n,startColumn:r,endColumn:a}=this._rangeData;let i,o;const s=this._worksheet.getCellMatrix();if(!hh.isNumber(e[0])){let e=t,n=t;const a=this._worksheet.getRowCount();for(let n=1;n<t;n++)if(!s.getValue(t-n,r)){e=t-n+1;break}const l=0;for(;l<a-t;)if(!s.getValue(t+l,r)){n=t-l-1;break}let c=t,u=t;const h=this._worksheet.getColumnCount();for(let e=1;e<t;e++)if(!s.getValue(t,r-e)){c=t-e+1;break}const d=0;for(;d<h-r;)if(!s.getValue(t,r+d)){u=t-d-1;break}return o=c-u,o=e-n,i=t,this._worksheet.getRange(e,c,i,o)}{const n=e[0];if(n===fh.COLUMNS){let e=t,n=t;const a=this._worksheet.getRowCount();for(let n=1;n<t;n++)if(!s.getValue(t-n,r)){e=t-n+1;break}const l=0;for(;l<a-t;)if(!s.getValue(t+l,r)){n=t-l-1;break}return o=e-n,i=0,this._worksheet.getRange(t,e,i,o)}if(n===fh.ROWS){let e=t,n=t;const a=this._worksheet.getColumnCount();for(let n=1;n<t;n++)if(!s.getValue(t,r-n)){e=t-n+1;break}const l=0;for(;l<a-r;)if(!s.getValue(t,r+l)){n=t-l-1;break}return o=0,i=e-n,this._worksheet.getRange(e,r,i,o)}}return this}trimWhitespace(){var e;const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l=this._worksheet.getCellMatrix(),c=/\s+/g,u=new sh;for(let t=0;t<=i-a;t++)for(let n=0;n<=s-o;n++){const r=null==(e=l.getValue(t,n).m)?void 0:e.replace(c,"");u.setValue(t+a,n+o,r||"")}const h={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:u.getData(),rangeData:this._rangeData},d=new Np(t.getWorkBook(),h);return r.invoke(d),this}activate(){var e;return-1===(null==(e=this._rangeData)?void 0:e.startRow)?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this}),this)}activateAsCurrentCell(){return this._worksheet.getSelection().setCurrentCell(this),this}isIntersection(e){const t=this._rangeData.startRow,n=this._rangeData.endRow,r=this._rangeData.startColumn,a=this._rangeData.endColumn,i=e.getRangeData().startRow,o=e.getRangeData().endRow,s=e.getRangeData().startColumn,l=e.getRangeData().endColumn,c=Math.abs(r+a-s-l),u=Math.abs(r-a)+Math.abs(s-l),h=Math.abs(t+n-i-o),d=Math.abs(t-n)+Math.abs(i-o);return c<=u&&h<=d}setFontColor(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={cl:{rgb:e}},c=hh.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new Np(t.getWorkBook(),u);return r.invoke(h),this}copyTo(...e){const{_context:t,_worksheet:n,_commandManager:r}=this,a=e[0],[i,o]=this._handleCopyRange(this,a),{startRow:s,startColumn:l,endRow:c,endColumn:u}=o;if(Xd.checkup(e,dp,Xd.BOOLEAN_TYPE)){const a=e[1];if(e[2],a===gh.PASTE_NORMAL){const e=new sh;i.forEach(((t,n)=>t.forEach(((t,r)=>{e.setValue(n+s,r+l,t||{})}))));const a={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_DATA_ACTION,cellValue:e.getData(),rangeData:o},c=new Np(t.getWorkBook(),a);r.invoke(c)}else if(a===gh.PASTE_FORMAT){const e=t.getWorkBook().getStyles(),a=new sh;i.map(((t,n)=>t.forEach(((t,r)=>{a.setValue(n,r,t.s?e.get(t.s):{})}))));const s={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:a.getData(),rangeData:o},l=new Np(t.getWorkBook(),s);r.invoke(l)}else if(a===gh.PASTE_VALUES){const e=new sh;i.forEach(((t,n)=>t.forEach(((t,r)=>{e.setValue(n+s,r+l,(null==t?void 0:t.v)||"")}))));const a={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:e.getData(),rangeData:o},c=new Np(t.getWorkBook(),a);r.invoke(c)}else if(a===gh.PASTE_COLUMN_WIDTHS){const e=this._rangeData.startColumn;for(let t=0;t<u-e;t++){const r=n.getColumnWidth(e+t);n.setColumnWidth(e+t,r)}}}else if(Xd.checkup(e,dp,Xd.OBJECT_TYPE)){const a=e[1],c=new sh;i.forEach(((e,t)=>e.forEach(((e,n)=>{c.setValue(t+s,n+l,e||{})}))));const u={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_DATA_ACTION,cellValue:c.getData(),rangeData:o,options:a},h=new Np(t.getWorkBook(),u);r.invoke(h)}else if(Xd.checkup(e,dp)){const e=new sh;i.forEach(((t,n)=>t.forEach(((t,r)=>{e.setValue(n+s,r+l,t||{})}))));const a={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_DATA_ACTION,cellValue:e.getData(),rangeData:o},c=new Np(t.getWorkBook(),a);r.invoke(c)}}copyFormatToRange(...e){const{_context:t,_commandManager:n}=this,r=e[1],a=e[2],i=e[3],o=e[4],s=hh.isAssignableFrom(e[0],hp)?e[0].getSheetId():e[0],[l,c]=this._handleCopyRange(this,{startRow:r,endRow:a,startColumn:i,endColumn:o}),u=t.getWorkBook().getStyles(),h=new sh;l.map(((e,t)=>e.map(((e,n)=>(h.setValue(t,n,e.s?u.get(e.s):{}),e.s?u.get(e.s):{})))));const d={sheetId:s,actionName:Fh.SET_RANGE_STYLE_ACTION,value:h.getData(),rangeData:c},p=new Np(t.getWorkBook(),d);n.invoke(p)}copyValuesToRange(...e){const{_context:t,_commandManager:n}=this,r=e[1],a=e[2],i=e[3],o=e[4],s=hh.isAssignableFrom(e[0],hp)?e[0].getSheetId():e[0],[l,c]=this._handleCopyRange(this,{startRow:r,endRow:a,startColumn:i,endColumn:o}),u=new sh;l.forEach(((e,t)=>e.forEach(((e,n)=>{u.setValue(t+c.startRow,n+c.startColumn,(null==e?void 0:e.v)||"")}))));const h={sheetId:s,actionName:Fh.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:u.getData(),rangeData:c},d=new Np(t.getWorkBook(),h);n.invoke(d)}moveTo(e){const{_context:t,_worksheet:n,_commandManager:r,_rangeData:a}=this,i={sheetId:n.getSheetId(),actionName:Fh.CLEAR_RANGE_ACTION,options:{formatOnly:!0,contentsOnly:!0,commentsOnly:!0,validationsOnly:!0,skipFilteredRows:!0},rangeData:a},o=this.getMatrix(),{startRow:s,endRow:l,startColumn:c,endColumn:u}=this._rangeData,{startRow:h,startColumn:d}=e.getRangeData(),p=new sh;for(let e=s;e<=l;e++)for(let t=c;t<=u;t++)p.setValue(h+(e-s),d+(t-c),o.getValue(e,t)||{});const m={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_DATA_ACTION,cellValue:p.getData(),rangeData:{startRow:h,endRow:h+(l-s),startColumn:d,endColumn:d+(u-c)}},_=new Np(t.getWorkBook(),i,m);r.invoke(_)}offset(...e){const{startRow:t,endRow:n,startColumn:r,endColumn:a}=this._rangeData,i=e[0],o=e[1],s=e[2],l=e[3],c={startRow:t+i,endRow:n+i,startColumn:r+o,endColumn:a+o};return hh.isNumber(s)&&(c.endRow=c.startRow+s-1),hh.isNumber(l)&&(c.endColumn=c.endColumn+l-1),new dp(this._worksheet,c)}setBorder(...e){const t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],o=e[5],s=e[6]?e[6]:"black",l=e[7]?e[7]:ph.DASH_DOT,{_context:c,_worksheet:u,_commandManager:h}=this,d=c.getWorkBook(),p=this._rangeData,m=u.getSheetId(),_={startRow:p.startRow-1,startColumn:p.startColumn,endRow:p.startRow-1,endColumn:p.endColumn},g={startRow:p.startRow,startColumn:p.startColumn-1,endRow:p.endRow,endColumn:p.startColumn-1},f={startRow:p.endRow+1,startColumn:p.startColumn,endRow:p.endRow+1,endColumn:p.endColumn},y={startRow:p.startRow,startColumn:p.endColumn+1,endRow:p.endRow,endColumn:p.endColumn+1},v={startRow:p.startRow,startColumn:p.startColumn,endRow:p.startRow,endColumn:p.endColumn},b={startRow:p.startRow,startColumn:p.startColumn,endRow:p.endRow,endColumn:p.startColumn},x={startRow:p.endRow,startColumn:p.startColumn,endRow:p.endRow,endColumn:p.endColumn},w={startRow:p.startRow,startColumn:p.endColumn,endRow:p.endRow,endColumn:p.endColumn},T=new dp(u,_),C=new dp(u,g),E=new dp(u,f),A=new dp(u,y),S=new dp(u,v),D=new dp(u,b),R=new dp(u,x),N=new dp(u,w),M=new sh,O=new sh,k=new sh,I=new sh,P=new sh,L=[],B={s:l,cl:{rgb:s}};if(!0===t||!1===t){if(T.isValid()){T.forEach(((e,t)=>{M.setValue(e,t,{bd:{b:null}})}));const e={sheetId:m,actionName:Fh.SET_RANGE_STYLE_ACTION,value:M.getArrayData(),rangeData:_};L.push(e)}S.forEach(((e,n)=>{if(!0===t){const t=hh.deepMerge(P.getValue(e,n)||{},{bd:{t:hh.deepClone(B)}});P.setValue(e,n,t)}else if(!1===t){const t=hh.deepMerge(P.getValue(e,n)||{},{bd:{t:null}});P.setValue(e,n,t)}}))}if(!0===r||!1===r){if(E.isValid()){E.forEach(((e,t)=>{k.setValue(e,t,{bd:{t:null}})}));const e={sheetId:m,actionName:Fh.SET_RANGE_STYLE_ACTION,value:k.getArrayData(),rangeData:f};L.push(e)}R.forEach(((e,t)=>{if(!0===r){const n=hh.deepMerge(P.getValue(e,t)||{},{bd:{b:hh.deepClone(B)}});P.setValue(e,t,n)}else if(!1===r){const n=hh.deepMerge(P.getValue(e,t)||{},{bd:{b:null}});P.setValue(e,t,n)}}))}if(!0===n||!1===n){if(C.isValid()){C.forEach(((e,t)=>{O.setValue(e,t,{bd:{r:null}})}));const e={sheetId:m,actionName:Fh.SET_RANGE_STYLE_ACTION,value:O.getArrayData(),rangeData:g};L.push(e)}D.forEach(((e,t)=>{if(!0===n){const n=hh.deepMerge(P.getValue(e,t)||{},{bd:{l:hh.deepClone(B)}});P.setValue(e,t,n)}else if(!1===n){const n=hh.deepMerge(P.getValue(e,t)||{},{bd:{l:null}});P.setValue(e,t,n)}}))}if(!0===a||!1===a){if(A.isValid()){A.forEach(((e,t)=>{I.setValue(e,t,{bd:{l:null}})}));const e={sheetId:m,actionName:Fh.SET_RANGE_STYLE_ACTION,value:I.getArrayData(),rangeData:y};L.push(e)}N.forEach(((e,t)=>{if(!0===a){const n=hh.deepMerge(P.getValue(e,t)||{},{bd:{r:hh.deepClone(B)}});P.setValue(e,t,n)}else if(!1===a){const n=hh.deepMerge(P.getValue(e,t)||{},{bd:{r:null}});P.setValue(e,t,n)}}))}(!0===i||!1===i)&&this.forEach(((e,t)=>{if(t!==p.endColumn)if(!0===i){const n=hh.deepMerge(P.getValue(e,t)||{},{bd:{r:hh.deepClone(B)}});P.setValue(e,t,n)}else if(!1===i){const n=hh.deepMerge(P.getValue(e,t)||{},{bd:{r:null}});P.setValue(e,t,n)}if(t!==p.startColumn){const n=hh.deepMerge(P.getValue(e,t)||{},{bd:{l:null}});P.setValue(e,t,n)}})),(!0===o||!1===o)&&this.forEach(((e,t)=>{if(e!==p.endRow)if(!0===o){const n=hh.deepMerge(P.getValue(e,t)||{},{bd:{b:hh.deepClone(B)}});P.setValue(e,t,n)}else if(!1===o){const n=hh.deepMerge(P.getValue(e,t)||{},{bd:{b:null}});P.setValue(e,t,n)}if(e!==p.startRow){const n=hh.deepMerge(P.getValue(e,t)||{},{bd:{t:null}});P.setValue(e,t,n)}}));const F={sheetId:m,actionName:Fh.SET_RANGE_STYLE_ACTION,value:P.getArrayData(),rangeData:P.getDataRange()};L.push(F);const H=new Np(d,...L);return h.invoke(H),this}setBorderByType(e,t,n){let r=null,a=null,i=null,o=null,s=null,l=null;switch(e){case mh.TOP:r=!0;break;case mh.BOTTOM:i=!0;break;case mh.LEFT:a=!0;break;case mh.RIGHT:o=!0;break;case mh.NONE:r=!1,a=!1,i=!1,o=!1,s=!1,l=!1;break;case mh.ALL:r=!0,a=!0,i=!0,o=!0,s=!0,l=!0;break;case mh.OUTSIDE:r=!0,a=!0,i=!0,o=!0;break;case mh.INSIDE:s=!0,l=!0;break;case mh.HORIZONTAL:l=!0;break;case mh.VERTICAL:s=!0}this.setBorder(r,a,i,o,s,l,t,n)}setFontFamily(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={ff:e},c=hh.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new Np(t.getWorkBook(),u);return r.invoke(h),this}setFontSize(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={fs:e},c=hh.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new Np(t.getWorkBook(),u);return r.invoke(h),this}setHorizontalAlignment(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={ht:e},c=hh.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new Np(t.getWorkBook(),u);return r.invoke(h),this}setVerticalAlignment(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={vt:e},c=hh.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new Np(t.getWorkBook(),u);return r.invoke(h),this}setTextDirection(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={td:e},c=hh.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new Np(t.getWorkBook(),u);return r.invoke(h),this}setWrapStrategy(e){const{_context:t,_worksheet:n,_commandManager:r}=this,{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l={tb:e},c=hh.fillObjectMatrix(i-a+1,s-o+1,l),u={sheetId:n.getSheetId(),actionName:Fh.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},h=new Np(t.getWorkBook(),u);return r.invoke(h),this}setValue(e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:a}=this,{startRow:i,startColumn:o,endRow:s,endColumn:l}=t,c=new sh;for(let t=i;t<=s;t++)for(let n=o;n<=l;n++)c.setValue(t,n,e);const u={sheetId:a.getSheetId(),actionName:Fh.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:c.getData(),rangeData:this._rangeData},h=new Np(n.getWorkBook(),u);return r.invoke(h),this}setValues(...e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:a}=this,i=e[0];if(Xd.checkup(e,Array)){const{startRow:e,startColumn:o,endRow:s,endColumn:l}=t,c=new sh;for(let t=0;t<=s-e;t++)for(let n=0;n<=l-o;n++)c.setValue(t+e,n+o,i[t][n]);const u={sheetId:a.getSheetId(),actionName:Fh.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:c.getData(),rangeData:this._rangeData},h=new Np(n.getWorkBook(),u);r.invoke(h)}else if(Xd.checkup(e,sh)){const e={sheetId:a.getSheetId(),actionName:Fh.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:i,rangeData:this._rangeData},t=new Np(n.getWorkBook(),e);r.invoke(t)}return this}setRangeData(e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:a}=this,i={sheetId:a.getSheetId(),actionName:Fh.SET_RANGE_DATA_ACTION,cellValue:e,rangeData:t},o=new Np(n.getWorkBook(),i);return r.invoke(o),this}setRangeDatas(...e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:a}=this,i=e[0];if(Xd.checkup(e,Array)){const{startRow:e,startColumn:o,endRow:s,endColumn:l}=t,c=new sh;for(let t=0;t<=s-e;t++)for(let n=0;n<=l-o;n++)c.setValue(t+e,n+o,i[t][n]);const u={sheetId:a.getSheetId(),actionName:Fh.SET_RANGE_DATA_ACTION,cellValue:c.getData(),rangeData:this._rangeData},h=new Np(n.getWorkBook(),u);r.invoke(h)}else if(Xd.checkup(e,sh)){const e={sheetId:a.getSheetId(),actionName:Fh.SET_RANGE_DATA_ACTION,cellValue:i,rangeData:this._rangeData},t=new Np(n.getWorkBook(),e);r.invoke(t)}return this}clear(...e){const{_context:t,_worksheet:n,_commandManager:r,_rangeData:a}=this;let i={formatOnly:!0,contentsOnly:!0};Xd.checkup(e,Xd.OBJECT_TYPE)&&(i=e[0]);const o={sheetId:n.getSheetId(),actionName:Fh.CLEAR_RANGE_ACTION,options:i,rangeData:a},s=new Np(t.getWorkBook(),o);return r.invoke(s),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}clearNote(){return this.clear({commentsOnly:!0})}deleteCells(e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:a}=this,i={sheetId:a.getSheetId(),actionName:Fh.DELETE_RANGE_ACTION,shiftDimension:e,rangeData:t},o=new Np(n.getWorkBook(),i);r.invoke(o)}insertCells(...e){const t=e[0],n=e[1],{_rangeData:r,_context:a,_commandManager:i,_worksheet:o}=this,{startRow:s,endRow:l,startColumn:c,endColumn:u}=this._rangeData;let h=this._rangeData,d=new sh;if(n){d=n.getMatrixObject();const e=n.getRangeData();h={startRow:s,endRow:s+e.endRow-e.startRow,startColumn:c,endColumn:s+e.endColumn-e.startColumn}}else for(let e=s;e<=l;e++)for(let t=c;t<=u;t++)d.setValue(e,t,{m:"",v:""});const p={sheetId:o.getSheetId(),actionName:Fh.INSERT_RANGE_ACTION,shiftDimension:t,rangeData:h,cellValue:d.getData()},m=new Np(a.getWorkBook(),p);return i.invoke(m),this}merge(){const{_worksheet:e}=this,t=e.getContext(),n=e.getSheetId(),r=e.getCommandManager(),a={actionName:Fh.ADD_MERGE_ACTION,sheetId:n,rectangles:[this._rangeData]},i=new Np(t.getWorkBook(),a);return r.invoke(i),this}mergeAcross(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),r=e.getSheetId(),{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l=[];for(let e=a;e<=i;e++){const t={startRow:e,endRow:e,startColumn:o,endColumn:s};l.push(t)}const c={actionName:Fh.ADD_MERGE_ACTION,sheetId:r,rectangles:l},u=new Np(n.getWorkBook(),c);return t.invoke(u),this}mergeVertically(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),r=e.getSheetId(),{startRow:a,endRow:i,startColumn:o,endColumn:s}=this._rangeData,l=[];for(let e=o;e<=s;e++){const t={startRow:a,endRow:i,startColumn:e,endColumn:e};l.push(t)}const c={actionName:Fh.ADD_MERGE_ACTION,sheetId:r,rectangles:l},u=new Np(n.getWorkBook(),c);return t.invoke(u),this}breakApart(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),r=e.getSheetId(),a=this._worksheet.getMerges().getMergedRanges(this._rangeData),i={actionName:Fh.REMOVE_MERGE_ACTION,sheetId:r,rectangles:a},o=new Np(n.getWorkBook(),i);return t.invoke(o),this}removeDuplicates(...e){const{_rangeData:t,_context:n,_commandManager:r,_worksheet:a}=this;Array.isArray(e[0])&&e[0];const i=this.getMatrix().getData(),o=[];for(let e=0;e<=t.endColumn-t.startColumn;e++){const t=[],n={},r=this.getColumnMatrix(e).getData();for(const a in r){const i=r[a][e].m;n.hasOwnProperty(i)||(n[i]=1,t.push(e))}o.push(t)}const s=Array.from(new Set(o.flat())),l={};s.forEach(((e,t)=>{l[t]=i[e]}));const c=[{sheetId:a.getSheetId(),actionName:Fh.SET_RANGE_DATA_ACTION,cellValue:l,rangeData:t}],u=new Np(n.getWorkBook(),...c);return r.invoke(u),this}getRowMatrix(e){const{startColumn:t,endColumn:n}=this._rangeData,r=this._worksheet.getCellMatrix(),a=new sh;for(let i=e;i<=e;i++)for(let e=t;e<=n;e++)a.setValue(i,e,r.getValue(i,e)||{});return a}getColumnMatrix(e){const{startRow:t,endRow:n}=this._rangeData,r=this._worksheet.getCellMatrix(),a=new sh;for(let i=t;i<=n;i++)for(let t=e;t<=e;t++)a.setValue(i,t,r.getValue(i,t)||{});return a}_handleCopyRange(...e){const t=e[0];let n=e[1];n=Xd.checkup(e,dp,dp)?n.getRangeData():n;const r=t._worksheet.getCellMatrix(),{startRow:a,endRow:i,startColumn:o,endColumn:s}=t.getRangeData();let{startRow:l,endRow:c,startColumn:u,endColumn:h}=n;const d=i-a+1,p=s-o+1,m=c-l+1,_=h-u+1;let g,f=[];if(m%d==0&&_%p==0){for(let e=0;e<m;e++){const t=[];for(let n=0;n<_;n++){const i=r.getValue((e+a)%d,(n+o)%p)||{};t.push(i)}f.push(t)}g=n}else f=r.getFragments(a,i,o,s).getData(),c+=d-m,h+=p-_,g={startRow:l,endRow:c,startColumn:u,endColumn:h};return[f,g]}forEach(e){dp.foreach(this._rangeData,e)}randomize(){const{_context:e,_worksheet:t,_commandManager:n,_rangeData:r}=this,{startRow:a,startColumn:i}=r,o=new sh;hh.randSort(this.getMatrix().toArray()).forEach(((e,t)=>e.forEach(((e,n)=>{o.setValue(t+a,n+i,e||{})}))));const s={sheetId:t.getSheetId(),actionName:Fh.SET_RANGE_DATA_ACTION,cellValue:o.getData(),rangeData:r},l=new Np(e.getWorkBook(),s);n.invoke(l)}isValid(){return!Object.values(this._rangeData).includes(-1)}}function pp(e){return null!=e}var mp=(e=>(e.MESSAGE="message",e.OPEN="open",e.CLOSE="close",e.ERROR="error",e.RETRY="retry",e.DESTROY="destroy",e))(mp||{});const _p={url:"",heartbeatTime:6e3};class gp{constructor(e){Zu(this,"_config"),Zu(this,"_listens"),Zu(this,"_timer"),Zu(this,"_socket");const t=function(e,...t){for(const n of t)if(n)for(const t in n)n.hasOwnProperty(t)&&pp(n[t])&&(e[t]=n[t]);return e}({},_p,e);if(function(e){return function(e){return null==e}(e)||""===e.toString()}(t.url))throw new Error("url must be input");this._listens=new Map,this._timer=-1,this._config=e}_create(){const{_config:e}=this;this._socket=new WebSocket(e.url)}_bind(){this._socket.addEventListener("message",this._message),this._socket.addEventListener("open",this._open),this._socket.addEventListener("close",this._close),this._socket.addEventListener("error",this._error)}_message(e){const t=this._listens.get("message");t&&t(e)}_open(e){const t=this._listens.get("open");t&&(t(e),this._heartbeat())}_error(e){const t=this._listens.get("error");t&&(t(e),this._retry())}_close(e){const t=this._listens.get("close");t&&(t(e),this.destroy())}_clear(){this._timer>-1&&clearInterval(this._timer),this._timer=-1,this._socket.removeEventListener("message",this._message),this._socket.removeEventListener("open",this._open),this._socket.removeEventListener("close",this._close),this._socket.removeEventListener("error",this._error),this._socket.close()}_heartbeat(){const{_socket:e,_config:t}=this,{heartbeatTime:n}=t;this._timer=setInterval((function(){e.send("heartbea_message")}),n)}_retry(){const e=this._listens.get("retry");e&&e(),this._clear(),this._create(),this._bind()}link(){this._create(),this._bind()}send(e){this._socket.send(e)}destroy(){const e=this._listens.get("destroy");e&&e(),this._clear(),this._listens.clear()}on(e,t){this._listens[e]=t}}Object.keys(Yh).reduce(((e,t)=>[...e,...Yh[t]]),[]);class fp{static fromSequence(e){if(hh.isObject(e)&&fp.requiredNewInstance(this))return this.newInstance(e);if(hh.isArray(e)&&fp.requiredNewInstance(this)){const t=this;return e.map((e=>t.newInstance(e)))}return[]}toSequence(){return{className:hh.getClassName(this)}}}function yp(e,t){return e.zIndex>t.zIndex?1:e.zIndex===t.zIndex?0:-1}(e=>{e.requiredNewInstance=function(e){if(hh.isDefine(e.newInstance))return!0;throw new Error("sequence newInstance need subclass implement!")}})(fp||(fp={}));Zu(class{static GetClass(e){return this.RegisteredTypes&&this.RegisteredTypes[e]?this.RegisteredTypes[e]:null}},"RegisteredTypes",{});var vp=(e=>(e[e.REDO=0]="REDO",e[e.UNDO=1]="UNDO",e))(vp||{});class bp extends rh{}class xp extends rh{}class wp extends rh{}class Tp{constructor(e){Zu(this,"_undoManager"),this._undoManager=e.getUndoManager()}static staticInitialize(){this._actionClass=new Map,this._actionObservers=new bp,this._commandObservers=new xp,this._commandInjectorObservers=new wp}static getAction(e){return this._actionClass[e]}static getActionObservers(){return this._actionObservers}static getCommandObservers(){return this._commandObservers}static register(e,t){this._actionClass[e]=t}static getCommandInjectorObservers(){return this._commandInjectorObservers}undo(){const{_undoManager:e}=this,t=e.undo();t&&t.undo()}redo(){const{_undoManager:e}=this,t=e.redo();t&&t.redo()}invoke(e){const{_undoManager:t}=this;e.invoke(),t.push(e)}}Zu(Tp,"_actionClass"),Zu(Tp,"_commandObservers"),Zu(Tp,"_actionObservers"),Zu(Tp,"_commandInjectorObservers"),Tp.staticInitialize();class Cp{constructor(){Zu(this,"_data",[])}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new Cp}}const Ep=Cp.create();class Ap{constructor(){Zu(this,"_actionExtensionFactoryList",[])}get actionExtensionFactoryList(){return this._actionExtensionFactoryList}initialize(){this._initExtensions()}add(...e){this._actionExtensionFactoryList.push(...e),this._actionExtensionFactoryList.sort(yp)}delete(e){const t=this._actionExtensionFactoryList.indexOf(e);this._actionExtensionFactoryList.splice(t,1)}_initExtensions(){this._actionExtensionFactoryList.push(...Ep.getData().sort(yp))}}const Sp=class{constructor(){Zu(this,"_actionExtensionFactoryList")}handle(e){var t;const n=null==(t=null==Sp?void 0:Sp.register)?void 0:t.actionExtensionFactoryList;!n||(this._actionExtensionFactoryList=n,this._checkExtension(e))}_checkExtension(e){if(!this._actionExtensionFactoryList)return!1;e.forEach((t=>{this._actionExtensionFactoryList.forEach((n=>{const r=n.check(t,e);!1!==r&&r.execute()}))}))}static create(){return this.register||(this.register=new Ap,this.register.initialize()),this.register}};let Dp=Sp;Zu(Dp,"register");class Rp{constructor(e){Zu(this,"_actions"),(new Dp).handle(e)}getDoData(){return this._actions.map((e=>e.getDoActionData()))}getOldData(){return this._actions.map((e=>e.getOldActionDaa()))}getInjector(){const e=this;return new class{injectAction(t){e._actions.push(t)}getActions(){return e._actions.concat([])}include(t){for(let n=0;n<e._actions.length;n++)if(e._actions[n]instanceof t)return e._actions[n];return null}}}redo(){this._actions.forEach((e=>e.redo())),Tp.getCommandObservers().notifyObservers({type:vp.REDO,actions:this._actions})}undo(){this._actions.forEach((e=>e.undo())),Tp.getCommandObservers().notifyObservers({type:vp.UNDO,actions:this._actions})}invoke(){Tp.getCommandInjectorObservers().notifyObservers(this.getInjector()),Tp.getCommandObservers().notifyObservers({type:vp.REDO,actions:this._actions})}}class Np extends Rp{constructor(e,...t){super(t),Zu(this,"unit"),this.unit=e,this._actions=[],t.forEach((t=>{const n=Tp.getAction(t.actionName),r=Tp.getActionObservers(),a=new n(t,e,r);this._actions.push(a)}))}}Tp.register(Fh.INSERT_ROW_DATA_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,rowCount:ih.getMaxLength(e.rowData[0]),convertor:[]},this.validate()}do(){const e=this.getWorkSheet();rd(this._doActionData.rowIndex,this._doActionData.rowData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();ud(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.INSERT_ROW_ACTION,Ud),Tp.register(Fh.REMOVE_ROW_DATA_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,rowData:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=ud(this._doActionData.rowIndex,this._doActionData.rowCount,e.getCellMatrix().toJSON());return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();rd(this._oldActionData.rowIndex,this._oldActionData.rowData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.REMOVE_ROW_ACTION,Wd),Tp.register(Fh.SET_RANGE_STYLE_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._oldActionData={...e,value:this.do()},this.validate()}do(){const{value:e,rangeData:t}=this._doActionData,n=this._workbook.getStyles(),r=vd(this.getWorkSheet().getCellMatrix(),e,t,n);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),r}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:Fh.SET_RANGE_STYLE_ACTION,sheetId:e,value:this.do(),rangeData:t}}undo(){const{value:e,rangeData:t,sheetId:n}=this._oldActionData,r=this._workbook.getStyles(),a=this.getWorkSheet().getCellMatrix();this._doActionData={actionName:Fh.SET_RANGE_STYLE_ACTION,sheetId:n,value:vd(a,e,t,r),rangeData:t},this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.SET_WORKSHEET_STATUS_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,sheetStatus:this.do(),convertor:[]},this.validate()}do(){const e=Bd(this.getWorkSheet(),this._doActionData.sheetStatus);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:Fh.SET_WORKSHEET_STATUS_ACTION,sheetStatus:this.do()}}undo(){const{sheetStatus:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:Fh.SET_WORKSHEET_STATUS_ACTION,sheetId:t,sheetStatus:Bd(n,e)},this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.SET_SELECTION_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new Kh(Vh)]};const{activeRangeList:r,activeRange:a,currentCell:i}=this.do();this._oldActionData={...e,activeRangeList:r,activeRange:a,currentCell:i},this.validate()}do(){const{activeRangeList:e,activeRange:t,currentCell:n}=this._doActionData,r=Md(this.getWorkSheet(),e,t,n);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),r}redo(){const{sheetId:e}=this._doActionData,{activeRangeList:t,activeRange:n,currentCell:r}=this.do();this._oldActionData={actionName:Fh.SET_SELECTION_ACTION,sheetId:e,activeRangeList:t,activeRange:n,currentCell:r}}undo(){const{activeRangeList:e,activeRange:t,currentCell:n,sheetId:r}=this._oldActionData,a=Md(this.getWorkSheet(),e,t,n);this._doActionData={actionName:Fh.SET_SELECTION_ACTION,sheetId:r,activeRangeList:a.activeRangeList,activeRange:a.activeRange,currentCell:a.currentCell},this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.SET_RANGE_DATA_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new Kh(Vh)]},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=this._workbook.getStyles(),n=Cd(e.getCellMatrix(),this._doActionData.cellValue,this._doActionData.rangeData,t,this._doActionData.options);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),n}redo(){const{sheetId:e,rangeData:t,options:n}=this._doActionData;this._oldActionData={actionName:Fh.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:this.do(),rangeData:t,options:n}}undo(){const{rangeData:e,sheetId:t,cellValue:n,options:r}=this._oldActionData,a=this.getWorkSheet(),i=this._workbook.getStyles();a&&(this._doActionData={actionName:Fh.SET_RANGE_DATA_ACTION,sheetId:t,cellValue:Cd(a.getCellMatrix(),n,e,i),rangeData:e,options:r},this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}),Tp.register(Fh.SET_RANGE_FORMATTED_VALUE_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new Kh(Vh)]},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=Dd(this.getWorkSheet().getCellMatrix(),this._doActionData.cellValue,this._doActionData.rangeData);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:Fh.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellValue:n}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:Fh.SET_RANGE_DATA_ACTION,sheetId:t,cellValue:Dd(r.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}),Tp.register(Fh.DELETE_RANGE_ACTION,Hd),Tp.register(Fh.CLEAR_RANGE_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,cellValue:this.do(),convertor:[]},this.validate()}do(){const e=function(e,t,n){const{startRow:r,endRow:a,startColumn:i,endColumn:o}=n,s=new sh;for(let n=r;n<=a;n++)for(let r=i;r<=o;r++){const a=e.getValue(n,r);s.setValue(n,r,hh.deepClone(a)),a&&(t.formatOnly&&delete a.s,t.contentsOnly&&(a.v="",a.m=""),e.setValue(n,r,hh.deepClone(a)))}return s.getData()}(this.getWorkSheet().getCellMatrix(),this._doActionData.options,this._doActionData.rangeData);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:Fh.SET_RANGE_DATA_ACTION,sheetId:e,rangeData:t,cellValue:this.do(),convertor:[new Kh(Wh)]}}undo(){const e=this.getWorkSheet(),{rangeData:t,cellValue:n}=this._oldActionData,r=this._workbook.getStyles();e&&(Cd(e.getCellMatrix(),n,t,r),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}),Tp.register(Fh.INSERT_RANGE_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet();e&&(ad({rowCount:e.getLastRow(),columnCount:e.getLastColumn()},e.getCellMatrix(),this._doActionData.shiftDimension,this._doActionData.rangeData,this._doActionData.cellValue),this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}))}redo(){this.do()}undo(){const{rangeData:e,sheetId:t,shiftDimension:n}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:Fh.SET_RANGE_DATA_ACTION,sheetId:t,cellValue:Jh({rowCount:r.getLastRow(),columnCount:r.getLastColumn()},r.getCellMatrix(),n,e),rangeData:e,shiftDimension:n},this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}),Tp.register(Fh.SET_TAB_COLOR_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new Kh(Vh)]},this._oldActionData={...e,color:this.do()},this.validate()}do(){const e=Id(this.getWorkSheet(),this._doActionData.color);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:Fh.SET_TAB_COLOR_ACTION,color:this.do()}}undo(){const{color:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:Fh.SET_TAB_COLOR_ACTION,sheetId:t,color:Id(n,e)},this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.HIDE_SHEET_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,hidden:this.do(),convertor:[]},this.validate()}do(){const e=ed(this.getWorkSheet(),this._doActionData.hidden);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:Fh.HIDE_SHEET_ACTION,hidden:this.do()}}undo(){const{hidden:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:Fh.HIDE_SHEET_ACTION,sheetId:t,hidden:ed(n,e)},this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.SET_WORKSHEET_ACTIVATE_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]};const{oldSheetId:r,status:a}=this.do();this._oldActionData={...e,sheetId:r,status:a,convertor:[]},this.validate(),this.removeOperation(Qu.SERVER_ACTION)}do(){const{sheetId:e,status:t}=this._doActionData,n=Pd(this._workbook.getSheetBySheetId(e));return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),n}redo(){const{oldSheetId:e,status:t}=this.do();this._oldActionData={actionName:Fh.SET_WORKSHEET_ACTIVATE_ACTION,sheetId:e,status:t}}undo(){const{sheetId:e}=this._oldActionData;this._oldActionData.status;const t=this._workbook.getSheetBySheetId(e);if(t){const{oldSheetId:e,status:n}=Pd(t);this._doActionData={actionName:Fh.SET_WORKSHEET_ACTIVATE_ACTION,sheetId:e,status:n},this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}}validate(){return!1}}),Tp.register(Fh.SET_HIDE_ROW_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet();fd(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();kd(this._oldActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.SET_SHOW_ROW_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet();kd(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();fd(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.SET_HIDE_COLUMN_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet();pd(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();md(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.SET_SHOW_COLUMN_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,convertor:[]},this.validate()}do(){const e=this.getWorkSheet();md(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();pd(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.ADD_MERGE_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new Kh(Wh)]},this._oldActionData={...e,rectangles:this.do(),convertor:[new Kh(zh)]},this.validate()}do(){return Xh(this.getWorkSheet().getMerges(),this._doActionData.rectangles)}redo(){this.do()}undo(){$h(this.getWorkSheet().getMerges(),this._doActionData.rectangles)}validate(){return!1}}),Tp.register(Fh.REMOVE_MERGE_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,rectangles:this.do(),convertor:[]},this.validate()}do(){const e=$h(this.getWorkSheet().getMerges(),this._doActionData.rectangles);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){Xh(this.getWorkSheet().getMerges(),this._doActionData.rectangles),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.SET_WORKSHEET_NAME_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,sheetName:this.do(),convertor:[]},this.validate()}do(){const e=Ld(this.getWorkSheet(),this._doActionData.sheetName);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:Fh.SET_WORKSHEET_NAME_ACTION,sheetName:this.do()}}undo(){const{sheetName:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:Fh.SET_WORKSHEET_NAME_ACTION,sheetId:t,sheetName:Ld(n,e)},this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.SET_HIDDEN_GRIDLINES_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,hideGridlines:this.do(),convertor:[]},this.validate()}do(){const e=gd(this.getWorkSheet(),this._doActionData.hideGridlines);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){this._oldActionData;gd(this.getWorkSheet(),this._oldActionData.hideGridlines),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.SET_COLUMN_WIDTH_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,columnWidth:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=_d(this._doActionData.columnIndex,this._doActionData.columnWidth,e.getColumnManager());return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=_d(this._oldActionData.columnIndex,this._oldActionData.columnWidth,e.getColumnManager());return this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this}),t}validate(){return!1}}),Tp.register(Fh.SET_ROW_HEIGHT_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,rowHeight:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=Nd(this._doActionData.rowIndex,this._doActionData.rowHeight,e.getRowManager());return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=Nd(this._oldActionData.rowIndex,this._oldActionData.rowHeight,e.getRowManager());return this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this}),t}validate(){return!1}}),Tp.register(Fh.SET_BORDER_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,styles:this.do(),convertor:[]},this.validate()}do(){const e=this.getWorkSheet(),t=dd(e.getCellMatrix(),e.getContext().getWorkBook().getStyles(),this._doActionData.styles);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();dd(e.getCellMatrix(),e.getContext().getWorkBook().getStyles(),this._oldActionData.styles),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.SET_RIGHT_TO_LEFT_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,rightToLeft:this.do(),convertor:[]},this.validate()}do(){const e=Rd(this.getWorkSheet(),this._doActionData.rightToLeft);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){this._oldActionData;Rd(this.getWorkSheet(),this._oldActionData.rightToLeft),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.INSERT_COLUMN_DATA_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this.do(),this._oldActionData={...e,columnCount:ih.getMaxLength(e.columnData[0]),convertor:[]},this.validate()}do(){const e=this.getWorkSheet();nd(this._doActionData.columnIndex,this._doActionData.columnData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();ld(this._oldActionData.columnIndex,this._oldActionData.columnCount,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.REMOVE_COLUMN_DATA_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new Kh(zh)]},this._oldActionData={...e,columnData:this.do(),convertor:[new Kh(Wh)]},this.validate()}do(){const e=this.getWorkSheet(),t=ld(this._doActionData.columnIndex,this._doActionData.columnCount,e.getCellMatrix().toJSON());return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();nd(this._oldActionData.columnIndex,this._oldActionData.columnData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}),Tp.register(Fh.INSERT_COLUMN_ACTION,qd),Tp.register(Fh.REMOVE_COLUMN_ACTION,Vd),Tp.register(Fh.DELETE_NAMED_RANGE_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new Kh(Vh)]},this._oldActionData={actionName:Fh.ADD_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRange:this.do()},this.validate()}do(){const{namedRangeId:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),Qh(t,e)}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:Fh.ADD_BANDING_ACTION,namedRange:this.do(),convertor:[new Kh(Wh)]}}undo(){const{namedRange:e}=this._oldActionData,t=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this}),Zh(t,e)}validate(){return!1}}),Tp.register(Fh.SET_NAMED_RANGE_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new Kh(Vh)]},this._oldActionData={actionName:Fh.SET_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRange:this.do()},this.validate()}do(){const{namedRange:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),yd(t,e)}redo(){const{sheetId:e,namedRange:t}=this._doActionData;this._oldActionData={actionName:Fh.SET_NAMED_RANGE_ACTION,sheetId:e,namedRange:this.do()}}undo(){const{namedRange:e,sheetId:t}=this._oldActionData,n=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this}),this._doActionData={actionName:Fh.SET_NAMED_RANGE_ACTION,sheetId:t,namedRange:yd(n,e)}}validate(){return!1}}),Tp.register(Fh.ADD_NAMED_RANGE_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new Kh(Vh)]},this.do(),this._oldActionData={actionName:Fh.DELETE_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRangeId:e.namedRange.namedRangeId},this.validate()}do(){const{namedRange:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),Zh(t,e)}redo(){this.do()}undo(){const{namedRangeId:e,sheetId:t}=this._oldActionData,n=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this}),this._doActionData={actionName:Fh.ADD_NAMED_RANGE_ACTION,sheetId:t,namedRange:Qh(n,e)}}validate(){return!1}}),Tp.register(Fh.SET_RANGE_FORMAT_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[new Kh(Vh)]},this._oldActionData={...e,cellFormat:this.do()},this.validate()}do(){const e=Ed(this.getWorkSheet().getCellMatrix(),this._doActionData.cellFormat,this._doActionData.rangeData);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:Fh.SET_RANGE_FORMAT_ACTION,sheetId:e,cellFormat:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellFormat:n}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:Fh.SET_RANGE_FORMAT_ACTION,sheetId:t,cellFormat:Ed(r.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}),Tp.register(Fh.SET_RANGE_FORMULA_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,cellFormula:this.do(),convertor:[]},this.validate()}do(){const e=Ad(this.getWorkSheet().getCellMatrix(),this._doActionData.cellFormula,this._doActionData.rangeData);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:Fh.SET_RANGE_FORMULA_ACTION,sheetId:e,cellFormula:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellFormula:n}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:Fh.SET_RANGE_FORMULA_ACTION,sheetId:t,cellFormula:Ad(r.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}),Tp.register(Fh.SET_RANGE_NOTE_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,cellNote:this.do(),convertor:[]},this.validate()}do(){const e=Sd(this.getWorkSheet().getCellMatrix(),this._doActionData.cellNote,this._doActionData.rangeData);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),e}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:Fh.SET_RANGE_NOTE_ACTION,sheetId:e,cellNote:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellNote:n}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:Fh.SET_RANGE_NOTE_ACTION,sheetId:t,cellNote:Sd(r.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}),Tp.register(Fh.INSERT_SHEET_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,sheetId:this.do(),convertor:[]}}do(){const e=od(this.getWorkBook(),this._doActionData.index,this._doActionData.sheet);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),e}redo(){this.redo()}undo(){hd(this.getWorkBook(),this._oldActionData.sheetId),this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this})}validate(){throw new Error("Method not implemented.")}}),Tp.register(Fh.REMOVE_SHEET_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,...this.do(),convertor:[]}}do(){return this.redo()}redo(){const e=hd(this.getWorkBook(),this._doActionData.sheetId);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),e}undo(){const e=this.getWorkBook();this._observers.notifyObservers({type:vp.UNDO,data:this._oldActionData,action:this}),od(e,this._oldActionData.index,this._oldActionData.sheet)}validate(){throw new Error("Method not implemented.")}}),Tp.register(Fh.SET_SHEET_ORDER_ACTION,zd),Tp.register(Fh.SET_SHEET_ORDER_ACTION,zd),Tp.register(Fh.SET_ZOOM_RATIO_ACTION,class extends eh{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]},this._oldActionData={...e,zoom:this.do(),convertor:[]},this.validate()}redo(){const e=Fd(this.getWorkBook(),this._doActionData.sheetId,this._doActionData.zoom);return this._observers.notifyObservers({type:vp.REDO,data:this._doActionData,action:this}),e}do(){return this.redo()}undo(){Fd(this.getWorkBook(),this._oldActionData.sheetId,this._oldActionData.zoom),this._observers.notifyObservers({type:vp.REDO,data:this._oldActionData,action:this})}validate(){return!1}});var Mp,Op=(e=>(e[e.PARAGRAPH=0]="PARAGRAPH",e[e.TABLE=1]="TABLE",e[e.SECTION_BREAK=2]="SECTION_BREAK",e[e.CUSTOM=3]="CUSTOM",e))(Op||{}),kp=(e=>(e[e.TEXT_RUN=0]="TEXT_RUN",e[e.AUTO_TEXT=1]="AUTO_TEXT",e[e.PAGE_BREAK=2]="PAGE_BREAK",e[e.COLUMN_BREAK=3]="COLUMN_BREAK",e[e.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",e[e.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",e[e.EQUATION=6]="EQUATION",e[e.DRAWING=7]="DRAWING",e[e.PERSON=8]="PERSON",e[e.RICH_LINK=9]="RICH_LINK",e))(kp||{});!function(e){!function(t){var n="object"==typeof jd?jd:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),r=a(e);function a(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}typeof n.Reflect>"u"?n.Reflect=e:r=a(n.Reflect,r),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",a=n&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",i="function"==typeof Object.create,o={__proto__:[]}instanceof Array,s=!i&&!o,l={create:i?function(){return re(Object.create(null))}:o?function(){return re({__proto__:null})}:function(){return re({})},has:s?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:s?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},c=Object.getPrototypeOf(Function),u="object"==typeof process&&process.env&&"true"==={}.REFLECT_METADATA_USE_MAP_POLYFILL,h=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,d=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,p=new(u||"function"!=typeof WeakMap?ne():WeakMap);function m(e,t,n,r){if(P(n)){if(!z(e))throw new TypeError;if(!G(t))throw new TypeError;return C(e,t)}if(!z(e))throw new TypeError;if(!F(t))throw new TypeError;if(!F(r)&&!P(r)&&!L(r))throw new TypeError;return L(r)&&(r=void 0),E(e,t,n=W(n),r)}function _(e,t){function n(n,r){if(!F(n))throw new TypeError;if(!P(r)&&!X(r))throw new TypeError;M(e,t,n,r)}return n}function g(e,t,n,r){if(!F(n))throw new TypeError;return P(r)||(r=W(r)),M(e,t,n,r)}function f(e,t,n){if(!F(t))throw new TypeError;return P(n)||(n=W(n)),S(e,t,n)}function y(e,t,n){if(!F(t))throw new TypeError;return P(n)||(n=W(n)),D(e,t,n)}function v(e,t,n){if(!F(t))throw new TypeError;return P(n)||(n=W(n)),R(e,t,n)}function b(e,t,n){if(!F(t))throw new TypeError;return P(n)||(n=W(n)),N(e,t,n)}function x(e,t){if(!F(e))throw new TypeError;return P(t)||(t=W(t)),O(e,t)}function w(e,t){if(!F(e))throw new TypeError;return P(t)||(t=W(t)),k(e,t)}function T(e,t,n){if(!F(t))throw new TypeError;P(n)||(n=W(n));var r=A(t,n,!1);if(P(r)||!r.delete(e))return!1;if(r.size>0)return!0;var a=p.get(t);return a.delete(n),a.size>0||p.delete(t),!0}function C(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!P(r)&&!L(r)){if(!G(r))throw new TypeError;t=r}}return t}function E(e,t,n,r){for(var a=e.length-1;a>=0;--a){var i=(0,e[a])(t,n,r);if(!P(i)&&!L(i)){if(!F(i))throw new TypeError;r=i}}return r}function A(e,t,n){var r=p.get(e);if(P(r)){if(!n)return;r=new h,p.set(e,r)}var a=r.get(t);if(P(a)){if(!n)return;a=new h,r.set(t,a)}return a}function S(e,t,n){if(D(e,t,n))return!0;var r=J(t);return!L(r)&&S(e,r,n)}function D(e,t,n){var r=A(t,n,!1);return!P(r)&&U(r.has(e))}function R(e,t,n){if(D(e,t,n))return N(e,t,n);var r=J(t);return L(r)?void 0:R(e,r,n)}function N(e,t,n){var r=A(t,n,!1);if(!P(r))return r.get(e)}function M(e,t,n,r){A(n,r,!0).set(e,t)}function O(e,t){var n=k(e,t),r=J(e);if(null===r)return n;var a=O(r,t);if(a.length<=0)return n;if(n.length<=0)return a;for(var i=new d,o=[],s=0,l=n;s<l.length;s++){var c=l[s];i.has(c)||(i.add(c),o.push(c))}for(var u=0,h=a;u<h.length;u++){c=h[u];i.has(c)||(i.add(c),o.push(c))}return o}function k(e,t){var n=[],r=A(e,t,!1);if(P(r))return n;for(var a=j(r.keys()),i=0;;){var o=Z(a);if(!o)return n.length=i,n;var s=K(o);try{n[i]=s}catch(e){try{Q(a)}finally{throw e}}i++}}function I(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function P(e){return void 0===e}function L(e){return null===e}function B(e){return"symbol"==typeof e}function F(e){return"object"==typeof e?null!==e:"function"==typeof e}function H(e,t){switch(I(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",a=$(e,r);if(void 0!==a){var i=a.call(e,n);if(F(i))throw new TypeError;return i}return q(e,"default"===n?"number":n)}function q(e,t){if("string"===t){var n=e.toString;if(Y(n))if(!F(a=n.call(e)))return a;if(Y(r=e.valueOf))if(!F(a=r.call(e)))return a}else{var r;if(Y(r=e.valueOf))if(!F(a=r.call(e)))return a;var a,i=e.toString;if(Y(i))if(!F(a=i.call(e)))return a}throw new TypeError}function U(e){return!!e}function V(e){return""+e}function W(e){var t=H(e,3);return B(t)?t:V(t)}function z(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function Y(e){return"function"==typeof e}function G(e){return"function"==typeof e}function X(e){switch(I(e)){case 3:case 4:return!0;default:return!1}}function $(e,t){var n=e[t];if(null!=n){if(!Y(n))throw new TypeError;return n}}function j(e){var t=$(e,a);if(!Y(t))throw new TypeError;var n=t.call(e);if(!F(n))throw new TypeError;return n}function K(e){return e.value}function Z(e){var t=e.next();return!t.done&&t}function Q(e){var t=e.return;t&&t.call(e)}function J(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===c||t!==c)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var a=r.constructor;return"function"!=typeof a||a===e?t:a}function ee(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[a]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,a=n+1;a<r;a++)this._keys[a-1]=this._keys[a],this._values[a-1]=this._values[a];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,i)},t.prototype.entries=function(){return new n(this._keys,this._values,o)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[a]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function i(e,t){return t}function o(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[a]=function(){return this.keys()},e}()}function ne(){var e=16,n=l.create(),r=a();return function(){function e(){this._key=a()}return e.prototype.has=function(e){var t=i(e,!1);return void 0!==t&&l.has(t,this._key)},e.prototype.get=function(e){var t=i(e,!1);return void 0!==t?l.get(t,this._key):void 0},e.prototype.set=function(e,t){return i(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=i(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=a()},e}();function a(){var e;do{e="@@WeakMap@@"+c()}while(l.has(n,e));return n[e]=!0,e}function i(e,n){if(!t.call(e,r)){if(!n)return;Object.defineProperty(e,r,{value:l.create()})}return e[r]}function o(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function s(e){return"function"==typeof Uint8Array?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(e)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(e)):o(new Uint8Array(e),e):o(new Array(e),e)}function c(){var t=s(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<e;++r){var a=t[r];(4===r||6===r||8===r)&&(n+="-"),a<16&&(n+="0"),n+=a.toString(16).toLowerCase()}return n}}function re(e){return e.__=void 0,delete e.__,e}e("decorate",m),e("metadata",_),e("defineMetadata",g),e("hasMetadata",f),e("hasOwnMetadata",y),e("getMetadata",v),e("getOwnMetadata",b),e("getMetadataKeys",x),e("getOwnMetadataKeys",w),e("deleteMetadata",T)}(r)}()}(Mp||(Mp={}));const Ip=class{static register(e,t){let n=Ip.sMap.get(e);n?n.push(t):(n=new Array,n.push(t),Ip.sMap.set(e,n))}static getTable(e){var t;let n=new Array,r=e;for(;null!=r;){const e=null!=(t=Ip.sMap.get(r))?t:[];n=n.concat(e),r=Object.getPrototypeOf(r)}return n}};let Pp=Ip;Zu(Pp,"sMap",new Map);const Lp="MessageQueue";class Bp{constructor(){Zu(this,"_messages"),this.load()}first(){return this._messages[0]}last(){return this._messages[this._messages.length-1]}size(){return this._messages.length}pop(){this._messages.shift(),this.save()}push(e){this._messages.push(e),this.save()}hasMessage(){return this._messages.length>0}isEmpty(){return!this.hasMessage()}save(){const e=JSON.stringify(this._messages);localStorage.setItem(Lp,e)}load(){const e=localStorage.getItem(Lp);e&&(this._messages=JSON.parse(e))}}class Fp{static isMessageResponseReceive(e){return"message_response"===e.type}packMessage(e){return{changed:e,version:hh.generateRandomId()}}}var Hp=Object.defineProperty,qp=Object.getOwnPropertyDescriptor,Up=(e,t,n,r)=>{for(var a,i=r>1?void 0:r?qp(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Hp(t,n,i),i};const Vp=class extends Fp{constructor(){super(...arguments),Zu(this,"config"),Zu(this,"globalSendResolve"),Zu(this,"socket"),Zu(this,"status"),Zu(this,"messageQueue")}initialize(){this.messageQueue=new Bp,this.status="wait",this.globalSendResolve=()=>{},this.config.socketEnable&&(this.socket=new gp({url:this.config.socketUrl}),this.socket.on(mp.MESSAGE,(e=>{this.checkupReceiveMessage(e.data)})),this.socket.on(mp.ERROR,(()=>{})),this.socket.on(mp.OPEN,(()=>{})),this.socket.on(mp.CLOSE,(()=>{})),this.socket.on(mp.RETRY,(()=>{})),this.socket.on(mp.DESTROY,(()=>{})),this.socket.link())}getTopMessage(){return this.messageQueue.first()}popTopMessage(){this.messageQueue.pop()}serializeTopMessage(){var e;const t=this.getTopMessage();return null!=(e=JSON.stringify(t))?e:""}checkupReceiveMessage(e){Vp.isMessageResponseReceive(e)&&this.getTopMessage().version===e.message.version&&(this.popTopMessage(),this.globalSendResolve())}pushMessageQueue(e){this.config.socketEnable&&(this.messageQueue.push(this.packMessage(e)),this.sendMessageQueue())}async sendTopMessage(){const e=this.serializeTopMessage();return this.socket.send(e),new Promise((e=>this.globalSendResolve=e))}async sendMessageQueue(){const{messageQueue:e,status:t}=this;if("wait"===t){for(this.status="work";e.hasMessage();)await this.sendTopMessage();this.status="wait"}return this.status}};let Wp=Vp;Up([(e,t)=>{Pp.register(e,t),Reflect.defineMetadata("AttributeValue",{},e,t)}],Wp.prototype,"config",2),Up([(e,t,n)=>{Pp.register(e,t),Reflect.defineMetadata("PostConstruct",n,e,t)}],Wp.prototype,"initialize",1);const zp={documentId:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:Op.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:kp.TEXT_RUN,tr:{ct:"在“第1题”工作表中完成以下操作",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},smallSub:{eId:"twoElement",st:0,ed:15,et:kp.TEXT_RUN,tr:{ct:"上标",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:Ah.SUPERSCRIPT}}},twoElement:{eId:"twoElement",st:0,ed:15,et:kp.TEXT_RUN,tr:{ct:"日期列单元格数据验证，限制只能输入日期（介于1949年1月1日至2099年1月1日）",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:kp.TEXT_RUN},{elementId:"smallSub",paragraphElementType:kp.TEXT_RUN},{elementId:"twoElement",paragraphElementType:kp.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},Yp={id:"workbook-01",theme:"default",locale:bh.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:Sh.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{cl:{rgb:"blue"},fs:16,bd:{t:{s:ph.MEDIUM_DASHED,cl:{rgb:"black"}},l:{s:ph.MEDIUM_DASHED,cl:{rgb:"black"}},r:{s:ph.THICK,cl:{rgb:"black"}},b:{s:ph.THIN,cl:{rgb:"red"}}},ht:3},2:{bg:{rgb:"rgb(200, 2, 0)"},fs:24},3:{ht:Th.RIGHT,vt:Ch.TOP,tb:Eh.WRAP,bg:{rgb:"rgb(255, 255, 0)"},tr:{a:45,v:Sh.FALSE},bd:{t:{s:ph.THIN,cl:{rgb:"black"}},l:{s:ph.THIN,cl:{rgb:"black"}},r:{s:ph.THIN,cl:{rgb:"black"}},b:{s:ph.THIN,cl:{rgb:"red"}}}},4:{bg:{rgb:"rgb(0, 0, 255)"}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-01":{type:xh.GRID,id:"sheet-01",cellData:{0:{0:{s:"1",v:1,m:"1"},1:{s:"1",v:1,m:"1"},5:{s:"1",v:8,m:"8"},6:{s:"2",v:8,m:"8"}},1:{0:{v:1,m:"1"},1:{v:1,m:"1"},2:{v:80,m:"80",s:"3"},3:{v:"富文本编辑",m:"富文本编辑",s:"2"}},2:{0:{v:1111,m:"1111"},1:{v:1111,m:"1111"},5:{s:"1",v:8,m:"8"},6:{s:"1",v:8,m:"8"},7:{s:"1",v:8,m:"8"},8:{s:"1",v:8,m:"8"}},3:{0:{v:1111,m:"1111"},1:{v:1111,m:"1111"}},10:{9:{v:1111,s:"2",m:"1111"}},13:{9:{v:1111,s:"4",m:"1111"}},17:{3:{v:"做移动端开发和前端开发的人员，对 MVC、MVP、MVVM 这几个名词应该都不陌生，这是三个最常用的应用架构模式，目的都是为了将业务和视图的实现代码分离",s:"3",p:zp}},20:{10:{v:"北京马拉松组委会办公室一位接电话的女士证实，的确有这项规定，她还称2014年马拉松的预登记工作将在本周启动。北京马拉松比赛将在10月19日举行。",s:"3"},12:{s:"4"}},29:{13:{p:hh.deepClone(zp),s:"4"}}},name:"sheet1",tabColor:"red",hidden:Sh.FALSE,freezeColumn:1,rowCount:1e3,columnCount:20,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:27,mergeData:[{startRow:0,endRow:1,startColumn:0,endColumn:1},{startRow:2,endRow:6,startColumn:5,endColumn:10},{startRow:10,endRow:12,startColumn:9,endColumn:12},{startRow:10,endRow:12,startColumn:9,endColumn:12},{startRow:17,endRow:21,startColumn:3,endColumn:6},{startRow:13,endRow:15,startColumn:9,endColumn:10},{startRow:24,endRow:27,startColumn:9,endColumn:10}],rowData:{3:{h:50,hd:Sh.FALSE},4:{h:60,hd:Sh.FALSE},29:{h:200,hd:Sh.FALSE}},columnData:{5:{w:100,hd:Sh.FALSE},6:{w:200,hd:Sh.FALSE},13:{w:300,hd:Sh.FALSE}},status:1,showGridlines:1,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:Sh.FALSE},columnTitle:{height:20,hidden:Sh.FALSE},selections:["A2"],rightToLeft:Sh.FALSE,pluginMeta:{}},"sheet-02":{type:xh.GRID,id:"sheet-02",name:"sheet2",cellData:{0:{0:{s:"1",v:1,m:"1"},1:{s:"1",v:1,m:"1"},5:{s:"1",v:8,m:"8"},6:{s:"2",v:8,m:"8"}},20:{0:{v:"sheet2",m:"sheet2"},1:{v:"sheet2 - 2",m:"sheet2 - 2"}}}},"sheet-03":{type:xh.GRID,id:"sheet-03",name:"sheet3"},"sheet-04":{type:xh.GRID,id:"sheet-04",name:"sheet4"},"sheet-05":{type:xh.GRID,id:"sheet-05",name:"sheet5"},"sheet-06":{type:xh.GRID,id:"sheet-06",name:"sheet6"}},namedRanges:[]};var Gp,Xp,$p,jp,Kp,Zp,Qp={},Jp=[],em=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function tm(e,t){for(var n in t)e[n]=t[n];return e}function nm(e){var t=e.parentNode;t&&t.removeChild(e)}function rm(e,t,n){var r,a,i,o={};for(i in t)"key"==i?r=t[i]:"ref"==i?a=t[i]:o[i]=t[i];if(arguments.length>2&&(o.children=arguments.length>3?Gp.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(i in e.defaultProps)void 0===o[i]&&(o[i]=e.defaultProps[i]);return am(e,o,r,a,null)}function am(e,t,n,r,a){var i={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==a?++$p:a};return null==a&&null!=Xp.vnode&&Xp.vnode(i),i}function im(e){return e.children}function om(e,t){this.props=e,this.context=t}function sm(e,t){if(null==t)return e.__?sm(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?sm(e):null}function lm(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return lm(e)}}function cm(e){(!e.__d&&(e.__d=!0)&&jp.push(e)&&!um.__r++||Kp!==Xp.debounceRendering)&&((Kp=Xp.debounceRendering)||setTimeout)(um)}function um(){for(var e;um.__r=jp.length;)e=jp.sort((function(e,t){return e.__v.__b-t.__v.__b})),jp=[],e.some((function(e){var t,n,r,a,i,o;e.__d&&(i=(a=(t=e).__v).__e,(o=t.__P)&&(n=[],(r=tm({},a)).__v=a.__v+1,vm(o,a,r,t.__n,void 0!==o.ownerSVGElement,null!=a.__h?[i]:null,n,null==i?sm(a):i,a.__h),bm(n,a),a.__e!=i&&lm(a)))}))}function hm(e,t,n,r,a,i,o,s,l,c){var u,h,d,p,m,_,g,f=r&&r.__k||Jp,y=f.length;for(n.__k=[],u=0;u<t.length;u++)if(null!=(p=n.__k[u]=null==(p=t[u])||"boolean"==typeof p?null:"string"==typeof p||"number"==typeof p||"bigint"==typeof p?am(null,p,null,null,p):Array.isArray(p)?am(im,{children:p},null,null,null):p.__b>0?am(p.type,p.props,p.key,p.ref?p.ref:null,p.__v):p)){if(p.__=n,p.__b=n.__b+1,null===(d=f[u])||d&&p.key==d.key&&p.type===d.type)f[u]=void 0;else for(h=0;h<y;h++){if((d=f[h])&&p.key==d.key&&p.type===d.type){f[h]=void 0;break}d=null}vm(e,p,d=d||Qp,a,i,o,s,l,c),m=p.__e,(h=p.ref)&&d.ref!=h&&(g||(g=[]),d.ref&&g.push(d.ref,null,p),g.push(h,p.__c||m,p)),null!=m?(null==_&&(_=m),"function"==typeof p.type&&p.__k===d.__k?p.__d=l=dm(p,l,e):l=mm(e,p,d,f,m,l),"function"==typeof n.type&&(n.__d=l)):l&&d.__e==l&&l.parentNode!=e&&(l=sm(d))}for(n.__e=_,u=y;u--;)null!=f[u]&&Tm(f[u],f[u]);if(g)for(u=0;u<g.length;u++)wm(g[u],g[++u],g[++u])}function dm(e,t,n){for(var r,a=e.__k,i=0;a&&i<a.length;i++)(r=a[i])&&(r.__=e,t="function"==typeof r.type?dm(r,t,n):mm(n,r,r,a,r.__e,t));return t}function pm(e,t){return t=t||[],null==e||"boolean"==typeof e||(Array.isArray(e)?e.some((function(e){pm(e,t)})):t.push(e)),t}function mm(e,t,n,r,a,i){var o,s,l;if(void 0!==t.__d)o=t.__d,t.__d=void 0;else if(null==n||a!=i||null==a.parentNode)e:if(null==i||i.parentNode!==e)e.appendChild(a),o=null;else{for(s=i,l=0;(s=s.nextSibling)&&l<r.length;l+=2)if(s==a)break e;e.insertBefore(a,i),o=i}return void 0!==o?o:a.nextSibling}function _m(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||em.test(t)?n:n+"px"}function gm(e,t,n,r,a){var i;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||_m(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||_m(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])i=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+i]=n,n?r||e.addEventListener(t,i?ym:fm,i):e.removeEventListener(t,i?ym:fm,i);else if("dangerouslySetInnerHTML"!==t){if(a)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&-1==t.indexOf("-")?e.removeAttribute(t):e.setAttribute(t,n))}}function fm(e){this.l[e.type+!1](Xp.event?Xp.event(e):e)}function ym(e){this.l[e.type+!0](Xp.event?Xp.event(e):e)}function vm(e,t,n,r,a,i,o,s,l){var c,u,h,d,p,m,_,g,f,y,v,b,x,w,T,C=t.type;if(void 0!==t.constructor)return null;null!=n.__h&&(l=n.__h,s=t.__e=n.__e,t.__h=null,i=[s]),(c=Xp.__b)&&c(t);try{e:if("function"==typeof C){if(g=t.props,f=(c=C.contextType)&&r[c.__c],y=c?f?f.props.value:c.__:r,n.__c?_=(u=t.__c=n.__c).__=u.__E:("prototype"in C&&C.prototype.render?t.__c=u=new C(g,y):(t.__c=u=new om(g,y),u.constructor=C,u.render=Cm),f&&f.sub(u),u.props=g,u.state||(u.state={}),u.context=y,u.__n=r,h=u.__d=!0,u.__h=[],u._sb=[]),null==u.__s&&(u.__s=u.state),null!=C.getDerivedStateFromProps&&(u.__s==u.state&&(u.__s=tm({},u.__s)),tm(u.__s,C.getDerivedStateFromProps(g,u.__s))),d=u.props,p=u.state,h)null==C.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),null!=u.componentDidMount&&u.__h.push(u.componentDidMount);else{if(null==C.getDerivedStateFromProps&&g!==d&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(g,y),!u.__e&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(g,u.__s,y)||t.__v===n.__v){for(u.props=g,u.state=u.__s,t.__v!==n.__v&&(u.__d=!1),u.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),v=0;v<u._sb.length;v++)u.__h.push(u._sb[v]);u._sb=[],u.__h.length&&o.push(u);break e}null!=u.componentWillUpdate&&u.componentWillUpdate(g,u.__s,y),null!=u.componentDidUpdate&&u.__h.push((function(){u.componentDidUpdate(d,p,m)}))}if(u.context=y,u.props=g,u.__v=t,u.__P=e,b=Xp.__r,x=0,"prototype"in C&&C.prototype.render){for(u.state=u.__s,u.__d=!1,b&&b(t),c=u.render(u.props,u.state,u.context),w=0;w<u._sb.length;w++)u.__h.push(u._sb[w]);u._sb=[]}else do{u.__d=!1,b&&b(t),c=u.render(u.props,u.state,u.context),u.state=u.__s}while(u.__d&&++x<25);u.state=u.__s,null!=u.getChildContext&&(r=tm(tm({},r),u.getChildContext())),h||null==u.getSnapshotBeforeUpdate||(m=u.getSnapshotBeforeUpdate(d,p)),T=null!=c&&c.type===im&&null==c.key?c.props.children:c,hm(e,Array.isArray(T)?T:[T],t,n,r,a,i,o,s,l),u.base=t.__e,t.__h=null,u.__h.length&&o.push(u),_&&(u.__E=u.__=null),u.__e=!1}else null==i&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=xm(n.__e,t,n,r,a,i,o,l);(c=Xp.diffed)&&c(t)}catch(e){t.__v=null,(l||null!=i)&&(t.__e=s,t.__h=!!l,i[i.indexOf(s)]=null),Xp.__e(e,t,n)}}function bm(e,t){Xp.__c&&Xp.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){Xp.__e(e,t.__v)}}))}function xm(e,t,n,r,a,i,o,s){var l,c,u,h=n.props,d=t.props,p=t.type,m=0;if("svg"===p&&(a=!0),null!=i)for(;m<i.length;m++)if((l=i[m])&&"setAttribute"in l==!!p&&(p?l.localName===p:3===l.nodeType)){e=l,i[m]=null;break}if(null==e){if(null===p)return document.createTextNode(d);e=a?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p,d.is&&d),i=null,s=!1}if(null===p)h===d||s&&e.data===d||(e.data=d);else{if(i=i&&Gp.call(e.childNodes),c=(h=n.props||Qp).dangerouslySetInnerHTML,u=d.dangerouslySetInnerHTML,!s){if(null!=i)for(h={},m=0;m<e.attributes.length;m++)h[e.attributes[m].name]=e.attributes[m].value;(u||c)&&(u&&(c&&u.__html==c.__html||u.__html===e.innerHTML)||(e.innerHTML=u&&u.__html||""))}if(function(e,t,n,r,a){var i;for(i in n)"children"===i||"key"===i||i in t||gm(e,i,null,n[i],r);for(i in t)a&&"function"!=typeof t[i]||"children"===i||"key"===i||"value"===i||"checked"===i||n[i]===t[i]||gm(e,i,t[i],n[i],r)}(e,d,h,a,s),u)t.__k=[];else if(m=t.props.children,hm(e,Array.isArray(m)?m:[m],t,n,r,a&&"foreignObject"!==p,i,o,i?i[0]:n.__k&&sm(n,0),s),null!=i)for(m=i.length;m--;)null!=i[m]&&nm(i[m]);s||("value"in d&&void 0!==(m=d.value)&&(m!==e.value||"progress"===p&&!m||"option"===p&&m!==h.value)&&gm(e,"value",m,h.value,!1),"checked"in d&&void 0!==(m=d.checked)&&m!==e.checked&&gm(e,"checked",m,h.checked,!1))}return e}function wm(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){Xp.__e(e,n)}}function Tm(e,t,n){var r,a;if(Xp.unmount&&Xp.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||wm(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){Xp.__e(e,t)}r.base=r.__P=null,e.__c=void 0}if(r=e.__k)for(a=0;a<r.length;a++)r[a]&&Tm(r[a],t,n||"function"!=typeof e.type);n||null==e.__e||nm(e.__e),e.__=e.__e=e.__d=void 0}function Cm(e,t,n){return this.constructor(e,n)}function Em(e,t,n){var r,a,i;Xp.__&&Xp.__(e,t),a=(r="function"==typeof n)?null:n&&n.__k||t.__k,i=[],vm(t,e=(!r&&n||t).__k=rm(im,null,[e]),a||Qp,Qp,void 0!==t.ownerSVGElement,!r&&n?[n]:a?null:t.firstChild?Gp.call(t.childNodes):null,i,!r&&n?n:a?a.__e:t.firstChild,r),bm(i,e)}function Am(e,t,n){var r,a,i,o=tm({},e.props);for(i in t)"key"==i?r=t[i]:"ref"==i?a=t[i]:o[i]=t[i];return arguments.length>2&&(o.children=arguments.length>3?Gp.call(arguments,2):n),am(e.type,o,r||e.key,a||e.ref,null)}function Sm(e,t){var n={__c:t="__cC"+Zp++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,r;return this.getChildContext||(n=[],(r={})[t]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&n.some(cm)},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Provider.__=n.Consumer.contextType=n}function Dm(){return(Dm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Rm(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(n=i[r])>=0||(a[n]=e[n]);return a}function Nm(t){var n=(0,e.useRef)(t),r=(0,e.useRef)((function(e){n.current&&n.current(e)}));return n.current=t,r.current}Gp=Jp.slice,Xp={__e:function(e,t,n,r){for(var a,i,o;t=t.__;)if((a=t.__c)&&!a.__)try{if((i=a.constructor)&&null!=i.getDerivedStateFromError&&(a.setState(i.getDerivedStateFromError(e)),o=a.__d),null!=a.componentDidCatch&&(a.componentDidCatch(e,r||{}),o=a.__d),o)return a.__E=a}catch(t){e=t}throw e}},$p=0,om.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=tm({},this.state),"function"==typeof e&&(e=e(tm({},n),this.props)),e&&tm(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),cm(this))},om.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),cm(this))},om.prototype.render=im,jp=[],um.__r=0,Zp=0;var Mm=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),e>n?n:e<t?t:e},Om=function(e){return"touches"in e},km=function(e){return e&&e.ownerDocument.defaultView||self},Im=function(e,t,n){var r=e.getBoundingClientRect(),a=Om(t)?function(e,t){for(var n=0;n<e.length;n++)if(e[n].identifier===t)return e[n];return e[0]}(t.touches,n):t;return{left:Mm((a.pageX-(r.left+km(e).pageXOffset))/r.width),top:Mm((a.pageY-(r.top+km(e).pageYOffset))/r.height)}},Pm=function(e){!Om(e)&&e.preventDefault()},Lm=e.memo((function(t){var n=t.onMove,r=t.onKey,a=Rm(t,["onMove","onKey"]),i=(0,e.useRef)(null),o=Nm(n),s=Nm(r),l=(0,e.useRef)(null),c=(0,e.useRef)(!1),u=(0,e.useMemo)((function(){var e=function(e){Pm(e),(Om(e)?e.touches.length>0:e.buttons>0)&&i.current?o(Im(i.current,e,l.current)):n(!1)},t=function(){return n(!1)};function n(n){var r=c.current,a=km(i.current),o=n?a.addEventListener:a.removeEventListener;o(r?"touchmove":"mousemove",e),o(r?"touchend":"mouseup",t)}return[function(e){var t=e.nativeEvent,r=i.current;if(r&&(Pm(t),!function(e,t){return t&&!Om(e)}(t,c.current)&&r)){if(Om(t)){c.current=!0;var a=t.changedTouches||[];a.length&&(l.current=a[0].identifier)}r.focus(),o(Im(r,t,l.current)),n(!0)}},function(e){var t=e.which||e.keyCode;t<37||t>40||(e.preventDefault(),s({left:39===t?.05:37===t?-.05:0,top:40===t?.05:38===t?-.05:0}))},n]}),[s,o]),h=u[0],d=u[1],p=u[2];return(0,e.useEffect)((function(){return p}),[p]),e.createElement("div",Dm({},a,{onTouchStart:h,onMouseDown:h,className:"react-colorful__interactive",ref:i,onKeyDown:d,tabIndex:0,role:"slider"}))})),Bm=function(e){return e.filter(Boolean).join(" ")},Fm=function(t){var n=t.color,r=t.left,a=t.top,i=void 0===a?.5:a,o=Bm(["react-colorful__pointer",t.className]);return e.createElement("div",{className:o,style:{top:100*i+"%",left:100*r+"%"}},e.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:n}}))},Hm=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=Math.pow(10,t)),Math.round(n*e)/n},qm=(Math.PI,function(e){var t=e.s,n=e.v,r=e.a,a=(200-t)*n/100;return{h:Hm(e.h),s:Hm(a>0&&a<200?t*n/100/(a<=100?a:200-a)*100:0),l:Hm(a/2),a:Hm(r,2)}}),Um=function(e){var t=qm(e);return"hsl("+t.h+", "+t.s+"%, "+t.l+"%)"},Vm=function(e){var t=qm(e);return"hsla("+t.h+", "+t.s+"%, "+t.l+"%, "+t.a+")"},Wm=function(e){var t=e.h,n=e.s,r=e.v,a=e.a;t=t/360*6,n/=100,r/=100;var i=Math.floor(t),o=r*(1-n),s=r*(1-(t-i)*n),l=r*(1-(1-t+i)*n),c=i%6;return{r:Hm(255*[r,s,o,o,l,r][c]),g:Hm(255*[l,r,r,s,o,o][c]),b:Hm(255*[o,o,l,r,r,s][c]),a:Hm(a,2)}},zm=function(e){var t=/rgba?\(?\s*(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i.exec(e);return t?Ym({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):{h:0,s:0,v:0,a:1}},Ym=function(e){var t=e.r,n=e.g,r=e.b,a=e.a,i=Math.max(t,n,r),o=i-Math.min(t,n,r),s=o?i===t?(n-r)/o:i===n?2+(r-t)/o:4+(t-n)/o:0;return{h:Hm(60*(s<0?s+6:s)),s:Hm(i?o/i*100:0),v:Hm(i/255*100),a}},Gm=e.memo((function(t){var n=t.hue,r=t.onChange,a=Bm(["react-colorful__hue",t.className]);return e.createElement("div",{className:a},e.createElement(Lm,{onMove:function(e){r({h:360*e.left})},onKey:function(e){r({h:Mm(n+360*e.left,0,360)})},"aria-label":"Hue","aria-valuenow":Hm(n),"aria-valuemax":"360","aria-valuemin":"0"},e.createElement(Fm,{className:"react-colorful__hue-pointer",left:n/360,color:Um({h:n,s:100,v:100,a:1})})))})),Xm=e.memo((function(t){var n=t.hsva,r=t.onChange,a={backgroundColor:Um({h:n.h,s:100,v:100,a:1})};return e.createElement("div",{className:"react-colorful__saturation",style:a},e.createElement(Lm,{onMove:function(e){r({s:100*e.left,v:100-100*e.top})},onKey:function(e){r({s:Mm(n.s+100*e.left,0,100),v:Mm(n.v-100*e.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+Hm(n.s)+"%, Brightness "+Hm(n.v)+"%"},e.createElement(Fm,{className:"react-colorful__saturation-pointer",top:1-n.v/100,left:n.s/100,color:Um(n)})))})),$m=function(e,t){if(e===t)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0},jm=function(e,t){return e.replace(/\s/g,"")===t.replace(/\s/g,"")};function Km(t,n,r){var a=Nm(r),i=(0,e.useState)((function(){return t.toHsva(n)})),o=i[0],s=i[1],l=(0,e.useRef)({color:n,hsva:o});(0,e.useEffect)((function(){if(!t.equal(n,l.current.color)){var e=t.toHsva(n);l.current={hsva:e,color:n},s(e)}}),[n,t]),(0,e.useEffect)((function(){var e;$m(o,l.current.hsva)||t.equal(e=t.fromHsva(o),l.current.color)||(l.current={hsva:o,color:e},a(e))}),[o,t,a]);var c=(0,e.useCallback)((function(e){s((function(t){return Object.assign({},t,e)}))}),[]);return[o,c]}var Zm,Qm="undefined"!=typeof window?e.useLayoutEffect:e.useEffect,Jm=new Map,e_=function(e){Qm((function(){var t=e.current?e.current.ownerDocument:document;if(void 0!==t&&!Jm.has(t)){var r=t.createElement("style");r.innerHTML='.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>\')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}',Jm.set(t,r);var a=Zm||n.nc;a&&r.setAttribute("nonce",a),t.head.appendChild(r)}}),[])},t_=function(t){var n=t.className,r=t.hsva,a=t.onChange,i={backgroundImage:"linear-gradient(90deg, "+Vm(Object.assign({},r,{a:0}))+", "+Vm(Object.assign({},r,{a:1}))+")"},o=Bm(["react-colorful__alpha",n]),s=Hm(100*r.a);return e.createElement("div",{className:o},e.createElement("div",{className:"react-colorful__alpha-gradient",style:i}),e.createElement(Lm,{onMove:function(e){a({a:e.left})},onKey:function(e){a({a:Mm(r.a+e.left)})},"aria-label":"Alpha","aria-valuetext":s+"%","aria-valuenow":s,"aria-valuemin":"0","aria-valuemax":"100"},e.createElement(Fm,{className:"react-colorful__alpha-pointer",left:r.a,color:Vm(r)})))},n_=function(t){var n=t.className,r=t.colorModel,a=t.color,i=void 0===a?r.defaultColor:a,o=t.onChange,s=Rm(t,["className","colorModel","color","onChange"]),l=(0,e.useRef)(null);e_(l);var c=Km(r,i,o),u=c[0],h=c[1],d=Bm(["react-colorful",n]);return e.createElement("div",Dm({},s,{ref:l,className:d}),e.createElement(Xm,{hsva:u,onChange:h}),e.createElement(Gm,{hue:u.h,onChange:h}),e.createElement(t_,{hsva:u,onChange:h,className:"react-colorful__last-control"}))},r_={defaultColor:"rgba(0, 0, 0, 1)",toHsva:zm,fromHsva:function(e){var t=Wm(e);return"rgba("+t.r+", "+t.g+", "+t.b+", "+t.a+")"},equal:jm},a_=function(t){return e.createElement(n_,Dm({},t,{colorModel:r_}))},i_=/^#?([0-9A-F]{3,8})$/i,o_=function(t){var n=t.color,r=void 0===n?"":n,a=t.onChange,i=t.onBlur,o=t.escape,s=t.validate,l=t.format,c=t.process,u=Rm(t,["color","onChange","onBlur","escape","validate","format","process"]),h=(0,e.useState)((function(){return o(r)})),d=h[0],p=h[1],m=Nm(a),_=Nm(i),g=(0,e.useCallback)((function(e){var t=o(e.target.value);p(t),s(t)&&m(c?c(t):t)}),[o,c,s,m]),f=(0,e.useCallback)((function(e){s(e.target.value)||p(o(r)),_(e)}),[r,o,s,_]);return(0,e.useEffect)((function(){p(o(r))}),[r,o]),e.createElement("input",Dm({},u,{value:l?l(d):d,spellCheck:"false",onChange:g,onBlur:f}))},s_=function(e){return"#"+e},l_=function(t){var n=t.prefixed,r=t.alpha,a=Rm(t,["prefixed","alpha"]),i=(0,e.useCallback)((function(e){return e.replace(/([^0-9A-F]+)/gi,"").substring(0,r?8:6)}),[r]),o=(0,e.useCallback)((function(e){return function(e,t){var n=i_.exec(e),r=n?n[1].length:0;return 3===r||6===r||!!t&&4===r||!!t&&8===r}(e,r)}),[r]);return e.createElement(o_,Dm({},a,{escape:i,format:n?s_:void 0,process:s_,validate:o}))};const c_=Sm({});var u_,h_,d_,p_=(e=>(e.INPUT="input",e.COLOR="color",e.DOUBLE="double",e.JSX="jsx",e.INPUT_NUMBER="inputNumber",e))(p_||{}),m_=[],__=[],g_=Xp.__b,f_=Xp.__r,y_=Xp.diffed,v_=Xp.__c,b_=Xp.unmount;function x_(){for(var e;e=m_.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(C_),e.__H.__h.forEach(E_),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),u_=null,g_&&g_(e)},Xp.__r=function(e){f_&&f_(e);var t=(u_=e.__c).__H;t&&(h_===u_?(t.__h=[],u_.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=__,e.__N=e.i=void 0}))):(t.__h.forEach(C_),t.__h.forEach(E_),t.__h=[])),h_=u_},Xp.diffed=function(e){y_&&y_(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==m_.push(t)&&d_===Xp.requestAnimationFrame||((d_=Xp.requestAnimationFrame)||T_)(x_)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==__&&(e.__=e.__V),e.i=void 0,e.__V=__}))),h_=u_=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(C_),e.__h=e.__h.filter((function(e){return!e.__||E_(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),v_&&v_(e,t)},Xp.unmount=function(e){b_&&b_(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{C_(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var w_="function"==typeof requestAnimationFrame;function T_(e){var t,n=function(){clearTimeout(r),w_&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);w_&&(t=requestAnimationFrame(n))}function C_(e){var t=u_,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),u_=t}function E_(e){var t=u_;e.__c=e.__(),u_=t}function A_(e,t){for(var n in t)e[n]=t[n];return e}function S_(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function D_(e){this.props=e}(D_.prototype=new om).isPureReactComponent=!0,D_.prototype.shouldComponentUpdate=function(e,t){return S_(this.props,e)||S_(this.state,t)};var R_=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),R_&&R_(e)};var N_="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function M_(e){function t(t){var n=A_({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=N_,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var O_=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);O_(e,t,n,r)};var k_=Xp.unmount;function I_(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=A_({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return I_(e,t,n)}))),e}function P_(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return P_(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function L_(){this.__u=0,this.t=null,this.__b=null}function B_(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function F_(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),k_&&k_(e)},(L_.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=B_(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=P_(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},L_.prototype.componentWillUnmount=function(){this.t=[]},L_.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=I_(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var H_=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(F_.prototype=new om).__a=function(e){var t=this,n=B_(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),H_(t,e,r)):a()};n?n(i):i()}},F_.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},F_.prototype.componentDidUpdate=F_.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){H_(e,n,t)}))};var q_="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,U_=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,V_="undefined"!=typeof document,W_=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var z_=Xp.event;function Y_(){}function G_(){return this.cancelBubble}function X_(){return this.defaultPrevented}Xp.event=function(e){return z_&&(e=z_(e)),e.persist=Y_,e.isPropagationStopped=G_,e.isDefaultPrevented=X_,e.nativeEvent=e};var $_={configurable:!0,get:function(){return this.class}},j_=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];V_&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!W_(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&U_.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&($_.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",$_))}e.$$typeof=q_,j_&&j_(e)};var K_=Xp.__r;Xp.__r=function(e){K_&&K_(e),e.__c};class Z_ extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}Z_.contextType=c_;function Q_(e){return(e=e?`${e}-`:"")+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(2,10)}function J_(...e){if(!e.length)return;let t="";return e.forEach((e=>{if(e instanceof Object)for(let n in e)e[n]&&(t+=` ${n}`);else t+=` ${e}`})),t}(class extends D_{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=c_;function eg(e,t){let n=null;return function(...r){clearTimeout(n),n=setTimeout((()=>{e(...r)}),t)}}const tg="rgb(0,0,0)";var ng=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(ng||{});class rg{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return rg.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new rg(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new rg(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new rg(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new rg(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new rg(this.x*e,this.y*t)}divide(e){return new rg(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new rg(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new rg(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new rg(Math.floor(this.x),Math.floor(this.y))}fract(){return new rg(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=rg.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return rg.NormalizeToRef(this,this),this}clone(){return new rg(this.x,this.y)}static Zero(){return new rg(0,0)}static One(){return new rg(1,1)}static FromArray(e,t=0){return new rg(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new rg(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new rg(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new rg(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=rg.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new rg(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=rg.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new rg(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new rg(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new rg(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new rg(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(rg.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return rg.CenterToRef(e,t,rg.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=rg.DistanceSquared(t,n);if(0===r)return rg.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,rg.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return rg.Distance(e,o)}static create(e,t){return new rg(e,t)}}function ag(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===ng.TOP?(r=s,a=l,i=c,o=l):t===ng.BOTTOM?(r=s,a=u,i=c,o=u):t===ng.LEFT?(r=s,a=l,i=s,o=u):t===ng.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function ig(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function og(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function sg(e,t,n,r,a=rg.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new rg(0,0),new rg(1,1);const lg="rgb(",cg=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${lg+e.join(",")})`:"rgb(0,0,0)";function ug(e,t){return Math.round(e*t)/t}function hg(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class dg{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return hg(e)}}const pg=Ss.create(),mg=Ss.create(),_g=Ss.create(),gg=Ss.create();class fg extends dg{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}gg.add(new class extends fg{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=rg.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||tg;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});gg.add(new class extends fg{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=rg.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});gg.add(new class extends fg{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=hg(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=rg.create(0,0),centerPoint:f=rg.create(0,0),alignOffset:y=rg.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||tg;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=ug(o+1-.5,d),i=sg(g.addByPoint(l,a),f,b,x,y),s=sg(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||tg;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=ug(h-.5,d),i=sg(g.addByPoint(l,a),f,b,x,y),o=sg(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||tg;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=ug(-1.5,d),i=sg(g.addByPoint(l,a),f,b,x,y),o=sg(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});gg.add(new class extends fg{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=rg.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||tg;r!==this._preBorderStyle&&(ig(e,r),e.lineWidth=og(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||tg,this._preBorderColor=i),ag(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(ng.TOP,t),n&&i.set(ng.BOTTOM,n),r&&i.set(ng.LEFT,r),a&&i.set(ng.RIGHT,a),i}});class yg extends dg{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}pg.add(new class extends yg{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||cg([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=ug(a,p),o=ug(o,p),s=ug(s,d),c=ug(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});pg.add(new class extends yg{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=ug(i,_),s=ug(s,_),c=ug(c,m),h=ug(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(ig(e,u),e.lineWidth=og(u)/g,f=u),d!==y&&(e.strokeStyle=d||tg,y=d),ag(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===ng.TOP||t===ng.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===ng.LEFT&&e>r&&e<=i||t===ng.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});pg.add(new class extends yg{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=cg([217,217,217]);let y=ug(m,f),v=ug(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=ug(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=ug(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=ug(n[o-1]||0,t),h=ug(n[s],t),d=ug(r[l-1]||0,t),p=ug(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});pg.add(new class extends yg{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=ug(o,g),c=ug(c,g),h=ug(h,_),p=ug(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=ug(o[t-1]||0,i),c=ug(o[n],i),u=ug(s[r-1]||0,i),h=ug(s[a],i);e.rect(u,l,h-u,c-l)}});mg.add(new class extends yg{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=cg([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=cg([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=cg([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=ug(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(ug(a,m),0),e.lineTo(ug(a,m),p),e.stroke()}});_g.add(new class extends yg{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=cg([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=cg([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=cg([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=ug(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=ug(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var vg="univer-icon";const bg=e=>{const{spin:t,rotate:n,children:r,name:a,style:i,className:o}=e;let s;i?(s=i,s.transform=n?`rotate(${n}deg)`:""):s=n?{transform:`rotate(${n}deg)`}:{};return rm("span",{role:"img",className:J_(vg,{[`${vg}-${a}`]:a,[`${vg}-spin`]:t||"loading"===a},o),style:{...s}},r)},xg=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"loading",style:e.style},rm("svg",{viewBox:"0 0 1024 1024",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 0 0-94.3-139.9 437.71 437.71 0 0 0-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"})));class wg{render(){return xg}}const Tg=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"logo",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 4864 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8477",fill:"currentColor"},rm("path",{d:"M1023.168 131.36c0 234.4-190.016 424.416-424.416 424.416 0-234.4 190.016-424.416 424.416-424.416zM131.36 1023.168c0-234.4 190.016-424.416 424.416-424.416 0 234.4-190.016 424.416-424.416 424.416zM929.696 929.696c-182.784 0-330.944-148.16-330.944-330.944 182.752 0 330.944 148.16 330.944 330.944z",fill:"#2D7FF9","p-id":"8478"}),rm("path",{d:"M494.848 0H0v494.848h494.848z",fill:"#2D7FF9",opacity:".503","p-id":"8479"}),rm("path",{d:"M558.016 81.376H81.376v476.64h476.64z",fill:"#2D7FF9",opacity:".551","p-id":"8480"}),rm("path",{d:"M558.304 164.416H164.384v393.92h393.92z",fill:"#2D7FF9",opacity:".805","p-id":"8481"}),rm("path",{d:"M1678.08 736v-64h-247.04V279.04H1356.8V736h321.28z m177.568 8.96c40.96 0 75.52-17.28 103.68-51.84V736h72.96V405.12h-72.96v202.24c-6.4 23.68-17.28 42.24-32 56.32-14.72 13.44-30.08 20.48-46.08 20.48-25.6 0-43.52-6.4-55.04-18.56-11.52-12.8-16.64-32-16.64-58.88v-201.6h-72.96v206.08c0 88.96 39.68 133.76 119.04 133.76z m407.936 0c42.88 0 77.44-10.88 103.04-32 26.24-21.76 43.52-55.04 51.2-99.84h-72.32c-5.76 48-32.64 72.32-81.28 72.32-28.16 0-49.28-10.24-63.36-30.08-15.36-20.48-22.4-49.28-22.4-85.76 0-35.84 7.68-64 23.04-83.84 15.36-20.48 36.48-30.08 63.36-30.08 21.76 0 39.68 5.12 53.12 15.36 12.8 10.24 21.76 25.6 26.24 46.72h72.32c-6.4-41.6-23.04-72.32-49.28-92.8-25.6-19.2-59.52-28.8-102.4-28.8-51.84 0-92.16 17.28-120.96 51.84-26.88 31.36-40.32 72.32-40.32 122.24 0 51.2 13.44 92.8 40.96 124.8 28.16 33.28 67.84 49.92 119.04 49.92z m292.128-8.96v-115.84l33.28-31.36 115.84 147.2h93.44l-159.36-193.92 146.56-136.96h-94.08l-135.68 131.2V270.08h-72.96V736h72.96z m404.096 126.72l179.2-457.6h-79.36l-83.84 235.52-87.68-235.52h-79.36l131.2 323.2-58.24 134.4h78.08z m357.408-117.76c99.2 0 149.12-35.2 149.12-105.6 0-29.44-13.44-53.12-39.68-69.76-17.92-12.16-46.08-22.4-83.2-31.36-33.28-8.32-55.04-14.72-65.92-19.2-17.92-7.68-26.24-17.28-26.24-27.52 0-12.8 5.12-21.76 16.64-27.52 9.6-5.76 24.32-8.32 43.52-8.32 22.4 0 39.04 3.2 49.92 10.24 10.24 6.4 17.92 18.56 23.04 35.2h71.04c-7.68-70.4-55.68-104.96-142.72-104.96-40.96 0-73.6 8.32-98.56 26.24-25.6 16.64-37.76 40.32-37.76 71.04 0 28.8 12.8 51.2 38.4 67.2 16 10.24 43.52 19.84 82.56 28.8 33.28 7.68 55.04 13.44 65.28 18.56 19.2 8.96 28.8 21.12 28.8 36.48 0 26.88-25.6 40.96-76.8 40.96-24.32 0-41.6-4.48-52.48-12.16-10.88-8.96-18.56-23.68-22.4-44.8h-71.04c7.04 77.44 56.32 116.48 148.48 116.48z m286.976-8.96v-184.96c0-28.16 6.4-50.56 19.84-68.48 12.8-17.92 30.72-26.88 53.76-26.88 24.96 0 43.52 7.68 56.32 23.68 10.88 14.72 16.64 36.48 16.64 64.64v192h72.96v-204.8c0-44.16-9.6-77.44-28.16-99.84-19.84-23.68-49.92-35.2-90.24-35.2-21.12 0-39.68 3.84-55.68 12.16-17.92 8.96-33.28 22.4-45.44 40.96v-179.2h-72.96V736h72.96z m447.648 8.96c44.16 0 80.64-12.8 110.08-37.76 23.04-20.48 38.4-46.72 46.08-77.44h-72.96c-8.96 18.56-18.56 32-29.44 40.32-14.08 10.24-32 15.36-54.4 15.36-26.24 0-46.72-8.32-60.8-24.32-14.08-16-22.4-39.68-24.96-70.4h247.68c0-59.52-13.44-106.24-39.68-139.52-28.8-37.12-70.4-55.04-124.8-55.04-49.28 0-88.32 16.64-116.48 50.56-29.44 33.28-43.52 74.24-43.52 123.52 0 55.04 15.36 97.92 46.08 129.28 28.8 30.08 67.84 45.44 117.12 45.44z m85.12-209.28h-170.24c4.48-26.24 13.44-46.08 26.88-59.52 14.08-14.08 32.64-20.48 56.96-20.48 51.2 0 80 26.24 86.4 80z m285.088 209.28c44.16 0 80.64-12.8 110.08-37.76 23.04-20.48 38.4-46.72 46.08-77.44h-72.96c-8.96 18.56-18.56 32-29.44 40.32-14.08 10.24-32 15.36-54.4 15.36-26.24 0-46.72-8.32-60.8-24.32-14.08-16-22.4-39.68-24.96-70.4h247.68c0-59.52-13.44-106.24-39.68-139.52-28.8-37.12-70.4-55.04-124.8-55.04-49.28 0-88.32 16.64-116.48 50.56-29.44 33.28-43.52 74.24-43.52 123.52 0 55.04 15.36 97.92 46.08 129.28 28.8 30.08 67.84 45.44 117.12 45.44z m85.12-209.28h-170.24c4.48-26.24 13.44-46.08 26.88-59.52 14.08-14.08 32.64-20.48 56.96-20.48 51.2 0 80 26.24 86.4 80z m310.016 200.32v-60.16h-43.52c-7.68 0-12.8-1.92-16.64-5.76-3.84-4.48-5.12-10.24-5.12-17.92v-186.88h73.6v-60.16h-73.6V298.24l-72.96 30.08v76.8h-59.52v60.16h59.52v186.88c0 26.88 6.4 46.72 19.2 60.8 13.44 15.36 34.56 23.04 63.36 23.04h55.68z",fill:"#7C838C","p-id":"8482"})));class Cg{render(){return Tg}}const Eg=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6466",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M533.333333 789.333333m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6467"}),rm("path",{d:"M682.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0V640a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 1 1-85.333333 0V640a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6468"}),rm("path",{d:"M367.829333 799.701333l90.538667-90.538666L367.786667 618.666667l-30.165334 30.165333 37.76 37.802667H256v42.666666h121.898667l-40.234667 40.234667 30.165333 30.165333z","p-id":"6469"}),rm("path",{d:"M490.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 1 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667zM682.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6470"}),rm("path",{d:"M341.333333 448m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6471"}))),Ag=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6336",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M533.333333 448m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6337"}),rm("path",{d:"M341.333333 789.333333m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6338"}),rm("path",{d:"M346.496 394.368L256 303.786667 346.496 213.333333l30.165333 30.165334-37.717333 37.802666h119.424v42.666667H336.469333l40.192 40.234667-30.165333 30.165333z","p-id":"6339"}),rm("path",{d:"M682.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667zM490.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0v-85.333333a42.666667 42.666667 0 0 1 42.666667-42.666667zM682.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0v-85.333333a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6340"}))),Sg=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6209",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M653.525333 213.333333l36.949334 21.333334-320 554.24-36.949334-21.333334L653.525333 213.333333zM682.666667 469.333333c71.68 0 128 67.626667 128 149.333334S754.346667 768 682.666667 768s-128-67.626667-128-149.333333 56.32-149.333333 128-149.333334z m0 42.666667c-46.165333 0-85.333333 46.976-85.333334 106.666667s39.168 106.666667 85.333334 106.666666c46.165333 0 85.333333-46.976 85.333333-106.666666s-39.168-106.666667-85.333333-106.666667zM341.333333 234.666667c71.68 0 128 67.626667 128 149.333333s-56.32 149.333333-128 149.333333S213.333333 465.706667 213.333333 384s56.32-149.333333 128-149.333333z m0 42.666666C295.168 277.333333 256 324.309333 256 384s39.168 106.666667 85.333333 106.666667c46.165333 0 85.333333-46.976 85.333334-106.666667s-39.168-106.666667-85.333334-106.666667z","p-id":"6210"}))),Dg=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6082",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M658.816 256l34.986667 24.490667-124.629334 177.92h119.04v42.666666h-149.333333v85.333334h149.333333v42.666666h-149.333333v128h-42.666667v-128h-149.333333v-42.666666h149.333333v-85.333334h-149.333333v-42.666666h119.04L341.333333 280.490667 376.32 256l141.226667 201.728L658.816 256z","p-id":"6083"}))),Rg=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5446",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M771.072 391.253333a6.698667 6.698667 0 0 0-0.512-9.514666 6.997333 6.997333 0 0 0-4.48-1.749334h-61.354667c-1.962667 0-3.84 0.853333-5.12 2.346667l-103.893333 122.709333a6.698667 6.698667 0 0 1-11.392-1.621333l-53.674667-119.381333a6.656 6.656 0 0 0-6.144-4.010667H381.866667l0.853333-3.968 6.741333-35.712c8.874667-46.933333 32.085333-68.864 72.533334-68.864 15.658667 0 29.994667 1.450667 41.258666 4.010667l11.861334-56.490667a197.888 197.888 0 0 0-46.464-5.12c-87.296 0-132.224 37.418667-148.650667 124.458667l-7.978667 41.813333H229.632a6.698667 6.698667 0 0 0-6.613333 5.376l-9.130667 43.818667a6.826667 6.826667 0 0 0 6.570667 8.106666h79.786666l-75.264 363.52a6.826667 6.826667 0 0 0 6.570667 8.234667H287.573333c3.242667 0 5.973333-2.346667 6.570667-5.418667l75.861333-366.165333h114.773334l57.685333 117.546667a6.570667 6.570667 0 0 1-1.024 7.381333l-152.746667 171.690667a6.826667 6.826667 0 0 0 5.12 11.264h61.44c2.005333 0 3.882667-0.853333 5.162667-2.389334l104.576-123.989333a6.826667 6.826667 0 0 1 11.392 1.493333l55.594667 120.661334a6.741333 6.741333 0 0 0 6.186666 3.968h54.613334a6.784 6.784 0 0 0 6.101333-9.770667L618.325333 567.466667a6.698667 6.698667 0 0 1 1.066667-7.466667l151.722667-168.661333-0.042667-0.042667z","p-id":"5447"}))),Ng=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333z","p-id":"5319"}),rm("path",{d:"M554.666667 213.333333v597.333334h-85.333334V213.333333z","p-id":"5320"}))),Mg=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333z","p-id":"5319"})));var Og={AddNumIcon:Eg,ReduceNumIcon:Ag,PercentIcon:Sg,MoneyIcon:Dg,FxIcon:Rg,AddIcon:Ng,ReduceIcon:Mg};class kg{render(){return Eg}}class Ig{render(){return Ag}}class Pg{render(){return Sg}}class Lg{render(){return Dg}}class Bg{render(){return Rg}}class Fg{render(){return Ng}}class Hg{render(){return Mg}}const qg=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M298.666667 213.333333h224a174.208 174.208 0 0 1 141.952 275.242667A174.208 174.208 0 0 1 572.458667 810.666667H298.666667V213.333333z m273.792 348.458667l-174.250667-0.042667v149.333334h174.250667a74.666667 74.666667 0 0 0 6.101333-149.077334l-6.101333-0.213333zM398.208 312.874667v149.333333h124.458667a74.666667 74.666667 0 0 0 6.144-149.077333l-6.144-0.256H398.208z","p-id":"5566"}))),Ug=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M469.333333 256h170.666667v42.666667h-170.666667z","p-id":"5693"}),rm("path",{d:"M573.738667 284.586667l-81.493334 462.208-41.984-7.381334 81.493334-462.208z","p-id":"5694"}),rm("path",{d:"M384 725.333333h170.666667v42.666667H384z","p-id":"5695"}))),Vg=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M298.666667 256h426.666666v42.666667H298.666667z","p-id":"5312"}),rm("path",{d:"M533.290667 554.666667l0.042666 192h-42.666666l-0.042667-192h42.666667z m0.042666-277.333334l-0.042666 234.666667h-42.666667l0.042667-234.666667h42.666666zM320 256v85.333333h-42.666667V256zM746.666667 256v85.333333h-42.666667V256z","p-id":"5313"}),rm("path",{d:"M256 469.333333h512v42.666667H256zM426.666667 725.333333h170.666666v42.666667h-170.666666z","p-id":"5314"}))),Wg=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M362.666667 256v298.666667a149.333333 149.333333 0 0 0 298.453333 8.192L661.333333 554.666667V256h42.666667v298.666667a192 192 0 0 1-383.786667 9.045333L320 554.666667V256h42.666667z","p-id":"5319"}),rm("path",{d:"M256 768m21.333333 0l469.333334 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-469.333334 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5320"}),rm("path",{d:"M256 256m21.333333 0l128 0q21.333333 0 21.333334 21.333333l0 0q0 21.333333-21.333334 21.333334l-128 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5321"}),rm("path",{d:"M597.333333 256m21.333334 0l128 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-128 0q-21.333333 0-21.333334-21.333334l0 0q0-21.333333 21.333334-21.333333Z","p-id":"5322"}))),zg=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5440",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M549.546667 256l194.133333 533.333333h-45.354667l-77.653333-213.333333H421.632l-77.653333 213.333333H298.666667L492.757333 256h56.789334z m-28.416 46.634667L437.162667 533.333333h167.978666l-84.010666-230.698666z","p-id":"5441"})));var Yg={BoldIcon:qg,ItalicIcon:Ug,DeleteLineIcon:Vg,UnderLineIcon:Wg,TextColorIcon:zg};class Gg{render(){return qg}}class Xg{render(){return Ug}}class $g{render(){return Vg}}class jg{render(){return Wg}}class Kg{render(){return zg}}const Zg=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5567",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M730.24 562.176l-253.44 253.44-217.173333-217.258667 253.44-253.44 217.173333 217.258667z m-72.405333-0.042667L512.981333 417.28l-180.992 180.992 144.810667 144.853333 181.034667-181.034666z","p-id":"5568"}),rm("path",{d:"M520.533333 298.666667v230.4H469.333333V349.824H392.533333v179.626667H341.333333V298.666667zM699.733333 554.666667c48.768 0 88.32 37.802667 88.32 84.48 0 46.634667-39.552 84.48-88.32 84.48","p-id":"5569"}))),Qg=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5695",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667zM469.333333 810.666667V256h42.666667v554.666667z","p-id":"5696"}),rm("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 512h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"5697"}))),Jg=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5823",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M213.333333 256h554.666667v42.666667H213.333333z","p-id":"5824"}),rm("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM384 512h42.666667v42.666667H384zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 512h42.666666v42.666667H298.666667z","p-id":"5825"}),rm("path",{d:"M469.333333 512h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"5826"}))),ef=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5952",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M768 810.666667H213.333333v-42.666667h554.666667z","p-id":"5953"}),rm("path",{d:"M768 640h-42.666667v-42.666667h42.666667zM768 469.333333h-42.666667v-42.666666h42.666667zM768 725.333333h-42.666667v-42.666666h42.666667zM768 554.666667h-42.666667v-42.666667h42.666667zM768 384h-42.666667V341.333333h42.666667z","p-id":"5954"}),rm("path",{d:"M512 640h-42.666667v-42.666667h42.666667z","p-id":"5955"}),rm("path",{d:"M256 640H213.333333v-42.666667h42.666667zM256 469.333333H213.333333v-42.666666h42.666667zM256 725.333333H213.333333v-42.666666h42.666667zM256 554.666667H213.333333v-42.666667h42.666667zM256 384H213.333333V341.333333h42.666667zM256 298.666667H213.333333V256h42.666667z","p-id":"5956"}),rm("path",{d:"M512 469.333333h-42.666667v-42.666666h42.666667zM512 725.333333h-42.666667v-42.666666h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM512 384h-42.666667V341.333333h42.666667z","p-id":"5957"}),rm("path",{d:"M768 298.666667h-42.666667V256h42.666667zM597.333333 298.666667h-42.666666V256h42.666666zM426.666667 298.666667H384V256h42.666667zM682.666667 298.666667h-42.666667V256h42.666667zM512 298.666667h-42.666667V256h42.666667zM341.333333 298.666667H298.666667V256h42.666666z","p-id":"5958"}),rm("path",{d:"M597.333333 554.666667h-42.666666v-42.666667h42.666666zM426.666667 554.666667H384v-42.666667h42.666667zM682.666667 554.666667h-42.666667v-42.666667h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM341.333333 554.666667H298.666667v-42.666667h42.666666z","p-id":"5959"}))),tf=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6085",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M213.333333 810.666667V256h42.666667v554.666667z","p-id":"6086"}),rm("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667z","p-id":"6087"}),rm("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6088"}),rm("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6089"}),rm("path",{d:"M384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667z","p-id":"6090"}),rm("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667z","p-id":"6091"}))),nf=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6217",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M768 256v554.666667h-42.666667V256z","p-id":"6218"}),rm("path",{d:"M597.333333 256v42.666667h-42.666666V256zM426.666667 256v42.666667H384V256zM682.666667 256v42.666667h-42.666667V256zM512 256v42.666667h-42.666667V256zM341.333333 256v42.666667H298.666667V256z","p-id":"6219"}),rm("path",{d:"M597.333333 512v42.666667h-42.666666v-42.666667z","p-id":"6220"}),rm("path",{d:"M597.333333 768v42.666667h-42.666666v-42.666667zM426.666667 768v42.666667H384v-42.666667zM682.666667 768v42.666667h-42.666667v-42.666667zM512 768v42.666667h-42.666667v-42.666667zM341.333333 768v42.666667H298.666667v-42.666667zM256 768v42.666667H213.333333v-42.666667z","p-id":"6221"}),rm("path",{d:"M426.666667 512v42.666667H384v-42.666667zM682.666667 512v42.666667h-42.666667v-42.666667zM512 512v42.666667h-42.666667v-42.666667zM341.333333 512v42.666667H298.666667v-42.666667z","p-id":"6222"}),rm("path",{d:"M256 256v42.666667H213.333333V256zM256 426.666667v42.666666H213.333333v-42.666666zM256 597.333333v42.666667H213.333333v-42.666667zM256 341.333333v42.666667H213.333333V341.333333zM256 512v42.666667H213.333333v-42.666667zM256 682.666667v42.666666H213.333333v-42.666666z","p-id":"6223"}),rm("path",{d:"M512 426.666667v42.666666h-42.666667v-42.666666zM512 597.333333v42.666667h-42.666667v-42.666667zM512 341.333333v42.666667h-42.666667V341.333333zM512 512v42.666667h-42.666667v-42.666667zM512 682.666667v42.666666h-42.666667v-42.666666z","p-id":"6224"}))),rf=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6350",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667zM384 554.666667v-42.666667h42.666667v42.666667zM384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667zM213.333333 298.666667V256h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667z","p-id":"6351"}),rm("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM213.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM213.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM213.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM213.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM213.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667zM213.333333 384V341.333333h42.666667v42.666667z","p-id":"6352"}),rm("path",{d:"M469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666zM469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6353"}))),af=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6479",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667z","p-id":"6480"}),rm("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"6481"}),rm("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6482"}),rm("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6483"}))),of=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6609",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6610"}),rm("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6611"}),rm("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6612"}))),sf=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6866",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6867"}),rm("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6868"}))),lf=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6994",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM384 512h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM298.666667 512h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"6995"}),rm("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6996"}))),cf=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7122",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 42.666667H256v512h512V256z","p-id":"7123"}),rm("path",{d:"M389.162667 426.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.802667-37.845333-119.466667 0.042666v-42.666666l121.856-0.042667-40.192-40.192 30.165334-30.165333zM645.162667 426.666667L554.666667 517.162667l90.496 90.538666 30.165333-30.165333-37.76-37.845333 119.466667 0.042666v-42.666666l-121.856-0.042667 40.149333-40.192-30.165333-30.165333z","p-id":"7124"})));var uf={FillColorIcon:Zg,FullBorderIcon:Qg,TopBorderIcon:Jg,BottomBorderIcon:ef,LeftBorderIcon:tf,RightBorderIcon:nf,NoneBorderIcon:rf,OuterBorderIcon:af,InnerBorderIcon:of,StripingBorderIcon:sf,VerticalBorderIcon:lf,MergeIcon:cf};class hf{render(){return Zg}}class df{render(){return Qg}}class pf{render(){return Jg}}class mf{render(){return ef}}class _f{render(){return tf}}class gf{render(){return nf}}class ff{render(){return rf}}class yf{render(){return af}}class vf{render(){return of}}class bf{render(){return sf}}class xf{render(){return lf}}class wf{render(){return cf}}const Tf=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7250",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m0 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7251"}))),Cf=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7377",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666zM341.333333 426.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-106.666666 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666zM341.333333 682.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7378"}))),Ef=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7504",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-213.333333 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7505"}))),Af=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7631",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M298.666667 384h426.666666v42.666667H298.666667zM416 527.829333l90.496-90.496 90.538667 90.496-30.165334 30.165334-37.802666-37.717334v290.090667h-42.666667v-292.565333l-40.234667 40.192-30.165333-30.165334z","p-id":"7632"}))),Sf=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7758",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M725.333333 533.333333H298.666667v-42.666666h426.666666zM426.666667 634.496l90.496-90.496 90.538666 90.496-30.165333 30.165333-39.936-39.850666v121.557333h-42.666667v-119.765333l-38.101333 38.058666-30.165333-30.165333zM426.666667 389.162667l90.496 90.538666 90.538666-90.538666-30.165333-30.165334-39.936 39.893334V277.333333h-42.666667v119.765334l-38.101333-38.101334-30.165333 30.165334z","p-id":"7759"}))),Df=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7885",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M725.333333 725.333333H298.666667v-42.666666h426.666666zM608 581.504l-90.496 90.496-90.538667-90.496 30.165334-30.165333 37.802666 37.717333V298.965333h42.666667v292.565334l40.234667-40.192 30.165333 30.165333z","p-id":"7886"}))),Rf=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8217",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M549.546667 213.333333l77.653333 213.333334h0.64l-0.042667 1.621333 53.76 147.712h-45.354666l-38.826667-106.666667h-152.405333l-38.826667 106.666667H360.789333l53.674667-147.498667 0.042667-1.834666h0.64l77.610666-213.333334h56.789334z m-28.416 46.634667L460.458667 426.666667h121.386666l-60.714666-166.698667zM709.162667 618.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.76-37.802667H256v-42.666666h463.232l-40.234667-40.234667 30.165334-30.165333z","p-id":"8218"}))),Nf=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4524",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M290.944 289.365333l205.738667 95.914667 0.469333-0.426667 1.109333 1.152 142.506667 66.432-32.128 32.085334-102.826667-47.957334-107.818666 107.733334 48 102.912-32.085334 32.042666-66.346666-142.250666-1.28-1.28 0.469333-0.512-96-205.696 40.192-40.149334z m12.885333 53.034667l74.965334 160.810667 85.845333-85.845334L303.786667 342.4zM690.432 463.104h128v128h-42.666667v-53.418667l-325.845333 325.802667-30.165333-30.165333 327.552-327.552h-56.874667v-42.666667z",fill:"#444D5A","p-id":"4525"}))),Mf=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4659",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M755.968 312.277333l-95.914667 205.738667 0.426667 0.469333-1.152 1.109334-66.432 142.506666-32.085333-32.128 47.957333-102.826666-107.733333-107.818667-102.912 48-32.042667-32.085333 142.250667-66.346667 1.28-1.28 0.512 0.469333 205.696-96 40.149333 40.192z m-53.034667 12.885334l-160.810666 74.965333 85.845333 85.845333 74.965333-160.810666zM582.229333 711.765333v128h-128v-42.666666h53.418667l-325.802667-325.845334 30.165334-30.165333 327.552 327.552v-56.874667h42.666666z",fill:"#444D5A","p-id":"4660"}))),Of=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4794",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M636.757333 298.666667l77.653334 213.333333h0.64l-0.042667 1.621333 53.76 147.712h-45.354667l-38.826666-106.666666h-152.405334l-38.826666 106.666666H448l53.674667-147.498666 0.042666-1.834667h0.64l77.610667-213.333333h56.789333z m-28.416 46.634666L547.669333 512h121.386667l-60.714667-166.698667zM394.368 698.496L303.786667 789.034667 213.333333 698.453333l30.165334-30.165333 37.802666 37.76V245.333333h42.666667v463.232l40.234667-40.234666 30.165333 30.165333z",fill:"#444D5A","p-id":"4795"}))),kf=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4929",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M192 495.786667l213.333333-77.653334v-0.64l1.621334 0.042667L554.666667 363.776v45.354667l-106.666667 38.826666v152.405334l106.666667 38.826666v45.354667l-147.498667-53.674667-1.834667-0.042666v-0.64l-213.333333-77.610667V495.786667z m46.634667 28.416L405.333333 584.874667v-121.386667l-166.698666 60.714667zM597.333333 336.170667l90.496-90.538667 90.538667 90.538667-30.165333 30.165333-37.802667-37.76V789.333333h-42.666667V326.101333l-40.234666 40.234667L597.333333 336.170667z",fill:"#444D5A","p-id":"4930"}))),If=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5199",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M789.333333 528.213333l-213.333333 77.653334v0.64l-1.621333-0.042667L426.666667 660.224v-45.354667l106.666666-38.826666V423.637333l-106.666666-38.826666V339.456l147.498666 53.674667 1.834667 0.042666v0.64l213.333333 77.610667v56.789333z m-46.634666-28.416L576 439.125333v121.386667l166.698667-60.714667zM384 687.829333l-90.496 90.538667-90.538667-90.538667 30.165334-30.165333 37.802666 37.76V234.666667h42.666667v463.232l40.234667-40.234667 30.165333 30.165333z",fill:"#444D5A","p-id":"5200"}))),Pf=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8736",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M213.333333 213.333333h85.12v597.333334H213.333333V213.333333z m225.450667 477.44l25.557333-21.333333-72.362666-63.786667 72.362666-63.872-25.557333-21.248-93.610667 80.853334h4.266667-4.266667l93.610667 89.386666z","p-id":"8737"}),rm("path",{d:"M768 213.333333h42.581333v597.333334H768z","p-id":"8738"}),rm("path",{d:"M540.928 367.274667H391.978667v42.581333h148.949333c59.605333 0 106.410667 38.314667 106.410667 85.12s-46.805333 85.12-106.410667 85.12H391.978667v42.581333h148.949333c85.12 0 157.482667-55.338667 157.482667-127.701333s-72.362667-127.701333-157.44-127.701333z","p-id":"8739"}))),Lf=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8608",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M300.288 810.666667H213.333333V213.333333h86.954667v279.978667h441.898667l-91.306667-85.845333 26.624-26.112L810.666667 512l-133.162667 130.688-26.624-26.154667 91.306667-85.845333-441.898667-0.042667z","p-id":"8609"}),rm("path",{d:"M530.688 213.333333h42.666667v242.688h-42.666667V213.333333z m0 354.688h42.666667V810.666667h-42.666667v-242.688z","p-id":"8610"}))),Bf=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8865",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M767.829333 213.333333h42.496v597.333334h-42.496z","p-id":"8866"}),rm("path",{d:"M767.146667 553.216h-384v-42.496h384v42.496zM213.333333 213.333333h84.992v597.333334H213.333333V213.333333z","p-id":"8867"})));class Ff{render(){return Tf}}class Hf{render(){return Cf}}class qf{render(){return Ef}}class Uf{render(){return Af}}class Vf{render(){return Sf}}class Wf{render(){return Df}}class zf{render(){return Rf}}class Yf{render(){return Nf}}class Gf{render(){return Mf}}class Xf{render(){return Of}}class $f{render(){return kf}}class jf{render(){return If}}class Kf{render(){return Pf}}class Zf{render(){return Lf}}class Qf{render(){return Bf}}var Jf={LeftAlignIcon:Tf,CenterAlignIcon:Cf,RightAlignIcon:Ef,TopVerticalIcon:Af,CenterVerticalIcon:Sf,BottomVerticalIcon:Df,TextRotateIcon:Rf,TextRotateAngleUpIcon:Nf,BrIcon:Pf,OverflowIcon:Lf,CutIcon:Bf};const ey=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8090",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 263.381334l-233.984 190.890666-118.613333-98.218666L256 704.64V768h512v-291.285333zM768 256H256v392.704l159.146667-134.954667 119.04 98.602667L768 421.674667V256zM384 341.333333a42.666667 42.666667 0 1 1 0 85.333334 42.666667 42.666667 0 0 1 0-85.333334z","p-id":"8091"}))),ty=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7962",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M771.584 251.733333c-49.066667-51.2-132.266667-51.2-181.333333 0l-74.666667 76.8c-8.533333 8.533333-8.533333 23.466667 0 32 8.533333 8.533333 21.333333 8.533333 29.866667 0l74.666666-76.8c34.133333-34.133333 87.466667-34.133333 121.6 0 34.133333 34.133333 34.133333 89.6 0 123.733334l-121.6 123.733333c-34.133333 34.133333-87.466667 34.133333-121.6 0-8.533333-8.533333-21.333333-8.533333-29.866666 0-8.533333 8.533333-8.533333 23.466667 0 32 49.066667 51.2 132.266667 51.2 181.333333 0l121.6-123.733333c51.2-53.333333 51.2-136.533333 0-187.733334z","p-id":"7963"}),rm("path",{d:"M477.184 663.466667l-74.666667 76.8c-34.133333 34.133333-87.466667 34.133333-121.6 0-34.133333-34.133333-34.133333-89.6 0-123.733334l121.6-123.733333c34.133333-34.133333 87.466667-34.133333 121.6 0 8.533333 8.533333 21.333333 8.533333 29.866667 0 8.533333-8.533333 8.533333-23.466667 0-32-49.066667-51.2-132.266667-51.2-181.333333 0l-121.6 123.733333c-51.2 51.2-49.066667 134.4 0 185.6 49.066667 51.2 132.266667 51.2 181.333333 0l74.666667-76.8c8.533333-8.533333 8.533333-23.466667 0-32-8.533333-6.4-21.333333-6.4-29.866667 2.133334z","p-id":"7964"}))),ny=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7833",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M256 213.333333H213.333333v597.333334h597.333334v-42.666667H256z","p-id":"7834"}),rm("path",{d:"M490.666667 343.466667V554.666667h185.6c-19.2 72.533333-85.333333 128-164.266667 128-93.866667 0-170.666667-76.8-170.666667-170.666667 0-87.466667 66.133333-157.866667 149.333334-168.533333M512 298.666667c-117.333333 0-213.333333 96-213.333333 213.333333s96 213.333333 213.333333 213.333333 213.333333-96 213.333333-213.333333h-192V298.666667H512z","p-id":"7835"}),rm("path",{d:"M618.666667 260.266667c83.2 14.933333 134.4 74.666667 147.2 166.4H618.666667V260.266667m-42.666667-46.933334v256H810.666667c0-149.333333-85.333333-256-234.666667-256z","p-id":"7836"})));var ry={PhotoIcon:ey,LinkIcon:ty,ChartIcon:ny};class ay{render(){return ey}}class iy{render(){return ty}}class oy{render(){return ny}}const sy=e=>rm(bg,{spin:e.spin,rotate:e.rotate,className:e.className,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M737.664 419.328H426.666667v42.666667h311.296l-84.48 84.437333a21.333333 21.333333 0 0 0 30.208 30.165333l120.746666-120.704a21.290667 21.290667 0 0 0 0-30.165333l-120.746666-120.661333a21.333333 21.333333 0 0 0-30.165334 30.165333l84.138667 84.096zM213.333333 632.661333a213.333333 213.333333 0 0 1 213.333334-213.333333v42.666667a170.666667 170.666667 0 0 0-170.666667 170.666666H213.333333z m0 0h42.666667v64a21.333333 21.333333 0 0 1-42.666667 0v-64z","p-id":"5693"}))),ly=e=>rm(bg,{spin:e.spin,rotate:e.rotate,className:e.className,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M287.018667 419.328h310.997333v42.666667H286.72l84.48 84.437333a21.333333 21.333333 0 1 1-30.208 30.165333l-120.746667-120.704a21.248 21.248 0 0 1 0-30.165333l120.746667-120.661333a21.333333 21.333333 0 0 1 30.165333 30.165333L287.018667 419.328z m524.330666 213.333333a213.333333 213.333333 0 0 0-213.333333-213.333333v42.666667a170.666667 170.666667 0 0 1 170.666667 170.666666h42.666666z m0 0h-42.666666v64a21.333333 21.333333 0 1 0 42.666666 0v-64z","p-id":"5566"}))),cy=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5955",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M725.333333 213.333333v85.333334h85.333334v234.666666h-298.666667V597.333333h21.333333v213.333334h-85.333333v-213.333334h21.333333v-106.666666h298.666667V341.333333h-42.666667v85.333334H213.333333V213.333333h512z m-42.666666 42.666667H256v128h426.666667V256z","p-id":"5956"}))),uy=e=>rm(bg,{spin:e.spin,rotate:e.rotate,className:e.className,name:"nextIcon",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M512 682.666667L170.666667 341.333333h682.666666z","p-id":"5312"}))),hy=e=>rm(bg,{spin:e.spin,rotate:e.rotate,className:e.className,name:"rightIcon",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M682.666667 512l-341.333334 341.333333V170.666667z","p-id":"5312"}))),dy=e=>rm(bg,{spin:e.spin,rotate:e.rotate,className:e.className,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M268.032 523.434667l60.373333-60.330667 211.2 211.2-60.373333 60.330667z","p-id":"5312"}),rm("path",{d:"M780.928 312.234667l60.373333 60.330666-331.904 331.861334-60.330666-60.330667z","p-id":"5313"}))),py=e=>rm(bg,{spin:e.spin,rotate:e.rotate,className:e.className,name:"foward",style:e.style},rm("svg",{width:"1em",height:"1em",fill:"currentColor",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1732"},rm("path",{d:"M224.45 538.68l575.11-346.21-0.05-68.75-575.03 345.61-0.03 69.35z","p-id":"1733"}),rm("path",{d:"M224.45 538.68l575.08 356.96v-69.52L224.48 469.33l-0.03 69.35z","p-id":"1734"}))),my=e=>rm(bg,{spin:e.spin,rotate:e.rotate,className:e.className,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M330.965333 270.634667l422.4 422.4-60.330666 60.330666-422.4-422.4z","p-id":"5319"}),rm("path",{d:"M753.365333 330.965333l-422.4 422.4-60.330666-60.330666 422.4-422.4z","p-id":"5320"}))),_y=e=>rm(bg,{spin:e.spin,rotate:e.rotate,className:e.className,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5446",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333zM213.333333 213.333333h597.333334v85.333334H213.333333zM213.333333 725.333333h597.333334v85.333334H213.333333z","p-id":"5447"}))),gy=e=>rm(bg,{spin:e.spin,rotate:e.rotate,className:e.className,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6513",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M512 219.428571c161.645714 0 307.931429 97.499429 438.857143 292.571429-130.925714 195.072-277.211429 292.571429-438.857143 292.571429S204.068571 707.072 73.142857 512c130.925714-195.072 277.211429-292.571429 438.857143-292.571429z m0 73.142858c-124.123429 0-241.225143 65.462857-365.714286 219.428571 119.661714 147.968 231.424 213.577143 365.714286 219.428571 124.196571 0 241.298286-65.462857 365.714286-219.428571-119.588571-147.968-231.350857-213.577143-365.714286-219.428571z","p-id":"6514"}),rm("path",{d:"M818.614857 146.285714l51.712 51.712L197.997714 870.4 146.285714 818.688z","p-id":"6515"}),rm("path",{d:"M512 365.714286a146.285714 146.285714 0 1 1 0 292.571428 146.285714 146.285714 0 0 1 0-292.571428z m0 73.142857a73.142857 73.142857 0 1 0 0 146.285714 73.142857 73.142857 0 0 0 0-146.285714z","p-id":"6516"})));var fy={BackIcon:sy,ForwardIcon:ly,FormatIcon:cy,NextIcon:uy,RightIcon:hy,CorrectIcon:dy,LtIcon:py,CloseIcon:my,MenuIcon:_y,HideIcon:gy};class yy{render(){return sy}}class vy{render(){return ly}}class by{render(){return cy}}class xy{render(){return uy}}class wy{render(){return hy}}class Ty{render(){return dy}}class Cy{render(){return py}}class Ey{render(){return my}}class Ay{render(){return my}}class Sy{render(){return _y}}class Dy{render(){return gy}}const Ry=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7578",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M256 362.666667v298.666666l256 149.333334 256-149.333334v-298.666666L512 213.333333 256 362.666667zM725.333333 640l-213.333333 128-213.333333-128V384l213.333333-128 213.333333 128v256z m-189.354666 40.021333a18.645333 18.645333 0 0 1-18.645334 18.645334 18.304 18.304 0 0 1-18.688-18.645334V535.466667l-130.645333-75.349334a18.645333 18.645333 0 0 1 4.565333-34.133333 18.304 18.304 0 0 1 14.08 2.005333l130.688 74.666667 129.578667-74.666667a18.304 18.304 0 0 1 25.386667 6.698667 18.645333 18.645333 0 0 1-6.784 25.386667l-129.536 74.666666v145.237334z","p-id":"7579"}))),Ny=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7451",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M774.058667 213.333333v42.666667H310.784l236.288 256-236.330667 256h463.317334v42.666667H213.333333l275.669334-298.666667L213.333333 213.333333z","p-id":"7452"}))),My=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6675",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M704 256a21.333333 21.333333 0 0 1 21.333333 21.333333v469.333334a21.333333 21.333333 0 1 1-42.666666 0v-469.333334c0-11.776 9.472-21.333333 21.333333-21.333333zM512 384c11.776 0 21.333333 7.68 21.333333 17.194667v221.610666c0 9.514667-9.472 17.194667-21.333333 17.194667-11.776 0-21.333333-7.68-21.333333-17.194667V401.194667c0-4.565333 2.218667-8.96 6.186666-12.16A24.32 24.32 0 0 1 512 384zM320 256a21.333333 21.333333 0 0 1 21.333333 21.333333v469.333334a21.333333 21.333333 0 1 1-42.666666 0v-469.333334c0-11.776 9.472-21.333333 21.333333-21.333333z m283.562667 368.896a21.333333 21.333333 0 0 1 30.165333 30.165333l-106.666667 106.666667a21.333333 21.333333 0 0 1-30.165333 0l-106.666667-106.666667a21.333333 21.333333 0 0 1 30.165334-30.165333L512 716.501333l91.605333-91.562666z m0.298666-225.834667a21.333333 21.333333 0 0 0 30.165334-30.165333l-106.666667-106.666667a21.333333 21.333333 0 0 0-30.165333 0l-106.666667 106.666667a21.333333 21.333333 0 0 0 30.165333 30.165333l91.562667-91.562666 91.605333 91.562666z","p-id":"6676"}))),Oy=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6548",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M430.848 666.197333H366.592V236.074667a6.656 6.656 0 0 0-6.741333-6.528h-47.36a6.656 6.656 0 0 0-6.741334 6.528v430.122666H241.493333c-5.674667 0-8.874667 6.314667-5.333333 10.538667l94.72 115.2a6.912 6.912 0 0 0 10.624 0l94.72-115.2c3.413333-4.224 0.298667-10.538667-5.376-10.538667zM582.442667 806.698667l20.992-61.098667h103.68l21.205333 61.098667h43.690667L672.64 533.333333h-34.688l-99.370667 273.365334h43.861334z m112.896-97.877334h-79.872l39.552-119.424h0.768l39.552 119.466667zM742.570667 486.698667v-39.168h-124.288l124.288-203.093334V213.333333h-169.685334v36.949334h119.04l-123.904 201.941333v34.474667z","p-id":"6549"}))),ky=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6294",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M430.848 357.76H366.592v430.165333a6.656 6.656 0 0 1-6.741333 6.485334h-47.36a6.656 6.656 0 0 1-6.741334-6.485334V357.76H241.493333c-5.674667 0-8.874667-6.314667-5.333333-10.538667l94.72-115.2a6.912 6.912 0 0 1 10.624 0l94.72 115.2c3.413333 4.224 0.298667 10.538667-5.376 10.538667zM582.442667 486.698667l20.992-61.098667h103.68l21.205333 61.098667h43.690667L672.64 213.333333h-34.688l-99.370667 273.365334h43.861334z m112.896-97.877334h-79.872l39.552-119.424h0.768l39.552 119.466667zM742.570667 806.698667v-39.168h-124.288l124.288-203.093334V533.333333h-169.685334v36.949334h119.04l-123.904 201.941333v34.474667z","p-id":"6295"}))),Iy=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6802",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M736 213.333333H328.533333C288 213.333333 256 245.333333 256 285.866667c0 17.066667 6.4 34.133333 17.066667 46.933333 0 2.133333 2.133333 2.133333 2.133333 4.266667l160 160v168.533333c0 6.4 2.133333 10.666667 6.4 14.933333l145.066667 123.733334c4.266667 2.133333 8.533333 4.266667 12.8 4.266666 6.4 0 10.666667-2.133333 14.933333-6.4 4.266667-4.266667 4.266667-10.666667 4.266667-14.933333V503.466667l170.666666-166.4 2.133334-2.133334c10.666667-12.8 17.066667-29.866667 17.066666-46.933333 0-42.666667-32-74.666667-72.533333-74.666667z m23.466667 93.866667s-2.133333 2.133333 0 0l-172.8 172.8c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334l-162.133333-166.4-2.133333-2.133333c-6.4-6.4-8.533333-12.8-8.533334-21.333333 0-17.066667 14.933333-32 32-32h407.466667c17.066667 0 32 14.933333 32 32 0 8.533333-4.266667 14.933333-8.533333 21.333333z","p-id":"6803"}))),Py=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6929",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M736 213.333333H328.533333C288 213.333333 256 245.333333 256 285.866667c0 17.066667 6.4 34.133333 17.066667 46.933333 0 2.133333 2.133333 2.133333 2.133333 4.266667l160 160v168.533333c0 6.4 2.133333 10.666667 6.4 14.933333l145.066667 123.733334c4.266667 2.133333 8.533333 4.266667 12.8 4.266666 6.4 0 10.666667-2.133333 14.933333-6.4 4.266667-4.266667 4.266667-10.666667 4.266667-14.933333V503.466667l170.666666-166.4 2.133334-2.133334c10.666667-12.8 17.066667-29.866667 17.066666-46.933333 0-42.666667-32-74.666667-72.533333-74.666667z m23.466667 93.866667s-2.133333 2.133333 0 0l-172.8 172.8c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334l-162.133333-166.4-2.133333-2.133333c-6.4-6.4-8.533333-12.8-8.533334-21.333333 0-17.066667 14.933333-32 32-32h407.466667c17.066667 0 32 14.933333 32 32 0 8.533333-4.266667 14.933333-8.533333 21.333333z","p-id":"6930"}),rm("path",{d:"M688.213333 378.410667l-101.546666 101.589333c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334L403.626667 408.32l284.586666-29.909333z","p-id":"6931"}))),Ly=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7193",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M214.016 722.432h593.92v42.410667H214.016v-42.410667z m578.048-312.106667l-180.693333-181.077333A53.376 53.376 0 0 0 573.738667 213.333333a45.653333 45.653333 0 0 0-32.64 13.226667l-313.941334 314.965333c-18.56 18.602667-17.322667 50.261333 2.688 70.4l68.010667 68.096h298.24l198.698667-199.338666c18.56-18.602667 17.322667-50.261333-2.730667-70.357334z m-213.546667 227.242667H315.434667L259.84 581.888c-3.968-4.010667-4.053333-9.088-2.730667-10.453333L430.08 398.08l193.92 193.92-45.44 45.568z","p-id":"7194"}))),By=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5912",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M764.330667 592.170667l30.165333 30.165333L734.165333 682.666667l60.330667 60.330666-30.165333 30.165334-60.330667-60.330667-60.330667 60.330667-30.165333-30.165334L673.834667 682.666667l-60.330667-60.330667 30.165333-30.165333 60.330667 60.330666 60.330667-60.330666zM725.333333 512v42.666667H256v128h256v42.666666H213.333333v-213.333333h512z m47.829334-209.664l30.165333 30.165333L682.666667 453.12l-30.165334 30.165333-90.496-90.453333 30.165334-30.208 60.330666 60.330667 120.661334-120.661334zM725.333333 256v42.666667H256v128h256v42.666666H213.333333V256h512z","p-id":"5913"})));var Fy={PivotableIcon:Ry,SumIcon:Ny,OrderIcon:My,OrderDESCIcon:Oy,OrderASCIcon:ky,FilterIcon:Iy,FilterRankIcon:Py,CleanIcon:Ly,CheckIcon:By};class Hy{render(){return Ry}}class qy{render(){return Ny}}class Uy{render(){return My}}class Vy{render(){return Oy}}class Wy{render(){return ky}}class zy{render(){return Iy}}class Yy{render(){return Py}}class Gy{render(){return Ly}}class Xy{render(){return By}}const $y=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7705",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M352 490.666667a32 32 0 1 0 64 0 32 32 0 0 0-64 0z m128 0a32 32 0 1 0 64 0 32 32 0 0 0-64 0z m128 0a32 32 0 1 0 64 0 32 32 0 0 0-64 0z","p-id":"7706"}),rm("path",{d:"M768 298.666667H256c-23.466667 0-42.666667 19.2-42.666667 42.666666v298.666667c0 23.466667 19.2 42.666667 42.666667 42.666667h106.666667v128l128-128H768c23.466667 0 42.666667-19.2 42.666667-42.666667V341.333333c0-23.466667-19.2-42.666667-42.666667-42.666666z m0 320c0 12.8-8.533333 21.333333-21.333333 21.333333H469.333333l-64 64V640h-128c-12.8 0-21.333333-8.533333-21.333333-21.333333v-256c0-12.8 8.533333-21.333333 21.333333-21.333334h469.333334c12.8 0 21.333333 8.533333 21.333333 21.333334v256z","p-id":"7707"})));class jy{render(){return $y}}const Ky=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5448",width:"1em",height:"1em"},rm("path",{d:"M256.426667 256.426667h255.317333v553.130666H256.426667z",fill:"#B5B8BD","p-id":"5449"}),rm("path",{d:"M809.557333 213.930667v595.626666H213.930667V213.930667h595.626666z m-42.538666 42.538666H256.426667v510.549334h510.549333V256.426667z",fill:"#444D5A","p-id":"5450"}),rm("path",{d:"M490.453333 256.426667h42.538667v510.592h-42.538667z",fill:"#444D5A","p-id":"5451"}),rm("path",{d:"M256.426667 532.992v-42.538667h510.592v42.538667z",fill:"#444D5A","p-id":"5452"}),rm("path",{d:"M256.384 226.261333l264.192 264.192-30.122667 30.08-264.192-264.192 30.122667-30.08z m-30.122667 317.184l30.122667-30.122666 264.192 264.192-30.122667 30.08-264.192-264.149334z",fill:"#444D5A","p-id":"5453"})));class Zy{render(){return Ky}}const Qy=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6039",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 320h-106.666667V768H768v-234.666667z m-405.376 0h-106.666667V768h106.666667v-234.666667z m256.042667 86.784L445.482667 768H618.666667v-147.882667z m0-162.346666l-213.376 179.968v108.885333l213.376-179.072v-109.781333z m0-163.669334l-213.333334 179.029334v108.885333l213.333334-179.072V294.101333zM768 256h-103.936l-2.730667 2.304V490.666667H768V256zM362.666667 256H256v234.666667h106.666667V256z m235.008 0H405.333333v161.408L597.674667 256z","p-id":"6040"})));class Jy{render(){return Qy}}const ev=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5501",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M544.896 389.717333h110.762667v46.933334c6.698667 6.613333 15.658667 6.613333 22.357333 0l84.949333-55.125334c6.698667-4.437333 6.698667-13.226667 0-19.84l-84.906666-57.386666c-6.741333-6.613333-15.701333-6.613333-22.4 0v41.258666h-133.12l-89.429334 154.453334H343.722667v0.128h-22.698667c-11.178667 0-22.357333 11.050667-22.357333 22.058666 0 11.050667 11.178667 22.058667 22.357333 22.058667h134.101333l-0.085333-0.128h0.426667l89.386666-154.453333h0.042667z m133.12 198.954667a15.061333 15.061333 0 0 0-22.314667 0v43.690667h-66.133333l-67.029333-110.293334-22.357334 44.117334s62.592 103.68 67.072 110.293333h88.448V721.066667a15.061333 15.061333 0 0 0 22.314667 0l84.949333-55.168c6.698667-4.437333 6.698667-13.226667 0-19.84l-84.906666-57.386667h-0.042667z","p-id":"5502"})));class tv{render(){return ev}}const nv=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4859",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M768 430.933333H280.405333l-4.394666-0.554666c-5.461333-0.853333-6.570667-1.749333-12.885334-6.528l-2.986666-5.376c-6.4-11.946667-5.376-13.738667 2.986666-28.885334L440.618667 213.333333l34.218666 34.048-136.362666 135.424H768v48.170667z m-7.594667 163.242667L585.472 768l-34.261333-34.048 136.362666-135.424H258.048v-48.170667h484.096c10.453333 0 19.882667 6.272 23.893333 15.872a25.6 25.6 0 0 1-5.632 27.989334z","p-id":"4860"})));class rv{render(){return nv}}const av=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4732",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M664.832 634.624l128.554667 128.597333a21.333333 21.333333 0 1 1-30.165334 30.165334l-128.597333-128.597334a256 256 0 1 1 30.165333-30.165333zM469.333333 682.666667a213.333333 213.333333 0 1 0 0-426.666667 213.333333 213.333333 0 0 0 0 426.666667z","p-id":"4733"})));class iv{render(){return av}}const ov=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4605",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334zM341.333333 383.872H256V768h85.333333V383.872z m426.666667 0H383.872V768H768V383.872z m-149.333333 21.461333a64 64 0 0 1 63.701333 57.856L682.666667 469.333333v64h42.666666v213.333334h-298.666666v-213.333334h42.666666V469.333333a64 64 0 0 1 57.856-63.701333L533.333333 405.333333h85.333334z m64 170.666667h-213.333334v128h213.333334v-128z m-106.666667 21.333333a21.333333 21.333333 0 0 1 21.333333 21.333334v42.666666a21.333333 21.333333 0 1 1-42.666666 0v-42.666666a21.333333 21.333333 0 0 1 21.333333-21.333334z m42.666667-149.333333h-85.333334a21.333333 21.333333 0 0 0-20.992 17.493333L512 469.333333v64h128V469.333333a21.333333 21.333333 0 0 0-13.909333-20.010666l-3.584-0.981334-3.84-0.341333zM768 256H383.872v85.290667L768 341.333333V256zM341.333333 256H256v85.333333l85.333333-0.042666V256z","p-id":"4606"})));class sv{render(){return ov}}const lv=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5579",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M618.666667 723.584V661.333333a21.333333 21.333333 0 1 1 42.666666 0v62.250667a128.128 128.128 0 0 0 104.917334-104.917333H704a21.333333 21.333333 0 1 1 0-42.666667h62.250667a128.128 128.128 0 0 0-104.917334-104.874667V533.333333a21.333333 21.333333 0 1 1-42.666666 0v-62.208a128.085333 128.085333 0 0 0-104.874667 104.874667H576a21.333333 21.333333 0 0 1 0 42.666667h-62.208a128.128 128.128 0 0 0 104.874667 104.917333z m149.333333-296.96a213.12 213.12 0 0 0-42.666667-24.874667V277.333333a21.333333 21.333333 0 0 0-21.333333-21.333333h-426.666667a21.333333 21.333333 0 0 0-21.333333 21.333333v341.333334a21.333333 21.333333 0 0 0 21.333333 21.333333h153.6c2.986667 14.848 7.594667 29.098667 13.482667 42.666667H256a42.666667 42.666667 0 0 1-42.666667-42.666667V256a42.666667 42.666667 0 0 1 42.666667-42.666667h469.333333a42.666667 42.666667 0 0 1 42.666667 42.666667v170.666667zM640 768a170.666667 170.666667 0 1 1 0-341.333333 170.666667 170.666667 0 0 1 0 341.333333z","p-id":"5580"})));class cv{render(){return lv}}const uv=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em"},rm("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 42.666667H256v512h512V256z","p-id":"5319"}),rm("path",{d:"M256 512h256v42.666667H256zM554.666667 256v298.666667h-42.666667V256z","p-id":"5320"}),rm("path",{d:"M405.333333 256v298.666667h-42.666666V256z","p-id":"5321"})));class hv{render(){return uv}}const dv=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5447",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M256 256h554.666667v42.666667H256z","p-id":"5448"}),rm("path",{d:"M298.666667 256v554.666667H256V256zM810.666667 256v554.666667h-42.666667V256zM469.333333 256v554.666667h-42.666666V256zM640 256v554.666667h-42.666667V256z","p-id":"5449"}),rm("path",{d:"M256 426.666667h554.666667v42.666666H256zM256 597.333333h554.666667v42.666667H256zM256 768h554.666667v42.666667H256z","p-id":"5450"})));class pv{render(){return dv}}const mv=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5576",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M810.666667 213.333333v42.666667h-170.709334L640 768h170.666667v42.666667h-213.333334V213.333333h213.333334z m-384 0l-0.042667 554.666667H426.666667v42.666667H213.333333v-42.666667h170.624L384 256H213.333333V213.333333h213.333334z m106.666666 512v85.333334h-42.666666v-85.333334h42.666666z m0-170.666666v85.333333h-42.666666v-85.333333h42.666666z m0-170.666667v85.333333h-42.666666V384h42.666666z m0-170.666667v85.333334h-42.666666V213.333333h42.666666z","p-id":"5577"})));class _v{render(){return mv}}const gv=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6094",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M913.988 173.68H110.05c-25.671 0-46.676 21.007-46.676 46.679v665.897c0 25.651 20.987 46.638 46.637 46.638H913.95c25.671 0 46.676-21.004 46.676-46.676V220.32c0-25.651-20.988-46.64-46.638-46.64zM339.796 896.142c0 12.016-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.337-21.303-21.353V768.023c0-12.014 9.338-21.353 21.303-21.353h213.627c11.965 0 21.305 9.34 21.305 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.338-21.303-21.353V543.029c0-12.013 9.338-21.354 21.303-21.354h213.627c11.965 0 21.305 9.34 21.305 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.337-21.303-21.353V319.596c0-12.013 9.338-21.353 21.303-21.353h213.627c11.965 0 21.305 9.34 21.305 21.353v128.118zM639.269 896.14c0 12.016-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.337-21.305-21.353V768.023c0-12.014 9.34-21.353 21.305-21.353h213.626c11.966 0 21.306 9.34 21.306 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.338-21.305-21.353V543.029c0-12.013 9.34-21.354 21.305-21.354h213.626c11.966 0 21.306 9.34 21.306 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.337-21.305-21.353V319.596c0-12.013 9.34-21.353 21.305-21.353h213.626c11.966 0 21.306 9.34 21.306 21.353v128.118zM941.864 896.14c0 12.016-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.337-21.304-21.353V768.023c0-12.014 9.338-21.353 21.304-21.353h213.626c11.966 0 21.304 9.34 21.304 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.338-21.304-21.353V543.029c0-12.013 9.338-21.354 21.304-21.354h213.626c11.966 0 21.304 9.34 21.304 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.337-21.304-21.353V319.596c0-12.013 9.338-21.353 21.304-21.353h213.626c11.966 0 21.304 9.34 21.304 21.353v128.118z","p-id":"6095"})));class fv{render(){return gv}}var yv={CommentIcon:$y,FreezeIcon:Ky,conditionalFormatIcon:Qy,DivideIcon:ev,ReplaceIcon:nv,SearchIcon:av,LockIcon:ov,LocationIcon:lv,PageIcon:uv,RegularIcon:dv,LayoutIcon:mv,TableIcon:gv};const vv=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4476",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M743.125333 341.333333c35.669333 0 64.384 28.885333 67.285334 65.024l0.256 6.101334V682.666667h-149.76v-42.666667H768V412.458667c0-14.592-9.514667-26.154667-21.333333-28.16L743.168 384H280.874667c-12.16 0-22.784 10.24-24.576 24.149333l-0.298667 4.266667V640h127.36v42.666667H213.333333V412.458667c0-36.906667 26.794667-67.712 61.653334-70.826667L280.874667 341.333333h462.250666z","p-id":"4477"}),rm("path",{d:"M682.666667 213.333333H341.333333v170.666667h341.333334V213.333333z m-42.666667 42.666667v85.333333H384V256h256zM682.666667 554.666667v256H341.333333v-256h341.333334z m-42.666667 42.666666H384v170.666667h256v-170.666667z","p-id":"4478"}),rm("path",{d:"M341.333333 426.666667h128v42.666666H341.333333z","p-id":"4479"}))),bv=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5374",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M590.848 567.04l-265.386667-306.645333a28.245333 28.245333 0 0 1 3.2-40.149334 29.141333 29.141333 0 0 1 40.789334 3.242667l267.946666 309.674667a124.885333 124.885333 0 0 1 144.213334 34.474666 125.141333 125.141333 0 0 1-16.042667 176.256 125.141333 125.141333 0 0 1-176.341333-14.805333 125.013333 125.013333 0 0 1 1.621333-162.048z m40.149333 18.133333c-18.602667 15.701333-29.312 38.826667-29.312 63.189334 0 45.909333 37.461333 83.157333 83.754667 83.157333a83.413333 83.413333 0 0 0 83.712-83.157333 83.413333 83.413333 0 0 0-83.712-83.114667c-15.189333 0-29.44 4.010667-41.685333 11.008a28.458667 28.458667 0 0 1-12.757334 8.96v-0.042667z m-150.698666-52.565333l-38.229334 44.16a29.653333 29.653333 0 0 1-0.768 0.810667 124.885333 124.885333 0 0 1-6.528 151.509333 125.141333 125.141333 0 0 1-176.341333 14.805333C205.226667 699.306667 198.101333 620.373333 242.346667 567.637333a124.928 124.928 0 0 1 156.416-28.544l38.528-44.501333c9.514667 17.237333 24.746667 30.634667 43.008 37.973333z m105.6-122.026667a85.632 85.632 0 0 0-43.818667-37.12l129.749333-150.016a29.141333 29.141333 0 0 1 40.789334-3.242666 28.245333 28.245333 0 0 1 3.2 40.149333l-129.92 150.186667z m-300.8 301.44c35.413333 29.738667 88.064 25.301333 117.546666-9.813333a83.413333 83.413333 0 0 0-10.666666-117.546667 83.456 83.456 0 0 0-117.589334 9.856 83.456 83.456 0 0 0 10.709334 117.504z","p-id":"5375"}))),xv=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5706",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M727.04 706.218667a11.946667 11.946667 0 0 1 8.704 3.754666 13.312 13.312 0 0 1 3.626667 9.130667V810.666667H583.253333v-91.52c0-3.413333 1.28-6.741333 3.626667-9.173334a11.946667 11.946667 0 0 1 8.661333-3.754666zM362.666667 725.333333v42.666667h-128v-42.666667h128z m128 0v42.666667h-42.666667v-42.666667h42.666667z m301.696-143.957333a18.773333 18.773333 0 0 1 18.304 19.2v117.205333c0 10.581333-8.277333 19.2-18.346667 19.2h-28.458667v-11.434666c-0.128-21.333333-16.554667-38.570667-36.778666-38.570667h-131.498667c-20.224 0-36.693333 17.237333-36.778667 38.570667v11.477333h-28.458666a18.858667 18.858667 0 0 1-18.346667-19.2v-117.248c0-10.581333 8.277333-19.2 18.346667-19.2zM256 533.333333v128H213.333333v-128h42.666667z m411.477333 85.845334H567.04a12.586667 12.586667 0 0 0-12.245333 12.8c0.042667 7.125333 5.546667 12.885333 12.245333 12.842666h100.394667a12.586667 12.586667 0 0 0 12.202666-12.8c0-7.082667-5.504-12.8-12.202666-12.8zM723.072 512a14.506667 14.506667 0 0 1 14.165333 14.805333v35.84H585.386667v-35.84a14.506667 14.506667 0 0 1 14.165333-14.805333zM768 362.666667v128h-42.666667v-128h42.666667z m-512-42.666667v128H213.333333v-128h42.666667zM768 213.333333v64h-42.666667V256h-64V213.333333H768zM362.666667 213.333333v42.666667H256v21.333333H213.333333V213.333333h149.333334z m213.333333 0v42.666667h-128V213.333333h128z","p-id":"5707"}))),wv=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5833",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M727.04 706.218667a11.946667 11.946667 0 0 1 8.704 3.754666 13.312 13.312 0 0 1 3.626667 9.130667V810.666667H583.253333v-91.52c0-3.413333 1.28-6.741333 3.626667-9.173334a11.946667 11.946667 0 0 1 8.661333-3.754666zM768 213.333333v277.333334h-42.666667V256H256v469.333333h234.666667v42.666667H213.333333V213.333333h554.666667z m24.362667 368.042667a18.773333 18.773333 0 0 1 18.304 19.2v117.205333c0 10.581333-8.277333 19.2-18.346667 19.2h-28.458667v-11.434666c-0.128-21.333333-16.554667-38.570667-36.778666-38.570667h-131.498667c-20.224 0-36.693333 17.237333-36.778667 38.570667v11.477333h-28.458666a18.858667 18.858667 0 0 1-18.346667-19.2v-117.248c0-10.581333 8.277333-19.2 18.346667-19.2z m-124.885334 37.802667H567.04a12.586667 12.586667 0 0 0-12.245333 12.8c0.042667 7.125333 5.546667 12.885333 12.245333 12.842666h100.394667a12.586667 12.586667 0 0 0 12.202666-12.8c0-7.082667-5.504-12.8-12.202666-12.8zM723.072 512a14.506667 14.506667 0 0 1 14.165333 14.805333v35.84H585.386667v-35.84a14.506667 14.506667 0 0 1 14.165333-14.805333z","p-id":"5834"}),rm("path",{d:"M341.333333 341.333333h298.666667v42.666667H341.333333zM341.333333 426.666667h170.666667v42.666666H341.333333z",fill:"#444D5A","p-id":"5835"}))),Tv=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"foward",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5815",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 263.381334l-233.984 190.890666-118.613333-98.218666L256 704.64V768h512v-291.285333zM768 256H256v392.704l159.146667-134.954667 119.04 98.602667L768 421.674667V256zM384 341.333333a42.666667 42.666667 0 1 1 0 85.333334 42.666667 42.666667 0 0 1 0-85.333334z",fill:"#444D5A","p-id":"5816"})));class Cv{render(){return vv}}class Ev{render(){return bv}}class Av{render(){return xv}}class Sv{render(){return wv}}class Dv{render(){return Tv}}var Rv={PrintIcon:vv,ScreenshotIcon:bv,PrintAreaIcon:xv,PrintTitleIcon:wv,ImageIcon:Tv};const Nv=e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"logo",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1214",width:"1em",height:"1em"},rm("path",{d:"M840 288H688v-56c0-40-32-72-72-72h-208C368 160 336 192 336 232V288h-152c-12.8 0-24 11.2-24 24s11.2 24 24 24h656c12.8 0 24-11.2 24-24s-11.2-24-24-24zM384 288v-56c0-12.8 11.2-24 24-24h208c12.8 0 24 11.2 24 24V288H384zM758.4 384c-12.8 0-24 11.2-24 24v363.2c0 24-19.2 44.8-44.8 44.8H332.8c-24 0-44.8-19.2-44.8-44.8V408c0-12.8-11.2-24-24-24s-24 11.2-24 24v363.2c0 51.2 41.6 92.8 92.8 92.8h358.4c51.2 0 92.8-41.6 92.8-92.8V408c-1.6-12.8-12.8-24-25.6-24z","p-id":"1215"}),rm("path",{d:"M444.8 744v-336c0-12.8-11.2-24-24-24s-24 11.2-24 24v336c0 12.8 11.2 24 24 24s24-11.2 24-24zM627.2 744v-336c0-12.8-11.2-24-24-24s-24 11.2-24 24v336c0 12.8 11.2 24 24 24s24-11.2 24-24z","p-id":"1216"})));class Mv{render(){return Nv}}var Ov={Close:e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"logo",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4224",width:"1em",height:"1em",fill:"currentColor"},rm("path",{d:"M119.808 180.053333l60.330667-60.245333 724.053333 724.053333-60.330667 60.330667z","p-id":"4225"}),rm("path",{d:"M843.946667 119.808l60.245333 60.330667-724.053333 724.053333-60.330667-60.330667z","p-id":"4226"}))),DropDownIcon:e=>rm(bg,{spin:e.spin,rotate:e.rotate,name:"dropdown",style:e.style},rm("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4519",width:"1em",height:"1em"},rm("path",{d:"M149.930667 444.330667l60.330666-60.330667 362.069334 362.069333L512 806.4z",fill:"#B5B8BD","p-id":"4520"}),rm("path",{d:"M813.738667 384l60.330666 60.330667L512 806.4l-60.330667-60.330667z",fill:"#B5B8BD","p-id":"4521"})))};const kv={RightIcon:rm(fy.RightIcon,null)};Symbol.toStringTag;var Iv="univer-btn";const Pv=e=>{const{type:t,shape:n,size:r,htmlType:a="button",danger:i=!1,disabled:o,block:s=!1,loading:l=!1,active:c=!1,onClick:u,children:h,className:d="",style:p}=e;let m="";switch(r){case"large":m="lg";break;case"small":m="sm"}const _=J_(Iv,{[`${Iv}-${t}`]:t,[`${Iv}-${n}`]:n,[`${Iv}-${m}`]:r,[`${Iv}-danger`]:!!i,[`${Iv}-block`]:s,[`${Iv}-loading`]:l},d);let g=p;c&&(g=Object.assign(p||{},{background:"#eee"}));return rm("button",{type:a,onClick:e=>{o?e.preventDefault():u&&u(e)},className:_,disabled:o,style:{...g}},l?rm(xg,null):"",h)};class Lv{render(){return Pv}}var Bv={};class Fv extends Z_{constructor(){super(...arguments),this.canvasRef={current:null}}componentDidMount(){this.drawLine()}drawLine(){const e=this.canvasRef;this.props.drawLine(e)}setLineDash(e,t,n,r,a,i,o){try{"Hair"===t?e.setLineDash([1,2]):t.indexOf("DashDotDot")>-1?e.setLineDash([2,2,5,2,2]):t.indexOf("DashDot")>-1?e.setLineDash([2,5,2]):t.indexOf("Dotted")>-1?e.setLineDash([2]):t.indexOf("Dashed")>-1?e.setLineDash([3]):e.setLineDash([0])}catch(e){console.log(e)}e.beginPath(),t.indexOf("Medium")>-1?("h"===n?(e.moveTo(r,a-.5),e.lineTo(i,o-.5)):(e.moveTo(r-.5,a),e.lineTo(i-.5,o)),e.lineWidth=2):"Thick"===t?(e.moveTo(r,a),e.lineTo(i,o),e.lineWidth=3):(e.moveTo(r,a),e.lineTo(i,o),e.lineWidth=1)}render(){return rm("canvas",{ref:this.canvasRef,className:Bv.canvas,width:this.props.width,height:this.props.height})}}class Hv extends om{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"Thin","h",0,5,100,5),t.stroke(),t.closePath()}render(){return rm(Fv,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class qv{render(){return Hv}}class Uv extends om{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"Hair","h",0,5,100,5),t.stroke(),t.closePath()}render(){return rm(Fv,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class Vv{render(){return Uv}}class Wv extends om{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"Dotted","h",0,5,100,5),t.stroke(),t.closePath()}render(){return rm(Fv,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class zv{render(){return Wv}}class Yv extends om{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"Dashed","h",0,5,100,5),t.stroke(),t.closePath()}render(){return rm(Fv,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class Gv{render(){return Yv}}class Xv extends Z_{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"DashDot","h",0,5,100,5),t.stroke(),t.closePath()}render(){return rm(Fv,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class $v{render(){return Xv}}class jv extends Z_{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"DashDotDot","h",0,5,100,5),t.stroke(),t.closePath()}render(){return rm(Fv,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class Kv{render(){return jv}}class Zv extends om{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"Medium","h",0,5,100,5),t.stroke(),t.closePath()}render(){return rm(Fv,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class Qv{render(){return Zv}}class Jv extends om{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"MediumDashed","h",0,5,100,5),t.stroke(),t.closePath()}render(){return rm(Fv,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class eb{render(){return Jv}}class tb extends om{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"MediumDashDot","h",0,5,100,5),t.stroke(),t.closePath()}render(){return rm(Fv,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class nb{render(){return tb}}class rb extends om{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"MediumDashDotDot","h",0,5,100,5),t.stroke(),t.closePath()}render(){return rm(Fv,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class ab{render(){return rb}}class ib extends om{constructor(){super(...arguments),this.ref={current:null}}drawLine(e){let t=e.current.getContext("2d");this.ref.current.setLineDash(t,"Thick","h",0,5,100,5),t.stroke(),t.closePath()}render(){return rm(Fv,{ref:this.ref,width:"100",height:"10",drawLine:e=>this.drawLine(e)})}}class ob{render(){return ib}}Symbol.toStringTag;var sb="univer-cell-range-modal",lb="univer-cell-modal-icon";class cb extends Z_{constructor(){super(...arguments),this.ref={current:null},this.state={modalData:[{name:"dataValidation.selectCellRange2",show:!1,group:[{name:"button.confirm",type:"primary",onClick:()=>this.handleOk()},{name:"button.cancel"}]}],placeholderState:{name:"dataValidation.selectCellRange2"},value:""},this.showModal=(e,t)=>{let{modalData:n}=this.state;const r=n.findIndex((t=>t.name===e));r>-1&&(n[r].show=t),this.setValue({modalData:n})},this.handleOk=()=>{const e=this.ref.current.getValue();this.showModal("dataValidation.selectCellRange2",!1),this.setValue({value:e})},this.setValue=(e,t)=>{this.setState((t=>({...e})),t)},this.changeRange=e=>{const t=e.target;this.setValue({value:t.value})},this.showRange=()=>{var e;this.showModal("dataValidation.selectCellRange2",!0),null==(e=this._context.getWorkBook().getActiveSheet())||e.getSelection().setSelection({selection:this.state.value})}}setLocale(){const e=this.context.locale;this.setState((t=>{let{modalData:n,placeholderState:r}=t;return n.forEach((t=>{t.title=e.get(t.locale),t.group&&t.group.length&&t.group.forEach((t=>{t.label=e.get(t.locale)}))})),r.label=e.get(r.name),{modalData:n,placeholderState:r}}))}componentWillReceiveProps(e){this.setValue({value:e.valueProps})}componentDidMount(){var e,t;this.setValue({value:this.props.valueProps}),this.setLocale(),this._context,this._localeObserver=null==(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))?void 0:e.add((()=>{this.setLocale()})),this._localeObserver1=null==(t=this._context.getObserverManager().getObserver("onAfterSetSelectionObservable","worksheet"))?void 0:t.add((e=>{console.dir(e)}))}componentWillUnmount(){}render(e,t){const{modalData:n,placeholderState:r,value:a}=t,{placeholderProps:i}=e;return rm("div",{className:sb},rm($b,{placeholder:i,value:a,onChange:e=>this.changeRange(e)}),rm("span",{className:lb,onClick:this.showRange},rm(yv.TableIcon,null)),n.map((e=>{if(e.show)return rm(K$,{title:e.title,visible:e.show,group:e.group,onCancel:e.onCancel},rm($b,{readonly:!0,placeholder:r.label,value:a,ref:this.ref}))})))}}class ub{render(){return cb}}var hb="univer-checkbox-wrapper",db="univer-check-box",pb="univer-checkbox-input",mb="univer-checkbox-inner",_b="univer-checkbox-group";class gb extends Z_{constructor(){super(...arguments),this.state={classes:this.props.className?`${this.props.className} ${db}`:db,check:!0},this.handleStyle=(e,t)=>{let n=J_(db,{[`${db}-checked`]:e,[`${db}-disabled`]:t});this.setState((t=>({classes:n,check:e})))},this.handleChange=e=>{var t,n;const r=e.target;this.handleStyle(r.checked,this.props.disabled),null==(n=(t=this.props).onChange)||n.call(t,e)}}componentWillMount(){this.handleStyle(this.props.checked,this.props.disabled)}componentWillReceiveProps(e){this.handleStyle(e.checked,e.disabled)}render(e,t){const{classes:n,check:r}=t,{value:a,name:i,disabled:o,children:s}=e;return rm("label",{className:hb},rm("span",{className:n},rm("span",{className:mb}),rm("input",{type:"checkbox",name:i,checked:r,disabled:o,className:pb,value:a,onChange:this.handleChange})),s&&rm("span",null,s))}}class fb{render(){return gb}}var yb,vb,bb,xb,wb=0,Tb=[],Cb=[],Eb=Xp.__b,Ab=Xp.__r,Sb=Xp.diffed,Db=Xp.__c,Rb=Xp.unmount;function Nb(e,t){Xp.__h&&Xp.__h(vb,e,wb||t),wb=0;var n=vb.__H||(vb.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:Cb}),n.__[e]}function Mb(e){return wb=1,function(e,t,n){var r=Nb(yb++,2);if(r.t=e,!r.__c&&(r.__=[n?n(t):Hb(void 0,t),function(e){var t=r.__N?r.__N[0]:r.__[0],n=r.t(t,e);t!==n&&(r.__N=[n,r.__[1]],r.__c.setState({}))}],r.__c=vb,!vb.u)){vb.u=!0;var a=vb.shouldComponentUpdate;vb.shouldComponentUpdate=function(e,t,n){if(!r.__c.__H)return!0;var i=r.__c.__H.__.filter((function(e){return e.__c}));if(i.every((function(e){return!e.__N})))return!a||a.call(this,e,t,n);var o=!1;return i.forEach((function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(o=!0)}})),!(!o&&r.__c.props===e)&&(!a||a.call(this,e,t,n))}}return r.__N||r.__}(Hb,e)}function Ob(e){return wb=5,function(e,t){var n=Nb(yb++,7);return Fb(n.__H,t)?(n.__V=e(),n.i=t,n.__h=e,n.__V):n.__}((function(){return{current:e}}),[])}function kb(){for(var e;e=Tb.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Lb),e.__H.__h.forEach(Bb),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),vb=null,Eb&&Eb(e)},Xp.__r=function(e){Ab&&Ab(e),yb=0;var t=(vb=e.__c).__H;t&&(bb===vb?(t.__h=[],vb.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=Cb,e.__N=e.i=void 0}))):(t.__h.forEach(Lb),t.__h.forEach(Bb),t.__h=[])),bb=vb},Xp.diffed=function(e){Sb&&Sb(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==Tb.push(t)&&xb===Xp.requestAnimationFrame||((xb=Xp.requestAnimationFrame)||Pb)(kb)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==Cb&&(e.__=e.__V),e.i=void 0,e.__V=Cb}))),bb=vb=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(Lb),e.__h=e.__h.filter((function(e){return!e.__||Bb(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),Db&&Db(e,t)},Xp.unmount=function(e){Rb&&Rb(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{Lb(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var Ib="function"==typeof requestAnimationFrame;function Pb(e){var t,n=function(){clearTimeout(r),Ib&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);Ib&&(t=requestAnimationFrame(n))}function Lb(e){var t=vb,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),vb=t}function Bb(e){var t=vb;e.__c=e.__(),vb=t}function Fb(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function Hb(e,t){return"function"==typeof t?t(e):t}const qb=e=>{let{options:t,onChange:n,disabled:r,name:a}=e,i=Ob(null);r&&t.forEach((e=>{e.disabled=!0})),a&&t.forEach((e=>{e.name=a}));const o=()=>{var e;if(!n)return;let t=null==(e=i.current)?void 0:e.querySelectorAll("label input"),r=[];null==t||t.forEach((e=>{let t=e;t.checked&&r.push(t.value)})),n(r)};return rm("div",{className:_b,ref:i},t.map((e=>rm(gb,{name:e.name,disabled:e.disabled,checked:e.checked,onChange:o,value:e.value},e.label))))};class Ub{render(){return qb}}var Vb={panelWrapper:"univer-panel-wrapper",panelHeader:"univer-panel-header",panelHeaderIcon:"univer-panel-header-icon",panelHeaderIconRotate:"univer-panel-header-icon-rotate",panelBody:"univer-panel-body",active:"univer-active"};const Wb=e=>{const{header:t,children:n}=e;let[r,a]=Mb(J_(Vb.panelBody));return rm("div",{className:Vb.panelWrapper},rm("div",{className:Vb.panelHeader,onClick:()=>{r.includes("active")?a(J_(Vb.panelBody)):a(J_(Vb.panelBody,Vb.active))}},t,rm("span",{className:`${Vb.panelHeaderIcon} ${r.includes("active")?Vb.panelHeaderIconRotate:""}`},rm(fy.NextIcon,null))),rm("div",{className:r},n))},zb=e=>{const{children:t}=e;return rm("div",{className:Vb.collapseWrapper},t)};class Yb{render(){return zb}}class Gb{render(){return Wb}}var Xb="univer-input";class $b extends Z_{constructor(){super(...arguments),this.ref={current:null},this.setValue=(e,t)=>{this.setState((t=>({value:e})),t)},this.handleChange=e=>{const{onChange:t}=this.props;if(!t)return;const n=e.target;this.setValue(n.value),t(e)},this.handleKeyUp=e=>{const{onKeyUp:t}=this.props;null==t||t(e)},this.onFocus=e=>{const{onFocus:t}=this.props;null==t||t(e)},this.onClick=e=>{const{onClick:t}=this.props;null==t||t(e)},this.onBlur=e=>{const{onBlur:t}=this.props;null==t||t(e)},this.getValue=()=>this.ref.current.value}initialize(e){this.state={value:e.value,focused:!1}}componentWillMount(){this.props.value&&this.setValue(this.props.value)}componentWillReceiveProps(e){e.value&&e.value!==this.state.value&&this.setValue(e.value)}render(e,t){const{id:n,disabled:r,type:a,placeholder:i,bordered:o=!0,className:s="",readonly:l}=e,{value:c}=t,u=J_(Xb,{[`${Xb}-disable`]:r,[`${Xb}-borderless`]:!o},s);return rm("input",{type:a,onBlur:this.onBlur,onFocus:this.onFocus,className:u,placeholder:i,disabled:r,ref:this.ref,onChange:this.handleChange,value:c,onClick:this.onClick,readonly:l,id:n,onKeyUp:this.handleKeyUp})}}class jb{render(){return $b}}const Kb=e=>{let t,{color:n}=e;if(!n)return null;if(n.indexOf("#")>-1){if(n=Ha.hexToRgbString(n),!n)return null;t=n.replace("rgba(","").replace(")","").split(",")}else n.indexOf("rgba")>-1?t=n.replace("rgba(","").replace(")","").split(","):(t=n.replace("rgb(","").replace(")","").split(","),t.push("1"));let r=Ob(null);return rm($b,{ref:r,type:"text",value:`rgba(${t})`,onChange:()=>{e.onChange(r.current.base.value)}})};var Zb={colorPickerPanel:"univer-color-picker-panel",colorPickerPanelSetting:"univer-color-picker-panel-setting",panelInput:"univer-panel-input",panelColor:"univer-panel-color"};class Qb extends Z_{initialize(e){this.state={color:e.color||"#000"}}setColor(e){this.setState({color:e}),this.props.onChange(e)}render(){return rm("div",{className:Zb.colorPickerPanel,onClick:e=>e.stopPropagation()},rm(a_,{className:Zb.colorPicker,color:this.state.color,onChange:eg(this.setColor.bind(this),500)}),rm("div",{className:Zb.colorPickerPanelSetting},rm("div",{className:Zb.panelInput},this.props.rgb?rm(Kb,{color:this.state.color,onChange:eg(this.setColor.bind(this),500)}):rm(l_,{color:this.state.color,onChange:eg(this.setColor.bind(this),500)})),rm("div",{className:Zb.panelColor},rm("div",{style:{background:this.state.color}}),rm("div",{style:{background:this.props.color}}))))}}var Jb="univer-color-picker-outer",ex="univer-color-picker",tx="univer-picker",nx="univer-picker-swatches",rx="univer-picker-swatches-item",ax="univer-picker-swatch",ix="univer-picker-swatch-btn",ox="univer-colorful-warp",sx="univer-color-picker-slot";let lx=[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]];class cx extends Z_{constructor(){super(...arguments),this.ulRef={current:null},this.onChange=e=>{this.props.onChange&&this.props.onChange(e),this.setState({afterColor:e})},this.onClick=(e,t)=>{this.props.onClick&&this.props.onClick(e,t)},this.onCancel=()=>{this.props.onCancel&&this.props.onCancel()},this.hideSelect=e=>{e&&this.ulRef.current.contains(e.target)||(this.setState((e=>({styles:{display:"none"}}))),document.removeEventListener("click",this.hideSelect,!0))},this.showSelect=e=>{this.setState((e=>({styles:{display:"block"}}))),document.addEventListener("click",this.hideSelect,!0)},this.getOffset=(e,t)=>{const n=e.getBoundingClientRect(),r=this.ulRef.current.getBoundingClientRect(),a=document.documentElement.clientWidth||document.body.clientWidth,i=document.documentElement.clientHeight||document.body.clientHeight;let o=0,s=0;return s=n.top+r.height>i?n.top-r.height:n.top+n.height,o=n.left+r.width>a?a-r.width:n.left,{left:o,top:s}},this.onSwitch=e=>{e.stopImmediatePropagation(),new Promise(((e,t)=>{this.setState({setting:!this.state.setting}),e("end")})).then((()=>{if(this.state.root){const{top:e,left:t}=this.getOffset(this.state.root,this.ulRef.current);this.ulRef.current.style.left=`${t}px`,this.ulRef.current.style.top=`${e}px`}}))}}initialize(e){this.state={presetColors:lx,defaultColor:e.color||"#000",afterColor:e.color||"#000",rgb:!0,setting:!1,styles:{},currentLocale:"",locale:{},root:null}}componentWillMount(){}componentWillUnmount(){}setLocale(){const e=this.context.locale.get("toolbar");this.setState({locale:e})}render(){const e=Object.assign(this.state.styles||{},this.props.style);return rm("div",{className:`${Jb} ${this.props.className}`,ref:this.ulRef,style:{...e}},this.props.slot&&this.props.slot.header?rm("div",{className:sx},this.props.slot.header.content):null,rm("div",{className:ex,onClick:e=>{}},rm("div",{className:tx},rm("div",{className:nx},this.state.presetColors.map((e=>rm("div",{className:rx},e.map((e=>rm("span",{className:ax,style:{background:e}},rm(xK,{title:e,placement:"top"},rm("button",{key:e,className:ix,style:{background:e},onClick:t=>{this.props.onClick&&this.props.onClick(e,t)}}))))))))),rm("div",null,rm(Pv,{onClick:this.onSwitch},this.state.setting?this.state.locale.collapse:this.state.locale.customColor))),this.state.setting?rm("div",{className:ox},rm(Qb,{color:this.state.defaultColor,rgb:this.state.rgb,onChange:this.onChange.bind(this)}),rm("div",null,rm(Pv,{type:"primary",onClick:e=>{var t;null==(t=this.onClick)||t.call(this,this.state.afterColor,e)}},this.state.locale.confirmColor),rm(Pv,{danger:!0,onClick:e=>{this.onCancel()}},this.state.locale.cancelColor),rm(Pv,{onClick:e=>{e.stopPropagation(),this.setState({rgb:!this.state.rgb})}},this.state.locale.change))):null))}}class ux{render(){return cx}}var hx="univer-color-picker-circle-button",dx="univer-color-select-circle",px="univer-vertical-middle";class mx extends Z_{constructor(){super(...arguments),this.ref={current:null},this.colorRef={current:null},this.handleColorSelectButtonClick=e=>{e.stopImmediatePropagation(),this.colorRef.current.showSelect(this.ref.current)}}render(e){const{color:t,onClick:n,onCancel:r,style:a,colorPickerStyle:i}=e,o=this.getComponentRender().renderFunction("NextIcon");return rm("div",{style:a,className:hx,ref:this.ref,onClick:this.handleColorSelectButtonClick},rm("span",{className:`${dx} ${px}`,style:{backgroundColor:t}}),rm(o,{className:px}),rm(cx,{color:t,onClick:n,onCancel:r,style:i,ref:this.colorRef}))}}class _x{render(){return mx}}const gx=M_(((e,t)=>{const{children:n,style:r,className:a,onClick:i}=e;return rm("div",{ref:t,style:r,className:a,onClick:i},n)}));class fx{render(){return gx}}var yx="univer-format-modal";class vx extends Z_{constructor(){super(...arguments),this.refs=[],this.ModalRefs=[],this.setValue=(e,t)=>{this.setState((t=>({...e})),t)},this.showModal=(e,t)=>{let n=this.state.data,r=n.findIndex((t=>t.name===e));r>-1&&(n[r].show=t,this.setValue({data:n},(()=>({data:n}))))}}initialize(e){this.state={data:[{name:"format.titleCurrency",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleCurrency",!1)},{name:"format.titleDateTime",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleDateTime",!1)},{name:"format.titleNumber",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleNumber",!1)}]}}setLocale(){const e=this.context.locale;let t=this.state.data;t.forEach((t=>{var n;t.title=e.get(t.name),"format.titleCurrency"===t.name?t.children=e.get("currencyDetail").map((e=>({label:e.name,icon:e.value}))):"format.titleDateTime"===t.name?t.children=e.get("dateFmtList").map((e=>({label:e.name,icon:e.value}))):"format.titleNumber"===t.name&&(t.children=e.get("numFmtList").map((e=>({label:e.name,icon:e.value})))),(null==(n=t.group)?void 0:n.length)&&t.group.forEach((t=>{t.label=e.get(t.locale)}))})),this.setState((e=>({data:t})))}componentWillMount(){var e;this.setLocale(),this._localeObserver=null==(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))?void 0:e.add((()=>{this.setLocale()}))}componentWillUnmount(){}render(e,t){const{data:n}=t;return rm(im,null,n.map(((e,t)=>e.show?rm(K$,{title:e.title,className:yx,group:e.group,visible:e.show,onCancel:e.onCancel},e.label,rm(NK,{show:!0,children:e.children,ref:e=>this.refs[t]=e})):rm(im,null))))}}class bx{render(){return vx}}const xx=Sm({});var wx,Tx,Cx,Ex=[],Ax=[],Sx=Xp.__b,Dx=Xp.__r,Rx=Xp.diffed,Nx=Xp.__c,Mx=Xp.unmount;function Ox(){for(var e;e=Ex.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Px),e.__H.__h.forEach(Lx),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),wx=null,Sx&&Sx(e)},Xp.__r=function(e){Dx&&Dx(e);var t=(wx=e.__c).__H;t&&(Tx===wx?(t.__h=[],wx.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=Ax,e.__N=e.i=void 0}))):(t.__h.forEach(Px),t.__h.forEach(Lx),t.__h=[])),Tx=wx},Xp.diffed=function(e){Rx&&Rx(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==Ex.push(t)&&Cx===Xp.requestAnimationFrame||((Cx=Xp.requestAnimationFrame)||Ix)(Ox)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==Ax&&(e.__=e.__V),e.i=void 0,e.__V=Ax}))),Tx=wx=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(Px),e.__h=e.__h.filter((function(e){return!e.__||Lx(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),Nx&&Nx(e,t)},Xp.unmount=function(e){Mx&&Mx(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{Px(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var kx="function"==typeof requestAnimationFrame;function Ix(e){var t,n=function(){clearTimeout(r),kx&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);kx&&(t=requestAnimationFrame(n))}function Px(e){var t=wx,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),wx=t}function Lx(e){var t=wx;e.__c=e.__(),wx=t}function Bx(e,t){for(var n in t)e[n]=t[n];return e}function Fx(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function Hx(e){this.props=e}(Hx.prototype=new om).isPureReactComponent=!0,Hx.prototype.shouldComponentUpdate=function(e,t){return Fx(this.props,e)||Fx(this.state,t)};var qx=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),qx&&qx(e)};var Ux="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Vx(e){function t(t){var n=Bx({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=Ux,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var Wx=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);Wx(e,t,n,r)};var zx=Xp.unmount;function Yx(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=Bx({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return Yx(e,t,n)}))),e}function Gx(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return Gx(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function Xx(){this.__u=0,this.t=null,this.__b=null}function $x(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function jx(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),zx&&zx(e)},(Xx.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=$x(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=Gx(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},Xx.prototype.componentWillUnmount=function(){this.t=[]},Xx.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=Yx(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var Kx=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(jx.prototype=new om).__a=function(e){var t=this,n=$x(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),Kx(t,e,r)):a()};n?n(i):i()}},jx.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},jx.prototype.componentDidUpdate=jx.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){Kx(e,n,t)}))};var Zx="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,Qx=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Jx="undefined"!=typeof document,ew=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var tw=Xp.event;function nw(){}function rw(){return this.cancelBubble}function aw(){return this.defaultPrevented}Xp.event=function(e){return tw&&(e=tw(e)),e.persist=nw,e.isPropagationStopped=rw,e.isDefaultPrevented=aw,e.nativeEvent=e};var iw={configurable:!0,get:function(){return this.class}},ow=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];Jx&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!ew(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&Qx.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(iw.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",iw))}e.$$typeof=Zx,ow&&ow(e)};var sw=Xp.__r;Xp.__r=function(e){sw&&sw(e),e.__c};class lw extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}lw.contextType=xx;(class extends Hx{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=xx;const cw="rgb(0,0,0)";var uw=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(uw||{});class hw{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return hw.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new hw(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new hw(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new hw(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new hw(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new hw(this.x*e,this.y*t)}divide(e){return new hw(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new hw(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new hw(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new hw(Math.floor(this.x),Math.floor(this.y))}fract(){return new hw(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=hw.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return hw.NormalizeToRef(this,this),this}clone(){return new hw(this.x,this.y)}static Zero(){return new hw(0,0)}static One(){return new hw(1,1)}static FromArray(e,t=0){return new hw(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new hw(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new hw(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new hw(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=hw.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new hw(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=hw.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new hw(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new hw(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new hw(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new hw(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(hw.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return hw.CenterToRef(e,t,hw.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=hw.DistanceSquared(t,n);if(0===r)return hw.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,hw.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return hw.Distance(e,o)}static create(e,t){return new hw(e,t)}}function dw(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===uw.TOP?(r=s,a=l,i=c,o=l):t===uw.BOTTOM?(r=s,a=u,i=c,o=u):t===uw.LEFT?(r=s,a=l,i=s,o=u):t===uw.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function pw(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function mw(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function _w(e,t,n,r,a=hw.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new hw(0,0),new hw(1,1);const gw="rgb(",fw=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${gw+e.join(",")})`:"rgb(0,0,0)";function yw(e,t){return Math.round(e*t)/t}function vw(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class bw{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return vw(e)}}const xw=Ss.create(),ww=Ss.create(),Tw=Ss.create(),Cw=Ss.create();class Ew extends bw{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}Cw.add(new class extends Ew{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=hw.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||cw;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});Cw.add(new class extends Ew{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=hw.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});Cw.add(new class extends Ew{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=vw(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=hw.create(0,0),centerPoint:f=hw.create(0,0),alignOffset:y=hw.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||cw;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=yw(o+1-.5,d),i=_w(g.addByPoint(l,a),f,b,x,y),s=_w(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||cw;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=yw(h-.5,d),i=_w(g.addByPoint(l,a),f,b,x,y),o=_w(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||cw;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=yw(-1.5,d),i=_w(g.addByPoint(l,a),f,b,x,y),o=_w(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});Cw.add(new class extends Ew{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=hw.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||cw;r!==this._preBorderStyle&&(pw(e,r),e.lineWidth=mw(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||cw,this._preBorderColor=i),dw(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(uw.TOP,t),n&&i.set(uw.BOTTOM,n),r&&i.set(uw.LEFT,r),a&&i.set(uw.RIGHT,a),i}});class Aw extends bw{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}xw.add(new class extends Aw{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||fw([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=yw(a,p),o=yw(o,p),s=yw(s,d),c=yw(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});xw.add(new class extends Aw{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=yw(i,_),s=yw(s,_),c=yw(c,m),h=yw(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(pw(e,u),e.lineWidth=mw(u)/g,f=u),d!==y&&(e.strokeStyle=d||cw,y=d),dw(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===uw.TOP||t===uw.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===uw.LEFT&&e>r&&e<=i||t===uw.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});xw.add(new class extends Aw{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=fw([217,217,217]);let y=yw(m,f),v=yw(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=yw(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=yw(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=yw(n[o-1]||0,t),h=yw(n[s],t),d=yw(r[l-1]||0,t),p=yw(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});xw.add(new class extends Aw{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=yw(o,g),c=yw(c,g),h=yw(h,_),p=yw(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=yw(o[t-1]||0,i),c=yw(o[n],i),u=yw(s[r-1]||0,i),h=yw(s[a],i);e.rect(u,l,h-u,c-l)}});ww.add(new class extends Aw{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=fw([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=fw([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=fw([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=yw(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(yw(a,m),0),e.lineTo(yw(a,m),p),e.stroke()}});Tw.add(new class extends Aw{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=fw([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=fw([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=fw([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=yw(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=yw(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var Sw,Dw,Rw,Nw=[],Mw=[],Ow=Xp.__b,kw=Xp.__r,Iw=Xp.diffed,Pw=Xp.__c,Lw=Xp.unmount;function Bw(){for(var e;e=Nw.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(qw),e.__H.__h.forEach(Uw),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),Sw=null,Ow&&Ow(e)},Xp.__r=function(e){kw&&kw(e),0;var t=(Sw=e.__c).__H;t&&(Dw===Sw?(t.__h=[],Sw.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=Mw,e.__N=e.i=void 0}))):(t.__h.forEach(qw),t.__h.forEach(Uw),t.__h=[])),Dw=Sw},Xp.diffed=function(e){Iw&&Iw(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==Nw.push(t)&&Rw===Xp.requestAnimationFrame||((Rw=Xp.requestAnimationFrame)||Hw)(Bw)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==Mw&&(e.__=e.__V),e.i=void 0,e.__V=Mw}))),Dw=Sw=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(qw),e.__h=e.__h.filter((function(e){return!e.__||Uw(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),Pw&&Pw(e,t)},Xp.unmount=function(e){Lw&&Lw(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{qw(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var Fw="function"==typeof requestAnimationFrame;function Hw(e){var t,n=function(){clearTimeout(r),Fw&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);Fw&&(t=requestAnimationFrame(n))}function qw(e){var t=Sw,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),Sw=t}function Uw(e){var t=Sw;e.__c=e.__(),Sw=t}Vx(((e,t)=>{const{children:n,style:r,className:a,onClick:i}=e;return rm("div",{ref:t,style:r,className:a,onClick:i},n)}));const Vw=Sm({});var Ww,zw,Yw,Gw=[],Xw=[],$w=Xp.__b,jw=Xp.__r,Kw=Xp.diffed,Zw=Xp.__c,Qw=Xp.unmount;function Jw(){for(var e;e=Gw.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(nT),e.__H.__h.forEach(rT),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),Ww=null,$w&&$w(e)},Xp.__r=function(e){jw&&jw(e);var t=(Ww=e.__c).__H;t&&(zw===Ww?(t.__h=[],Ww.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=Xw,e.__N=e.i=void 0}))):(t.__h.forEach(nT),t.__h.forEach(rT),t.__h=[])),zw=Ww},Xp.diffed=function(e){Kw&&Kw(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==Gw.push(t)&&Yw===Xp.requestAnimationFrame||((Yw=Xp.requestAnimationFrame)||tT)(Jw)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==Xw&&(e.__=e.__V),e.i=void 0,e.__V=Xw}))),zw=Ww=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(nT),e.__h=e.__h.filter((function(e){return!e.__||rT(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),Zw&&Zw(e,t)},Xp.unmount=function(e){Qw&&Qw(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{nT(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var eT="function"==typeof requestAnimationFrame;function tT(e){var t,n=function(){clearTimeout(r),eT&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);eT&&(t=requestAnimationFrame(n))}function nT(e){var t=Ww,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),Ww=t}function rT(e){var t=Ww;e.__c=e.__(),Ww=t}function aT(e,t){for(var n in t)e[n]=t[n];return e}function iT(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function oT(e){this.props=e}(oT.prototype=new om).isPureReactComponent=!0,oT.prototype.shouldComponentUpdate=function(e,t){return iT(this.props,e)||iT(this.state,t)};var sT=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),sT&&sT(e)};var lT="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function cT(e){function t(t){var n=aT({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=lT,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var uT=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);uT(e,t,n,r)};var hT=Xp.unmount;function dT(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=aT({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return dT(e,t,n)}))),e}function pT(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return pT(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function mT(){this.__u=0,this.t=null,this.__b=null}function _T(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function gT(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),hT&&hT(e)},(mT.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=_T(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=pT(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},mT.prototype.componentWillUnmount=function(){this.t=[]},mT.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=dT(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var fT=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(gT.prototype=new om).__a=function(e){var t=this,n=_T(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),fT(t,e,r)):a()};n?n(i):i()}},gT.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},gT.prototype.componentDidUpdate=gT.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){fT(e,n,t)}))};var yT="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,vT=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,bT="undefined"!=typeof document,xT=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var wT=Xp.event;function TT(){}function CT(){return this.cancelBubble}function ET(){return this.defaultPrevented}Xp.event=function(e){return wT&&(e=wT(e)),e.persist=TT,e.isPropagationStopped=CT,e.isDefaultPrevented=ET,e.nativeEvent=e};var AT={configurable:!0,get:function(){return this.class}},ST=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];bT&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!xT(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&vT.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(AT.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",AT))}e.$$typeof=yT,ST&&ST(e)};var DT=Xp.__r;Xp.__r=function(e){DT&&DT(e),e.__c};(class extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=Vw;(class extends oT{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=Vw;const RT="rgb(0,0,0)";var NT=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(NT||{});class MT{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return MT.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new MT(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new MT(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new MT(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new MT(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new MT(this.x*e,this.y*t)}divide(e){return new MT(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new MT(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new MT(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new MT(Math.floor(this.x),Math.floor(this.y))}fract(){return new MT(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=MT.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return MT.NormalizeToRef(this,this),this}clone(){return new MT(this.x,this.y)}static Zero(){return new MT(0,0)}static One(){return new MT(1,1)}static FromArray(e,t=0){return new MT(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new MT(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new MT(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new MT(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=MT.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new MT(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=MT.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new MT(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new MT(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new MT(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new MT(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(MT.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return MT.CenterToRef(e,t,MT.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=MT.DistanceSquared(t,n);if(0===r)return MT.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,MT.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return MT.Distance(e,o)}static create(e,t){return new MT(e,t)}}function OT(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===NT.TOP?(r=s,a=l,i=c,o=l):t===NT.BOTTOM?(r=s,a=u,i=c,o=u):t===NT.LEFT?(r=s,a=l,i=s,o=u):t===NT.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function kT(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function IT(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function PT(e,t,n,r,a=MT.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new MT(0,0),new MT(1,1);const LT="rgb(",BT=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${LT+e.join(",")})`:"rgb(0,0,0)";function FT(e,t){return Math.round(e*t)/t}function HT(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class qT{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return HT(e)}}const UT=Ss.create(),VT=Ss.create(),WT=Ss.create(),zT=Ss.create();class YT extends qT{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}zT.add(new class extends YT{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=MT.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||RT;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});zT.add(new class extends YT{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=MT.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});zT.add(new class extends YT{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=HT(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=MT.create(0,0),centerPoint:f=MT.create(0,0),alignOffset:y=MT.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||RT;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=FT(o+1-.5,d),i=PT(g.addByPoint(l,a),f,b,x,y),s=PT(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||RT;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=FT(h-.5,d),i=PT(g.addByPoint(l,a),f,b,x,y),o=PT(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||RT;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=FT(-1.5,d),i=PT(g.addByPoint(l,a),f,b,x,y),o=PT(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});zT.add(new class extends YT{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=MT.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||RT;r!==this._preBorderStyle&&(kT(e,r),e.lineWidth=IT(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||RT,this._preBorderColor=i),OT(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(NT.TOP,t),n&&i.set(NT.BOTTOM,n),r&&i.set(NT.LEFT,r),a&&i.set(NT.RIGHT,a),i}});class GT extends qT{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}UT.add(new class extends GT{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||BT([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=FT(a,p),o=FT(o,p),s=FT(s,d),c=FT(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});UT.add(new class extends GT{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=FT(i,_),s=FT(s,_),c=FT(c,m),h=FT(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(kT(e,u),e.lineWidth=IT(u)/g,f=u),d!==y&&(e.strokeStyle=d||RT,y=d),OT(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===NT.TOP||t===NT.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===NT.LEFT&&e>r&&e<=i||t===NT.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});UT.add(new class extends GT{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=BT([217,217,217]);let y=FT(m,f),v=FT(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=FT(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=FT(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=FT(n[o-1]||0,t),h=FT(n[s],t),d=FT(r[l-1]||0,t),p=FT(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});UT.add(new class extends GT{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=FT(o,g),c=FT(c,g),h=FT(h,_),p=FT(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=FT(o[t-1]||0,i),c=FT(o[n],i),u=FT(s[r-1]||0,i),h=FT(s[a],i);e.rect(u,l,h-u,c-l)}});VT.add(new class extends GT{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=BT([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=BT([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=BT([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=FT(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(FT(a,m),0),e.lineTo(FT(a,m),p),e.stroke()}});WT.add(new class extends GT{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=BT([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=BT([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=BT([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=FT(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=FT(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var XT,$T,jT,KT=[],ZT=[],QT=Xp.__b,JT=Xp.__r,eC=Xp.diffed,tC=Xp.__c,nC=Xp.unmount;function rC(){for(var e;e=KT.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(oC),e.__H.__h.forEach(sC),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),XT=null,QT&&QT(e)},Xp.__r=function(e){JT&&JT(e);var t=(XT=e.__c).__H;t&&($T===XT?(t.__h=[],XT.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=ZT,e.__N=e.i=void 0}))):(t.__h.forEach(oC),t.__h.forEach(sC),t.__h=[])),$T=XT},Xp.diffed=function(e){eC&&eC(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==KT.push(t)&&jT===Xp.requestAnimationFrame||((jT=Xp.requestAnimationFrame)||iC)(rC)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==ZT&&(e.__=e.__V),e.i=void 0,e.__V=ZT}))),$T=XT=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(oC),e.__h=e.__h.filter((function(e){return!e.__||sC(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),tC&&tC(e,t)},Xp.unmount=function(e){nC&&nC(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{oC(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var aC="function"==typeof requestAnimationFrame;function iC(e){var t,n=function(){clearTimeout(r),aC&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);aC&&(t=requestAnimationFrame(n))}function oC(e){var t=XT,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),XT=t}function sC(e){var t=XT;e.__c=e.__(),XT=t}cT(((e,t)=>{const{children:n,style:r,className:a,onClick:i}=e;return rm("div",{ref:t,style:r,className:a,onClick:i},n)}));const lC=Sm({});var cC,uC,hC,dC=[],pC=[],mC=Xp.__b,_C=Xp.__r,gC=Xp.diffed,fC=Xp.__c,yC=Xp.unmount;function vC(){for(var e;e=dC.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(wC),e.__H.__h.forEach(TC),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),cC=null,mC&&mC(e)},Xp.__r=function(e){_C&&_C(e);var t=(cC=e.__c).__H;t&&(uC===cC?(t.__h=[],cC.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=pC,e.__N=e.i=void 0}))):(t.__h.forEach(wC),t.__h.forEach(TC),t.__h=[])),uC=cC},Xp.diffed=function(e){gC&&gC(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==dC.push(t)&&hC===Xp.requestAnimationFrame||((hC=Xp.requestAnimationFrame)||xC)(vC)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==pC&&(e.__=e.__V),e.i=void 0,e.__V=pC}))),uC=cC=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(wC),e.__h=e.__h.filter((function(e){return!e.__||TC(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),fC&&fC(e,t)},Xp.unmount=function(e){yC&&yC(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{wC(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var bC="function"==typeof requestAnimationFrame;function xC(e){var t,n=function(){clearTimeout(r),bC&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);bC&&(t=requestAnimationFrame(n))}function wC(e){var t=cC,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),cC=t}function TC(e){var t=cC;e.__c=e.__(),cC=t}function CC(e,t){for(var n in t)e[n]=t[n];return e}function EC(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function AC(e){this.props=e}(AC.prototype=new om).isPureReactComponent=!0,AC.prototype.shouldComponentUpdate=function(e,t){return EC(this.props,e)||EC(this.state,t)};var SC=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),SC&&SC(e)};var DC="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function RC(e){function t(t){var n=CC({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=DC,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var NC=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);NC(e,t,n,r)};var MC=Xp.unmount;function OC(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=CC({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return OC(e,t,n)}))),e}function kC(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return kC(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function IC(){this.__u=0,this.t=null,this.__b=null}function PC(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function LC(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),MC&&MC(e)},(IC.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=PC(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=kC(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},IC.prototype.componentWillUnmount=function(){this.t=[]},IC.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=OC(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var BC=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(LC.prototype=new om).__a=function(e){var t=this,n=PC(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),BC(t,e,r)):a()};n?n(i):i()}},LC.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},LC.prototype.componentDidUpdate=LC.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){BC(e,n,t)}))};var FC="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,HC=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,qC="undefined"!=typeof document,UC=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var VC=Xp.event;function WC(){}function zC(){return this.cancelBubble}function YC(){return this.defaultPrevented}Xp.event=function(e){return VC&&(e=VC(e)),e.persist=WC,e.isPropagationStopped=zC,e.isDefaultPrevented=YC,e.nativeEvent=e};var GC={configurable:!0,get:function(){return this.class}},XC=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];qC&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!UC(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&HC.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(GC.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",GC))}e.$$typeof=FC,XC&&XC(e)};var $C=Xp.__r;Xp.__r=function(e){$C&&$C(e),e.__c};(class extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=lC;(class extends AC{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=lC;const jC="rgb(0,0,0)";var KC=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(KC||{});class ZC{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return ZC.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new ZC(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new ZC(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new ZC(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new ZC(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new ZC(this.x*e,this.y*t)}divide(e){return new ZC(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new ZC(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new ZC(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new ZC(Math.floor(this.x),Math.floor(this.y))}fract(){return new ZC(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=ZC.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return ZC.NormalizeToRef(this,this),this}clone(){return new ZC(this.x,this.y)}static Zero(){return new ZC(0,0)}static One(){return new ZC(1,1)}static FromArray(e,t=0){return new ZC(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new ZC(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new ZC(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new ZC(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=ZC.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new ZC(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=ZC.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new ZC(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new ZC(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new ZC(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new ZC(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(ZC.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return ZC.CenterToRef(e,t,ZC.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=ZC.DistanceSquared(t,n);if(0===r)return ZC.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,ZC.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return ZC.Distance(e,o)}static create(e,t){return new ZC(e,t)}}function QC(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===KC.TOP?(r=s,a=l,i=c,o=l):t===KC.BOTTOM?(r=s,a=u,i=c,o=u):t===KC.LEFT?(r=s,a=l,i=s,o=u):t===KC.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function JC(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function eE(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function tE(e,t,n,r,a=ZC.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new ZC(0,0),new ZC(1,1);const nE="rgb(",rE=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${nE+e.join(",")})`:"rgb(0,0,0)";function aE(e,t){return Math.round(e*t)/t}function iE(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class oE{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return iE(e)}}const sE=Ss.create(),lE=Ss.create(),cE=Ss.create(),uE=Ss.create();class hE extends oE{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}uE.add(new class extends hE{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=ZC.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||jC;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});uE.add(new class extends hE{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=ZC.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});uE.add(new class extends hE{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=iE(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=ZC.create(0,0),centerPoint:f=ZC.create(0,0),alignOffset:y=ZC.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||jC;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=aE(o+1-.5,d),i=tE(g.addByPoint(l,a),f,b,x,y),s=tE(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||jC;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=aE(h-.5,d),i=tE(g.addByPoint(l,a),f,b,x,y),o=tE(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||jC;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=aE(-1.5,d),i=tE(g.addByPoint(l,a),f,b,x,y),o=tE(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});uE.add(new class extends hE{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=ZC.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||jC;r!==this._preBorderStyle&&(JC(e,r),e.lineWidth=eE(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||jC,this._preBorderColor=i),QC(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(KC.TOP,t),n&&i.set(KC.BOTTOM,n),r&&i.set(KC.LEFT,r),a&&i.set(KC.RIGHT,a),i}});class dE extends oE{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}sE.add(new class extends dE{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||rE([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=aE(a,p),o=aE(o,p),s=aE(s,d),c=aE(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});sE.add(new class extends dE{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=aE(i,_),s=aE(s,_),c=aE(c,m),h=aE(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(JC(e,u),e.lineWidth=eE(u)/g,f=u),d!==y&&(e.strokeStyle=d||jC,y=d),QC(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===KC.TOP||t===KC.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===KC.LEFT&&e>r&&e<=i||t===KC.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});sE.add(new class extends dE{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=rE([217,217,217]);let y=aE(m,f),v=aE(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=aE(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=aE(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=aE(n[o-1]||0,t),h=aE(n[s],t),d=aE(r[l-1]||0,t),p=aE(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});sE.add(new class extends dE{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=aE(o,g),c=aE(c,g),h=aE(h,_),p=aE(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=aE(o[t-1]||0,i),c=aE(o[n],i),u=aE(s[r-1]||0,i),h=aE(s[a],i);e.rect(u,l,h-u,c-l)}});lE.add(new class extends dE{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=rE([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=rE([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=rE([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=aE(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(aE(a,m),0),e.lineTo(aE(a,m),p),e.stroke()}});cE.add(new class extends dE{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=rE([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=rE([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=rE([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=aE(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=aE(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var pE,mE,_E,gE=[],fE=[],yE=Xp.__b,vE=Xp.__r,bE=Xp.diffed,xE=Xp.__c,wE=Xp.unmount;function TE(){for(var e;e=gE.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(AE),e.__H.__h.forEach(SE),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),pE=null,yE&&yE(e)},Xp.__r=function(e){vE&&vE(e);var t=(pE=e.__c).__H;t&&(mE===pE?(t.__h=[],pE.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=fE,e.__N=e.i=void 0}))):(t.__h.forEach(AE),t.__h.forEach(SE),t.__h=[])),mE=pE},Xp.diffed=function(e){bE&&bE(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==gE.push(t)&&_E===Xp.requestAnimationFrame||((_E=Xp.requestAnimationFrame)||EE)(TE)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==fE&&(e.__=e.__V),e.i=void 0,e.__V=fE}))),mE=pE=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(AE),e.__h=e.__h.filter((function(e){return!e.__||SE(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),xE&&xE(e,t)},Xp.unmount=function(e){wE&&wE(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{AE(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var CE="function"==typeof requestAnimationFrame;function EE(e){var t,n=function(){clearTimeout(r),CE&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);CE&&(t=requestAnimationFrame(n))}function AE(e){var t=pE,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),pE=t}function SE(e){var t=pE;e.__c=e.__(),pE=t}RC(((e,t)=>{const{children:n,style:r,className:a,onClick:i}=e;return rm("div",{ref:t,style:r,className:a,onClick:i},n)}));const DE=Sm({});var RE,NE,ME,OE=[],kE=[],IE=Xp.__b,PE=Xp.__r,LE=Xp.diffed,BE=Xp.__c,FE=Xp.unmount;function HE(){for(var e;e=OE.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(VE),e.__H.__h.forEach(WE),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),RE=null,IE&&IE(e)},Xp.__r=function(e){PE&&PE(e);var t=(RE=e.__c).__H;t&&(NE===RE?(t.__h=[],RE.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=kE,e.__N=e.i=void 0}))):(t.__h.forEach(VE),t.__h.forEach(WE),t.__h=[])),NE=RE},Xp.diffed=function(e){LE&&LE(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==OE.push(t)&&ME===Xp.requestAnimationFrame||((ME=Xp.requestAnimationFrame)||UE)(HE)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==kE&&(e.__=e.__V),e.i=void 0,e.__V=kE}))),NE=RE=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(VE),e.__h=e.__h.filter((function(e){return!e.__||WE(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),BE&&BE(e,t)},Xp.unmount=function(e){FE&&FE(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{VE(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var qE="function"==typeof requestAnimationFrame;function UE(e){var t,n=function(){clearTimeout(r),qE&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);qE&&(t=requestAnimationFrame(n))}function VE(e){var t=RE,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),RE=t}function WE(e){var t=RE;e.__c=e.__(),RE=t}function zE(e,t){for(var n in t)e[n]=t[n];return e}function YE(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function GE(e){this.props=e}(GE.prototype=new om).isPureReactComponent=!0,GE.prototype.shouldComponentUpdate=function(e,t){return YE(this.props,e)||YE(this.state,t)};var XE=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),XE&&XE(e)};var $E="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function jE(e){function t(t){var n=zE({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=$E,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var KE=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);KE(e,t,n,r)};var ZE=Xp.unmount;function QE(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=zE({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return QE(e,t,n)}))),e}function JE(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return JE(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function eA(){this.__u=0,this.t=null,this.__b=null}function tA(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function nA(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),ZE&&ZE(e)},(eA.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=tA(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=JE(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},eA.prototype.componentWillUnmount=function(){this.t=[]},eA.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=QE(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var rA=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(nA.prototype=new om).__a=function(e){var t=this,n=tA(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),rA(t,e,r)):a()};n?n(i):i()}},nA.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},nA.prototype.componentDidUpdate=nA.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){rA(e,n,t)}))};var aA="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,iA=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,oA="undefined"!=typeof document,sA=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var lA=Xp.event;function cA(){}function uA(){return this.cancelBubble}function hA(){return this.defaultPrevented}Xp.event=function(e){return lA&&(e=lA(e)),e.persist=cA,e.isPropagationStopped=uA,e.isDefaultPrevented=hA,e.nativeEvent=e};var dA={configurable:!0,get:function(){return this.class}},pA=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];oA&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!sA(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&iA.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(dA.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",dA))}e.$$typeof=aA,pA&&pA(e)};var mA=Xp.__r;Xp.__r=function(e){mA&&mA(e),e.__c};(class extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=DE;(class extends GE{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=DE;const _A="rgb(0,0,0)";var gA=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(gA||{});class fA{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return fA.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new fA(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new fA(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new fA(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new fA(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new fA(this.x*e,this.y*t)}divide(e){return new fA(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new fA(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new fA(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new fA(Math.floor(this.x),Math.floor(this.y))}fract(){return new fA(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=fA.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return fA.NormalizeToRef(this,this),this}clone(){return new fA(this.x,this.y)}static Zero(){return new fA(0,0)}static One(){return new fA(1,1)}static FromArray(e,t=0){return new fA(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new fA(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new fA(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new fA(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=fA.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new fA(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=fA.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new fA(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new fA(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new fA(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new fA(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(fA.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return fA.CenterToRef(e,t,fA.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=fA.DistanceSquared(t,n);if(0===r)return fA.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,fA.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return fA.Distance(e,o)}static create(e,t){return new fA(e,t)}}function yA(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===gA.TOP?(r=s,a=l,i=c,o=l):t===gA.BOTTOM?(r=s,a=u,i=c,o=u):t===gA.LEFT?(r=s,a=l,i=s,o=u):t===gA.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function vA(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function bA(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function xA(e,t,n,r,a=fA.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new fA(0,0),new fA(1,1);const wA="rgb(",TA=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${wA+e.join(",")})`:"rgb(0,0,0)";function CA(e,t){return Math.round(e*t)/t}function EA(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class AA{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return EA(e)}}const SA=Ss.create(),DA=Ss.create(),RA=Ss.create(),NA=Ss.create();class MA extends AA{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}NA.add(new class extends MA{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=fA.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||_A;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});NA.add(new class extends MA{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=fA.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});NA.add(new class extends MA{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=EA(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=fA.create(0,0),centerPoint:f=fA.create(0,0),alignOffset:y=fA.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||_A;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=CA(o+1-.5,d),i=xA(g.addByPoint(l,a),f,b,x,y),s=xA(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||_A;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=CA(h-.5,d),i=xA(g.addByPoint(l,a),f,b,x,y),o=xA(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||_A;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=CA(-1.5,d),i=xA(g.addByPoint(l,a),f,b,x,y),o=xA(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});NA.add(new class extends MA{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=fA.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||_A;r!==this._preBorderStyle&&(vA(e,r),e.lineWidth=bA(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||_A,this._preBorderColor=i),yA(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(gA.TOP,t),n&&i.set(gA.BOTTOM,n),r&&i.set(gA.LEFT,r),a&&i.set(gA.RIGHT,a),i}});class OA extends AA{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}SA.add(new class extends OA{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||TA([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=CA(a,p),o=CA(o,p),s=CA(s,d),c=CA(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});SA.add(new class extends OA{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=CA(i,_),s=CA(s,_),c=CA(c,m),h=CA(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(vA(e,u),e.lineWidth=bA(u)/g,f=u),d!==y&&(e.strokeStyle=d||_A,y=d),yA(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===gA.TOP||t===gA.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===gA.LEFT&&e>r&&e<=i||t===gA.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});SA.add(new class extends OA{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=TA([217,217,217]);let y=CA(m,f),v=CA(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=CA(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=CA(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=CA(n[o-1]||0,t),h=CA(n[s],t),d=CA(r[l-1]||0,t),p=CA(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});SA.add(new class extends OA{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=CA(o,g),c=CA(c,g),h=CA(h,_),p=CA(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=CA(o[t-1]||0,i),c=CA(o[n],i),u=CA(s[r-1]||0,i),h=CA(s[a],i);e.rect(u,l,h-u,c-l)}});DA.add(new class extends OA{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=TA([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=TA([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=TA([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=CA(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(CA(a,m),0),e.lineTo(CA(a,m),p),e.stroke()}});RA.add(new class extends OA{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=TA([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=TA([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=TA([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=CA(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=CA(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var kA,IA,PA,LA=[],BA=[],FA=Xp.__b,HA=Xp.__r,qA=Xp.diffed,UA=Xp.__c,VA=Xp.unmount;function WA(){for(var e;e=LA.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(GA),e.__H.__h.forEach(XA),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),kA=null,FA&&FA(e)},Xp.__r=function(e){HA&&HA(e);var t=(kA=e.__c).__H;t&&(IA===kA?(t.__h=[],kA.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=BA,e.__N=e.i=void 0}))):(t.__h.forEach(GA),t.__h.forEach(XA),t.__h=[])),IA=kA},Xp.diffed=function(e){qA&&qA(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==LA.push(t)&&PA===Xp.requestAnimationFrame||((PA=Xp.requestAnimationFrame)||YA)(WA)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==BA&&(e.__=e.__V),e.i=void 0,e.__V=BA}))),IA=kA=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(GA),e.__h=e.__h.filter((function(e){return!e.__||XA(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),UA&&UA(e,t)},Xp.unmount=function(e){VA&&VA(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{GA(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var zA="function"==typeof requestAnimationFrame;function YA(e){var t,n=function(){clearTimeout(r),zA&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);zA&&(t=requestAnimationFrame(n))}function GA(e){var t=kA,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),kA=t}function XA(e){var t=kA;e.__c=e.__(),kA=t}jE(((e,t)=>{const{children:n,style:r,className:a,onClick:i}=e;return rm("div",{ref:t,style:r,className:a,onClick:i},n)}));const $A=Sm({});var jA,KA,ZA,QA=[],JA=[],eS=Xp.__b,tS=Xp.__r,nS=Xp.diffed,rS=Xp.__c,aS=Xp.unmount;function iS(){for(var e;e=QA.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(lS),e.__H.__h.forEach(cS),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),jA=null,eS&&eS(e)},Xp.__r=function(e){tS&&tS(e);var t=(jA=e.__c).__H;t&&(KA===jA?(t.__h=[],jA.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=JA,e.__N=e.i=void 0}))):(t.__h.forEach(lS),t.__h.forEach(cS),t.__h=[])),KA=jA},Xp.diffed=function(e){nS&&nS(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==QA.push(t)&&ZA===Xp.requestAnimationFrame||((ZA=Xp.requestAnimationFrame)||sS)(iS)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==JA&&(e.__=e.__V),e.i=void 0,e.__V=JA}))),KA=jA=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(lS),e.__h=e.__h.filter((function(e){return!e.__||cS(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),rS&&rS(e,t)},Xp.unmount=function(e){aS&&aS(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{lS(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var oS="function"==typeof requestAnimationFrame;function sS(e){var t,n=function(){clearTimeout(r),oS&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);oS&&(t=requestAnimationFrame(n))}function lS(e){var t=jA,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),jA=t}function cS(e){var t=jA;e.__c=e.__(),jA=t}function uS(e,t){for(var n in t)e[n]=t[n];return e}function hS(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function dS(e){this.props=e}(dS.prototype=new om).isPureReactComponent=!0,dS.prototype.shouldComponentUpdate=function(e,t){return hS(this.props,e)||hS(this.state,t)};var pS=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),pS&&pS(e)};var mS="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function _S(e){function t(t){var n=uS({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=mS,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var gS=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);gS(e,t,n,r)};var fS=Xp.unmount;function yS(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=uS({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return yS(e,t,n)}))),e}function vS(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return vS(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function bS(){this.__u=0,this.t=null,this.__b=null}function xS(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function wS(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),fS&&fS(e)},(bS.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=xS(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=vS(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},bS.prototype.componentWillUnmount=function(){this.t=[]},bS.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=yS(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var TS=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(wS.prototype=new om).__a=function(e){var t=this,n=xS(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),TS(t,e,r)):a()};n?n(i):i()}},wS.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},wS.prototype.componentDidUpdate=wS.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){TS(e,n,t)}))};var CS="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,ES=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,AS="undefined"!=typeof document,SS=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var DS=Xp.event;function RS(){}function NS(){return this.cancelBubble}function MS(){return this.defaultPrevented}Xp.event=function(e){return DS&&(e=DS(e)),e.persist=RS,e.isPropagationStopped=NS,e.isDefaultPrevented=MS,e.nativeEvent=e};var OS={configurable:!0,get:function(){return this.class}},kS=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];AS&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!SS(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&ES.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(OS.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",OS))}e.$$typeof=CS,kS&&kS(e)};var IS=Xp.__r;Xp.__r=function(e){IS&&IS(e),e.__c};(class extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=$A;(class extends dS{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=$A;const PS="rgb(0,0,0)";var LS=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(LS||{});class BS{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return BS.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new BS(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new BS(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new BS(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new BS(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new BS(this.x*e,this.y*t)}divide(e){return new BS(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new BS(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new BS(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new BS(Math.floor(this.x),Math.floor(this.y))}fract(){return new BS(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=BS.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return BS.NormalizeToRef(this,this),this}clone(){return new BS(this.x,this.y)}static Zero(){return new BS(0,0)}static One(){return new BS(1,1)}static FromArray(e,t=0){return new BS(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new BS(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new BS(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new BS(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=BS.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new BS(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=BS.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new BS(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new BS(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new BS(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new BS(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(BS.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return BS.CenterToRef(e,t,BS.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=BS.DistanceSquared(t,n);if(0===r)return BS.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,BS.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return BS.Distance(e,o)}static create(e,t){return new BS(e,t)}}function FS(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===LS.TOP?(r=s,a=l,i=c,o=l):t===LS.BOTTOM?(r=s,a=u,i=c,o=u):t===LS.LEFT?(r=s,a=l,i=s,o=u):t===LS.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function HS(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function qS(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function US(e,t,n,r,a=BS.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new BS(0,0),new BS(1,1);const VS="rgb(",WS=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${VS+e.join(",")})`:"rgb(0,0,0)";function zS(e,t){return Math.round(e*t)/t}function YS(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class GS{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return YS(e)}}const XS=Ss.create(),$S=Ss.create(),jS=Ss.create(),KS=Ss.create();class ZS extends GS{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}KS.add(new class extends ZS{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=BS.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||PS;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});KS.add(new class extends ZS{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=BS.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});KS.add(new class extends ZS{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=YS(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=BS.create(0,0),centerPoint:f=BS.create(0,0),alignOffset:y=BS.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||PS;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=zS(o+1-.5,d),i=US(g.addByPoint(l,a),f,b,x,y),s=US(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||PS;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=zS(h-.5,d),i=US(g.addByPoint(l,a),f,b,x,y),o=US(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||PS;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=zS(-1.5,d),i=US(g.addByPoint(l,a),f,b,x,y),o=US(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});KS.add(new class extends ZS{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=BS.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||PS;r!==this._preBorderStyle&&(HS(e,r),e.lineWidth=qS(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||PS,this._preBorderColor=i),FS(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(LS.TOP,t),n&&i.set(LS.BOTTOM,n),r&&i.set(LS.LEFT,r),a&&i.set(LS.RIGHT,a),i}});class QS extends GS{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}XS.add(new class extends QS{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||WS([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=zS(a,p),o=zS(o,p),s=zS(s,d),c=zS(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});XS.add(new class extends QS{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=zS(i,_),s=zS(s,_),c=zS(c,m),h=zS(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(HS(e,u),e.lineWidth=qS(u)/g,f=u),d!==y&&(e.strokeStyle=d||PS,y=d),FS(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===LS.TOP||t===LS.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===LS.LEFT&&e>r&&e<=i||t===LS.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});XS.add(new class extends QS{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=WS([217,217,217]);let y=zS(m,f),v=zS(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=zS(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=zS(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=zS(n[o-1]||0,t),h=zS(n[s],t),d=zS(r[l-1]||0,t),p=zS(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});XS.add(new class extends QS{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=zS(o,g),c=zS(c,g),h=zS(h,_),p=zS(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=zS(o[t-1]||0,i),c=zS(o[n],i),u=zS(s[r-1]||0,i),h=zS(s[a],i);e.rect(u,l,h-u,c-l)}});$S.add(new class extends QS{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=WS([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=WS([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=WS([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=zS(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(zS(a,m),0),e.lineTo(zS(a,m),p),e.stroke()}});jS.add(new class extends QS{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=WS([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=WS([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=WS([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=zS(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=zS(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var JS,eD,tD,nD=[],rD=[],aD=Xp.__b,iD=Xp.__r,oD=Xp.diffed,sD=Xp.__c,lD=Xp.unmount;function cD(){for(var e;e=nD.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(dD),e.__H.__h.forEach(pD),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),JS=null,aD&&aD(e)},Xp.__r=function(e){iD&&iD(e);var t=(JS=e.__c).__H;t&&(eD===JS?(t.__h=[],JS.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=rD,e.__N=e.i=void 0}))):(t.__h.forEach(dD),t.__h.forEach(pD),t.__h=[])),eD=JS},Xp.diffed=function(e){oD&&oD(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==nD.push(t)&&tD===Xp.requestAnimationFrame||((tD=Xp.requestAnimationFrame)||hD)(cD)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==rD&&(e.__=e.__V),e.i=void 0,e.__V=rD}))),eD=JS=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(dD),e.__h=e.__h.filter((function(e){return!e.__||pD(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),sD&&sD(e,t)},Xp.unmount=function(e){lD&&lD(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{dD(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var uD="function"==typeof requestAnimationFrame;function hD(e){var t,n=function(){clearTimeout(r),uD&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);uD&&(t=requestAnimationFrame(n))}function dD(e){var t=JS,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),JS=t}function pD(e){var t=JS;e.__c=e.__(),JS=t}_S(((e,t)=>{const{children:n,style:r,className:a,onClick:i}=e;return rm("div",{ref:t,style:r,className:a,onClick:i},n)}));const mD=Sm({});var _D,gD,fD,yD=[],vD=[],bD=Xp.__b,xD=Xp.__r,wD=Xp.diffed,TD=Xp.__c,CD=Xp.unmount;function ED(){for(var e;e=yD.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(DD),e.__H.__h.forEach(RD),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),_D=null,bD&&bD(e)},Xp.__r=function(e){xD&&xD(e);var t=(_D=e.__c).__H;t&&(gD===_D?(t.__h=[],_D.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=vD,e.__N=e.i=void 0}))):(t.__h.forEach(DD),t.__h.forEach(RD),t.__h=[])),gD=_D},Xp.diffed=function(e){wD&&wD(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==yD.push(t)&&fD===Xp.requestAnimationFrame||((fD=Xp.requestAnimationFrame)||SD)(ED)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==vD&&(e.__=e.__V),e.i=void 0,e.__V=vD}))),gD=_D=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(DD),e.__h=e.__h.filter((function(e){return!e.__||RD(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),TD&&TD(e,t)},Xp.unmount=function(e){CD&&CD(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{DD(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var AD="function"==typeof requestAnimationFrame;function SD(e){var t,n=function(){clearTimeout(r),AD&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);AD&&(t=requestAnimationFrame(n))}function DD(e){var t=_D,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),_D=t}function RD(e){var t=_D;e.__c=e.__(),_D=t}function ND(e,t){for(var n in t)e[n]=t[n];return e}function MD(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function OD(e){this.props=e}(OD.prototype=new om).isPureReactComponent=!0,OD.prototype.shouldComponentUpdate=function(e,t){return MD(this.props,e)||MD(this.state,t)};var kD=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),kD&&kD(e)};var ID="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function PD(e){function t(t){var n=ND({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=ID,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var LD=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);LD(e,t,n,r)};var BD=Xp.unmount;function FD(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=ND({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return FD(e,t,n)}))),e}function HD(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return HD(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function qD(){this.__u=0,this.t=null,this.__b=null}function UD(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function VD(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),BD&&BD(e)},(qD.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=UD(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=HD(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},qD.prototype.componentWillUnmount=function(){this.t=[]},qD.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=FD(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var WD=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(VD.prototype=new om).__a=function(e){var t=this,n=UD(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),WD(t,e,r)):a()};n?n(i):i()}},VD.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},VD.prototype.componentDidUpdate=VD.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){WD(e,n,t)}))};var zD="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,YD=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,GD="undefined"!=typeof document,XD=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var $D=Xp.event;function jD(){}function KD(){return this.cancelBubble}function ZD(){return this.defaultPrevented}Xp.event=function(e){return $D&&(e=$D(e)),e.persist=jD,e.isPropagationStopped=KD,e.isDefaultPrevented=ZD,e.nativeEvent=e};var QD={configurable:!0,get:function(){return this.class}},JD=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];GD&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!XD(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&YD.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(QD.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",QD))}e.$$typeof=zD,JD&&JD(e)};var eR=Xp.__r;Xp.__r=function(e){eR&&eR(e),e.__c};(class extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=mD;(class extends OD{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=mD;const tR="rgb(0,0,0)";var nR=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(nR||{});class rR{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return rR.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new rR(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new rR(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new rR(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new rR(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new rR(this.x*e,this.y*t)}divide(e){return new rR(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new rR(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new rR(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new rR(Math.floor(this.x),Math.floor(this.y))}fract(){return new rR(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=rR.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return rR.NormalizeToRef(this,this),this}clone(){return new rR(this.x,this.y)}static Zero(){return new rR(0,0)}static One(){return new rR(1,1)}static FromArray(e,t=0){return new rR(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new rR(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new rR(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new rR(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=rR.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new rR(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=rR.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new rR(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new rR(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new rR(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new rR(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(rR.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return rR.CenterToRef(e,t,rR.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=rR.DistanceSquared(t,n);if(0===r)return rR.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,rR.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return rR.Distance(e,o)}static create(e,t){return new rR(e,t)}}function aR(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===nR.TOP?(r=s,a=l,i=c,o=l):t===nR.BOTTOM?(r=s,a=u,i=c,o=u):t===nR.LEFT?(r=s,a=l,i=s,o=u):t===nR.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function iR(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function oR(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function sR(e,t,n,r,a=rR.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new rR(0,0),new rR(1,1);const lR="rgb(",cR=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${lR+e.join(",")})`:"rgb(0,0,0)";function uR(e,t){return Math.round(e*t)/t}function hR(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class dR{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return hR(e)}}const pR=Ss.create(),mR=Ss.create(),_R=Ss.create(),gR=Ss.create();class fR extends dR{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}gR.add(new class extends fR{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=rR.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||tR;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});gR.add(new class extends fR{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=rR.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});gR.add(new class extends fR{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=hR(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=rR.create(0,0),centerPoint:f=rR.create(0,0),alignOffset:y=rR.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||tR;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=uR(o+1-.5,d),i=sR(g.addByPoint(l,a),f,b,x,y),s=sR(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||tR;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=uR(h-.5,d),i=sR(g.addByPoint(l,a),f,b,x,y),o=sR(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||tR;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=uR(-1.5,d),i=sR(g.addByPoint(l,a),f,b,x,y),o=sR(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});gR.add(new class extends fR{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=rR.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||tR;r!==this._preBorderStyle&&(iR(e,r),e.lineWidth=oR(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||tR,this._preBorderColor=i),aR(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(nR.TOP,t),n&&i.set(nR.BOTTOM,n),r&&i.set(nR.LEFT,r),a&&i.set(nR.RIGHT,a),i}});class yR extends dR{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}pR.add(new class extends yR{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||cR([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=uR(a,p),o=uR(o,p),s=uR(s,d),c=uR(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});pR.add(new class extends yR{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=uR(i,_),s=uR(s,_),c=uR(c,m),h=uR(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(iR(e,u),e.lineWidth=oR(u)/g,f=u),d!==y&&(e.strokeStyle=d||tR,y=d),aR(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===nR.TOP||t===nR.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===nR.LEFT&&e>r&&e<=i||t===nR.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});pR.add(new class extends yR{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=cR([217,217,217]);let y=uR(m,f),v=uR(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=uR(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=uR(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=uR(n[o-1]||0,t),h=uR(n[s],t),d=uR(r[l-1]||0,t),p=uR(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});pR.add(new class extends yR{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=uR(o,g),c=uR(c,g),h=uR(h,_),p=uR(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=uR(o[t-1]||0,i),c=uR(o[n],i),u=uR(s[r-1]||0,i),h=uR(s[a],i);e.rect(u,l,h-u,c-l)}});mR.add(new class extends yR{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=cR([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=cR([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=cR([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=uR(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(uR(a,m),0),e.lineTo(uR(a,m),p),e.stroke()}});_R.add(new class extends yR{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=cR([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=cR([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=cR([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=uR(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=uR(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var vR,bR,xR,wR=[],TR=[],CR=Xp.__b,ER=Xp.__r,AR=Xp.diffed,SR=Xp.__c,DR=Xp.unmount;function RR(){for(var e;e=wR.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(OR),e.__H.__h.forEach(kR),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),vR=null,CR&&CR(e)},Xp.__r=function(e){ER&&ER(e);var t=(vR=e.__c).__H;t&&(bR===vR?(t.__h=[],vR.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=TR,e.__N=e.i=void 0}))):(t.__h.forEach(OR),t.__h.forEach(kR),t.__h=[])),bR=vR},Xp.diffed=function(e){AR&&AR(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==wR.push(t)&&xR===Xp.requestAnimationFrame||((xR=Xp.requestAnimationFrame)||MR)(RR)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==TR&&(e.__=e.__V),e.i=void 0,e.__V=TR}))),bR=vR=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(OR),e.__h=e.__h.filter((function(e){return!e.__||kR(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),SR&&SR(e,t)},Xp.unmount=function(e){DR&&DR(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{OR(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var NR="function"==typeof requestAnimationFrame;function MR(e){var t,n=function(){clearTimeout(r),NR&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);NR&&(t=requestAnimationFrame(n))}function OR(e){var t=vR,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),vR=t}function kR(e){var t=vR;e.__c=e.__(),vR=t}PD(((e,t)=>{const{children:n,style:r,className:a,onClick:i}=e;return rm("div",{ref:t,style:r,className:a,onClick:i},n)}));const IR=Sm({});var PR,LR,BR,FR=[],HR=[],qR=Xp.__b,UR=Xp.__r,VR=Xp.diffed,WR=Xp.__c,zR=Xp.unmount;function YR(){for(var e;e=FR.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach($R),e.__H.__h.forEach(jR),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),PR=null,qR&&qR(e)},Xp.__r=function(e){UR&&UR(e);var t=(PR=e.__c).__H;t&&(LR===PR?(t.__h=[],PR.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=HR,e.__N=e.i=void 0}))):(t.__h.forEach($R),t.__h.forEach(jR),t.__h=[])),LR=PR},Xp.diffed=function(e){VR&&VR(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==FR.push(t)&&BR===Xp.requestAnimationFrame||((BR=Xp.requestAnimationFrame)||XR)(YR)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==HR&&(e.__=e.__V),e.i=void 0,e.__V=HR}))),LR=PR=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach($R),e.__h=e.__h.filter((function(e){return!e.__||jR(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),WR&&WR(e,t)},Xp.unmount=function(e){zR&&zR(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{$R(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var GR="function"==typeof requestAnimationFrame;function XR(e){var t,n=function(){clearTimeout(r),GR&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);GR&&(t=requestAnimationFrame(n))}function $R(e){var t=PR,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),PR=t}function jR(e){var t=PR;e.__c=e.__(),PR=t}function KR(e,t){for(var n in t)e[n]=t[n];return e}function ZR(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function QR(e){this.props=e}(QR.prototype=new om).isPureReactComponent=!0,QR.prototype.shouldComponentUpdate=function(e,t){return ZR(this.props,e)||ZR(this.state,t)};var JR=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),JR&&JR(e)};var eN="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function tN(e){function t(t){var n=KR({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=eN,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var nN=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);nN(e,t,n,r)};var rN=Xp.unmount;function aN(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=KR({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return aN(e,t,n)}))),e}function iN(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return iN(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function oN(){this.__u=0,this.t=null,this.__b=null}function sN(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function lN(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),rN&&rN(e)},(oN.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=sN(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=iN(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},oN.prototype.componentWillUnmount=function(){this.t=[]},oN.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=aN(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var cN=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(lN.prototype=new om).__a=function(e){var t=this,n=sN(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),cN(t,e,r)):a()};n?n(i):i()}},lN.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},lN.prototype.componentDidUpdate=lN.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){cN(e,n,t)}))};var uN="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,hN=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,dN="undefined"!=typeof document,pN=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var mN=Xp.event;function _N(){}function gN(){return this.cancelBubble}function fN(){return this.defaultPrevented}Xp.event=function(e){return mN&&(e=mN(e)),e.persist=_N,e.isPropagationStopped=gN,e.isDefaultPrevented=fN,e.nativeEvent=e};var yN={configurable:!0,get:function(){return this.class}},vN=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];dN&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!pN(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&hN.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(yN.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",yN))}e.$$typeof=uN,vN&&vN(e)};var bN=Xp.__r;Xp.__r=function(e){bN&&bN(e),e.__c};(class extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=IR;(class extends QR{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=IR;const xN="rgb(0,0,0)";var wN=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(wN||{});class TN{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return TN.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new TN(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new TN(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new TN(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new TN(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new TN(this.x*e,this.y*t)}divide(e){return new TN(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new TN(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new TN(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new TN(Math.floor(this.x),Math.floor(this.y))}fract(){return new TN(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=TN.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return TN.NormalizeToRef(this,this),this}clone(){return new TN(this.x,this.y)}static Zero(){return new TN(0,0)}static One(){return new TN(1,1)}static FromArray(e,t=0){return new TN(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new TN(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new TN(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new TN(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=TN.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new TN(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=TN.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new TN(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new TN(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new TN(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new TN(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(TN.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return TN.CenterToRef(e,t,TN.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=TN.DistanceSquared(t,n);if(0===r)return TN.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,TN.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return TN.Distance(e,o)}static create(e,t){return new TN(e,t)}}function CN(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===wN.TOP?(r=s,a=l,i=c,o=l):t===wN.BOTTOM?(r=s,a=u,i=c,o=u):t===wN.LEFT?(r=s,a=l,i=s,o=u):t===wN.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function EN(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function AN(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function SN(e,t,n,r,a=TN.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new TN(0,0),new TN(1,1);const DN="rgb(",RN=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${DN+e.join(",")})`:"rgb(0,0,0)";function NN(e,t){return Math.round(e*t)/t}function MN(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class ON{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return MN(e)}}const kN=Ss.create(),IN=Ss.create(),PN=Ss.create(),LN=Ss.create();class BN extends ON{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}LN.add(new class extends BN{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=TN.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||xN;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});LN.add(new class extends BN{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=TN.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});LN.add(new class extends BN{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=MN(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=TN.create(0,0),centerPoint:f=TN.create(0,0),alignOffset:y=TN.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||xN;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=NN(o+1-.5,d),i=SN(g.addByPoint(l,a),f,b,x,y),s=SN(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||xN;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=NN(h-.5,d),i=SN(g.addByPoint(l,a),f,b,x,y),o=SN(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||xN;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=NN(-1.5,d),i=SN(g.addByPoint(l,a),f,b,x,y),o=SN(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});LN.add(new class extends BN{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=TN.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||xN;r!==this._preBorderStyle&&(EN(e,r),e.lineWidth=AN(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||xN,this._preBorderColor=i),CN(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(wN.TOP,t),n&&i.set(wN.BOTTOM,n),r&&i.set(wN.LEFT,r),a&&i.set(wN.RIGHT,a),i}});class FN extends ON{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}kN.add(new class extends FN{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||RN([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=NN(a,p),o=NN(o,p),s=NN(s,d),c=NN(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});kN.add(new class extends FN{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=NN(i,_),s=NN(s,_),c=NN(c,m),h=NN(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(EN(e,u),e.lineWidth=AN(u)/g,f=u),d!==y&&(e.strokeStyle=d||xN,y=d),CN(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===wN.TOP||t===wN.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===wN.LEFT&&e>r&&e<=i||t===wN.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});kN.add(new class extends FN{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=RN([217,217,217]);let y=NN(m,f),v=NN(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=NN(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=NN(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=NN(n[o-1]||0,t),h=NN(n[s],t),d=NN(r[l-1]||0,t),p=NN(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});kN.add(new class extends FN{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=NN(o,g),c=NN(c,g),h=NN(h,_),p=NN(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=NN(o[t-1]||0,i),c=NN(o[n],i),u=NN(s[r-1]||0,i),h=NN(s[a],i);e.rect(u,l,h-u,c-l)}});IN.add(new class extends FN{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=RN([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=RN([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=RN([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=NN(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(NN(a,m),0),e.lineTo(NN(a,m),p),e.stroke()}});PN.add(new class extends FN{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=RN([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=RN([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=RN([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=NN(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=NN(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var HN,qN,UN,VN=[],WN=[],zN=Xp.__b,YN=Xp.__r,GN=Xp.diffed,XN=Xp.__c,$N=Xp.unmount;function jN(){for(var e;e=VN.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(QN),e.__H.__h.forEach(JN),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),HN=null,zN&&zN(e)},Xp.__r=function(e){YN&&YN(e);var t=(HN=e.__c).__H;t&&(qN===HN?(t.__h=[],HN.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=WN,e.__N=e.i=void 0}))):(t.__h.forEach(QN),t.__h.forEach(JN),t.__h=[])),qN=HN},Xp.diffed=function(e){GN&&GN(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==VN.push(t)&&UN===Xp.requestAnimationFrame||((UN=Xp.requestAnimationFrame)||ZN)(jN)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==WN&&(e.__=e.__V),e.i=void 0,e.__V=WN}))),qN=HN=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(QN),e.__h=e.__h.filter((function(e){return!e.__||JN(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),XN&&XN(e,t)},Xp.unmount=function(e){$N&&$N(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{QN(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var KN="function"==typeof requestAnimationFrame;function ZN(e){var t,n=function(){clearTimeout(r),KN&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);KN&&(t=requestAnimationFrame(n))}function QN(e){var t=HN,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),HN=t}function JN(e){var t=HN;e.__c=e.__(),HN=t}tN(((e,t)=>{const{children:n,style:r,className:a,onClick:i}=e;return rm("div",{ref:t,style:r,className:a,onClick:i},n)}));const eM=Sm({});var tM,nM,rM,aM=[],iM=[],oM=Xp.__b,sM=Xp.__r,lM=Xp.diffed,cM=Xp.__c,uM=Xp.unmount;function hM(){for(var e;e=aM.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(mM),e.__H.__h.forEach(_M),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),tM=null,oM&&oM(e)},Xp.__r=function(e){sM&&sM(e);var t=(tM=e.__c).__H;t&&(nM===tM?(t.__h=[],tM.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=iM,e.__N=e.i=void 0}))):(t.__h.forEach(mM),t.__h.forEach(_M),t.__h=[])),nM=tM},Xp.diffed=function(e){lM&&lM(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==aM.push(t)&&rM===Xp.requestAnimationFrame||((rM=Xp.requestAnimationFrame)||pM)(hM)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==iM&&(e.__=e.__V),e.i=void 0,e.__V=iM}))),nM=tM=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(mM),e.__h=e.__h.filter((function(e){return!e.__||_M(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),cM&&cM(e,t)},Xp.unmount=function(e){uM&&uM(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{mM(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var dM="function"==typeof requestAnimationFrame;function pM(e){var t,n=function(){clearTimeout(r),dM&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);dM&&(t=requestAnimationFrame(n))}function mM(e){var t=tM,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),tM=t}function _M(e){var t=tM;e.__c=e.__(),tM=t}function gM(e,t){for(var n in t)e[n]=t[n];return e}function fM(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function yM(e){this.props=e}(yM.prototype=new om).isPureReactComponent=!0,yM.prototype.shouldComponentUpdate=function(e,t){return fM(this.props,e)||fM(this.state,t)};var vM=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),vM&&vM(e)};var bM="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function xM(e){function t(t){var n=gM({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=bM,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var wM=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);wM(e,t,n,r)};var TM=Xp.unmount;function CM(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=gM({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return CM(e,t,n)}))),e}function EM(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return EM(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function AM(){this.__u=0,this.t=null,this.__b=null}function SM(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function DM(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),TM&&TM(e)},(AM.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=SM(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=EM(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},AM.prototype.componentWillUnmount=function(){this.t=[]},AM.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=CM(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var RM=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(DM.prototype=new om).__a=function(e){var t=this,n=SM(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),RM(t,e,r)):a()};n?n(i):i()}},DM.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},DM.prototype.componentDidUpdate=DM.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){RM(e,n,t)}))};var NM="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,MM=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,OM="undefined"!=typeof document,kM=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var IM=Xp.event;function PM(){}function LM(){return this.cancelBubble}function BM(){return this.defaultPrevented}Xp.event=function(e){return IM&&(e=IM(e)),e.persist=PM,e.isPropagationStopped=LM,e.isDefaultPrevented=BM,e.nativeEvent=e};var FM={configurable:!0,get:function(){return this.class}},HM=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];OM&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!kM(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&MM.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(FM.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",FM))}e.$$typeof=NM,HM&&HM(e)};var qM=Xp.__r;Xp.__r=function(e){qM&&qM(e),e.__c};(class extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=eM;(class extends yM{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=eM;const UM="rgb(0,0,0)";var VM=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(VM||{});class WM{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return WM.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new WM(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new WM(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new WM(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new WM(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new WM(this.x*e,this.y*t)}divide(e){return new WM(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new WM(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new WM(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new WM(Math.floor(this.x),Math.floor(this.y))}fract(){return new WM(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=WM.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return WM.NormalizeToRef(this,this),this}clone(){return new WM(this.x,this.y)}static Zero(){return new WM(0,0)}static One(){return new WM(1,1)}static FromArray(e,t=0){return new WM(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new WM(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new WM(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new WM(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=WM.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new WM(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=WM.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new WM(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new WM(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new WM(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new WM(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(WM.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return WM.CenterToRef(e,t,WM.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=WM.DistanceSquared(t,n);if(0===r)return WM.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,WM.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return WM.Distance(e,o)}static create(e,t){return new WM(e,t)}}function zM(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===VM.TOP?(r=s,a=l,i=c,o=l):t===VM.BOTTOM?(r=s,a=u,i=c,o=u):t===VM.LEFT?(r=s,a=l,i=s,o=u):t===VM.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function YM(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function GM(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function XM(e,t,n,r,a=WM.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new WM(0,0),new WM(1,1);const $M="rgb(",jM=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${$M+e.join(",")})`:"rgb(0,0,0)";function KM(e,t){return Math.round(e*t)/t}function ZM(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class QM{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return ZM(e)}}const JM=Ss.create(),eO=Ss.create(),tO=Ss.create(),nO=Ss.create();class rO extends QM{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}nO.add(new class extends rO{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=WM.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||UM;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});nO.add(new class extends rO{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=WM.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});nO.add(new class extends rO{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=ZM(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=WM.create(0,0),centerPoint:f=WM.create(0,0),alignOffset:y=WM.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||UM;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=KM(o+1-.5,d),i=XM(g.addByPoint(l,a),f,b,x,y),s=XM(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||UM;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=KM(h-.5,d),i=XM(g.addByPoint(l,a),f,b,x,y),o=XM(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||UM;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=KM(-1.5,d),i=XM(g.addByPoint(l,a),f,b,x,y),o=XM(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});nO.add(new class extends rO{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=WM.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||UM;r!==this._preBorderStyle&&(YM(e,r),e.lineWidth=GM(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||UM,this._preBorderColor=i),zM(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(VM.TOP,t),n&&i.set(VM.BOTTOM,n),r&&i.set(VM.LEFT,r),a&&i.set(VM.RIGHT,a),i}});class aO extends QM{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}JM.add(new class extends aO{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||jM([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=KM(a,p),o=KM(o,p),s=KM(s,d),c=KM(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});JM.add(new class extends aO{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=KM(i,_),s=KM(s,_),c=KM(c,m),h=KM(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(YM(e,u),e.lineWidth=GM(u)/g,f=u),d!==y&&(e.strokeStyle=d||UM,y=d),zM(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===VM.TOP||t===VM.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===VM.LEFT&&e>r&&e<=i||t===VM.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});JM.add(new class extends aO{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=jM([217,217,217]);let y=KM(m,f),v=KM(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=KM(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=KM(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=KM(n[o-1]||0,t),h=KM(n[s],t),d=KM(r[l-1]||0,t),p=KM(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});JM.add(new class extends aO{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=KM(o,g),c=KM(c,g),h=KM(h,_),p=KM(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=KM(o[t-1]||0,i),c=KM(o[n],i),u=KM(s[r-1]||0,i),h=KM(s[a],i);e.rect(u,l,h-u,c-l)}});eO.add(new class extends aO{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=jM([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=jM([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=jM([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=KM(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(KM(a,m),0),e.lineTo(KM(a,m),p),e.stroke()}});tO.add(new class extends aO{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=jM([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=jM([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=jM([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=KM(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=KM(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var iO,oO,sO,lO=[],cO=[],uO=Xp.__b,hO=Xp.__r,dO=Xp.diffed,pO=Xp.__c,mO=Xp.unmount;function _O(){for(var e;e=lO.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(yO),e.__H.__h.forEach(vO),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),iO=null,uO&&uO(e)},Xp.__r=function(e){hO&&hO(e);var t=(iO=e.__c).__H;t&&(oO===iO?(t.__h=[],iO.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=cO,e.__N=e.i=void 0}))):(t.__h.forEach(yO),t.__h.forEach(vO),t.__h=[])),oO=iO},Xp.diffed=function(e){dO&&dO(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==lO.push(t)&&sO===Xp.requestAnimationFrame||((sO=Xp.requestAnimationFrame)||fO)(_O)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==cO&&(e.__=e.__V),e.i=void 0,e.__V=cO}))),oO=iO=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(yO),e.__h=e.__h.filter((function(e){return!e.__||vO(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),pO&&pO(e,t)},Xp.unmount=function(e){mO&&mO(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{yO(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var gO="function"==typeof requestAnimationFrame;function fO(e){var t,n=function(){clearTimeout(r),gO&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);gO&&(t=requestAnimationFrame(n))}function yO(e){var t=iO,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),iO=t}function vO(e){var t=iO;e.__c=e.__(),iO=t}xM(((e,t)=>{const{children:n,style:r,className:a,onClick:i}=e;return rm("div",{ref:t,style:r,className:a,onClick:i},n)}));const bO=Sm({});var xO,wO,TO,CO=[],EO=[],AO=Xp.__b,SO=Xp.__r,DO=Xp.diffed,RO=Xp.__c,NO=Xp.unmount;function MO(){for(var e;e=CO.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(IO),e.__H.__h.forEach(PO),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),xO=null,AO&&AO(e)},Xp.__r=function(e){SO&&SO(e);var t=(xO=e.__c).__H;t&&(wO===xO?(t.__h=[],xO.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=EO,e.__N=e.i=void 0}))):(t.__h.forEach(IO),t.__h.forEach(PO),t.__h=[])),wO=xO},Xp.diffed=function(e){DO&&DO(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==CO.push(t)&&TO===Xp.requestAnimationFrame||((TO=Xp.requestAnimationFrame)||kO)(MO)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==EO&&(e.__=e.__V),e.i=void 0,e.__V=EO}))),wO=xO=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(IO),e.__h=e.__h.filter((function(e){return!e.__||PO(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),RO&&RO(e,t)},Xp.unmount=function(e){NO&&NO(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{IO(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var OO="function"==typeof requestAnimationFrame;function kO(e){var t,n=function(){clearTimeout(r),OO&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);OO&&(t=requestAnimationFrame(n))}function IO(e){var t=xO,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),xO=t}function PO(e){var t=xO;e.__c=e.__(),xO=t}function LO(e,t){for(var n in t)e[n]=t[n];return e}function BO(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function FO(e){this.props=e}(FO.prototype=new om).isPureReactComponent=!0,FO.prototype.shouldComponentUpdate=function(e,t){return BO(this.props,e)||BO(this.state,t)};var HO=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),HO&&HO(e)};var qO="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function UO(e){function t(t){var n=LO({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=qO,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var VO=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);VO(e,t,n,r)};var WO=Xp.unmount;function zO(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=LO({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return zO(e,t,n)}))),e}function YO(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return YO(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function GO(){this.__u=0,this.t=null,this.__b=null}function XO(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function $O(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),WO&&WO(e)},(GO.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=XO(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=YO(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},GO.prototype.componentWillUnmount=function(){this.t=[]},GO.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=zO(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var jO=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};($O.prototype=new om).__a=function(e){var t=this,n=XO(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),jO(t,e,r)):a()};n?n(i):i()}},$O.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},$O.prototype.componentDidUpdate=$O.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){jO(e,n,t)}))};var KO="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,ZO=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,QO="undefined"!=typeof document,JO=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var ek=Xp.event;function tk(){}function nk(){return this.cancelBubble}function rk(){return this.defaultPrevented}Xp.event=function(e){return ek&&(e=ek(e)),e.persist=tk,e.isPropagationStopped=nk,e.isDefaultPrevented=rk,e.nativeEvent=e};var ak={configurable:!0,get:function(){return this.class}},ik=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];QO&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!JO(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&ZO.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(ak.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",ak))}e.$$typeof=KO,ik&&ik(e)};var ok=Xp.__r;Xp.__r=function(e){ok&&ok(e),e.__c};(class extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=bO;(class extends FO{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=bO;const sk="rgb(0,0,0)";var lk=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(lk||{});class ck{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return ck.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new ck(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new ck(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new ck(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new ck(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new ck(this.x*e,this.y*t)}divide(e){return new ck(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new ck(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new ck(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new ck(Math.floor(this.x),Math.floor(this.y))}fract(){return new ck(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=ck.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return ck.NormalizeToRef(this,this),this}clone(){return new ck(this.x,this.y)}static Zero(){return new ck(0,0)}static One(){return new ck(1,1)}static FromArray(e,t=0){return new ck(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new ck(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new ck(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new ck(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=ck.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new ck(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=ck.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new ck(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new ck(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new ck(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new ck(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(ck.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return ck.CenterToRef(e,t,ck.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=ck.DistanceSquared(t,n);if(0===r)return ck.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,ck.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return ck.Distance(e,o)}static create(e,t){return new ck(e,t)}}function uk(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===lk.TOP?(r=s,a=l,i=c,o=l):t===lk.BOTTOM?(r=s,a=u,i=c,o=u):t===lk.LEFT?(r=s,a=l,i=s,o=u):t===lk.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function hk(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function dk(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function pk(e,t,n,r,a=ck.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new ck(0,0),new ck(1,1);const mk="rgb(",_k=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${mk+e.join(",")})`:"rgb(0,0,0)";function gk(e,t){return Math.round(e*t)/t}function fk(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class yk{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return fk(e)}}const vk=Ss.create(),bk=Ss.create(),xk=Ss.create(),wk=Ss.create();class Tk extends yk{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}wk.add(new class extends Tk{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=ck.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||sk;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});wk.add(new class extends Tk{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=ck.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});wk.add(new class extends Tk{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=fk(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=ck.create(0,0),centerPoint:f=ck.create(0,0),alignOffset:y=ck.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||sk;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=gk(o+1-.5,d),i=pk(g.addByPoint(l,a),f,b,x,y),s=pk(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||sk;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=gk(h-.5,d),i=pk(g.addByPoint(l,a),f,b,x,y),o=pk(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||sk;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=gk(-1.5,d),i=pk(g.addByPoint(l,a),f,b,x,y),o=pk(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});wk.add(new class extends Tk{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=ck.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||sk;r!==this._preBorderStyle&&(hk(e,r),e.lineWidth=dk(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||sk,this._preBorderColor=i),uk(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(lk.TOP,t),n&&i.set(lk.BOTTOM,n),r&&i.set(lk.LEFT,r),a&&i.set(lk.RIGHT,a),i}});class Ck extends yk{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}vk.add(new class extends Ck{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||_k([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=gk(a,p),o=gk(o,p),s=gk(s,d),c=gk(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});vk.add(new class extends Ck{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=gk(i,_),s=gk(s,_),c=gk(c,m),h=gk(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(hk(e,u),e.lineWidth=dk(u)/g,f=u),d!==y&&(e.strokeStyle=d||sk,y=d),uk(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===lk.TOP||t===lk.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===lk.LEFT&&e>r&&e<=i||t===lk.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});vk.add(new class extends Ck{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=_k([217,217,217]);let y=gk(m,f),v=gk(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=gk(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=gk(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=gk(n[o-1]||0,t),h=gk(n[s],t),d=gk(r[l-1]||0,t),p=gk(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});vk.add(new class extends Ck{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=gk(o,g),c=gk(c,g),h=gk(h,_),p=gk(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=gk(o[t-1]||0,i),c=gk(o[n],i),u=gk(s[r-1]||0,i),h=gk(s[a],i);e.rect(u,l,h-u,c-l)}});bk.add(new class extends Ck{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=_k([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=_k([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=_k([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=gk(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(gk(a,m),0),e.lineTo(gk(a,m),p),e.stroke()}});xk.add(new class extends Ck{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=_k([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=_k([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=_k([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=gk(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=gk(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var Ek,Ak,Sk,Dk=[],Rk=[],Nk=Xp.__b,Mk=Xp.__r,Ok=Xp.diffed,kk=Xp.__c,Ik=Xp.unmount;function Pk(){for(var e;e=Dk.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Fk),e.__H.__h.forEach(Hk),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),Ek=null,Nk&&Nk(e)},Xp.__r=function(e){Mk&&Mk(e);var t=(Ek=e.__c).__H;t&&(Ak===Ek?(t.__h=[],Ek.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=Rk,e.__N=e.i=void 0}))):(t.__h.forEach(Fk),t.__h.forEach(Hk),t.__h=[])),Ak=Ek},Xp.diffed=function(e){Ok&&Ok(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==Dk.push(t)&&Sk===Xp.requestAnimationFrame||((Sk=Xp.requestAnimationFrame)||Bk)(Pk)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==Rk&&(e.__=e.__V),e.i=void 0,e.__V=Rk}))),Ak=Ek=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(Fk),e.__h=e.__h.filter((function(e){return!e.__||Hk(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),kk&&kk(e,t)},Xp.unmount=function(e){Ik&&Ik(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{Fk(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var Lk="function"==typeof requestAnimationFrame;function Bk(e){var t,n=function(){clearTimeout(r),Lk&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);Lk&&(t=requestAnimationFrame(n))}function Fk(e){var t=Ek,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),Ek=t}function Hk(e){var t=Ek;e.__c=e.__(),Ek=t}UO(((e,t)=>{const{children:n,style:r,className:a,onClick:i}=e;return rm("div",{ref:t,style:r,className:a,onClick:i},n)}));const qk=Sm({});var Uk,Vk,Wk,zk=[],Yk=[],Gk=Xp.__b,Xk=Xp.__r,$k=Xp.diffed,jk=Xp.__c,Kk=Xp.unmount;function Zk(){for(var e;e=zk.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(eI),e.__H.__h.forEach(tI),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),Uk=null,Gk&&Gk(e)},Xp.__r=function(e){Xk&&Xk(e);var t=(Uk=e.__c).__H;t&&(Vk===Uk?(t.__h=[],Uk.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=Yk,e.__N=e.i=void 0}))):(t.__h.forEach(eI),t.__h.forEach(tI),t.__h=[])),Vk=Uk},Xp.diffed=function(e){$k&&$k(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==zk.push(t)&&Wk===Xp.requestAnimationFrame||((Wk=Xp.requestAnimationFrame)||Jk)(Zk)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==Yk&&(e.__=e.__V),e.i=void 0,e.__V=Yk}))),Vk=Uk=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(eI),e.__h=e.__h.filter((function(e){return!e.__||tI(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),jk&&jk(e,t)},Xp.unmount=function(e){Kk&&Kk(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{eI(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var Qk="function"==typeof requestAnimationFrame;function Jk(e){var t,n=function(){clearTimeout(r),Qk&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);Qk&&(t=requestAnimationFrame(n))}function eI(e){var t=Uk,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),Uk=t}function tI(e){var t=Uk;e.__c=e.__(),Uk=t}function nI(e,t){for(var n in t)e[n]=t[n];return e}function rI(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function aI(e){this.props=e}(aI.prototype=new om).isPureReactComponent=!0,aI.prototype.shouldComponentUpdate=function(e,t){return rI(this.props,e)||rI(this.state,t)};var iI=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),iI&&iI(e)};var oI="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function sI(e){function t(t){var n=nI({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=oI,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var lI=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);lI(e,t,n,r)};var cI=Xp.unmount;function uI(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=nI({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return uI(e,t,n)}))),e}function hI(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return hI(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function dI(){this.__u=0,this.t=null,this.__b=null}function pI(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function mI(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),cI&&cI(e)},(dI.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=pI(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=hI(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},dI.prototype.componentWillUnmount=function(){this.t=[]},dI.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=uI(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var _I=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(mI.prototype=new om).__a=function(e){var t=this,n=pI(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),_I(t,e,r)):a()};n?n(i):i()}},mI.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},mI.prototype.componentDidUpdate=mI.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){_I(e,n,t)}))};var gI="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,fI=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,yI="undefined"!=typeof document,vI=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var bI=Xp.event;function xI(){}function wI(){return this.cancelBubble}function TI(){return this.defaultPrevented}Xp.event=function(e){return bI&&(e=bI(e)),e.persist=xI,e.isPropagationStopped=wI,e.isDefaultPrevented=TI,e.nativeEvent=e};var CI={configurable:!0,get:function(){return this.class}},EI=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];yI&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!vI(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&fI.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(CI.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",CI))}e.$$typeof=gI,EI&&EI(e)};var AI=Xp.__r;Xp.__r=function(e){AI&&AI(e),e.__c};(class extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=qk;(class extends aI{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=qk;const SI="rgb(0,0,0)";var DI=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(DI||{});class RI{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return RI.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new RI(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new RI(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new RI(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new RI(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new RI(this.x*e,this.y*t)}divide(e){return new RI(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new RI(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new RI(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new RI(Math.floor(this.x),Math.floor(this.y))}fract(){return new RI(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=RI.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return RI.NormalizeToRef(this,this),this}clone(){return new RI(this.x,this.y)}static Zero(){return new RI(0,0)}static One(){return new RI(1,1)}static FromArray(e,t=0){return new RI(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new RI(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new RI(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new RI(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=RI.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new RI(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=RI.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new RI(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new RI(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new RI(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new RI(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(RI.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return RI.CenterToRef(e,t,RI.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=RI.DistanceSquared(t,n);if(0===r)return RI.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,RI.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return RI.Distance(e,o)}static create(e,t){return new RI(e,t)}}function NI(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===DI.TOP?(r=s,a=l,i=c,o=l):t===DI.BOTTOM?(r=s,a=u,i=c,o=u):t===DI.LEFT?(r=s,a=l,i=s,o=u):t===DI.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function MI(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function OI(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function kI(e,t,n,r,a=RI.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new RI(0,0),new RI(1,1);const II="rgb(",PI=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${II+e.join(",")})`:"rgb(0,0,0)";function LI(e,t){return Math.round(e*t)/t}function BI(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class FI{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return BI(e)}}const HI=Ss.create(),qI=Ss.create(),UI=Ss.create(),VI=Ss.create();class WI extends FI{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}VI.add(new class extends WI{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=RI.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||SI;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});VI.add(new class extends WI{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=RI.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});VI.add(new class extends WI{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=BI(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=RI.create(0,0),centerPoint:f=RI.create(0,0),alignOffset:y=RI.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||SI;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=LI(o+1-.5,d),i=kI(g.addByPoint(l,a),f,b,x,y),s=kI(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||SI;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=LI(h-.5,d),i=kI(g.addByPoint(l,a),f,b,x,y),o=kI(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||SI;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=LI(-1.5,d),i=kI(g.addByPoint(l,a),f,b,x,y),o=kI(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});VI.add(new class extends WI{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=RI.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||SI;r!==this._preBorderStyle&&(MI(e,r),e.lineWidth=OI(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||SI,this._preBorderColor=i),NI(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(DI.TOP,t),n&&i.set(DI.BOTTOM,n),r&&i.set(DI.LEFT,r),a&&i.set(DI.RIGHT,a),i}});class zI extends FI{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}HI.add(new class extends zI{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||PI([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=LI(a,p),o=LI(o,p),s=LI(s,d),c=LI(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});HI.add(new class extends zI{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=LI(i,_),s=LI(s,_),c=LI(c,m),h=LI(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(MI(e,u),e.lineWidth=OI(u)/g,f=u),d!==y&&(e.strokeStyle=d||SI,y=d),NI(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===DI.TOP||t===DI.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===DI.LEFT&&e>r&&e<=i||t===DI.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});HI.add(new class extends zI{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=PI([217,217,217]);let y=LI(m,f),v=LI(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=LI(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=LI(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=LI(n[o-1]||0,t),h=LI(n[s],t),d=LI(r[l-1]||0,t),p=LI(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});HI.add(new class extends zI{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=LI(o,g),c=LI(c,g),h=LI(h,_),p=LI(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=LI(o[t-1]||0,i),c=LI(o[n],i),u=LI(s[r-1]||0,i),h=LI(s[a],i);e.rect(u,l,h-u,c-l)}});qI.add(new class extends zI{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=PI([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=PI([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=PI([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=LI(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(LI(a,m),0),e.lineTo(LI(a,m),p),e.stroke()}});UI.add(new class extends zI{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=PI([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=PI([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=PI([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=LI(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=LI(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var YI,GI,XI,$I=[],jI=[],KI=Xp.__b,ZI=Xp.__r,QI=Xp.diffed,JI=Xp.__c,eP=Xp.unmount;function tP(){for(var e;e=$I.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(aP),e.__H.__h.forEach(iP),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),YI=null,KI&&KI(e)},Xp.__r=function(e){ZI&&ZI(e);var t=(YI=e.__c).__H;t&&(GI===YI?(t.__h=[],YI.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=jI,e.__N=e.i=void 0}))):(t.__h.forEach(aP),t.__h.forEach(iP),t.__h=[])),GI=YI},Xp.diffed=function(e){QI&&QI(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==$I.push(t)&&XI===Xp.requestAnimationFrame||((XI=Xp.requestAnimationFrame)||rP)(tP)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==jI&&(e.__=e.__V),e.i=void 0,e.__V=jI}))),GI=YI=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(aP),e.__h=e.__h.filter((function(e){return!e.__||iP(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),JI&&JI(e,t)},Xp.unmount=function(e){eP&&eP(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{aP(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var nP="function"==typeof requestAnimationFrame;function rP(e){var t,n=function(){clearTimeout(r),nP&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);nP&&(t=requestAnimationFrame(n))}function aP(e){var t=YI,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),YI=t}function iP(e){var t=YI;e.__c=e.__(),YI=t}sI(((e,t)=>{const{children:n,style:r,className:a,onClick:i}=e;return rm("div",{ref:t,style:r,className:a,onClick:i},n)}));const oP=Sm({});var sP,lP,cP,uP=[],hP=[],dP=Xp.__b,pP=Xp.__r,mP=Xp.diffed,_P=Xp.__c,gP=Xp.unmount;function fP(){for(var e;e=uP.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(bP),e.__H.__h.forEach(xP),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),sP=null,dP&&dP(e)},Xp.__r=function(e){pP&&pP(e);var t=(sP=e.__c).__H;t&&(lP===sP?(t.__h=[],sP.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=hP,e.__N=e.i=void 0}))):(t.__h.forEach(bP),t.__h.forEach(xP),t.__h=[])),lP=sP},Xp.diffed=function(e){mP&&mP(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==uP.push(t)&&cP===Xp.requestAnimationFrame||((cP=Xp.requestAnimationFrame)||vP)(fP)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==hP&&(e.__=e.__V),e.i=void 0,e.__V=hP}))),lP=sP=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(bP),e.__h=e.__h.filter((function(e){return!e.__||xP(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),_P&&_P(e,t)},Xp.unmount=function(e){gP&&gP(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{bP(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var yP="function"==typeof requestAnimationFrame;function vP(e){var t,n=function(){clearTimeout(r),yP&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);yP&&(t=requestAnimationFrame(n))}function bP(e){var t=sP,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),sP=t}function xP(e){var t=sP;e.__c=e.__(),sP=t}function wP(e,t){for(var n in t)e[n]=t[n];return e}function TP(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function CP(e){this.props=e}(CP.prototype=new om).isPureReactComponent=!0,CP.prototype.shouldComponentUpdate=function(e,t){return TP(this.props,e)||TP(this.state,t)};var EP=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),EP&&EP(e)};var AP="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function SP(e){function t(t){var n=wP({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=AP,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var DP=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);DP(e,t,n,r)};var RP=Xp.unmount;function NP(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=wP({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return NP(e,t,n)}))),e}function MP(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return MP(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function OP(){this.__u=0,this.t=null,this.__b=null}function kP(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function IP(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),RP&&RP(e)},(OP.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=kP(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=MP(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},OP.prototype.componentWillUnmount=function(){this.t=[]},OP.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=NP(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var PP=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(IP.prototype=new om).__a=function(e){var t=this,n=kP(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),PP(t,e,r)):a()};n?n(i):i()}},IP.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},IP.prototype.componentDidUpdate=IP.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){PP(e,n,t)}))};var LP="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,BP=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,FP="undefined"!=typeof document,HP=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var qP=Xp.event;function UP(){}function VP(){return this.cancelBubble}function WP(){return this.defaultPrevented}Xp.event=function(e){return qP&&(e=qP(e)),e.persist=UP,e.isPropagationStopped=VP,e.isDefaultPrevented=WP,e.nativeEvent=e};var zP={configurable:!0,get:function(){return this.class}},YP=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];FP&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!HP(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&BP.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(zP.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",zP))}e.$$typeof=LP,YP&&YP(e)};var GP=Xp.__r;Xp.__r=function(e){GP&&GP(e),e.__c};(class extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=oP;(class extends CP{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=oP;const XP="rgb(0,0,0)";var $P=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))($P||{});class jP{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return jP.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new jP(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new jP(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new jP(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new jP(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new jP(this.x*e,this.y*t)}divide(e){return new jP(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new jP(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new jP(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new jP(Math.floor(this.x),Math.floor(this.y))}fract(){return new jP(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=jP.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return jP.NormalizeToRef(this,this),this}clone(){return new jP(this.x,this.y)}static Zero(){return new jP(0,0)}static One(){return new jP(1,1)}static FromArray(e,t=0){return new jP(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new jP(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new jP(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new jP(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=jP.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new jP(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=jP.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new jP(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new jP(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new jP(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new jP(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(jP.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return jP.CenterToRef(e,t,jP.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=jP.DistanceSquared(t,n);if(0===r)return jP.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,jP.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return jP.Distance(e,o)}static create(e,t){return new jP(e,t)}}function KP(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===$P.TOP?(r=s,a=l,i=c,o=l):t===$P.BOTTOM?(r=s,a=u,i=c,o=u):t===$P.LEFT?(r=s,a=l,i=s,o=u):t===$P.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function ZP(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function QP(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function JP(e,t,n,r,a=jP.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new jP(0,0),new jP(1,1);const eL="rgb(",tL=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${eL+e.join(",")})`:"rgb(0,0,0)";function nL(e,t){return Math.round(e*t)/t}function rL(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class aL{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return rL(e)}}const iL=Ss.create(),oL=Ss.create(),sL=Ss.create(),lL=Ss.create();class cL extends aL{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}lL.add(new class extends cL{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=jP.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||XP;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});lL.add(new class extends cL{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=jP.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});lL.add(new class extends cL{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=rL(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=jP.create(0,0),centerPoint:f=jP.create(0,0),alignOffset:y=jP.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||XP;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=nL(o+1-.5,d),i=JP(g.addByPoint(l,a),f,b,x,y),s=JP(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||XP;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=nL(h-.5,d),i=JP(g.addByPoint(l,a),f,b,x,y),o=JP(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||XP;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=nL(-1.5,d),i=JP(g.addByPoint(l,a),f,b,x,y),o=JP(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});lL.add(new class extends cL{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=jP.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||XP;r!==this._preBorderStyle&&(ZP(e,r),e.lineWidth=QP(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||XP,this._preBorderColor=i),KP(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set($P.TOP,t),n&&i.set($P.BOTTOM,n),r&&i.set($P.LEFT,r),a&&i.set($P.RIGHT,a),i}});class uL extends aL{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}iL.add(new class extends uL{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||tL([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=nL(a,p),o=nL(o,p),s=nL(s,d),c=nL(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});iL.add(new class extends uL{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=nL(i,_),s=nL(s,_),c=nL(c,m),h=nL(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(ZP(e,u),e.lineWidth=QP(u)/g,f=u),d!==y&&(e.strokeStyle=d||XP,y=d),KP(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===$P.TOP||t===$P.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===$P.LEFT&&e>r&&e<=i||t===$P.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});iL.add(new class extends uL{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=tL([217,217,217]);let y=nL(m,f),v=nL(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=nL(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=nL(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=nL(n[o-1]||0,t),h=nL(n[s],t),d=nL(r[l-1]||0,t),p=nL(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});iL.add(new class extends uL{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=nL(o,g),c=nL(c,g),h=nL(h,_),p=nL(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=nL(o[t-1]||0,i),c=nL(o[n],i),u=nL(s[r-1]||0,i),h=nL(s[a],i);e.rect(u,l,h-u,c-l)}});oL.add(new class extends uL{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=tL([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=tL([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=tL([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=nL(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(nL(a,m),0),e.lineTo(nL(a,m),p),e.stroke()}});sL.add(new class extends uL{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=tL([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=tL([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=tL([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=nL(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=nL(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var hL,dL,pL,mL=[],_L=[],gL=Xp.__b,fL=Xp.__r,yL=Xp.diffed,vL=Xp.__c,bL=Xp.unmount;function xL(){for(var e;e=mL.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(CL),e.__H.__h.forEach(EL),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),hL=null,gL&&gL(e)},Xp.__r=function(e){fL&&fL(e);var t=(hL=e.__c).__H;t&&(dL===hL?(t.__h=[],hL.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=_L,e.__N=e.i=void 0}))):(t.__h.forEach(CL),t.__h.forEach(EL),t.__h=[])),dL=hL},Xp.diffed=function(e){yL&&yL(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==mL.push(t)&&pL===Xp.requestAnimationFrame||((pL=Xp.requestAnimationFrame)||TL)(xL)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==_L&&(e.__=e.__V),e.i=void 0,e.__V=_L}))),dL=hL=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(CL),e.__h=e.__h.filter((function(e){return!e.__||EL(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),vL&&vL(e,t)},Xp.unmount=function(e){bL&&bL(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{CL(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var wL="function"==typeof requestAnimationFrame;function TL(e){var t,n=function(){clearTimeout(r),wL&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);wL&&(t=requestAnimationFrame(n))}function CL(e){var t=hL,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),hL=t}function EL(e){var t=hL;e.__c=e.__(),hL=t}SP(((e,t)=>{const{children:n,style:r,className:a,onClick:i}=e;return rm("div",{ref:t,style:r,className:a,onClick:i},n)}));const AL=Sm({});var SL,DL,RL,NL=[],ML=[],OL=Xp.__b,kL=Xp.__r,IL=Xp.diffed,PL=Xp.__c,LL=Xp.unmount;function BL(){for(var e;e=NL.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(qL),e.__H.__h.forEach(UL),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),SL=null,OL&&OL(e)},Xp.__r=function(e){kL&&kL(e);var t=(SL=e.__c).__H;t&&(DL===SL?(t.__h=[],SL.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=ML,e.__N=e.i=void 0}))):(t.__h.forEach(qL),t.__h.forEach(UL),t.__h=[])),DL=SL},Xp.diffed=function(e){IL&&IL(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==NL.push(t)&&RL===Xp.requestAnimationFrame||((RL=Xp.requestAnimationFrame)||HL)(BL)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==ML&&(e.__=e.__V),e.i=void 0,e.__V=ML}))),DL=SL=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(qL),e.__h=e.__h.filter((function(e){return!e.__||UL(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),PL&&PL(e,t)},Xp.unmount=function(e){LL&&LL(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{qL(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var FL="function"==typeof requestAnimationFrame;function HL(e){var t,n=function(){clearTimeout(r),FL&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);FL&&(t=requestAnimationFrame(n))}function qL(e){var t=SL,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),SL=t}function UL(e){var t=SL;e.__c=e.__(),SL=t}function VL(e,t){for(var n in t)e[n]=t[n];return e}function WL(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function zL(e){this.props=e}(zL.prototype=new om).isPureReactComponent=!0,zL.prototype.shouldComponentUpdate=function(e,t){return WL(this.props,e)||WL(this.state,t)};var YL=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),YL&&YL(e)};var GL="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function XL(e){function t(t){var n=VL({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=GL,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var $L=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);$L(e,t,n,r)};var jL=Xp.unmount;function KL(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=VL({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return KL(e,t,n)}))),e}function ZL(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return ZL(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function QL(){this.__u=0,this.t=null,this.__b=null}function JL(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function eB(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),jL&&jL(e)},(QL.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=JL(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=ZL(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},QL.prototype.componentWillUnmount=function(){this.t=[]},QL.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=KL(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var tB=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(eB.prototype=new om).__a=function(e){var t=this,n=JL(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),tB(t,e,r)):a()};n?n(i):i()}},eB.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},eB.prototype.componentDidUpdate=eB.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){tB(e,n,t)}))};var nB="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,rB=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,aB="undefined"!=typeof document,iB=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var oB=Xp.event;function sB(){}function lB(){return this.cancelBubble}function cB(){return this.defaultPrevented}Xp.event=function(e){return oB&&(e=oB(e)),e.persist=sB,e.isPropagationStopped=lB,e.isDefaultPrevented=cB,e.nativeEvent=e};var uB={configurable:!0,get:function(){return this.class}},hB=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];aB&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!iB(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&rB.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(uB.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",uB))}e.$$typeof=nB,hB&&hB(e)};var dB=Xp.__r;Xp.__r=function(e){dB&&dB(e),e.__c};(class extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=AL;(class extends zL{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=AL;const pB="rgb(0,0,0)";var mB=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(mB||{});class _B{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return _B.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new _B(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new _B(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new _B(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new _B(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new _B(this.x*e,this.y*t)}divide(e){return new _B(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new _B(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new _B(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new _B(Math.floor(this.x),Math.floor(this.y))}fract(){return new _B(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=_B.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return _B.NormalizeToRef(this,this),this}clone(){return new _B(this.x,this.y)}static Zero(){return new _B(0,0)}static One(){return new _B(1,1)}static FromArray(e,t=0){return new _B(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new _B(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new _B(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new _B(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=_B.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new _B(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=_B.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new _B(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new _B(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new _B(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new _B(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(_B.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return _B.CenterToRef(e,t,_B.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=_B.DistanceSquared(t,n);if(0===r)return _B.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,_B.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return _B.Distance(e,o)}static create(e,t){return new _B(e,t)}}function gB(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===mB.TOP?(r=s,a=l,i=c,o=l):t===mB.BOTTOM?(r=s,a=u,i=c,o=u):t===mB.LEFT?(r=s,a=l,i=s,o=u):t===mB.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function fB(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function yB(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function vB(e,t,n,r,a=_B.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new _B(0,0),new _B(1,1);const bB="rgb(",xB=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${bB+e.join(",")})`:"rgb(0,0,0)";function wB(e,t){return Math.round(e*t)/t}function TB(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class CB{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return TB(e)}}const EB=Ss.create(),AB=Ss.create(),SB=Ss.create(),DB=Ss.create();class RB extends CB{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}DB.add(new class extends RB{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=_B.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||pB;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});DB.add(new class extends RB{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=_B.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});DB.add(new class extends RB{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=TB(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=_B.create(0,0),centerPoint:f=_B.create(0,0),alignOffset:y=_B.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||pB;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=wB(o+1-.5,d),i=vB(g.addByPoint(l,a),f,b,x,y),s=vB(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||pB;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=wB(h-.5,d),i=vB(g.addByPoint(l,a),f,b,x,y),o=vB(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||pB;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=wB(-1.5,d),i=vB(g.addByPoint(l,a),f,b,x,y),o=vB(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});DB.add(new class extends RB{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=_B.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||pB;r!==this._preBorderStyle&&(fB(e,r),e.lineWidth=yB(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||pB,this._preBorderColor=i),gB(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(mB.TOP,t),n&&i.set(mB.BOTTOM,n),r&&i.set(mB.LEFT,r),a&&i.set(mB.RIGHT,a),i}});class NB extends CB{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}EB.add(new class extends NB{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||xB([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=wB(a,p),o=wB(o,p),s=wB(s,d),c=wB(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});EB.add(new class extends NB{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=wB(i,_),s=wB(s,_),c=wB(c,m),h=wB(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(fB(e,u),e.lineWidth=yB(u)/g,f=u),d!==y&&(e.strokeStyle=d||pB,y=d),gB(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===mB.TOP||t===mB.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===mB.LEFT&&e>r&&e<=i||t===mB.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});EB.add(new class extends NB{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=xB([217,217,217]);let y=wB(m,f),v=wB(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=wB(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=wB(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=wB(n[o-1]||0,t),h=wB(n[s],t),d=wB(r[l-1]||0,t),p=wB(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});EB.add(new class extends NB{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=wB(o,g),c=wB(c,g),h=wB(h,_),p=wB(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=wB(o[t-1]||0,i),c=wB(o[n],i),u=wB(s[r-1]||0,i),h=wB(s[a],i);e.rect(u,l,h-u,c-l)}});AB.add(new class extends NB{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=xB([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=xB([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=xB([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=wB(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(wB(a,m),0),e.lineTo(wB(a,m),p),e.stroke()}});SB.add(new class extends NB{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=xB([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=xB([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=xB([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=wB(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=wB(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var MB,OB,kB,IB=[],PB=[],LB=Xp.__b,BB=Xp.__r,FB=Xp.diffed,HB=Xp.__c,qB=Xp.unmount;function UB(){for(var e;e=IB.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(zB),e.__H.__h.forEach(YB),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),MB=null,LB&&LB(e)},Xp.__r=function(e){BB&&BB(e);var t=(MB=e.__c).__H;t&&(OB===MB?(t.__h=[],MB.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=PB,e.__N=e.i=void 0}))):(t.__h.forEach(zB),t.__h.forEach(YB),t.__h=[])),OB=MB},Xp.diffed=function(e){FB&&FB(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==IB.push(t)&&kB===Xp.requestAnimationFrame||((kB=Xp.requestAnimationFrame)||WB)(UB)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==PB&&(e.__=e.__V),e.i=void 0,e.__V=PB}))),OB=MB=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(zB),e.__h=e.__h.filter((function(e){return!e.__||YB(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),HB&&HB(e,t)},Xp.unmount=function(e){qB&&qB(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{zB(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var VB="function"==typeof requestAnimationFrame;function WB(e){var t,n=function(){clearTimeout(r),VB&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);VB&&(t=requestAnimationFrame(n))}function zB(e){var t=MB,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),MB=t}function YB(e){var t=MB;e.__c=e.__(),MB=t}XL(((e,t)=>{const{children:n,style:r,className:a,onClick:i}=e;return rm("div",{ref:t,style:r,className:a,onClick:i},n)}));const GB=Sm({});var XB,$B,jB,KB=[],ZB=[],QB=Xp.__b,JB=Xp.__r,eF=Xp.diffed,tF=Xp.__c,nF=Xp.unmount;function rF(){for(var e;e=KB.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(oF),e.__H.__h.forEach(sF),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),XB=null,QB&&QB(e)},Xp.__r=function(e){JB&&JB(e);var t=(XB=e.__c).__H;t&&($B===XB?(t.__h=[],XB.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=ZB,e.__N=e.i=void 0}))):(t.__h.forEach(oF),t.__h.forEach(sF),t.__h=[])),$B=XB},Xp.diffed=function(e){eF&&eF(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==KB.push(t)&&jB===Xp.requestAnimationFrame||((jB=Xp.requestAnimationFrame)||iF)(rF)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==ZB&&(e.__=e.__V),e.i=void 0,e.__V=ZB}))),$B=XB=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(oF),e.__h=e.__h.filter((function(e){return!e.__||sF(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),tF&&tF(e,t)},Xp.unmount=function(e){nF&&nF(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{oF(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var aF="function"==typeof requestAnimationFrame;function iF(e){var t,n=function(){clearTimeout(r),aF&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);aF&&(t=requestAnimationFrame(n))}function oF(e){var t=XB,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),XB=t}function sF(e){var t=XB;e.__c=e.__(),XB=t}function lF(e,t){for(var n in t)e[n]=t[n];return e}function cF(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function uF(e){this.props=e}(uF.prototype=new om).isPureReactComponent=!0,uF.prototype.shouldComponentUpdate=function(e,t){return cF(this.props,e)||cF(this.state,t)};var hF=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),hF&&hF(e)};var dF="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function pF(e){function t(t){var n=lF({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=dF,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var mF=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);mF(e,t,n,r)};var _F=Xp.unmount;function gF(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=lF({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return gF(e,t,n)}))),e}function fF(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return fF(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function yF(){this.__u=0,this.t=null,this.__b=null}function vF(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function bF(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),_F&&_F(e)},(yF.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=vF(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=fF(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},yF.prototype.componentWillUnmount=function(){this.t=[]},yF.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=gF(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var xF=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(bF.prototype=new om).__a=function(e){var t=this,n=vF(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),xF(t,e,r)):a()};n?n(i):i()}},bF.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},bF.prototype.componentDidUpdate=bF.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){xF(e,n,t)}))};var wF="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,TF=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,CF="undefined"!=typeof document,EF=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var AF=Xp.event;function SF(){}function DF(){return this.cancelBubble}function RF(){return this.defaultPrevented}Xp.event=function(e){return AF&&(e=AF(e)),e.persist=SF,e.isPropagationStopped=DF,e.isDefaultPrevented=RF,e.nativeEvent=e};var NF={configurable:!0,get:function(){return this.class}},MF=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];CF&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!EF(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&TF.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(NF.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",NF))}e.$$typeof=wF,MF&&MF(e)};var OF=Xp.__r;Xp.__r=function(e){OF&&OF(e),e.__c};(class extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=GB;(class extends uF{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=GB;const kF="rgb(0,0,0)";var IF=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(IF||{});class PF{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return PF.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new PF(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new PF(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new PF(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new PF(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new PF(this.x*e,this.y*t)}divide(e){return new PF(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new PF(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new PF(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new PF(Math.floor(this.x),Math.floor(this.y))}fract(){return new PF(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=PF.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return PF.NormalizeToRef(this,this),this}clone(){return new PF(this.x,this.y)}static Zero(){return new PF(0,0)}static One(){return new PF(1,1)}static FromArray(e,t=0){return new PF(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new PF(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new PF(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new PF(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=PF.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new PF(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=PF.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new PF(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new PF(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new PF(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new PF(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(PF.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return PF.CenterToRef(e,t,PF.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=PF.DistanceSquared(t,n);if(0===r)return PF.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,PF.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return PF.Distance(e,o)}static create(e,t){return new PF(e,t)}}function LF(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===IF.TOP?(r=s,a=l,i=c,o=l):t===IF.BOTTOM?(r=s,a=u,i=c,o=u):t===IF.LEFT?(r=s,a=l,i=s,o=u):t===IF.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function BF(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function FF(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function HF(e,t,n,r,a=PF.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new PF(0,0),new PF(1,1);const qF="rgb(",UF=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${qF+e.join(",")})`:"rgb(0,0,0)";function VF(e,t){return Math.round(e*t)/t}function WF(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class zF{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return WF(e)}}const YF=Ss.create(),GF=Ss.create(),XF=Ss.create(),$F=Ss.create();class jF extends zF{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}$F.add(new class extends jF{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=PF.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||kF;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});$F.add(new class extends jF{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=PF.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});$F.add(new class extends jF{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=WF(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=PF.create(0,0),centerPoint:f=PF.create(0,0),alignOffset:y=PF.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||kF;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=VF(o+1-.5,d),i=HF(g.addByPoint(l,a),f,b,x,y),s=HF(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||kF;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=VF(h-.5,d),i=HF(g.addByPoint(l,a),f,b,x,y),o=HF(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||kF;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=VF(-1.5,d),i=HF(g.addByPoint(l,a),f,b,x,y),o=HF(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});$F.add(new class extends jF{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=PF.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||kF;r!==this._preBorderStyle&&(BF(e,r),e.lineWidth=FF(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||kF,this._preBorderColor=i),LF(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(IF.TOP,t),n&&i.set(IF.BOTTOM,n),r&&i.set(IF.LEFT,r),a&&i.set(IF.RIGHT,a),i}});class KF extends zF{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}YF.add(new class extends KF{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||UF([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=VF(a,p),o=VF(o,p),s=VF(s,d),c=VF(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});YF.add(new class extends KF{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=VF(i,_),s=VF(s,_),c=VF(c,m),h=VF(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(BF(e,u),e.lineWidth=FF(u)/g,f=u),d!==y&&(e.strokeStyle=d||kF,y=d),LF(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===IF.TOP||t===IF.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===IF.LEFT&&e>r&&e<=i||t===IF.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});YF.add(new class extends KF{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=UF([217,217,217]);let y=VF(m,f),v=VF(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=VF(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=VF(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=VF(n[o-1]||0,t),h=VF(n[s],t),d=VF(r[l-1]||0,t),p=VF(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});YF.add(new class extends KF{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=VF(o,g),c=VF(c,g),h=VF(h,_),p=VF(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=VF(o[t-1]||0,i),c=VF(o[n],i),u=VF(s[r-1]||0,i),h=VF(s[a],i);e.rect(u,l,h-u,c-l)}});GF.add(new class extends KF{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=UF([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=UF([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=UF([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=VF(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(VF(a,m),0),e.lineTo(VF(a,m),p),e.stroke()}});XF.add(new class extends KF{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=UF([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=UF([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=UF([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=VF(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=VF(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var ZF,QF,JF,eH=[],tH=[],nH=Xp.__b,rH=Xp.__r,aH=Xp.diffed,iH=Xp.__c,oH=Xp.unmount;function sH(){for(var e;e=eH.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(uH),e.__H.__h.forEach(hH),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),ZF=null,nH&&nH(e)},Xp.__r=function(e){rH&&rH(e);var t=(ZF=e.__c).__H;t&&(QF===ZF?(t.__h=[],ZF.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=tH,e.__N=e.i=void 0}))):(t.__h.forEach(uH),t.__h.forEach(hH),t.__h=[])),QF=ZF},Xp.diffed=function(e){aH&&aH(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==eH.push(t)&&JF===Xp.requestAnimationFrame||((JF=Xp.requestAnimationFrame)||cH)(sH)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==tH&&(e.__=e.__V),e.i=void 0,e.__V=tH}))),QF=ZF=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(uH),e.__h=e.__h.filter((function(e){return!e.__||hH(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),iH&&iH(e,t)},Xp.unmount=function(e){oH&&oH(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{uH(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var lH="function"==typeof requestAnimationFrame;function cH(e){var t,n=function(){clearTimeout(r),lH&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);lH&&(t=requestAnimationFrame(n))}function uH(e){var t=ZF,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),ZF=t}function hH(e){var t=ZF;e.__c=e.__(),ZF=t}pF(((e,t)=>{const{children:n,style:r,className:a,onClick:i}=e;return rm("div",{ref:t,style:r,className:a,onClick:i},n)}));const dH=Sm({});var pH,mH,_H,gH=[],fH=[],yH=Xp.__b,vH=Xp.__r,bH=Xp.diffed,xH=Xp.__c,wH=Xp.unmount;function TH(){for(var e;e=gH.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(AH),e.__H.__h.forEach(SH),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),pH=null,yH&&yH(e)},Xp.__r=function(e){vH&&vH(e);var t=(pH=e.__c).__H;t&&(mH===pH?(t.__h=[],pH.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=fH,e.__N=e.i=void 0}))):(t.__h.forEach(AH),t.__h.forEach(SH),t.__h=[])),mH=pH},Xp.diffed=function(e){bH&&bH(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==gH.push(t)&&_H===Xp.requestAnimationFrame||((_H=Xp.requestAnimationFrame)||EH)(TH)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==fH&&(e.__=e.__V),e.i=void 0,e.__V=fH}))),mH=pH=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(AH),e.__h=e.__h.filter((function(e){return!e.__||SH(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),xH&&xH(e,t)},Xp.unmount=function(e){wH&&wH(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{AH(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var CH="function"==typeof requestAnimationFrame;function EH(e){var t,n=function(){clearTimeout(r),CH&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);CH&&(t=requestAnimationFrame(n))}function AH(e){var t=pH,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),pH=t}function SH(e){var t=pH;e.__c=e.__(),pH=t}function DH(e,t){for(var n in t)e[n]=t[n];return e}function RH(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function NH(e){this.props=e}(NH.prototype=new om).isPureReactComponent=!0,NH.prototype.shouldComponentUpdate=function(e,t){return RH(this.props,e)||RH(this.state,t)};var MH=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),MH&&MH(e)};var OH="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function kH(e){function t(t){var n=DH({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=OH,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var IH=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);IH(e,t,n,r)};var PH=Xp.unmount;function LH(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=DH({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return LH(e,t,n)}))),e}function BH(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return BH(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function FH(){this.__u=0,this.t=null,this.__b=null}function HH(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function qH(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),PH&&PH(e)},(FH.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=HH(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=BH(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},FH.prototype.componentWillUnmount=function(){this.t=[]},FH.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=LH(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var UH=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(qH.prototype=new om).__a=function(e){var t=this,n=HH(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),UH(t,e,r)):a()};n?n(i):i()}},qH.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},qH.prototype.componentDidUpdate=qH.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){UH(e,n,t)}))};var VH="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,WH=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,zH="undefined"!=typeof document,YH=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var GH=Xp.event;function XH(){}function $H(){return this.cancelBubble}function jH(){return this.defaultPrevented}Xp.event=function(e){return GH&&(e=GH(e)),e.persist=XH,e.isPropagationStopped=$H,e.isDefaultPrevented=jH,e.nativeEvent=e};var KH={configurable:!0,get:function(){return this.class}},ZH=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];zH&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!YH(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&WH.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(KH.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",KH))}e.$$typeof=VH,ZH&&ZH(e)};var QH=Xp.__r;Xp.__r=function(e){QH&&QH(e),e.__c};(class extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=dH;(class extends NH{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=dH;const JH="rgb(0,0,0)";var eq=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(eq||{});class tq{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return tq.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new tq(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new tq(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new tq(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new tq(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new tq(this.x*e,this.y*t)}divide(e){return new tq(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new tq(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new tq(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new tq(Math.floor(this.x),Math.floor(this.y))}fract(){return new tq(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=tq.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return tq.NormalizeToRef(this,this),this}clone(){return new tq(this.x,this.y)}static Zero(){return new tq(0,0)}static One(){return new tq(1,1)}static FromArray(e,t=0){return new tq(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new tq(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new tq(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new tq(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=tq.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new tq(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=tq.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new tq(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new tq(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new tq(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new tq(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(tq.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return tq.CenterToRef(e,t,tq.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=tq.DistanceSquared(t,n);if(0===r)return tq.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,tq.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return tq.Distance(e,o)}static create(e,t){return new tq(e,t)}}function nq(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===eq.TOP?(r=s,a=l,i=c,o=l):t===eq.BOTTOM?(r=s,a=u,i=c,o=u):t===eq.LEFT?(r=s,a=l,i=s,o=u):t===eq.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function rq(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function aq(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function iq(e,t,n,r,a=tq.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new tq(0,0),new tq(1,1);const oq="rgb(",sq=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${oq+e.join(",")})`:"rgb(0,0,0)";function lq(e,t){return Math.round(e*t)/t}function cq(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class uq{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return cq(e)}}const hq=Ss.create(),dq=Ss.create(),pq=Ss.create(),mq=Ss.create();class _q extends uq{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}mq.add(new class extends _q{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=tq.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||JH;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});mq.add(new class extends _q{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=tq.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});mq.add(new class extends _q{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=cq(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=tq.create(0,0),centerPoint:f=tq.create(0,0),alignOffset:y=tq.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||JH;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=lq(o+1-.5,d),i=iq(g.addByPoint(l,a),f,b,x,y),s=iq(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||JH;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=lq(h-.5,d),i=iq(g.addByPoint(l,a),f,b,x,y),o=iq(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||JH;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=lq(-1.5,d),i=iq(g.addByPoint(l,a),f,b,x,y),o=iq(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});mq.add(new class extends _q{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=tq.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||JH;r!==this._preBorderStyle&&(rq(e,r),e.lineWidth=aq(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||JH,this._preBorderColor=i),nq(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(eq.TOP,t),n&&i.set(eq.BOTTOM,n),r&&i.set(eq.LEFT,r),a&&i.set(eq.RIGHT,a),i}});class gq extends uq{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}hq.add(new class extends gq{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||sq([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=lq(a,p),o=lq(o,p),s=lq(s,d),c=lq(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});hq.add(new class extends gq{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=lq(i,_),s=lq(s,_),c=lq(c,m),h=lq(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(rq(e,u),e.lineWidth=aq(u)/g,f=u),d!==y&&(e.strokeStyle=d||JH,y=d),nq(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===eq.TOP||t===eq.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===eq.LEFT&&e>r&&e<=i||t===eq.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});hq.add(new class extends gq{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=sq([217,217,217]);let y=lq(m,f),v=lq(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=lq(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=lq(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=lq(n[o-1]||0,t),h=lq(n[s],t),d=lq(r[l-1]||0,t),p=lq(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});hq.add(new class extends gq{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=lq(o,g),c=lq(c,g),h=lq(h,_),p=lq(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=lq(o[t-1]||0,i),c=lq(o[n],i),u=lq(s[r-1]||0,i),h=lq(s[a],i);e.rect(u,l,h-u,c-l)}});dq.add(new class extends gq{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=sq([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=sq([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=sq([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=lq(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(lq(a,m),0),e.lineTo(lq(a,m),p),e.stroke()}});pq.add(new class extends gq{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=sq([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=sq([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=sq([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=lq(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=lq(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var fq,yq,vq,bq=[],xq=[],wq=Xp.__b,Tq=Xp.__r,Cq=Xp.diffed,Eq=Xp.__c,Aq=Xp.unmount;function Sq(){for(var e;e=bq.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Nq),e.__H.__h.forEach(Mq),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),fq=null,wq&&wq(e)},Xp.__r=function(e){Tq&&Tq(e);var t=(fq=e.__c).__H;t&&(yq===fq?(t.__h=[],fq.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=xq,e.__N=e.i=void 0}))):(t.__h.forEach(Nq),t.__h.forEach(Mq),t.__h=[])),yq=fq},Xp.diffed=function(e){Cq&&Cq(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==bq.push(t)&&vq===Xp.requestAnimationFrame||((vq=Xp.requestAnimationFrame)||Rq)(Sq)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==xq&&(e.__=e.__V),e.i=void 0,e.__V=xq}))),yq=fq=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(Nq),e.__h=e.__h.filter((function(e){return!e.__||Mq(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),Eq&&Eq(e,t)},Xp.unmount=function(e){Aq&&Aq(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{Nq(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var Dq="function"==typeof requestAnimationFrame;function Rq(e){var t,n=function(){clearTimeout(r),Dq&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);Dq&&(t=requestAnimationFrame(n))}function Nq(e){var t=fq,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),fq=t}function Mq(e){var t=fq;e.__c=e.__(),fq=t}kH(((e,t)=>{const{children:n,style:r,className:a,onClick:i}=e;return rm("div",{ref:t,style:r,className:a,onClick:i},n)}));const Oq=Sm({});var kq,Iq,Pq,Lq=[],Bq=[],Fq=Xp.__b,Hq=Xp.__r,qq=Xp.diffed,Uq=Xp.__c,Vq=Xp.unmount;function Wq(){for(var e;e=Lq.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(Gq),e.__H.__h.forEach(Xq),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),kq=null,Fq&&Fq(e)},Xp.__r=function(e){Hq&&Hq(e);var t=(kq=e.__c).__H;t&&(Iq===kq?(t.__h=[],kq.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=Bq,e.__N=e.i=void 0}))):(t.__h.forEach(Gq),t.__h.forEach(Xq),t.__h=[])),Iq=kq},Xp.diffed=function(e){qq&&qq(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==Lq.push(t)&&Pq===Xp.requestAnimationFrame||((Pq=Xp.requestAnimationFrame)||Yq)(Wq)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==Bq&&(e.__=e.__V),e.i=void 0,e.__V=Bq}))),Iq=kq=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(Gq),e.__h=e.__h.filter((function(e){return!e.__||Xq(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),Uq&&Uq(e,t)},Xp.unmount=function(e){Vq&&Vq(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{Gq(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var zq="function"==typeof requestAnimationFrame;function Yq(e){var t,n=function(){clearTimeout(r),zq&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);zq&&(t=requestAnimationFrame(n))}function Gq(e){var t=kq,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),kq=t}function Xq(e){var t=kq;e.__c=e.__(),kq=t}function $q(e,t){for(var n in t)e[n]=t[n];return e}function jq(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function Kq(e){this.props=e}(Kq.prototype=new om).isPureReactComponent=!0,Kq.prototype.shouldComponentUpdate=function(e,t){return jq(this.props,e)||jq(this.state,t)};var Zq=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),Zq&&Zq(e)};var Qq="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Jq(e){function t(t){var n=$q({},t);return delete n.ref,e(n,t.ref||null)}return t.$$typeof=Qq,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var eU=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);eU(e,t,n,r)};var tU=Xp.unmount;function nU(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=$q({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return nU(e,t,n)}))),e}function rU(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return rU(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function aU(){this.__u=0,this.t=null,this.__b=null}function iU(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function oU(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),tU&&tU(e)},(aU.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=iU(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=rU(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},aU.prototype.componentWillUnmount=function(){this.t=[]},aU.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=nU(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var sU=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(oU.prototype=new om).__a=function(e){var t=this,n=iU(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),sU(t,e,r)):a()};n?n(i):i()}},oU.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},oU.prototype.componentDidUpdate=oU.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){sU(e,n,t)}))};var lU="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,cU=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,uU="undefined"!=typeof document,hU=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var dU=Xp.event;function pU(){}function mU(){return this.cancelBubble}function _U(){return this.defaultPrevented}Xp.event=function(e){return dU&&(e=dU(e)),e.persist=pU,e.isPropagationStopped=mU,e.isDefaultPrevented=_U,e.nativeEvent=e};var gU={configurable:!0,get:function(){return this.class}},fU=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];uU&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!hU(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&cU.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(gU.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",gU))}e.$$typeof=lU,fU&&fU(e)};var yU=Xp.__r;Xp.__r=function(e){yU&&yU(e),e.__c};(class extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=Oq;(class extends Kq{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=Oq;const vU="rgb(0,0,0)";var bU=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(bU||{});class xU{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return xU.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new xU(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new xU(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new xU(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new xU(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new xU(this.x*e,this.y*t)}divide(e){return new xU(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new xU(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new xU(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new xU(Math.floor(this.x),Math.floor(this.y))}fract(){return new xU(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=xU.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return xU.NormalizeToRef(this,this),this}clone(){return new xU(this.x,this.y)}static Zero(){return new xU(0,0)}static One(){return new xU(1,1)}static FromArray(e,t=0){return new xU(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new xU(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new xU(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new xU(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=xU.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new xU(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=xU.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new xU(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new xU(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new xU(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new xU(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(xU.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return xU.CenterToRef(e,t,xU.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=xU.DistanceSquared(t,n);if(0===r)return xU.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,xU.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return xU.Distance(e,o)}static create(e,t){return new xU(e,t)}}function wU(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===bU.TOP?(r=s,a=l,i=c,o=l):t===bU.BOTTOM?(r=s,a=u,i=c,o=u):t===bU.LEFT?(r=s,a=l,i=s,o=u):t===bU.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function TU(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function CU(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function EU(e,t,n,r,a=xU.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new xU(0,0),new xU(1,1);const AU="rgb(",SU=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${AU+e.join(",")})`:"rgb(0,0,0)";function DU(e,t){return Math.round(e*t)/t}function RU(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class NU{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return RU(e)}}const MU=Ss.create(),OU=Ss.create(),kU=Ss.create(),IU=Ss.create();class PU extends NU{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}IU.add(new class extends PU{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=xU.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||vU;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});IU.add(new class extends PU{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=xU.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});IU.add(new class extends PU{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=RU(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=xU.create(0,0),centerPoint:f=xU.create(0,0),alignOffset:y=xU.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||vU;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=DU(o+1-.5,d),i=EU(g.addByPoint(l,a),f,b,x,y),s=EU(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||vU;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=DU(h-.5,d),i=EU(g.addByPoint(l,a),f,b,x,y),o=EU(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||vU;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=DU(-1.5,d),i=EU(g.addByPoint(l,a),f,b,x,y),o=EU(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});IU.add(new class extends PU{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=xU.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||vU;r!==this._preBorderStyle&&(TU(e,r),e.lineWidth=CU(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||vU,this._preBorderColor=i),wU(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(bU.TOP,t),n&&i.set(bU.BOTTOM,n),r&&i.set(bU.LEFT,r),a&&i.set(bU.RIGHT,a),i}});class LU extends NU{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}MU.add(new class extends LU{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||SU([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=DU(a,p),o=DU(o,p),s=DU(s,d),c=DU(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});MU.add(new class extends LU{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=DU(i,_),s=DU(s,_),c=DU(c,m),h=DU(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(TU(e,u),e.lineWidth=CU(u)/g,f=u),d!==y&&(e.strokeStyle=d||vU,y=d),wU(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===bU.TOP||t===bU.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===bU.LEFT&&e>r&&e<=i||t===bU.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});MU.add(new class extends LU{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=SU([217,217,217]);let y=DU(m,f),v=DU(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=DU(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=DU(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=DU(n[o-1]||0,t),h=DU(n[s],t),d=DU(r[l-1]||0,t),p=DU(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});MU.add(new class extends LU{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=DU(o,g),c=DU(c,g),h=DU(h,_),p=DU(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=DU(o[t-1]||0,i),c=DU(o[n],i),u=DU(s[r-1]||0,i),h=DU(s[a],i);e.rect(u,l,h-u,c-l)}});OU.add(new class extends LU{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=SU([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=SU([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=SU([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=DU(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(DU(a,m),0),e.lineTo(DU(a,m),p),e.stroke()}});kU.add(new class extends LU{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=SU([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=SU([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=SU([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=DU(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=DU(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var BU,FU,HU,qU=[],UU=[],VU=Xp.__b,WU=Xp.__r,zU=Xp.diffed,YU=Xp.__c,GU=Xp.unmount;function XU(){for(var e;e=qU.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(KU),e.__H.__h.forEach(ZU),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),BU=null,VU&&VU(e)},Xp.__r=function(e){WU&&WU(e);var t=(BU=e.__c).__H;t&&(FU===BU?(t.__h=[],BU.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=UU,e.__N=e.i=void 0}))):(t.__h.forEach(KU),t.__h.forEach(ZU),t.__h=[])),FU=BU},Xp.diffed=function(e){zU&&zU(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==qU.push(t)&&HU===Xp.requestAnimationFrame||((HU=Xp.requestAnimationFrame)||jU)(XU)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==UU&&(e.__=e.__V),e.i=void 0,e.__V=UU}))),FU=BU=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(KU),e.__h=e.__h.filter((function(e){return!e.__||ZU(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),YU&&YU(e,t)},Xp.unmount=function(e){GU&&GU(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{KU(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var $U="function"==typeof requestAnimationFrame;function jU(e){var t,n=function(){clearTimeout(r),$U&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);$U&&(t=requestAnimationFrame(n))}function KU(e){var t=BU,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),BU=t}function ZU(e){var t=BU;e.__c=e.__(),BU=t}Jq(((e,t)=>{const{children:n,style:r,className:a,onClick:i}=e;return rm("div",{ref:t,style:r,className:a,onClick:i},n)}));var QU="univer-content-wrapper";function JU(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function eV(e){this.props=e}Jq(((e,t)=>{const{children:n,style:r,className:a}=e;return rm("main",{ref:t,style:r,className:`${QU} ${a}`},n)})),(eV.prototype=new om).isPureReactComponent=!0,eV.prototype.shouldComponentUpdate=function(e,t){return JU(this.props,e)||JU(this.state,t)};var tV=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),tV&&tV(e)};var nV=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);nV(e,t,n,r)};var rV=Xp.unmount;function aV(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return aV(e,t,n)}))),e}function iV(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return iV(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function oV(){this.__u=0,this.t=null,this.__b=null}function sV(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function lV(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),rV&&rV(e)},(oV.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=sV(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=iV(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},oV.prototype.componentWillUnmount=function(){this.t=[]},oV.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=aV(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var cV=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(lV.prototype=new om).__a=function(e){var t=this,n=sV(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),cV(t,e,r)):a()};n?n(i):i()}},lV.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},lV.prototype.componentDidUpdate=lV.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){cV(e,n,t)}))};var uV="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,hV=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,dV="undefined"!=typeof document,pV=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var mV=Xp.event;function _V(){}function gV(){return this.cancelBubble}function fV(){return this.defaultPrevented}Xp.event=function(e){return mV&&(e=mV(e)),e.persist=_V,e.isPropagationStopped=gV,e.isDefaultPrevented=fV,e.nativeEvent=e};var yV={configurable:!0,get:function(){return this.class}},vV=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];dV&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!pV(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&hV.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(yV.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",yV))}e.$$typeof=uV,vV&&vV(e)};var bV=Xp.__r;Xp.__r=function(e){bV&&bV(e),e.__c};var xV="univer-content-wrapper";function wV(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function TV(e){this.props=e}kH(((e,t)=>{const{children:n,style:r,className:a}=e;return rm("main",{ref:t,style:r,className:`${xV} ${a}`},n)})),(TV.prototype=new om).isPureReactComponent=!0,TV.prototype.shouldComponentUpdate=function(e,t){return wV(this.props,e)||wV(this.state,t)};var CV=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),CV&&CV(e)};var EV=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);EV(e,t,n,r)};var AV=Xp.unmount;function SV(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return SV(e,t,n)}))),e}function DV(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return DV(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function RV(){this.__u=0,this.t=null,this.__b=null}function NV(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function MV(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),AV&&AV(e)},(RV.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=NV(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=DV(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},RV.prototype.componentWillUnmount=function(){this.t=[]},RV.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=SV(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var OV=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(MV.prototype=new om).__a=function(e){var t=this,n=NV(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),OV(t,e,r)):a()};n?n(i):i()}},MV.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},MV.prototype.componentDidUpdate=MV.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){OV(e,n,t)}))};var kV="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,IV=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,PV="undefined"!=typeof document,LV=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var BV=Xp.event;function FV(){}function HV(){return this.cancelBubble}function qV(){return this.defaultPrevented}Xp.event=function(e){return BV&&(e=BV(e)),e.persist=FV,e.isPropagationStopped=HV,e.isDefaultPrevented=qV,e.nativeEvent=e};var UV={configurable:!0,get:function(){return this.class}},VV=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];PV&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!LV(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&IV.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(UV.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",UV))}e.$$typeof=kV,VV&&VV(e)};var WV=Xp.__r;Xp.__r=function(e){WV&&WV(e),e.__c};var zV="univer-content-wrapper";function YV(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function GV(e){this.props=e}pF(((e,t)=>{const{children:n,style:r,className:a}=e;return rm("main",{ref:t,style:r,className:`${zV} ${a}`},n)})),(GV.prototype=new om).isPureReactComponent=!0,GV.prototype.shouldComponentUpdate=function(e,t){return YV(this.props,e)||YV(this.state,t)};var XV=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),XV&&XV(e)};var $V=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);$V(e,t,n,r)};var jV=Xp.unmount;function KV(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return KV(e,t,n)}))),e}function ZV(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return ZV(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function QV(){this.__u=0,this.t=null,this.__b=null}function JV(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function eW(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),jV&&jV(e)},(QV.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=JV(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=ZV(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},QV.prototype.componentWillUnmount=function(){this.t=[]},QV.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=KV(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var tW=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(eW.prototype=new om).__a=function(e){var t=this,n=JV(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),tW(t,e,r)):a()};n?n(i):i()}},eW.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},eW.prototype.componentDidUpdate=eW.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){tW(e,n,t)}))};var nW="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,rW=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,aW="undefined"!=typeof document,iW=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var oW=Xp.event;function sW(){}function lW(){return this.cancelBubble}function cW(){return this.defaultPrevented}Xp.event=function(e){return oW&&(e=oW(e)),e.persist=sW,e.isPropagationStopped=lW,e.isDefaultPrevented=cW,e.nativeEvent=e};var uW={configurable:!0,get:function(){return this.class}},hW=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];aW&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!iW(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&rW.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(uW.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",uW))}e.$$typeof=nW,hW&&hW(e)};var dW=Xp.__r;Xp.__r=function(e){dW&&dW(e),e.__c};var pW="univer-content-wrapper";function mW(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function _W(e){this.props=e}XL(((e,t)=>{const{children:n,style:r,className:a}=e;return rm("main",{ref:t,style:r,className:`${pW} ${a}`},n)})),(_W.prototype=new om).isPureReactComponent=!0,_W.prototype.shouldComponentUpdate=function(e,t){return mW(this.props,e)||mW(this.state,t)};var gW=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),gW&&gW(e)};var fW=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);fW(e,t,n,r)};var yW=Xp.unmount;function vW(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return vW(e,t,n)}))),e}function bW(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return bW(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function xW(){this.__u=0,this.t=null,this.__b=null}function wW(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function TW(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),yW&&yW(e)},(xW.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=wW(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=bW(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},xW.prototype.componentWillUnmount=function(){this.t=[]},xW.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=vW(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var CW=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(TW.prototype=new om).__a=function(e){var t=this,n=wW(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),CW(t,e,r)):a()};n?n(i):i()}},TW.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},TW.prototype.componentDidUpdate=TW.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){CW(e,n,t)}))};var EW="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,AW=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,SW="undefined"!=typeof document,DW=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var RW=Xp.event;function NW(){}function MW(){return this.cancelBubble}function OW(){return this.defaultPrevented}Xp.event=function(e){return RW&&(e=RW(e)),e.persist=NW,e.isPropagationStopped=MW,e.isDefaultPrevented=OW,e.nativeEvent=e};var kW={configurable:!0,get:function(){return this.class}},IW=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];SW&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!DW(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&AW.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(kW.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",kW))}e.$$typeof=EW,IW&&IW(e)};var PW=Xp.__r;Xp.__r=function(e){PW&&PW(e),e.__c};var LW="univer-content-wrapper";function BW(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function FW(e){this.props=e}SP(((e,t)=>{const{children:n,style:r,className:a}=e;return rm("main",{ref:t,style:r,className:`${LW} ${a}`},n)})),(FW.prototype=new om).isPureReactComponent=!0,FW.prototype.shouldComponentUpdate=function(e,t){return BW(this.props,e)||BW(this.state,t)};var HW=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),HW&&HW(e)};var qW=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);qW(e,t,n,r)};var UW=Xp.unmount;function VW(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return VW(e,t,n)}))),e}function WW(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return WW(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function zW(){this.__u=0,this.t=null,this.__b=null}function YW(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function GW(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),UW&&UW(e)},(zW.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=YW(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=WW(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},zW.prototype.componentWillUnmount=function(){this.t=[]},zW.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=VW(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var XW=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(GW.prototype=new om).__a=function(e){var t=this,n=YW(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),XW(t,e,r)):a()};n?n(i):i()}},GW.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},GW.prototype.componentDidUpdate=GW.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){XW(e,n,t)}))};var $W="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,jW=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,KW="undefined"!=typeof document,ZW=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var QW=Xp.event;function JW(){}function ez(){return this.cancelBubble}function tz(){return this.defaultPrevented}Xp.event=function(e){return QW&&(e=QW(e)),e.persist=JW,e.isPropagationStopped=ez,e.isDefaultPrevented=tz,e.nativeEvent=e};var nz={configurable:!0,get:function(){return this.class}},rz=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];KW&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!ZW(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&jW.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(nz.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",nz))}e.$$typeof=$W,rz&&rz(e)};var az=Xp.__r;Xp.__r=function(e){az&&az(e),e.__c};var iz="univer-content-wrapper";function oz(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function sz(e){this.props=e}sI(((e,t)=>{const{children:n,style:r,className:a}=e;return rm("main",{ref:t,style:r,className:`${iz} ${a}`},n)})),(sz.prototype=new om).isPureReactComponent=!0,sz.prototype.shouldComponentUpdate=function(e,t){return oz(this.props,e)||oz(this.state,t)};var lz=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),lz&&lz(e)};var cz=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);cz(e,t,n,r)};var uz=Xp.unmount;function hz(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return hz(e,t,n)}))),e}function dz(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return dz(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function pz(){this.__u=0,this.t=null,this.__b=null}function mz(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function _z(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),uz&&uz(e)},(pz.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=mz(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=dz(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},pz.prototype.componentWillUnmount=function(){this.t=[]},pz.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=hz(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var gz=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(_z.prototype=new om).__a=function(e){var t=this,n=mz(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),gz(t,e,r)):a()};n?n(i):i()}},_z.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},_z.prototype.componentDidUpdate=_z.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){gz(e,n,t)}))};var fz="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,yz=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,vz="undefined"!=typeof document,bz=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var xz=Xp.event;function wz(){}function Tz(){return this.cancelBubble}function Cz(){return this.defaultPrevented}Xp.event=function(e){return xz&&(e=xz(e)),e.persist=wz,e.isPropagationStopped=Tz,e.isDefaultPrevented=Cz,e.nativeEvent=e};var Ez={configurable:!0,get:function(){return this.class}},Az=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];vz&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!bz(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&yz.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(Ez.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",Ez))}e.$$typeof=fz,Az&&Az(e)};var Sz=Xp.__r;Xp.__r=function(e){Sz&&Sz(e),e.__c};var Dz="univer-content-wrapper";function Rz(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function Nz(e){this.props=e}UO(((e,t)=>{const{children:n,style:r,className:a}=e;return rm("main",{ref:t,style:r,className:`${Dz} ${a}`},n)})),(Nz.prototype=new om).isPureReactComponent=!0,Nz.prototype.shouldComponentUpdate=function(e,t){return Rz(this.props,e)||Rz(this.state,t)};var Mz=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),Mz&&Mz(e)};var Oz=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);Oz(e,t,n,r)};var kz=Xp.unmount;function Iz(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return Iz(e,t,n)}))),e}function Pz(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return Pz(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function Lz(){this.__u=0,this.t=null,this.__b=null}function Bz(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function Fz(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),kz&&kz(e)},(Lz.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=Bz(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=Pz(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},Lz.prototype.componentWillUnmount=function(){this.t=[]},Lz.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=Iz(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var Hz=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(Fz.prototype=new om).__a=function(e){var t=this,n=Bz(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),Hz(t,e,r)):a()};n?n(i):i()}},Fz.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},Fz.prototype.componentDidUpdate=Fz.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){Hz(e,n,t)}))};var qz="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,Uz=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Vz="undefined"!=typeof document,Wz=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var zz=Xp.event;function Yz(){}function Gz(){return this.cancelBubble}function Xz(){return this.defaultPrevented}Xp.event=function(e){return zz&&(e=zz(e)),e.persist=Yz,e.isPropagationStopped=Gz,e.isDefaultPrevented=Xz,e.nativeEvent=e};var $z={configurable:!0,get:function(){return this.class}},jz=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];Vz&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!Wz(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&Uz.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&($z.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",$z))}e.$$typeof=qz,jz&&jz(e)};var Kz=Xp.__r;Xp.__r=function(e){Kz&&Kz(e),e.__c};var Zz="univer-content-wrapper";function Qz(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function Jz(e){this.props=e}xM(((e,t)=>{const{children:n,style:r,className:a}=e;return rm("main",{ref:t,style:r,className:`${Zz} ${a}`},n)})),(Jz.prototype=new om).isPureReactComponent=!0,Jz.prototype.shouldComponentUpdate=function(e,t){return Qz(this.props,e)||Qz(this.state,t)};var eY=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),eY&&eY(e)};var tY=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);tY(e,t,n,r)};var nY=Xp.unmount;function rY(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return rY(e,t,n)}))),e}function aY(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return aY(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function iY(){this.__u=0,this.t=null,this.__b=null}function oY(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function sY(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),nY&&nY(e)},(iY.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=oY(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=aY(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},iY.prototype.componentWillUnmount=function(){this.t=[]},iY.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=rY(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var lY=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(sY.prototype=new om).__a=function(e){var t=this,n=oY(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),lY(t,e,r)):a()};n?n(i):i()}},sY.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},sY.prototype.componentDidUpdate=sY.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){lY(e,n,t)}))};var cY="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,uY=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,hY="undefined"!=typeof document,dY=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var pY=Xp.event;function mY(){}function _Y(){return this.cancelBubble}function gY(){return this.defaultPrevented}Xp.event=function(e){return pY&&(e=pY(e)),e.persist=mY,e.isPropagationStopped=_Y,e.isDefaultPrevented=gY,e.nativeEvent=e};var fY={configurable:!0,get:function(){return this.class}},yY=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];hY&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!dY(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&uY.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(fY.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",fY))}e.$$typeof=cY,yY&&yY(e)};var vY=Xp.__r;Xp.__r=function(e){vY&&vY(e),e.__c};var bY="univer-content-wrapper";function xY(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function wY(e){this.props=e}tN(((e,t)=>{const{children:n,style:r,className:a}=e;return rm("main",{ref:t,style:r,className:`${bY} ${a}`},n)})),(wY.prototype=new om).isPureReactComponent=!0,wY.prototype.shouldComponentUpdate=function(e,t){return xY(this.props,e)||xY(this.state,t)};var TY=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),TY&&TY(e)};var CY=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);CY(e,t,n,r)};var EY=Xp.unmount;function AY(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return AY(e,t,n)}))),e}function SY(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return SY(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function DY(){this.__u=0,this.t=null,this.__b=null}function RY(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function NY(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),EY&&EY(e)},(DY.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=RY(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=SY(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},DY.prototype.componentWillUnmount=function(){this.t=[]},DY.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=AY(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var MY=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(NY.prototype=new om).__a=function(e){var t=this,n=RY(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),MY(t,e,r)):a()};n?n(i):i()}},NY.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},NY.prototype.componentDidUpdate=NY.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){MY(e,n,t)}))};var OY="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,kY=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,IY="undefined"!=typeof document,PY=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var LY=Xp.event;function BY(){}function FY(){return this.cancelBubble}function HY(){return this.defaultPrevented}Xp.event=function(e){return LY&&(e=LY(e)),e.persist=BY,e.isPropagationStopped=FY,e.isDefaultPrevented=HY,e.nativeEvent=e};var qY={configurable:!0,get:function(){return this.class}},UY=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];IY&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!PY(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&kY.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(qY.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",qY))}e.$$typeof=OY,UY&&UY(e)};var VY=Xp.__r;Xp.__r=function(e){VY&&VY(e),e.__c};var WY="univer-content-wrapper";function zY(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function YY(e){this.props=e}PD(((e,t)=>{const{children:n,style:r,className:a}=e;return rm("main",{ref:t,style:r,className:`${WY} ${a}`},n)})),(YY.prototype=new om).isPureReactComponent=!0,YY.prototype.shouldComponentUpdate=function(e,t){return zY(this.props,e)||zY(this.state,t)};var GY=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),GY&&GY(e)};var XY=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);XY(e,t,n,r)};var $Y=Xp.unmount;function jY(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return jY(e,t,n)}))),e}function KY(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return KY(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function ZY(){this.__u=0,this.t=null,this.__b=null}function QY(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function JY(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),$Y&&$Y(e)},(ZY.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=QY(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=KY(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},ZY.prototype.componentWillUnmount=function(){this.t=[]},ZY.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=jY(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var eG=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(JY.prototype=new om).__a=function(e){var t=this,n=QY(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),eG(t,e,r)):a()};n?n(i):i()}},JY.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},JY.prototype.componentDidUpdate=JY.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){eG(e,n,t)}))};var tG="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,nG=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,rG="undefined"!=typeof document,aG=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var iG=Xp.event;function oG(){}function sG(){return this.cancelBubble}function lG(){return this.defaultPrevented}Xp.event=function(e){return iG&&(e=iG(e)),e.persist=oG,e.isPropagationStopped=sG,e.isDefaultPrevented=lG,e.nativeEvent=e};var cG={configurable:!0,get:function(){return this.class}},uG=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];rG&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!aG(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&nG.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(cG.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",cG))}e.$$typeof=tG,uG&&uG(e)};var hG=Xp.__r;Xp.__r=function(e){hG&&hG(e),e.__c};var dG="univer-content-wrapper";function pG(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function mG(e){this.props=e}_S(((e,t)=>{const{children:n,style:r,className:a}=e;return rm("main",{ref:t,style:r,className:`${dG} ${a}`},n)})),(mG.prototype=new om).isPureReactComponent=!0,mG.prototype.shouldComponentUpdate=function(e,t){return pG(this.props,e)||pG(this.state,t)};var _G=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),_G&&_G(e)};var gG=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);gG(e,t,n,r)};var fG=Xp.unmount;function yG(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return yG(e,t,n)}))),e}function vG(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return vG(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function bG(){this.__u=0,this.t=null,this.__b=null}function xG(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function wG(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),fG&&fG(e)},(bG.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=xG(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=vG(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},bG.prototype.componentWillUnmount=function(){this.t=[]},bG.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=yG(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var TG=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(wG.prototype=new om).__a=function(e){var t=this,n=xG(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),TG(t,e,r)):a()};n?n(i):i()}},wG.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},wG.prototype.componentDidUpdate=wG.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){TG(e,n,t)}))};var CG="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,EG=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,AG="undefined"!=typeof document,SG=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var DG=Xp.event;function RG(){}function NG(){return this.cancelBubble}function MG(){return this.defaultPrevented}Xp.event=function(e){return DG&&(e=DG(e)),e.persist=RG,e.isPropagationStopped=NG,e.isDefaultPrevented=MG,e.nativeEvent=e};var OG={configurable:!0,get:function(){return this.class}},kG=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];AG&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!SG(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&EG.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(OG.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",OG))}e.$$typeof=CG,kG&&kG(e)};var IG=Xp.__r;Xp.__r=function(e){IG&&IG(e),e.__c};var PG="univer-content-wrapper";function LG(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function BG(e){this.props=e}jE(((e,t)=>{const{children:n,style:r,className:a}=e;return rm("main",{ref:t,style:r,className:`${PG} ${a}`},n)})),(BG.prototype=new om).isPureReactComponent=!0,BG.prototype.shouldComponentUpdate=function(e,t){return LG(this.props,e)||LG(this.state,t)};var FG=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),FG&&FG(e)};var HG=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);HG(e,t,n,r)};var qG=Xp.unmount;function UG(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return UG(e,t,n)}))),e}function VG(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return VG(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function WG(){this.__u=0,this.t=null,this.__b=null}function zG(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function YG(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),qG&&qG(e)},(WG.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=zG(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=VG(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},WG.prototype.componentWillUnmount=function(){this.t=[]},WG.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=UG(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var GG=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(YG.prototype=new om).__a=function(e){var t=this,n=zG(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),GG(t,e,r)):a()};n?n(i):i()}},YG.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},YG.prototype.componentDidUpdate=YG.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){GG(e,n,t)}))};var XG="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,$G=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,jG="undefined"!=typeof document,KG=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var ZG=Xp.event;function QG(){}function JG(){return this.cancelBubble}function eX(){return this.defaultPrevented}Xp.event=function(e){return ZG&&(e=ZG(e)),e.persist=QG,e.isPropagationStopped=JG,e.isDefaultPrevented=eX,e.nativeEvent=e};var tX={configurable:!0,get:function(){return this.class}},nX=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];jG&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!KG(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&$G.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(tX.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",tX))}e.$$typeof=XG,nX&&nX(e)};var rX=Xp.__r;Xp.__r=function(e){rX&&rX(e),e.__c};var aX="univer-content-wrapper";function iX(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function oX(e){this.props=e}RC(((e,t)=>{const{children:n,style:r,className:a}=e;return rm("main",{ref:t,style:r,className:`${aX} ${a}`},n)})),(oX.prototype=new om).isPureReactComponent=!0,oX.prototype.shouldComponentUpdate=function(e,t){return iX(this.props,e)||iX(this.state,t)};var sX=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),sX&&sX(e)};var lX=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);lX(e,t,n,r)};var cX=Xp.unmount;function uX(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return uX(e,t,n)}))),e}function hX(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return hX(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function dX(){this.__u=0,this.t=null,this.__b=null}function pX(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function mX(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),cX&&cX(e)},(dX.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=pX(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=hX(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},dX.prototype.componentWillUnmount=function(){this.t=[]},dX.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=uX(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var _X=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(mX.prototype=new om).__a=function(e){var t=this,n=pX(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),_X(t,e,r)):a()};n?n(i):i()}},mX.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},mX.prototype.componentDidUpdate=mX.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){_X(e,n,t)}))};var gX="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,fX=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,yX="undefined"!=typeof document,vX=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var bX=Xp.event;function xX(){}function wX(){return this.cancelBubble}function TX(){return this.defaultPrevented}Xp.event=function(e){return bX&&(e=bX(e)),e.persist=xX,e.isPropagationStopped=wX,e.isDefaultPrevented=TX,e.nativeEvent=e};var CX={configurable:!0,get:function(){return this.class}},EX=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];yX&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!vX(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&fX.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(CX.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",CX))}e.$$typeof=gX,EX&&EX(e)};var AX=Xp.__r;Xp.__r=function(e){AX&&AX(e),e.__c};var SX="univer-content-wrapper";function DX(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function RX(e){this.props=e}cT(((e,t)=>{const{children:n,style:r,className:a}=e;return rm("main",{ref:t,style:r,className:`${SX} ${a}`},n)})),(RX.prototype=new om).isPureReactComponent=!0,RX.prototype.shouldComponentUpdate=function(e,t){return DX(this.props,e)||DX(this.state,t)};var NX=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),NX&&NX(e)};var MX=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);MX(e,t,n,r)};var OX=Xp.unmount;function kX(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return kX(e,t,n)}))),e}function IX(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return IX(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function PX(){this.__u=0,this.t=null,this.__b=null}function LX(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function BX(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),OX&&OX(e)},(PX.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=LX(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=IX(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},PX.prototype.componentWillUnmount=function(){this.t=[]},PX.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=kX(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var FX=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(BX.prototype=new om).__a=function(e){var t=this,n=LX(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),FX(t,e,r)):a()};n?n(i):i()}},BX.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},BX.prototype.componentDidUpdate=BX.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){FX(e,n,t)}))};var HX="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,qX=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,UX="undefined"!=typeof document,VX=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var WX=Xp.event;function zX(){}function YX(){return this.cancelBubble}function GX(){return this.defaultPrevented}Xp.event=function(e){return WX&&(e=WX(e)),e.persist=zX,e.isPropagationStopped=YX,e.isDefaultPrevented=GX,e.nativeEvent=e};var XX={configurable:!0,get:function(){return this.class}},$X=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];UX&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!VX(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&qX.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(XX.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",XX))}e.$$typeof=HX,$X&&$X(e)};var jX=Xp.__r;Xp.__r=function(e){jX&&jX(e),e.__c};var KX="univer-content-wrapper";Vx(((e,t)=>{const{children:n,style:r,className:a}=e;return rm("main",{ref:t,style:r,className:`${KX} ${a}`},n)}));function ZX(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function QX(e){this.props=e}(QX.prototype=new om).isPureReactComponent=!0,QX.prototype.shouldComponentUpdate=function(e,t){return ZX(this.props,e)||ZX(this.state,t)};var JX=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),JX&&JX(e)};var e$=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);e$(e,t,n,r)};var t$=Xp.unmount;function n$(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return n$(e,t,n)}))),e}function r$(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return r$(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function a$(){this.__u=0,this.t=null,this.__b=null}function i$(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function o$(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),t$&&t$(e)},(a$.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=i$(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=r$(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},a$.prototype.componentWillUnmount=function(){this.t=[]},a$.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=n$(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var s$=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(o$.prototype=new om).__a=function(e){var t=this,n=i$(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),s$(t,e,r)):a()};n?n(i):i()}},o$.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},o$.prototype.componentDidUpdate=o$.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){s$(e,n,t)}))};var l$="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,c$=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,u$="undefined"!=typeof document,h$=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var d$=Xp.event;function p$(){}function m$(){return this.cancelBubble}function _$(){return this.defaultPrevented}Xp.event=function(e){return d$&&(e=d$(e)),e.persist=p$,e.isPropagationStopped=m$,e.isDefaultPrevented=_$,e.nativeEvent=e};var g$={configurable:!0,get:function(){return this.class}},f$=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];u$&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!h$(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&c$.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(g$.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",g$))}e.$$typeof=l$,f$&&f$(e)};var y$=Xp.__r;Xp.__r=function(e){y$&&y$(e),e.__c};var v$="univer-layout-wrapper",b$="univer-layout-wrapper-has-sider",x$="univer-header-wrapper",w$="univer-footer-wrapper",T$="univer-content-wrapper",C$="univer-sider-wrapper";class E$ extends Z_{constructor(){super(...arguments),this.ref={current:null},this.state={isAside:!1}}componentDidMount(){if(this.ref.current){let e=function(e){let t=[],n=e.getElementsByTagName("*");for(let r=0,a=n.length;r<a;++r){if(1!==n[r].nodeType)continue;let a=n[r].parentNode;a&&1===a.nodeType?a===e&&(t[t.length]=n[r]):a&&a.parentNode===e&&(t[t.length]=n[r])}return t}(this.ref.current);const t=e instanceof Array?e:[e];for(const e of t)"ASIDE"===e.tagName&&this.setState({isAside:!0})}}render(e,t){const{children:n,style:r,className:a}=e,{isAside:i}=t;return rm("section",{style:r,ref:this.ref,className:i?`${v$} ${b$} ${a}`:`${v$} ${a}`},n)}}const A$=e=>{const{children:t,style:n,className:r}=e;return rm("header",{style:n,className:`${x$} ${r}`},t)},S$=e=>{const{children:t,style:n,className:r}=e;return rm("footer",{style:n,className:`${w$} ${r}`},t)},D$=M_(((e,t)=>{const{children:n,style:r,className:a}=e;return rm("main",{ref:t,style:r,className:`${T$} ${a}`},n)})),R$=e=>{const{children:t,style:n,className:r}=e;return rm("aside",{style:n,className:`${C$} ${r}`},t)};class N${render(){return E$}}class M${render(){return A$}}class O${render(){return S$}}class k${render(){return D$}}class I${render(){return R$}}var P$="univer-cols-menu",L$="univer-cols-menuitem",B$="univer-cols-menuitem-line",F$="univer-cols-menuitem-disabled";class H$ extends Z_{constructor(){super(...arguments),this._MenuRef={current:null},this._refs=[],this.getMenuRef=()=>this._MenuRef,this.handleClick=(e,t,n)=>{const{deep:r=0}=this.props;t.onClick?t.onClick.call(null,e,t.value,n,r):this.props.onClick&&this.props.onClick.call(null,e,t.value,n,r),this.showMenu(!1)},this.showMenu=e=>{this.setState((t=>({show:e})),(()=>{this.getStyle()}))},this.mouseEnter=(e,t)=>{const{menu:n=[]}=this.props;n[t].children&&this._refs[t].showMenu(!0)},this.mouseLeave=(e,t)=>{const{menu:n=[]}=this.props;n[t].children&&this._refs[t].showMenu(!1)},this.getStyle=()=>{var e;const t=this._MenuRef.current;if(!t)return;let n={};const r=t.getBoundingClientRect();let a;const{dom:i,parent:o}=this.props;if(a={left:0,right:document.documentElement.clientWidth,top:0,bottom:document.documentElement.clientHeight},o){t.style.position="fixed";let i=null==(e=t.parentElement)?void 0:e.getBoundingClientRect();if(!i)return;i.right+r.width>a.right?(n.left=i.left-r.width+"px",n.top=`${i.top}px`):(n.left=`${i.right}px`,n.top=`${i.top}px`),this.setState({posStyle:n})}}}initialize(){this.state={show:!1,posStyle:{}}}render(){const{className:e="",style:t="",menu:n,deep:r=0}=this.props,{show:a,posStyle:i}=this.state;return rm("ul",{className:J_(P$,e),style:{...t,...i,display:a?"block":"none"},ref:this._MenuRef},null==n?void 0:n.map(((e,t)=>{var n,a;if(!e.hide)return rm(im,null,rm("li",{className:J_(L$,null!=(n=e.className)?n:"",e.disabled?F$:""),style:null!=(a=e.style)?a:"",onClick:n=>this.handleClick(n,e,t),onMouseEnter:e=>{this.mouseEnter(e,t)},onMouseLeave:e=>{this.mouseLeave(e,t)}},e.label,e.children?rm(H$,{ref:e=>this._refs[t]=e,menu:e.children,onClick:e.onClick,className:e.className,style:e.style,parent:this,deep:r+1}):rm(im,null)),e.border?rm("div",{className:B$}):"")})))}}class q${render(){return H$}}var U$="univer-drag";class V$ extends Z_{constructor(){super(...arguments),this.root={current:null},this.onMouseMove=e=>{let t=this.state.offsetX,n=this.state.offsetY,r=e.x-t+"px",a=e.y-n+"px";this.setState({top:a,left:r})}}initialize(){this.state={left:"",top:"",width:0,height:0,rootW:0,rootH:0,rootL:0,rootT:0,offsetX:0,offsetY:0}}onMouseUp(e){window.removeEventListener("mousemove",this.onMouseMove)}onMouseDown(e){if(e.target.className!==U$)return;window.addEventListener("mousemove",this.onMouseMove);let t=e.offsetX,n=e.offsetY;this.setState({offsetX:t,offsetY:n})}getWindowRect(){const e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,n=this.root.current.offsetWidth,r=this.root.current.offsetHeight,a=this.root.current.offsetLeft,i=this.root.current.offsetTop,o=(t-r)/2+"px",s=(e-n)/2+"px";this.setState({width:e,height:t,rootW:n,rootH:r,rootL:a,rootT:i,top:o,left:s})}componentDidMount(){this.props.isDrag&&this.getWindowRect()}render(){const{isDrag:e}=this.props;return rm(im,null,e?rm("div",{ref:this.root,className:U$,style:{top:this.state.top,left:this.state.left},onMouseUp:this.onMouseUp.bind(this),onMouseDown:this.onMouseDown.bind(this)},this.props.children):this.props.children)}}var W$="univer-modal-mask",z$="univer-modal-wrapper",Y$="univer-modal-darg-wrapper",G$="univer-modal-header",X$="univer-modal-close",$$="univer-modal-body",j$="univer-modal-footer";class K$ extends Z_{constructor(){super(...arguments),this.handleClickCancel=e=>{e&&e()},this.showModal=e=>{this.setState((t=>({visible:e})))},this.handleClick=e=>{e&&e()}}initialize(){var e;this.state={visible:null!=(e=this.props.visible)&&e}}render(){const{title:e,width:t=500,top:n=0,style:r,children:a,className:i,group:o=[],isDrag:s=!1,mask:l=!0,footer:c=!0}=this.props,{visible:u}=this.state;return rm(im,null,u?rm("div",{className:i},l?rm("div",{className:W$,onClick:e=>{var t,n;null==(n=(t=this.props).onCancel)||n.call(t,e),this.showModal(!1)}}):null,rm(V$,{isDrag:s},rm("div",{className:`${s?Y$:z$}`,style:{width:`${t}px`,...r}},rm("div",{className:G$},rm("span",null,e),rm("span",{className:X$,onClick:e=>{var t,n;null==(n=(t=this.props).onCancel)||n.call(t,e),this.showModal(!1)}},rm(Ov.Close,null))),rm("div",{className:$$},a),c?rm("div",{className:j$},o.map((e=>rm(Pv,{type:e.type,onClick:()=>this.handleClick(e.onClick)},e.label)))):null))):null)}}class Z${render(){return K$}}var Q$="univer-radio-wrap",J$="univer-radio-left",ej="univer-circle",tj="univer-active",nj="univer-fork",rj="univer-label";class aj extends Z_{render(){return rm("div",{className:Q$},rm("div",{className:J$},rm("div",{onClick:this.props.onClick.bind(this,this.props.value)},rm("div",{className:`${ej} ${this.props.active&&tj}`},rm("div",{className:nj})),rm("div",{className:rj},this.props.label)),this.props.children))}}class ij{render(){return aj}}class oj{render(){return aj}}function sj(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function lj(e){this.props=e}(lj.prototype=new om).isPureReactComponent=!0,lj.prototype.shouldComponentUpdate=function(e,t){return sj(this.props,e)||sj(this.state,t)};var cj=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),cj&&cj(e)};var uj=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);uj(e,t,n,r)};var hj=Xp.unmount;function dj(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return dj(e,t,n)}))),e}function pj(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return pj(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function mj(){this.__u=0,this.t=null,this.__b=null}function _j(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function gj(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),hj&&hj(e)},(mj.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=_j(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=pj(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},mj.prototype.componentWillUnmount=function(){this.t=[]},mj.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=dj(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var fj=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(gj.prototype=new om).__a=function(e){var t=this,n=_j(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),fj(t,e,r)):a()};n?n(i):i()}},gj.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},gj.prototype.componentDidUpdate=gj.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){fj(e,n,t)}))};var yj="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,vj=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,bj="undefined"!=typeof document,xj=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var wj=Xp.event;function Tj(){}function Cj(){return this.cancelBubble}function Ej(){return this.defaultPrevented}Xp.event=function(e){return wj&&(e=wj(e)),e.persist=Tj,e.isPropagationStopped=Cj,e.isDefaultPrevented=Ej,e.nativeEvent=e};var Aj={configurable:!0,get:function(){return this.class}},Sj=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];bj&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!xj(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&vj.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(Aj.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",Aj))}e.$$typeof=yj,Sj&&Sj(e)};var Dj=Xp.__r;Xp.__r=function(e){Dj&&Dj(e),e.__c};var Rj="univer-select-button",Nj="univer-select-button-inner",Mj="univer-select-color",Oj="univer-select-button-inner-label-icon",kj="univer-select-button-inner-label-string",Ij="univer-select-input",Pj="univer-select-line",Lj="univer-select-double-button",Bj="univer-double-buttons";class Fj extends lj{constructor(e){super(e),this.ref={current:null},this.inputRef={current:null},this.colorBtn={current:null},this.showSelect=e=>{e.stopImmediatePropagation();const t=this.ref.current;t&&this.props.selectType===p_.COLOR?t.showSelect(this.colorBtn.current):t&&t.showSelect(),window.addEventListener("click",this.hide,!0)},this.hide=e=>{this.ref.current&&(this.ref.current.ulRef||this.ref.current.ulRef.current)&&(this.ref.current.ulRef.current.contains(e.target)||this.hideSelect(e))},this.hideSelect=e=>{this.ref.current.hideSelect(e),window.removeEventListener("click",this.hide,!0)},this.changeValue=e=>{this.setState((t=>({...e})))},this.update=e=>{const t=typeof this.props.label,n=this.state.children;let r;null==n||n.forEach(((n,a)=>{n.value===e?(n.selected=!0,this.props.needChange&&(this.setState({label:"string"===t?n.label:n.icon}),r=n.label)):n.selected=!1})),this.setState({children:n}),this.props.selectType===p_.INPUT_NUMBER&&this.inputRef.current.setValue(r)},this.handleClick=(...e)=>{var t,n;const r=typeof this.props.label;this.hideSelect(e[0]);const{item:a,index:i}=e[1],o=this.state.children;null==o||o.forEach((e=>e.selected=!1)),o[i].selected=!0;let s=o[i].label;if(this.setState({children:o}),this.props.needChange){this.setState({label:"string"===r?s:a.icon}),[p_.INPUT,p_.INPUT_NUMBER].includes(this.props.selectType)&&this.inputRef.current.setValue(s);const e=this.props.children;if(e[10]&&"borderLine.borderColor"===e[10].locale){let n=e[10].children[0].value,r=e[11].value;return void(null==(t=this.props.onClick)||t.call(this,o[i].hasOwnProperty("value")?o[i].value:o[i].label,n,r))}}null==(n=this.props.onClick)||n.call(this,o[i].hasOwnProperty("value")?o[i].value:o[i].label)},this.handleButtonClick=()=>{var e,t,n,r;const a=this.state.children,i=null==a?void 0:a.find((e=>!0===e.selected)),o=this.props.children;if("color"===this.props.selectType)null==(e=this.props.onClick)||e.call(this,this.state.selectColor);else{if(o&&o[10]&&"borderLine.borderColor"===o[10].locale){let e=o[10].children[0].value,n=o[11].value;return void(i&&(null==(t=this.props.onClick)||t.call(this,i.hasOwnProperty("value")?i.value:i.label,e,n)))}if(o&&o[0]&&o[0].locale&&o[0].locale.indexOf("merge")>-1)return void(null==(n=this.props.onClick)||n.call(this,"all"))}i&&(null==(r=this.props.onClick)||r.call(this,i.hasOwnProperty("value")?i.value:i.label))},this.handleKeyUp=e=>{var t;if("Enter"===e.key){this.props.selectType===p_.INPUT_NUMBER&&this.inputRef.current.base.blur();const n=e.currentTarget.value;this.update(n),this.hideSelect(e),null==(t=this.props.onKeyUp)||t.call(this,n)}},this.state={label:"",children:[],selectColor:"#000"};const{triggerUpdate:t}=e;t&&t(this.update.bind(this))}componentWillMount(){this.changeValue({label:this.props.label,children:this.props.children})}render(e){const{icon:t,tooltip:n,selectType:r,border:a,slot:i,style:o,onClick:s}=e;return this.state.label,r===p_.INPUT||r===p_.INPUT_NUMBER?rm("div",{className:Rj},rm("div",{className:Ij},rm($b,{type:r===p_.INPUT_NUMBER?"number":"text",value:this.state.label,onClick:this.showSelect,ref:this.inputRef,bordered:!1,onKeyUp:this.handleKeyUp}),rm("span",{onClick:this.showSelect},t)),a?rm("div",{className:Pj}):"",rm(NK,{children:this.state.children,onClick:this.handleClick,ref:this.ref,style:o})):r===p_.DOUBLE?rm("div",{className:`${Rj} ${Lj}`},rm("div",{style:{display:"flex",alignItems:"center"}},rm(xK,{title:n,placement:"bottom"},rm(Pv,{type:"text",onClick:this.handleButtonClick},rm("div",{className:Nj},rm("div",{className:"string"==typeof this.state.label?kj:Oj},this.state.label)))),rm(xK,{title:this.props.tooltipRight,placement:"bottom"},rm(Pv,{type:"text",onClick:this.showSelect,className:Bj},rm("div",{className:Nj},t)))),a?rm("div",{className:Pj}):"",rm(NK,{children:this.state.children,onClick:this.handleClick,ref:this.ref,style:o})):r===p_.COLOR?rm("div",{className:`${Rj} ${Lj}`,ref:this.colorBtn},rm("div",{style:{display:"flex",alignItems:"center"}},rm(xK,{title:n,placement:"bottom"},rm(Pv,{type:"text",onClick:this.handleButtonClick},rm("div",{className:Nj},rm("div",{className:"string"==typeof this.state.label?kj:Oj},this.state.label),rm("div",{className:Mj,style:{backgroundColor:this.state.selectColor}})))),rm(xK,{title:this.props.tooltipRight,placement:"bottom"},rm(Pv,{type:"text",onClick:this.showSelect,className:Bj},rm("div",{className:Nj},t)))),a?rm("div",{className:Pj}):"",rm(cx,{color:"#000",onClick:e=>{this.setState({selectColor:e},(()=>{s&&s(this.state.selectColor)}))},slot:i,ref:this.ref})):rm("div",{className:Rj},rm(xK,{title:n,placement:"bottom"},rm(Pv,{type:"text",onClick:this.showSelect},rm("div",{className:Nj},rm("div",{className:"string"==typeof this.state.label?kj:Oj},this.state.label),t))),a?rm("div",{className:Pj}):"",rm(NK,{children:this.state.children,onClick:this.handleClick,ref:this.ref,style:o}))}}class Hj{render(){return Fj}}var qj="univer-dropdown",Uj="univer-drop-content",Vj="univer-drop-icon";class Wj extends Z_{constructor(){super(...arguments),this.MenuRef={current:null},this.DropRef={current:null},this.IconRef={current:null},this.handleClick=e=>{var t,n,r;null==(n=(t=this.props).onClick)||n.call(t);const{icon:a}=this.props;a||null==(r=this.MenuRef.current)||r.showMenu(!0)},this.handleSubClick=()=>{var e;null==(e=this.MenuRef.current)||e.showMenu(!0)},this.hideMenu=e=>{var t,n;this.DropRef.current&&(null==(t=this.DropRef.current)?void 0:t.contains(e.target))||null==(n=this.MenuRef.current)||n.showMenu(!1)}}initialize(){this.state={menuStyle:{}}}componentDidMount(){const{placement:e}=this.props;let t={position:"absolute"};e&&"Bottom"!==e?"Top"===e?(t.left=0,t.top="-100%"):"Left"===e?(t.left="-100%",t.top=0):(t.left="100%",t.top=0):(t.left=0,t.top="100%"),this.setState({menuStyle:t}),window.addEventListener("click",this.hideMenu)}componentWillUnmount(){window.removeEventListener("click",this.hideMenu)}render(){const{children:e,menu:t,showArrow:n,icon:r}=this.props,{menuStyle:a}=this.state;return rm("div",{className:qj,ref:this.DropRef},rm("div",{className:Uj,onClick:this.handleClick},e,n?rm(fy.NextIcon,null):""),r?rm("div",{ref:this.IconRef,className:Vj,onClick:this.handleSubClick},r):"",rm(H$,{onClick:t.onClick,ref:this.MenuRef,menu:t.menu,className:t.className,style:{...t.style,...a}}))}}class zj{render(){return Wj}}var Yj="univer-sider-modal",Gj="univer-sider-modal-header",Xj="univer-sider-modal-title",$j="univer-sider-modal-close",jj="univer-sider-modal-body",Kj="univer-sider-modal-body-inner",Zj="univer-sider-modal-footer";class Qj extends Z_{initialize(e){this.state={}}close(){this._context.getPluginManager().getPluginByName("spreadsheet").showSiderByName(this.props.pluginName,!1),this.props.closeSide&&this.props.closeSide()}render(e){const{className:t,style:n}=e;return rm("div",{className:`${Yj} ${t}`,style:{...n}},rm("div",{className:Gj},rm("h3",{className:Xj},this.props.title),rm("span",{className:$j,onClick:()=>this.close()},rm(Ov.Close,null))),rm("div",{className:jj},rm("div",{className:Kj},this.props.children)),rm("div",{className:Zj},this.props.footer))}}class Jj{render(){return Qj}}var eK="univer-slider";class tK extends Z_{constructor(){super(...arguments),this.ref={current:null},this.onInput=(e,t)=>{var n;const r=t.target.value;this.changeInputValue(e,r),null==(n=this.props.onChange)||n.call(this,t)},this.onClick=(e,t)=>{var n;const{min:r=0,max:a=100,step:i=1}=this.props,o=t.currentTarget;let s=t.offsetX;const l=o.offsetWidth;if(s<0||s>l)return;let c=s/this.width*(a-r);c%i&&(c+=i-c%i),this.changeInputValue(e,c),null==(n=this.props.onClick)||n.call(this,t,c)},this.changeInputValue=(e,t)=>{let n=this.ref.current,r=n.getElementsByTagName("input")[e].id;n.style.setProperty(`--${r}`,t),e?this.setValue({valueNext:t}):this.setValue({valuePrev:t})},this.setValue=(e,t)=>{this.setState((t=>({...e})),t)}}initialize(e){this.state={valuePrev:0,valueNext:0}}componentWillMount(){this.idPrev=Q_("slider"),this.idNext=Q_("slider")}componentDidMount(){const{min:e=0,max:t=100,range:n}=this.props;let r=t-e,a=this.ref.current;if(this.width=a.offsetWidth,a.style.cssText+=`--${this.idPrev}: ${this.state.valuePrev}; --${this.idNext}: ${this.state.valueNext}`,document.styleSheets[0].addRule(`.${eK}::after`,`margin-left: calc((var(--${this.idNext}) - ${e})/${r}*100%); width: calc((var(--${this.idPrev}) - var(--${this.idNext}))/${r}*100%);`),document.styleSheets[0].insertRule(`.${eK}::after {margin-left: calc((var(--${this.idNext}) - ${e})/${r}*100%); width: calc((var(--${this.idPrev}) - var(--${this.idNext}))/${r}*100%);}`,0),document.styleSheets[0].addRule(`.${eK}::before`,`margin-left: calc((var(--${this.idPrev}) - ${e})/${r}*100%);width: calc((var(--${this.idNext}) - var(--${this.idPrev}))/${r}*100%);`),document.styleSheets[0].insertRule(`.${eK}::before {margin-left: calc((var(--${this.idPrev}) - ${e})/${r}*100%);width: calc((var(--${this.idNext}) - var(--${this.idPrev}))/${r}*100%);}`,0),n){let{value:e}=this.props;e=e||[0,0],this.setValue({valuePrev:e[0],valueNext:e[1]})}else{let{value:e}=this.props;e=e||0,this.changeInputValue(0,e)}}render(e,t){const{valuePrev:n,valueNext:r}=t,{step:a=1,min:i=0,max:o=100,range:s=!1}=e;return s?rm("div",{className:eK,role:"group","aria-labelledby":"multi-lbl",style:{"--min":i,"--max":o},ref:this.ref},rm("label",{class:"sr-only",for:this.idPrev}),rm("input",{id:this.idPrev,type:"range",min:i,value:n,max:o,step:a,onInput:e=>this.onInput(0,e)}),rm("label",{class:"sr-only",for:this.idNext}),rm("input",{id:this.idNext,type:"range",min:i,value:r,max:o,step:a,onInput:e=>this.onInput(1,e)})):rm("div",{className:eK,role:"group","aria-labelledby":"multi-lbl",style:{"--min":i,"--max":o},ref:this.ref,onClick:e=>this.onClick(0,e)},rm("label",{class:"sr-only",for:this.idPrev}),rm("input",{id:this.idPrev,type:"range",min:i,value:n,max:o,step:a,onInput:e=>this.onInput(0,e)}))}}class nK{render(){return tK}}var rK="univer-tabs",aK="univer-tabs-nav",iK="univer-tabs-nav-wrap",oK="univer-tabs-nav-list",sK="univer-tabs-tab",lK="univer-tabs-tab-active",cK="univer-tabs-content",uK="univer-tabs-panel",hK="univer-tabs-panel-active";class dK extends lj{constructor(){super(...arguments),this.state={active:""},this.setValue=(e,t)=>{this.setState((t=>({...e})),t)},this.parseNavList=()=>{const{active:e}=this.state;return pm(this.props.children).map((t=>{const{tab:n,keys:r}=t.props,a=`${Q_("tab")}-${r}`;return rm("div",e===r?{id:a,onClick:this.handleClick,className:J_(sK,lK)}:{id:a,onClick:this.handleClick,className:sK},n)}))},this.handleClick=e=>{var t,n;const r=e.target.id,a=r.lastIndexOf("-"),i=r.slice(a+1);this.setValue({active:i}),null==(n=(t=this.props).onTabClick)||n.call(t,i,e)}}componentWillMount(){this.setValue({active:this.props.activeKey,children:this.props.children})}render(e,t){const{children:n,type:r="line",className:a}=e;return rm("div",{className:J_(rK,{[`${rK}-card`]:"card"===r},a)},rm("div",{className:aK},rm("div",{className:iK},rm("div",{className:oK},this.parseNavList()))),rm("div",{className:cK},n.map((e=>rm(pK,{keys:e.props.keys,active:e.props.keys===this.state.active},e.props.children)))))}}const pK=e=>{const{id:t,keys:n,style:r,children:a,active:i}=e;return rm("div",{id:t&&`${t}-panel-${n}`,role:"tabpanel",style:{...r},className:J_(uK,i&&hK)},i&&a)};class mK{render(){return dK}}class _K{render(){return pK}}var gK="univer-tooltip-Group",fK="univer-tooltip-title",yK="univer-tooltip-body",vK="univer-tooltip-triangle";const bK={top:"univer-top",bottom:"univer-bottom",left:"univer-left",right:"univer-right"};class xK extends Z_{constructor(){super(...arguments),this.tooltip={current:null}}initialize(e){this.state={placement:e.placement||"top",placementClassName:J_(fK,bK[e.placement||"top"]),top:"",left:""}}handleMouseOver(){if(this.tooltip&&this.tooltip.current){let e=this.tooltip.current.getBoundingClientRect(),t=e.height,n=e.width;"bottom"===this.state.placement?this.setState({top:t+10,left:n/2}):"left"===this.state.placement?this.setState({top:t/2,left:n+5}):"right"===this.state.placement?this.setState({top:t/2,left:-n-10}):this.setState({top:-t-20,left:n/2})}}render(){return rm("div",{ref:this.tooltip,className:gK,style:this.props.styles},rm("div",{className:yK,onMouseEnter:this.handleMouseOver.bind(this)},this.props.children),this.props.title?rm("span",{className:this.state.placementClassName,style:{top:`${this.state.top}px`,left:`${this.state.left}px`}},this.props.title,rm("span",{className:vK})):null)}}class wK{render(){return xK}}var TK="univer-cols-menu",CK="univer-cols-menu-jsx",EK="univer-cols-menuitem",AK="univer-line",SK="univer-cols-menuitem-content",DK="univer-ul-icon",RK="univer-submenu-arrow";class NK extends Z_{constructor(){super(...arguments),this.refs=[],this.ulRef={current:null},this.filterChildren=e=>{let t;return Array.from(e.children).forEach((e=>{"UL"===e.nodeName&&(t=!0)})),t},this.mouseOver=(e,t)=>{this.refs.forEach((e=>{e.hideSelect()}));const n=e.currentTarget;this.filterChildren(n)&&this.refs[t].showSelect()},this.mouseLeave=(e,t)=>{"jsx"!==(this.refs[t]?this.refs[t].props.children[0].selectType:"")&&this.refs.forEach((e=>{e.hideSelect()}))},this.handleClick=(e,{item:t,index:n,ref:r},a)=>{e.stopImmediatePropagation(),null==a||a.call(this,e,{item:t,index:n,ref:r})},this.handleKeyUp=(e,{item:t,index:n,ref:r},a)=>{e.stopImmediatePropagation(),null==a||a.call(this,e,{item:t,index:n,ref:r})},this.sendParent=()=>this,this.hideSelect=()=>{var e;window.removeEventListener("resize",this.resizeUl),"none"!==(null==(e=this.state.style)?void 0:e.display)&&(this.refs.forEach((e=>{e.hideSelect()})),this.setState((e=>({style:{display:"none"}}))))},this.showSelect=()=>{window.addEventListener("resize",this.resizeUl),this.setState((e=>({style:{display:"inline-block"}})),(()=>{this.getStyle()}))},this.getStyle=()=>{var e;const t=null==(e=this.ulRef.current)?void 0:e.parentElement,n=this.ulRef.current;let r,a={};if(!n||!t)return;const i=n.getBoundingClientRect();let o=null==t?void 0:t.getBoundingClientRect();r=this.getContext().getPluginManager().getPluginByName("spreadsheet").getContentRef().current.getBoundingClientRect(),r&&o&&("LI"===(null==t?void 0:t.nodeName)?(n.style.position="fixed",o=null==t?void 0:t.getBoundingClientRect(),o.right+i.width>r.right?(a.left=o.left-i.width+"px",a.top=`${o.top}px`):(a.left=`${o.right}px`,a.top=`${o.top}px`)):"DIV"===(null==t?void 0:t.nodeName)&&(o.right+i.width>r.right||o.right+i.width>document.documentElement.clientWidth?(a.right="0",a.left="auto"):(a.left="0",a.right="auto"),i.top>=r.bottom&&(a.top="auto",a.bottom="100%")),this.setState((e=>({posStyle:a}))))},this.showIcon=e=>"selected"in e||"hidden"in e?e.selected?rm("span",{className:DK},rm(fy.CorrectIcon,{style:{fontSize:"13px"}})):e.hidden?rm("span",{className:DK},rm(fy.HideIcon,{style:{fontSize:"13px"}})):rm("span",{className:DK}):"",this.getIcon=e=>{let t=e;return"string"==typeof t&&/Icon$/.test(t)&&(t=kv[t]),rm("span",{className:RK},t)},this.getParent=()=>{var e;return null!=(e=this.props.getParent())?e:null}}initialize(e){this.state={style:{display:"none"},posStyle:{}},this.resizeUl=eg(this.getStyle,200)}componentWillMount(){const{show:e=!1}=this.props;e&&this.setState((e=>({style:{display:"inline-block"}})))}render(e,t){var n;const{children:r,onClick:a,style:i,onKeyUp:o}=e,{posStyle:s}=t,l=Object.assign(null!=(n=this.state.style)?n:{},s,i||{});return(null==r?void 0:r.length)?(r.some(((e,t)=>!!e.selected&&(r.forEach(((e,n)=>{t!==n&&(e.selected=!1)})),!0))),rm("ul",{className:"jsx"===r[0].selectType?CK:TK,style:{...l},ref:this.ulRef},null==r?void 0:r.map(((e,t)=>{var n;let r=e.className?`${EK} ${e.className}`:EK;if(!e.hideLi)return rm("li",{className:r,style:{...e.style},onClick:n=>{n.stopPropagation(),this.handleClick(n,{item:e,index:t,ref:this},e.onClick?e.onClick:a)},onMouseEnter:e=>{this.mouseOver(e,t)},onMouseLeave:e=>{this.mouseLeave(e,t)},onKeyUp:n=>{this.handleKeyUp(n,{item:e,index:t,ref:this},e.onKeyUp?e.onKeyUp:o)}},rm("div",{className:"jsx"===e.selectType?"":SK},this.showIcon(e),rm("div",null,"jsx"===e.selectType?rm("span",null,Am(e.label,{onChange:this.getStyle})):rm("span",null,e.label),e.icon?this.getIcon(e.icon):"")),(null==(n=e.children)?void 0:n.length)?rm(NK,{children:e.children,onClick:e.onClick,ref:e=>this.refs[t]=e,getParent:this.sendParent}):rm(im,null),e.border?rm("div",{className:AK}):"")})))):rm(im,null)}}class MK{render(){return NK}}class OK extends Ts{constructor(){super("ComponentSheet")}getComponentRender(){return new kK(this.getComponentFactory())}getComponentFactory(){return new IK}}class kK{constructor(e){this._componentFactory=e}renderForwardFn(e){return this._componentFactory.createComponent(e).render()}renderClass(e){return this._componentFactory.createComponent(e).render()}renderFunction(e){return this._componentFactory.createComponent(e).render()}}class IK{createComponent(e){switch(e){case"Button":return new Lv;case"Select":return new Hj;case"Container":return new fx;case"CellRangeModal":return new ub;case"Modal":return new Z$;case"SiderModal":return new Jj;case"Layout":return new N$;case"Header":return new M$;case"Footer":return new O$;case"Content":return new k$;case"Sider":return new I$;case"Checkbox":return new fb;case"CheckboxGroup":return new Ub;case"ColorPicker":return new ux;case"ColorPickerCircleButton":return new _x;case"Input":return new jb;case"Radio":return new ij;case"RadioGroup":return new oj;case"Tab":return new mK;case"TabPane":return new _K;case"Tooltip":return new wK;case"Ul":return new MK;case"Collapse":return new Yb;case"Panel":return new Gb;case"FormatModal":return new bx;case"Menu":return new q$;case"Dropdown":return new zj;case"NextIcon":return new xy;case"RightIcon":return new wy;case"OrderIcon":return new Uy;case"CommentIcon":return new jy;case"ConditionalFormatIcon":return new Jy;case"ScreenshotIcon":return new Ev;case"CheckIcon":return new Xy;case"SearchIcon":return new iv;case"ReplaceIcon":return new rv;case"FreezeIcon":return new Zy;case"PivotableIcon":return new Hy;case"FillColorIcon":return new hf;case"BoldIcon":return new Gg;case"FullBorderIcon":return new df;case"TopBorderIcon":return new pf;case"BottomBorderIcon":return new mf;case"LeftBorderIcon":return new _f;case"RightBorderIcon":return new gf;case"NoneBorderIcon":return new ff;case"OuterBorderIcon":return new yf;case"InnerBorderIcon":return new vf;case"StripingBorderIcon":return new bf;case"VerticalBorderIcon":return new xf;case"MergeIcon":return new wf;case"SumIcon":return new qy;case"OrderDESCIcon":return new Vy;case"OrderASCIcon":return new Wy;case"FilterIcon":return new zy;case"FilterRankIcon":return new Yy;case"CleanIcon":return new Gy;case"DeleteIcon":return new Mv;case"DeleteLineIcon":return new $g;case"UnderLineIcon":return new jg;case"ItalicIcon":return new Xg;case"TextColorIcon":return new Kg;case"BackIcon":return new yy;case"ForwardIcon":return new vy;case"FormatIcon":return new by;case"CorrectIcon":return new Ty;case"LtIcon":return new Cy;case"CloseIcon":return new Ey;case"DropDownIcon":return new Ay;case"MenuIcon":return new Sy;case"HideIcon":return new Dy;case"PhotoIcon":return new ay;case"LinkIcon":return new iy;case"ChartIcon":return new oy;case"LoadingIcon":return new wg;case"LogoIcon":return new Cg;case"AddNumIcon":return new kg;case"ReduceNumIcon":return new Ig;case"PercentIcon":return new Pg;case"MoneyIcon":return new Lg;case"FxIcon":return new Bg;case"AddIcon":return new Fg;case"ReduceIcon":return new Hg;case"DivideIcon":return new tv;case"LockIcon":return new sv;case"LocationIcon":return new cv;case"PageIcon":return new hv;case"RegularIcon":return new pv;case"LayoutIcon":return new _v;case"TableIcon":return new fv;case"ImageIcon":return new Dv;case"LeftAlignIcon":return new Ff;case"CenterAlignIcon":return new Hf;case"RightAlignIcon":return new qf;case"TopVerticalIcon":return new Uf;case"CenterVerticalIcon":return new Vf;case"BottomVerticalIcon":return new Wf;case"TextRotateIcon":return new zf;case"TextRotateAngleUpIcon":return new Yf;case"TextRotateAngleDownIcon":return new Gf;case"TextRotateVerticalIcon":return new Xf;case"TextRotateRotationUpIcon":return new $f;case"TextRotateRotationDownIcon":return new jf;case"BrIcon":return new Kf;case"OverflowIcon":return new Zf;case"CutIcon":return new Qf;case"PrintIcon":return new Cv;case"PrintAreaIcon":return new Av;case"PrintTitleIcon":return new Sv;case"BorderDashDot":return new $v;case"BorderDashDotDot":return new Kv;case"BorderDashed":return new Gv;case"BorderDotted":return new zv;case"BorderHair":return new Vv;case"BorderMedium":return new Qv;case"BorderMediumDashDot":return new nb;case"BorderMediumDashDotDot":return new ab;case"BorderMediumDashed":return new eb;case"BorderThick":return new ob;case"BorderThin":return new qv;case"Slider":return new nK}throw new Error("Not Found Component")}}const PK=Sm({});var LK,BK,FK,HK=(e=>(e.JSX="jsx",e.JSX_STRING="jsx_string",e.HTML="html",e.HTML_STRING="html_string",e.STRING="string",e.SINGLE="single",e.SELECT="select",e))(HK||{}),qK=[],UK=[],VK=Xp.__b,WK=Xp.__r,zK=Xp.diffed,YK=Xp.__c,GK=Xp.unmount;function XK(){for(var e;e=qK.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(KK),e.__H.__h.forEach(ZK),e.__H.__h=[]}catch(t){e.__H.__h=[],Xp.__e(t,e.__v)}}Xp.__b=function(e){"function"!=typeof e.type||e.__m||null===e.__?e.__m||(e.__m=e.__&&e.__.__m?e.__.__m:""):e.__m=(e.__&&e.__.__m?e.__.__m:"")+(e.__&&e.__.__k?e.__.__k.indexOf(e):0),LK=null,VK&&VK(e)},Xp.__r=function(e){WK&&WK(e);var t=(LK=e.__c).__H;t&&(BK===LK?(t.__h=[],LK.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=UK,e.__N=e.i=void 0}))):(t.__h.forEach(KK),t.__h.forEach(ZK),t.__h=[])),BK=LK},Xp.diffed=function(e){zK&&zK(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==qK.push(t)&&FK===Xp.requestAnimationFrame||((FK=Xp.requestAnimationFrame)||jK)(XK)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==UK&&(e.__=e.__V),e.i=void 0,e.__V=UK}))),BK=LK=null},Xp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(KK),e.__h=e.__h.filter((function(e){return!e.__||ZK(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Xp.__e(n,e.__v)}})),YK&&YK(e,t)},Xp.unmount=function(e){GK&&GK(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{KK(e)}catch(e){t=e}})),n.__H=void 0,t&&Xp.__e(t,n.__v))};var $K="function"==typeof requestAnimationFrame;function jK(e){var t,n=function(){clearTimeout(r),$K&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);$K&&(t=requestAnimationFrame(n))}function KK(e){var t=LK,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),LK=t}function ZK(e){var t=LK;e.__c=e.__(),LK=t}function QK(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function JK(e){this.props=e}(JK.prototype=new om).isPureReactComponent=!0,JK.prototype.shouldComponentUpdate=function(e,t){return QK(this.props,e)||QK(this.state,t)};var eZ=Xp.__b;Xp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),eZ&&eZ(e)};var tZ=Xp.__e;Xp.__e=function(e,t,n,r){if(e.then)for(var a,i=t;i=i.__;)if((a=i.__c)&&a.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),a.__c(e,t);tZ(e,t,n,r)};var nZ=Xp.unmount;function rZ(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=function(e,t){for(var n in t)e[n]=t[n];return e}({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return rZ(e,t,n)}))),e}function aZ(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return aZ(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function iZ(){this.__u=0,this.t=null,this.__b=null}function oZ(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function sZ(){this.u=null,this.o=null}Xp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),nZ&&nZ(e)},(iZ.prototype=new om).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var a=oZ(r.__v),i=!1,o=function(){i||(i=!0,n.__R=null,a?a(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=aZ(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},iZ.prototype.componentWillUnmount=function(){this.t=[]},iZ.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=rZ(this.__b,n,r.__O=r.__P)}this.__b=null}var a=t.__a&&rm(im,null,e.fallback);return a&&(a.__h=null),[rm(im,null,t.__a?null:e.children),a]};var lZ=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(sZ.prototype=new om).__a=function(e){var t=this,n=oZ(t.__v),r=t.o.get(e);return r[0]++,function(a){var i=function(){t.props.revealOrder?(r.push(a),lZ(t,e,r)):a()};n?n(i):i()}},sZ.prototype.render=function(e){this.u=null,this.o=new Map;var t=pm(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},sZ.prototype.componentDidUpdate=sZ.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){lZ(e,n,t)}))};var cZ="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,uZ=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,hZ="undefined"!=typeof document,dZ=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};om.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(om.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var pZ=Xp.event;function mZ(){}function _Z(){return this.cancelBubble}function gZ(){return this.defaultPrevented}Xp.event=function(e){return pZ&&(e=pZ(e)),e.persist=mZ,e.isPropagationStopped=_Z,e.isDefaultPrevented=gZ,e.nativeEvent=e};var fZ={configurable:!0,get:function(){return this.class}},yZ=Xp.vnode;Xp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var a=-1===t.indexOf("-");for(var i in r={},n){var o=n[i];hZ&&"children"===i&&"noscript"===t||"value"===i&&"defaultValue"in n&&null==o||("defaultValue"===i&&"value"in n&&null==n.value?i="value":"download"===i&&!0===o?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!dZ(n.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():a&&uZ.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===o&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),r[i]&&(i="oninputCapture")),r[i]=o)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=pm(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=pm(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(fZ.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",fZ))}e.$$typeof=cZ,yZ&&yZ(e)};var vZ=Xp.__r;Xp.__r=function(e){vZ&&vZ(e),e.__c};class bZ extends om{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}bZ.contextType=PK;(class extends JK{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}).contextType=PK;const xZ="object"==typeof HTMLElement?function(e){return e instanceof HTMLElement}:function(e){return e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName};function wZ(e,t){let n=(t=t||document).querySelectorAll(e);return 1===n.length?Array.prototype.slice.call(n)[0]:Array.prototype.slice.call(n)}function TZ(...e){if(!e.length)return;let t="";return e.forEach((e=>{if(e instanceof Object)for(let n in e)e[n]&&(t+=` ${n}`);else t+=` ${e}`})),t}function CZ(e){return e!==document.body&&document.body.contains(e)}function EZ(e){return 0===e.length?e:e.replace(/^\s+|\s+$/gm,"")}function AZ(e){if(xZ(e.current))return e.current;let t=e.current;return t?null==t?void 0:t.base:e.base}let SZ=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),"");const DZ="rgb(0,0,0)";var RZ=(e=>(e.TOP="t",e.BOTTOM="b",e.LEFT="l",e.RIGHT="r",e))(RZ||{});class NZ{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=0|this.x;return e=397*e^(0|this.y),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return NZ.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new NZ(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new NZ(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new NZ(this.x-e.x,this.y-e.y)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new NZ(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new NZ(this.x*e,this.y*t)}divide(e){return new NZ(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new NZ(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new NZ(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new NZ(Math.floor(this.x),Math.floor(this.y))}fract(){return new NZ(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y,a=n*this.x+t*this.y;return this.x=r,this.y=a,this}rotateToRef(e,t){const n=Math.cos(e),r=Math.sin(e);return t.x=n*this.x-r*this.y,t.y=r*this.x+n*this.y,this}rotateByPoint(e,t=NZ.create(0,0)){const n=Math.cos(e),r=Math.sin(e),a=t.x+(this.x-t.x)*n-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*n;return this.x=a,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=-e+Math.atan2(this.y,this.x);return this.x=t*Math.cos(n),this.y=t*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return NZ.NormalizeToRef(this,this),this}clone(){return new NZ(this.x,this.y)}static Zero(){return new NZ(0,0)}static One(){return new NZ(1,1)}static FromArray(e,t=0){return new NZ(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,r,a){let i=a*a,o=a*i,s=.5*(2*t.x+(-e.x+n.x)*a+(2*e.x-5*t.x+4*n.x-r.x)*i+(-e.x+3*t.x-3*n.x+r.x)*o),l=.5*(2*t.y+(-e.y+n.y)*a+(2*e.y-5*t.y+4*n.y-r.y)*i+(-e.y+3*t.y-3*n.y+r.y)*o);return new NZ(s,l)}static Clamp(e,t,n){let r=e.x;r=r>n.x?n.x:r,r=r<t.x?t.x:r;let a=e.y;return a=a>n.y?n.y:a,a=a<t.y?t.y:a,new NZ(r,a)}static Hermite(e,t,n,r,a){let i=a*a,o=a*i,s=2*o-3*i+1,l=-2*o+3*i,c=o-2*i+a,u=o-i,h=e.x*s+n.x*l+t.x*c+r.x*u,d=e.y*s+n.y*l+t.y*c+r.y*u;return new NZ(h,d)}static Hermite1stDerivative(e,t,n,r,a){let i=NZ.Zero();return this.Hermite1stDerivativeToRef(e,t,n,r,a,i),i}static Hermite1stDerivativeToRef(e,t,n,r,a,i){const o=a*a;i.x=6*(o-a)*e.x+(3*o-4*a+1)*t.x+6*(-o+a)*n.x+(3*o-2*a)*r.x,i.y=6*(o-a)*e.y+(3*o-4*a+1)*t.y+6*(-o+a)*n.y+(3*o-2*a)*r.y}static Lerp(e,t,n){let r=e.x+(t.x-e.x)*n,a=e.y+(t.y-e.y)*n;return new NZ(r,a)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=NZ.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();0!==n&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new NZ(n,r)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new NZ(n,r)}static Transform(e,t,n=!1){const r=t,a=e;return n?new NZ(r[0]*a.x+r[2]*a.y,r[1]*a.x+r[3]*a.y):new NZ(r[0]*a.x+r[2]*a.y+r[4],r[1]*a.x+r[3]*a.y+r[5])}static PointInTriangle(e,t,n,r){let a=.5*(-n.y*r.x+t.y*(-n.x+r.x)+t.x*(n.y-r.y)+n.x*r.y),i=a<0?-1:1,o=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,s=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*i;return o>0&&s>0&&o+s<2*a*i}static Distance(e,t){return Math.sqrt(NZ.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,r=e.y-t.y;return n*n+r*r}static Center(e,t){return NZ.CenterToRef(e,t,NZ.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let r=NZ.DistanceSquared(t,n);if(0===r)return NZ.Distance(e,t);let a=n.subtract(t),i=Math.max(0,Math.min(1,NZ.Dot(e.subtract(t),a)/r)),o=t.add(a.multiplyByFloats(i,i));return NZ.Distance(e,o)}static create(e,t){return new NZ(e,t)}}function MZ(e,t,n){let r=0,a=0,i=0,o=0;const{startX:s,startY:l,endX:c,endY:u}=n;t===RZ.TOP?(r=s,a=l,i=c,o=l):t===RZ.BOTTOM?(r=s,a=u,i=c,o=u):t===RZ.LEFT?(r=s,a=l,i=s,o=u):t===RZ.RIGHT&&(r=c,a=l,i=c,o=u),e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),e.stroke()}function OZ(e,t){t===fa.HAIR?e.setLineDash([1,2]):t===fa.DASH_DOT_DOT||t===fa.MEDIUM_DASH_DOT_DOT?e.setLineDash([2,2,5,2,2]):t===fa.DASH_DOT||t===fa.MEDIUM_DASH_DOT||t===fa.SLANT_DASH_DOT?e.setLineDash([2,5,2]):t===fa.DOTTED?e.setLineDash([2]):t===fa.DASHED||t===fa.MEDIUM_DASHED?e.setLineDash([3]):e.setLineDash([0])}function kZ(e){let t=1;return e===fa.MEDIUM||e===fa.MEDIUM_DASH_DOT||e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT_DOT?t=2:e===fa.THICK&&(t=3),t}function IZ(e,t,n,r,a=NZ.create(0,0)){const i=e.add(t).rotateByPoint(r),o=r-n;return i.subtract(t).rotateByPoint(o,i).add(a).transformCoordinateOnRotate(o)}new NZ(0,0),new NZ(1,1);const PZ="rgb(",LZ=(e,t)=>e?t?`${"rgba("+e.join(",")},${t})`:`${PZ+e.join(",")})`:"rgb(0,0,0)";function BZ(e,t){return Math.round(e*t)/t}let FZ;function HZ(e){return e/(72/function(){if(FZ)return FZ;let e=56;for(;e<2e3;e++)if(!0===matchMedia(`(max-resolution: ${e}dpi)`).matches)return e;return FZ=e,setTimeout((()=>{FZ=null}),1e3),e}())}function qZ(e){const{scaleX:t=1,scaleY:n=1}=e;return Math.max(t,n)}class UZ{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return qZ(e)}}const VZ=Ss.create(),WZ=Ss.create(),zZ=Ss.create(),YZ=Ss.create();class GZ extends UZ{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}YZ.add(new class extends GZ{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var r;if(!(null==(r=n.parent)?void 0:r.parent))return;const{ts:a,content:i,fontStyle:o,bBox:s}=n;let{spanPointWithFont:l=NZ.create(0,0)}=this.extensionOffset;if(!a)return void(null!=i&&e.fillText(i,l.x,l.y));if(null==i)return;this._preFontString!==(null==o?void 0:o.fontString)&&(e.font=this._preFontString=(null==o?void 0:o.fontString)||"");const{cl:c,va:u}=a,h=Do(c)||DZ;if(h&&this._preFontColor!==h&&(e.fillStyle=h),u===Oa.SUBSCRIPT||u===Oa.SUPERSCRIPT){this.extensionOffset;let e=s.spo;u===Oa.SUPERSCRIPT&&(e=-s.sbo),l.y+=e}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});YZ.add(new class extends GZ{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{lineHeight:i=0}=a,{ts:o,width:s,content:l}=n;if(!o)return;const{bg:c}=o;if(!c)return;const u=Do(c),{spanStartPoint:h=NZ.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,s+1,i))}clearCache(){this._preBackgroundColor=""}});YZ.add(new class extends GZ{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c,bBox:u}=n;if(!s)return;const{sp:h}=u,d=qZ(t),{ul:p,st:m,ol:_}=s,{originTranslate:g=NZ.create(0,0),centerPoint:f=NZ.create(0,0),alignOffset:y=NZ.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:b=0,vertexAngle:x=0}=v;if(p){const{s:t,cl:n,t:r}=p;if(t===ka.TRUE){e.beginPath();const t=Do(n)||DZ;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=BZ(o+1-.5,d),i=IZ(g.addByPoint(l,a),f,b,x,y),s=IZ(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(s.x,s.y),e.stroke()}}if(m){const{s:t,cl:n,t:r}=m;if(t===ka.TRUE){e.beginPath();const t=Do(n)||DZ;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=BZ(h-.5,d),i=IZ(g.addByPoint(l,a),f,b,x,y),o=IZ(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}if(_){const{s:t,cl:n,t:r}=_;if(t===ka.TRUE){e.beginPath();const t=Do(n)||DZ;e.strokeStyle=t,this._setLineType(e,r||Da.SINGLE);const a=BZ(-1.5,d),i=IZ(g.addByPoint(l,a),f,b,x,y),o=IZ(g.addByPoint(l+c,a),f,b,x,y);e.moveTo(i.x,i.y),e.lineTo(o.x,o.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Da.DASH_DOT_DOT_HEAVY||t===Da.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Da.DASH_DOT_HEAVY||t===Da.DOT_DASH?e.setLineDash([2,5,2]):t===Da.DOTTED||t===Da.DOTTED_HEAVY?e.setLineDash([2]):t===Da.DASH||t===Da.DASHED_HEAVY?e.setLineDash([3]):t===Da.DASH_LONG||t===Da.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Da.WAVY_HEAVY||e===Da.DASHED_HEAVY||e===Da.DOTTED_HEAVY||e===Da.DASH_DOT_HEAVY||e===Da.DASH_LONG_HEAVY||e===Da.DASH_DOT_DOT_HEAVY?t=2:e===Da.THICK&&(t=3),t}});YZ.add(new class extends GZ{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var r;const a=null==(r=n.parent)?void 0:r.parent;if(!a)return;const{asc:i=0,lineHeight:o=0}=a,{ts:s,left:l,width:c}=n;if(!s)return;const{bd:u}=s;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:p=NZ.create(0,0)}=this.extensionOffset;for(let t of d.keys()){const n=d.get(t);if(!n)continue;const{s:r,cl:a}=n,i=Do(a)||DZ;r!==this._preBorderStyle&&(OZ(e,r),e.lineWidth=kZ(r)/h,this._preBorderStyle=r),i!==this._preBorderColor&&(e.strokeStyle=i||DZ,this._preBorderColor=i),MZ(e,t,{startX:p.x,startY:p.y,endX:p.x+c,endY:p.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:r,r:a}=e,i=new Map;return t&&i.set(RZ.TOP,t),n&&i.set(RZ.BOTTOM,n),r&&i.set(RZ.LEFT,r),a&&i.set(RZ.RIGHT,a),i}});class XZ extends UZ{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,r,a){return function(e,t,n,r,a){let{startY:i,endY:o,startX:s,endX:l}=function(e,t,n,r){const a=t-1;return{startY:n[e-1]||0,endY:n[e],startX:r[a]||0,endX:r[t]}}(e,t,n,r);const{isMerged:c,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:p,mergeColumn:m}=function(e,t,n){let r=!1,a=!1,i=-1,o=-1,s=-1,l=-1;return null==n||n.forEach(((n,c)=>{let u=!1;if(null==c||c.forEach(((n,c)=>{const{startRow:h,endRow:d,startColumn:p,endColumn:m}=c;return e===h&&t===p?(i=d,o=m,s=h,l=p,u=!0,a=!0,!1):e>=h&&e<=d&&t>=p&&t<=m?(i=d,o=m,s=h,l=p,u=!0,r=!0,!1):void 0})),u)return!1})),{isMergedMainCell:a,isMerged:r,newEndRow:i,newEndColumn:o,mergeRow:s,mergeColumn:l}}(e,t,a);let _={startRow:p,startColumn:m,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(c&&-1!==p&&-1!==m){let e=n[p-1]||0,t=n[h],a=r[m-1]||0,i=r[d];_={..._,startY:e,endY:t,startX:a,endX:i}}else c||-1===h||-1===d||(o=n[h]||0,l=r[d]||0);return{isMerged:c,isMergedMainCell:u,row:e,column:t,startY:i,endY:o,startX:s,endX:l,mergeInfo:_}}(e,t,n,r,a)}}VZ.add(new class extends XZ{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(e,t,n){const{rowTitleWidth:r,columnTitleHeight:a,dataMergeCache:i,stylesCache:o}=n,{background:s}=o;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:c,columnWidthAccumulation:u,rowTotalHeight:h}=n;if(!l||!u||void 0===c||void 0===h)return;e.save();const{scaleX:d=1,scaleY:p=1}=t;s&&Object.keys(s).forEach((t=>{const n=s[t];e.fillStyle=t||LZ([255,255,255]),e.beginPath(),n.forEach(((t,n)=>{n.forEach((n=>{let{isMerged:r,startY:a,endY:o,startX:s,endX:c}=this.getCellIndex(t,n,l,u,i);if(r)return!0;a=BZ(a,p),o=BZ(o,p),s=BZ(s,d),c=BZ(c,d),e.moveTo(s,a),e.lineTo(s,o),e.lineTo(c,o),e.lineTo(c,a)}))})),e.closePath(),e.fill()})),e.restore()}});VZ.add(new class extends XZ{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,dataMergeCache:o,stylesCache:s,overflowCache:l}=n,{border:c}=s;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const{scaleX:m=1,scaleY:_=1}=t,g=this._getScale(t);let f,y;null==c||c.forEach(((t,n)=>{null==n||n.forEach(((n,r)=>{if(!r)return!0;let{isMerged:a,startY:i,endY:s,startX:c,endX:h}=this.getCellIndex(t,n,u,d,o);if(a)return!0;i=BZ(i,_),s=BZ(s,_),c=BZ(c,m),h=BZ(h,m);for(let a in r){const{type:o,style:u,color:d}=r[a];this._getOverflowExclusion(l,o,t,n)||(u!==f&&(OZ(e,u),e.lineWidth=kZ(u)/g,f=u),d!==y&&(e.strokeStyle=d||DZ,y=d),MZ(e,o,{startX:c,startY:i,endX:h,endY:s}))}}))})),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,r){let a=!1;return t===RZ.TOP||t===RZ.BOTTOM||e&&e.forEach(((e,r)=>{if(e!==n)return!0;r.forEach(((e,n)=>{const{startColumn:r,endColumn:i}=n;return t===RZ.LEFT&&e>r&&e<=i||t===RZ.RIGHT&&e>=r&&e<i?(a=!0,!1):void 0}))})),a}});VZ.add(new class extends XZ{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0,dataMergeCache:o,overflowCache:s,stylesCache:l}=n,{startRow:c,endRow:u,startColumn:h,endColumn:d}=r;if(!n)return;const{rowHeightAccumulation:p,columnTotalWidth:m,columnWidthAccumulation:_,rowTotalHeight:g}=n;if(!p||!_||void 0===m||void 0===g)return;e.save();const f=this._getScale(t);e.beginPath(),e.lineWidth=1/f,e.strokeStyle=LZ([217,217,217]);let y=BZ(m,f),v=BZ(g,f);const b=_.length,x=p.length;for(let t=c-1;t<=u;t++){if(t<0||t>x-1)continue;const n=BZ(p[t],f);e.moveTo(0,n),e.lineTo(y,n)}for(let t=h;t<=d;t++){if(t<0||t>b-1)continue;const n=BZ(_[t],f);e.moveTo(n,0),e.lineTo(n,v)}e.stroke(),e.closePath(),this._clearRectangle(e,f,p,_,o),this._clearRectangle(e,f,p,_,s),e.restore()}_clearRectangle(e,t,n,r,a){null==a||a.forEach(((a,i)=>{null==i||i.forEach(((a,i)=>{const{startRow:o,endRow:s,startColumn:l,endColumn:c}=i,u=BZ(n[o-1]||0,t),h=BZ(n[s],t),d=BZ(r[l-1]||0,t),p=BZ(r[c],t);e.clearRect(d,u,p-d,h-u),e.beginPath(),e.moveTo(d,u),e.lineTo(p,u),e.lineTo(p,h),e.lineTo(d,h),e.lineTo(d,u),e.stroke(),e.closePath()}))}))}});VZ.add(new class extends XZ{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a,columnTitleHeight:i,stylesCache:o,dataMergeCache:s,overflowCache:l}=n,{font:c}=o;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;e.save();const m=this._getScale(t),{scaleX:_=1,scaleY:g=1}=t;c&&Object.keys(c).forEach((t=>{c[t].forEach(((t,n)=>{n.forEach(((n,r)=>{let{isMerged:a,isMergedMainCell:i,startY:o,endY:c,startX:h,endX:p,mergeInfo:f}=this.getCellIndex(t,n,u,d,s);if(a)return!0;o=BZ(o,g),c=BZ(c,g),h=BZ(h,_),p=BZ(p,_);const y=p-h,v=c-o,b=l.getValue(t,n),{horizontalAlign:x}=r;if(e.save(),e.beginPath(),b){const{startColumn:r,startRow:a,endColumn:i,endRow:s}=b;r===i&&r===n?e.rect(h,o,y,v):x===Ra.CENTER?this._clipRectangle(e,a,s,r,i,m,u,d):x===Ra.RIGHT?this._clipRectangle(e,a,t,r,n,m,u,d):this._clipRectangle(e,t,s,n,i,m,u,d)}else e.rect(h,o,y,v);e.clip(),e.translate(h,o),this._renderDocuments(e,r,h,o,p,c,t,n),e.restore()}))}))})),e.restore()}_renderDocuments(e,t,n,r,a,i,o,s){const l=this.getDocuments(),{documentSkeleton:c,angle:u,verticalAlign:h,horizontalAlign:d,wrapStrategy:p,content:m}=t,_=a-n,g=i-r;p===Ma.WRAP&&0===u&&(c.updateDocumentDataPageSize(_),c.calculate()),c.makeDirty(!1),l.resize(_,g),l.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,r,a,i,o,s){const l=BZ(o[t-1]||0,i),c=BZ(o[n],i),u=BZ(s[r-1]||0,i),h=BZ(s[a],i);e.rect(u,l,h-u,c-l)}});WZ.add(new class extends XZ{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=LZ([248,249,250]),e.fillRect(0,0,a,p),e.textAlign="center",e.textBaseline="middle",e.fillStyle=LZ([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=LZ([217,217,217]);let _=0;const g=u.length;for(let t=o-1;t<=s;t++){if(t<0||t>g-1)continue;const n=BZ(u[t],m);if(_===n)continue;e.moveTo(0,n),e.lineTo(a,n);const r=_+(n-_)/2;e.fillText(`${t+1}`,a/2,r+1),_=n}e.moveTo(BZ(a,m),0),e.lineTo(BZ(a,m),p),e.stroke()}});function $Z(e){const t=e.style.cssText;if(null==t||0===t.length)return{};let n=t.split(";"),r={};return n.forEach((n=>{let a=EZ((n=n.toLowerCase()).substr(0,n.indexOf(":"))),i=EZ(n.substr(n.indexOf(":")+1));if("font-weight"===a)r.bl="bold"===i?1:0;else if("font-style"===a)r.it="italic"===i?1:0;else if("font-family"===a)r.ff=i;else if("font-size"===a){let e=parseInt(i);t.indexOf("vertical-align")>-1&&(t.indexOf("sub")>-1||t.indexOf("sup")>-1)&&(e*=2),-1!==i.indexOf("px")&&(e=HZ(parseInt(i))),r.fs=e}else"color"===a?r.cl={rgb:i}:"background"===a||"background-color"===a?r.bg={rgb:i}:"text-decoration-line"===a?"underline"===i?(r.ul||(r.ul={s:1}),r.ul.s=1):"line-through"===i?(r.st||(r.st={s:1}),r.st.s=1):"overline"===i&&(r.ol||(r.ol={s:1}),r.ol.s=1):"text-decoration-color"===a?(r.hasOwnProperty("ul")&&(r.ul||(r.ul={s:1,cl:{rgb:i}}),r.ul.cl={rgb:i}),r.hasOwnProperty("st")&&(r.st||(r.st={s:1,cl:{rgb:i}}),r.st.cl={rgb:i}),r.hasOwnProperty("ol")&&(r.ol||(r.ol={s:1,cl:{rgb:i}}),r.ol.cl={rgb:i})):"text-decoration-style"===a?(r.hasOwnProperty("ul")&&(r.ul||(r.ul={s:1,t:Number(i)}),r.ul.t=Number(i)),r.hasOwnProperty("st")&&(r.st||(r.st={s:1,t:Number(i)}),r.st.t=Number(i)),r.hasOwnProperty("ol")&&(r.ol||(r.ol={s:1,t:Number(i)}),r.ol.t=Number(i))):"text-decoration"!==a&&"univer-strike"!==a||(r.st={s:1});if("univer-underline"===a&&(r.ul={s:1}),"vertical-align"===a&&("sub"===i?r.va=1:"super"===i?r.va=2:"top"===i?r.vt=1:"middle"===i?r.vt=2:"bottom"===i?r.vt=3:r.va=0),"transform"===a){const t=i.split(")"),n=t.findIndex((e=>e.includes("rotate")));if(n>-1){const a=t[n].match(/\d+/g);let i=0,o=0;(null==a?void 0:a.length)&&(i=+a[0]),e.dataset.vertical&&(o=+e.dataset.vertical),r.tr={a:i,v:o}}}"text-align"===a&&(r.ht="left"===i?1:"center"===i?2:"right"===i?3:"justify"===i?4:0),"overflow-wrap"!==a&&"overflowWrap"!==a||"break-word"===i&&(r.tb=3)})),r}function jZ(e){if(""===e)return[e];return e.match(/(?:(\n+.+)|(.+))/g).map((e=>e.replace(/\n/g,"\r\n")))}function KZ(e,t=!1){var n;let r="";const a=new Map([["ff",()=>{e.ff&&(r+=`font-family: ${e.ff}; `)}],["fs",()=>{if(e.fs){let t=e.fs;e.va&&(t/=2),r+=`font-size: ${t}pt; `}}],["it",()=>{e.it?r+="font-style: italic; ":r+="font-style: normal; "}],["bl",()=>{e.bl?r+="font-weight: bold; ":r+="font-weight: normal; "}],["ul",()=>{var t;(null==(t=e.ul)?void 0:t.s)&&(r.indexOf("text-decoration-line")>-1?r=r.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," underline"):r+="text-decoration-line: underline; ",e.ul.cl&&-1===r.indexOf("text-decoration-color")&&(r+=`text-decoration-color: ${Do(e.ul.cl)}; `),e.ul.t&&-1===r.indexOf("text-decoration-style")&&(r+=`text-decoration-style: ${e.ul.t} `))}],["st",()=>{var t;(null==(t=e.st)?void 0:t.s)&&(r.indexOf("text-decoration-line")>-1?r=r.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," line-through"):r+="text-decoration-line: line-through; ",e.st.cl&&-1===r.indexOf("text-decoration-color")&&(r+=`text-decoration-color: ${Do(e.st.cl)}; `),e.st.t&&-1===r.indexOf("text-decoration-style")&&(r+=`text-decoration-style: ${e.st.t} `))}],["ol",()=>{var t;(null==(t=e.ol)?void 0:t.s)&&(r.indexOf("text-decoration-line")>-1?r=r.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," overline"):r+="text-decoration-line: overline; ",e.ol.cl&&-1===r.indexOf("text-decoration-color")&&(r+=`text-decoration-color: ${Do(e.ol.cl)}; `),e.ol.t&&-1===r.indexOf("text-decoration-style")&&(r+=`text-decoration-style: ${e.ol.t} `))}],["bg",()=>{r+=`background: ${Do(e.bg)}; `}],["bd",()=>{var t,n,a,i,o,s,l,c,u,h,d,p;(null==(t=e.bd)?void 0:t.b)&&(r+=`border-bottom: ${ZZ(null==(n=e.bd)?void 0:n.b.s)} ${null!=(a=Do(e.bd.b.cl))?a:""}; `),(null==(i=e.bd)?void 0:i.t)&&(r+=`border-top: ${ZZ(null==(o=e.bd)?void 0:o.t.s)} ${null!=(s=Do(e.bd.t.cl))?s:""}; `),(null==(l=e.bd)?void 0:l.r)&&(r+=`border-right: ${ZZ(null==(c=e.bd)?void 0:c.r.s)} ${null!=(u=Do(e.bd.r.cl))?u:""}; `),(null==(h=e.bd)?void 0:h.l)&&(r+=`border-left: ${ZZ(null==(d=e.bd)?void 0:d.l.s)} ${null!=(p=Do(e.bd.l.cl))?p:""}; `)}],["cl",()=>{r+=`color: ${Do(e.cl)}; `}],["va",()=>{e.va===Oa.NORMAL?r+="vertical-align: baseline; ":e.va===Oa.SUBSCRIPT?r+="vertical-align: sub; ":r+="vertical-align: super; "}],["td",()=>{e.td===Sa.UNSPECIFIED?r+="direction: inherit; ":e.td===Sa.LEFT_TO_RIGHT?r+="direction: ltr; ":r+="direction: rtl; "}],["tr",()=>{var t,n,a;r+=`data-rotate: (${null==(t=e.tr)?void 0:t.a}deg${(null==(n=e.tr)?void 0:n.v)?` ,${null==(a=e.tr)?void 0:a.v}`:""});`}],["ht",()=>{e.ht===Ra.UNSPECIFIED?r+="text-align: inherit; ":e.ht===Ra.LEFT?r+="text-align: left; ":e.ht===Ra.RIGHT?r+="text-align: right; ":e.ht===Ra.CENTER?r+="text-align: center; ":r+="text-align: justify; "}],["vt",()=>{e.vt===Na.UNSPECIFIED?r+="vertical-align: inherit; ":e.vt===Na.BOTTOM?r+="vertical-align: bottom; ":e.vt===Na.TOP?r+="vertical-align: top; ":r+="vertical-align: middle; "}],["tb",()=>{e.tb===Ma.CLIP?r+="text-overflow: clip; ":e.tb===Ma.OVERFLOW?r+="text-break: overflow; ":e.tb===Ma.WRAP&&(r+="word-wrap: break-word; word-break: normal; ")}],["pd",()=>{var t,n,a,i,o,s,l,c;let u=`${null==(t=e.pd)?void 0:t.b}pt`,h=`${null==(n=e.pd)?void 0:n.t}pt`,d=`${null==(a=e.pd)?void 0:a.l}pt`,p=`${null==(i=e.pd)?void 0:i.r}pt`;(null==(o=e.pd)?void 0:o.b)&&(r+=`padding-bottom: ${u}; `),(null==(s=e.pd)?void 0:s.t)&&(r+=`padding-top: ${h}; `),(null==(l=e.pd)?void 0:l.l)&&(r+=`padding-left: ${d}; `),(null==(c=e.pd)?void 0:c.r)&&(r+=`padding-right: ${p}; `)}]]),i=["bd","tr","tb"];for(let r in e)t&&i.includes(r)||null==(n=a.get(r))||n();return r}function ZZ(e){let t="";return e===fa.NONE?t="none":e===fa.THIN?t="0.5pt solid":e===fa.HAIR?t="0.5pt double":e===fa.DOTTED?t="0.5pt dotted":e===fa.DASHED||e===fa.DASH_DOT?t="0.5pt dashed":e===fa.DASH_DOT_DOT?t="0.5pt dotted":e===fa.DOUBLE?t="0.5pt double":e===fa.MEDIUM?t="1pt solid":e===fa.MEDIUM_DASHED||e===fa.MEDIUM_DASH_DOT?t="1pt dashed":e===fa.MEDIUM_DASH_DOT_DOT?t="1pt dotted":e===fa.SLANT_DASH_DOT?t="0.5pt dashed":e===fa.THICK&&(t="1.5pt solid"),t}zZ.add(new class extends XZ{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(e,t,n){const{rowColumnSegment:r,rowTitleWidth:a=0,columnTitleHeight:i=0}=n,{startRow:o,endRow:s,startColumn:l,endColumn:c}=r;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:h,columnWidthAccumulation:d,rowTotalHeight:p}=n;if(!u||!d||void 0===h||void 0===p)return;const m=this._getScale(t);e.fillStyle=LZ([248,249,250]),e.fillRect(0,0,h,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=LZ([0,0,0]),e.beginPath(),e.lineWidth=1/m,e.strokeStyle=LZ([217,217,217]);let _=0;const g=d.length;for(let t=l-1;t<=c;t++){if(t<0||t>g-1)continue;const n=BZ(d[t],m);if(_===n)continue;e.moveTo(n,0),e.lineTo(n,i);const r=_+(n-_)/2;e.fillText(ns(t),r,i/2+1),_=n}const f=BZ(i,m);e.moveTo(0,f),e.lineTo(h,f),e.stroke()}});var QZ={spreadsheetLabel:"插件",spreadsheetRightLabel:"更多 Sheets",spreadsheet:{one:"一",two:"二",three:"三"},toolbar:{undo:"撤销",redo:"重做",paintFormat:"格式刷",currencyFormat:"货币格式",percentageFormat:"百分比格式",numberDecrease:"减少小数位数",numberIncrease:"增加小数位数",moreFormats:"更多格式",font:"字体",fontSize:"字号大小",bold:"粗体 (Ctrl+B)",italic:"斜体 (Ctrl+I)",strikethrough:"删除线 (Alt+Shift+5)",underline:"下划线",textColor:{main:"文本颜色",right:"颜色选择"},resetColor:"重置颜色",customColor:"自定义",alternatingColors:"交替颜色",confirmColor:"确定颜色",cancelColor:"取消",collapse:"收起",fillColor:{main:"单元格颜色",right:"颜色选择"},border:{main:"边框",right:"边框类型"},mergeCell:{main:"合并单元格",right:"选择合并类型"},horizontalAlignMode:{main:"水平对齐",right:"对齐方式"},verticalAlignMode:{main:"垂直对齐",right:"对齐方式"},textWrapMode:{main:"文本换行",right:"换行方式"},textRotateMode:{main:"文本旋转",right:"旋转方式"},freezeTopRow:"冻结首行",sortAndFilter:"排序和筛选",findAndReplace:"查找替换",sum:"求和",autoSum:"自动求和",moreFunction:"更多函数",conditionalalFormat:"条件格式",comment:"批注",pivotTable:"数据透视表",chart:"图表",screenshot:"截图",splitColumn:"分列",insertImage:"插入图片",insertLink:"插入链接",dataValidation:"数据验证",protection:"保护工作表内容",clearText:"清除颜色选择",noColorSelectedText:"没有颜色被选择",toolMore:"更多",toolLess:"少于",toolClose:"收起",toolMoreTip:"更多功能",moreOptions:"更多选项",cellFormat:"设置单元格格式",print:"打印",borderMethod:{top:"上框线",bottom:"下框线",left:"左框线",right:"右框线"},more:"更多"},defaultFmt:{Automatic:{text:"自动",value:"General",example:""},Number:{text:"数字",value:"##0.00",example:"1000.12"},Percent:{text:"百分比",value:"#0.00%",example:"12.21%"},PlainText:{text:"纯文本",value:"@",example:""},Scientific:{text:"科学计数",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"会计",value:"¥(0.00)",example:"¥(1200.09)"},Thousand:{text:"万元",value:"w",example:"1亿2000万2500"},Currency:{text:"货币",value:"¥0.00",example:"¥1200.09"},Digit:{text:"万元2位小数",value:"w0.00",example:"2万2500.55"},Date:{text:"日期",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"时间",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"时间24H",value:"hh:mm",example:"15:00"},DateTime:{text:"日期时间",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"日期时间24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"自定义格式",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"更多货币格式",moreDateTime:"更多日期与时间格式",moreNumber:"更多数字格式",titleCurrency:"货币格式",decimalPlaces:"小数位数",titleDateTime:"日期与时间格式",titleNumber:"数字格式"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"微软雅黑",SimSun:"宋体",SimHei:"黑体",Kaiti:"楷体",FangSong:"仿宋",NSimSun:"新宋体",STXinwei:"华文新魏",STXingkai:"华文行楷",STLiti:"华文隶书",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"常规视图",layoutBtn:"页面布局",pageBtn:"分页预览",menuItemPrint:"打印(Ctrl+P)",menuItemAreas:"打印区域",menuItemRows:"打印标题行",menuItemColumns:"打印标题列"},align:{left:"左对齐",center:"中间对齐",right:"右对齐",top:"顶部对齐",middle:"居中对齐",bottom:"底部对齐"},button:{confirm:"确定",cancel:"取消",close:"关闭",update:"Update",delete:"Delete",insert:"新建",prevPage:"上一页",nextPage:"下一页",total:"总共："},punctuation:{tab:"Tab 键",semicolon:"分号",comma:"逗号",space:"空格"},colorPicker:{collapse:"收起",customColor:"自定义",change:"切换",confirmColor:"确定",cancelColor:"取消"},borderLine:{borderTop:"上框线",borderBottom:"下框线",borderLeft:"左框线",borderRight:"右框线",borderNone:"无",borderAll:"所有",borderOutside:"外侧",borderInside:"内侧",borderHorizontal:"内侧横线",borderVertical:"内侧竖线",borderColor:"边框颜色",borderSize:"边框粗细"},merge:{all:"全部合并",vertical:"垂直合并",horizontal:"水平合并",cancel:"取消合并",overlappingError:"不能合并重叠区域",partiallyError:"无法对部分合并单元格执行此操作"},textWrap:{overflow:"溢出",wrap:"自动换行",clip:"截断"},textRotate:{none:"无旋转",angleUp:"向上倾斜",angleDown:"向下倾斜",vertical:"竖排文字",rotationUp:"向上90°",rotationDown:"向下90°"},sheetConfig:{delete:"删除",copy:"复制",rename:"重命名",changeColor:"更改颜色",hide:"隐藏",unhide:"取消隐藏",moveLeft:"向左移",moveRight:"向右移",resetColor:"重置颜色",cancelText:"取消",chooseText:"确定颜色",tipNameRepeat:"标签页的名称不能重复！请重新修改",noMoreSheet:"工作薄内至少含有一张可视工作表。若需删除选定的工作表，请先插入一张新工作表或显示一张隐藏的工作表。",confirmDelete:"是否删除",redoDelete:"可以通过Ctrl+Z撤销删除",noHide:"不能隐藏, 至少保留一个sheet标签",chartEditNoOpt:"图表编辑模式下不允许该操作！",sheetNameSpecCharError:"名称不能超过31个字符，首尾不能是' 且名称不能包含:\r\n[ ] : \\ ? * /",sheetNameCannotIsEmptyError:"名称不能为空!"},rightClick:{copy:"复制",copyAs:"复制为",paste:"粘贴",insert:"插入",delete:"删除",deleteCell:"删除单元格",deleteSelected:"删除选中",hide:"隐藏",hideSelected:"隐藏选中",showHide:"显示隐藏",to:"向",left:"左",right:"右",top:"上",bottom:"下",moveLeft:"左移",moveUp:"上移",add:"增加",row:"行",column:"列",width:"宽",height:"高",number:"数字",confirm:"确认",orderAZ:"A-Z顺序排列",orderZA:"Z-A降序排列",clearContent:"清除内容",matrix:"矩阵操作选区",sortSelection:"排序选区",filterSelection:"筛选选区",chartGeneration:"图表生成",firstLineTitle:"首行为标题",untitled:"无标题",array1:"一维数组",array2:"二维数组",array3:"多维数组",diagonal:"对角线",antiDiagonal:"反对角线",diagonalOffset:"对角偏移",offset:"偏移量",boolean:"布尔值",flip:"翻转",upAndDown:"上下",leftAndRight:"左右",clockwise:"顺时针",counterclockwise:"逆时针",transpose:"转置",matrixCalculation:"矩阵计算",plus:"加",minus:"减",multiply:"乘",divided:"除",power:"次方",root:"次方根",log:"log",delete0:"删除两端0值",removeDuplicate:"删除重复值",byRow:"按行",byCol:"按列",generateNewMatrix:"生成新矩阵"},info:{detailUpdate:"新打开",detailSave:"已恢复本地缓存",row:"行",column:"列",loading:"渲染中···",copy:"副本",return:"返回",rename:"重命名",tips:"重命名",noName:"无标题的电子表格",wait:"待更新",add:"添加",addLast:"在底部添加",backTop:"回到顶部",pageInfo:"共${total}条，${totalPage}页，当前已显示${currentPage}页",nextPage:"下一页",tipInputNumber:"请输入数字",tipInputNumberLimit:"增加范围限制在1-100",tipRowHeightLimit:"行高必须在0 ~ 545之间",tipColumnWidthLimit:"列宽必须在0 ~ 2038之间",pageInfoFull:"共${total}条，${totalPage}页，已显示全部数据"}},JZ={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"¥(0.00)",example:"¥(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"1亿2000万2500"},Currency:{text:"Currency",value:"¥0.00",example:"¥1200.09"},Digit:{text:"万元2位小数",value:"w0.00",example:"2万2500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Page break preview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:"The name cannot contain:[ ] :  ? * / ' \"",sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",paste:"Paste",insert:"Insert",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}，${totalPage} page，current ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}，${totalPage} page，All data displayed"}};class eQ{constructor(){this.viewKey=""}getScene(){return this._scene}getPlugin(){return this._plugin}getContext(){return this._plugin.getContext()}updateToSheet(e){}_initialize(){}initialize(e,t){return this._scene=e,this._plugin=t,this._initialize(),this}}var tQ=(e=>(e.MAIN_SCENE="mainScene",e.VIEW_MAIN="viewMain",e.VIEW_TOP="viewTop",e.VIEW_LEFT="viewLeft",e.VIEW_LEFT_TOP="viewLeftTop",e.SHEET_VIEW="sheetView",e))(tQ||{});const nQ=Ss.create();class rQ{constructor(e){this._scene=e,this._initialize()}_initialize(){this._scene.onKeyDownObservable.add((e=>{e.code})),this._scene.onKeyUpObservable.add((e=>{}))}handleEnter(){}handleTab(){}handleBackSpace(){}handleShift(){}handleControl(){}handleMeta(){}handleAlt(){}handleArrowUp(){}handleArrowDown(){}handleArrowLeft(){}handleArrowRight(){}}const aQ={container:"universheet",layout:"auto",selections:{"sheet-01":[{selection:{startRow:13,endRow:14,startColumn:1,endColumn:2}},{selection:{startRow:16,endRow:18,startColumn:1,endColumn:2},cell:{row:16,column:1}}],"sheet-02":[{selection:{startRow:17,endRow:20,startColumn:1,endColumn:2}},{selection:{startRow:22,endRow:23,startColumn:1,endColumn:2}},{selection:{startRow:25,endRow:27,startColumn:4,endColumn:6},cell:{row:25,column:4}}]}};var iQ=(e=>(e.SET_SELECTION_VALUE_ACTION="SetSelectionValueAction",e))(iQ||{});class oQ{constructor(){this._data=[]}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new oQ}}const sQ=oQ.create();class lQ{constructor(){this._cellEditExtensionFactoryList=[]}get cellEditExtensionFactoryList(){return this._cellEditExtensionFactoryList}initialize(){this._initExtensions()}add(...e){this._cellEditExtensionFactoryList.push(...e),this._cellEditExtensionFactoryList.sort(is)}delete(e){const t=this._cellEditExtensionFactoryList.indexOf(e);this._cellEditExtensionFactoryList.splice(t,1)}_initExtensions(){this._cellEditExtensionFactoryList.push(...sQ.getData().sort(is))}}class cQ{handle(e){this._cellEditExtensionFactoryList=cQ.register.cellEditExtensionFactoryList;const t=this._checkExtension(e);if(t)return t.execute(),t.getCell()}_checkExtension(e){let t=!1;if(!this._cellEditExtensionFactoryList)return!1;for(let n=0;n<this._cellEditExtensionFactoryList.length;n++){if(t=this._cellEditExtensionFactoryList[n].check(e),!1!==t)break}return t}static create(){return this.register||(this.register=new lQ,this.register.initialize()),this.register}}class uQ{constructor(){this._data=[]}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new uQ}}uQ.create();function hQ(e,t){var n;const r=null==(n=e.getContext().getPluginManager().getPluginByName(ti.SPREADSHEET))?void 0:n.getSelectionManager();if(!r)return[];const a=null==r?void 0:r.getCurrentModelsValue();return r.setModels(t),a}ps.register(iQ.SET_SELECTION_VALUE_ACTION,class extends ta{constructor(e,t,n){super(e,t,n),this._doActionData={...e,convertor:[]};const r=this.do();this._oldActionData={...e,selections:r},this.validate()}do(){const{selections:e}=this._doActionData,t=hQ(this.getWorkSheet(),e);return this._observers.notifyObservers({type:cs.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData,t=this.do();this._oldActionData={actionName:iQ.SET_SELECTION_VALUE_ACTION,sheetId:e,selections:t}}undo(){const{selections:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:iQ.SET_SELECTION_VALUE_ACTION,sheetId:t,selections:hQ(n,e)},this._observers.notifyObservers({type:cs.UNDO,data:this._oldActionData,action:this})}validate(){return!1}});class dQ{constructor(e){this._type=e}isEqual(e,t){const{startColumn:n,startRow:r,endColumn:a,endRow:i,type:o}=this,{startColumn:s,startRow:l,endColumn:c,endRow:u}=e;return o===t&&(n===s&&r===l&&a===c&&i===u)}isInclude(e,t){const{startColumn:n,startRow:r,endColumn:a,endRow:i,type:o}=this,{startColumn:s,startRow:l,endColumn:c,endRow:u}=e;return o===t&&!(c<n||s>a||l>i||u<r)}get startColumn(){return this._startColumn}get startRow(){return this._startRow}get endColumn(){return this._endColumn}get endRow(){return this._endRow}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get type(){return this._type}get currentCell(){return this._currentCell}highlightToSelection(){return Ao(this._currentCell)}getValue(){return{selection:{startColumn:this._startColumn,startRow:this._startRow,endColumn:this._endColumn,endRow:this._endRow,startX:this._startX,startY:this._startY,endX:this._endX,endY:this._endY},cell:this._currentCell}}setValue(e,t){const{startColumn:n,startRow:r,endColumn:a,endRow:i,startX:o,startY:s,endX:l,endY:c}=e;this._startColumn=n,this._startRow=r,this._endColumn=a,this._endRow=i,this._startX=o,this._startY=s,this._endX=l,this._endY=c,this.setCurrentCell(t)}setCurrentCell(e){e&&(this._currentCell=e)}clearCurrentCell(){this._currentCell=null}}class pQ{constructor(e,t,n=.05,r=.05){this._scene=e,this._padding=t,this._smoothRatioX=n,this._smoothRatioY=r,this._offsetX=0,this._offsetY=0,this._moveX=0,this._moveY=0,this._padding||(this._padding={t:20,b:20,l:46,r:20})}startScroll(e,t){this._offsetX=e,this._offsetY=t,this._moveX=e,this._moveY=t,this._viewport=this._getViewportByCoord(this._scene),this._runRenderLoop()}_scroll(e){const t=(null==e?void 0:e.top)||0,n=t+((null==e?void 0:e.height)||0),r=(null==e?void 0:e.left)||0,a=r+((null==e?void 0:e.width)||0),{t:i=0,b:o=0,r:s=0,l=0}=this._padding;let c=0,u=0;this._moveX<r+l&&(c=(this._moveX-r-l)*this._smoothRatioX),this._moveX>a-s&&(c=(this._moveX-a+s)*this._smoothRatioX),this._moveY<t+i&&(u=(this._moveY-t-i)*this._smoothRatioY),this._moveY>n-o&&(u=(this._moveY-n+o)*this._smoothRatioY);if(null==e?void 0:e.scrollBy({x:c,y:u})){const t=this._findAncestorScene(null==e?void 0:e.scene),n=this._getViewportByCoord(t);n&&this._scroll(n)}}scrolling(e,t,n){this._moveX=e,this._moveY=t,this._scrollFunction=n}stopScroll(){var e,t;e=this._requestNewFrameNumber,t||(t=window),t.requestPostAnimationFrame?t.cancelPostAnimationFrame(e):t.requestAnimationFrame?t.cancelAnimationFrame(e):t.msRequestAnimationFrame?t.msCancelAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitCancelAnimationFrame(e):t.mozRequestAnimationFrame?t.mozCancelAnimationFrame(e):t.oRequestAnimationFrame?t.oCancelAnimationFrame(e):window.clearTimeout(e)}_runRenderLoop(){this._scroll(this._viewport),this._scrollFunction&&this._scrollFunction(),this._requestNewFrameNumber=Xl(this._runRenderLoop.bind(this))}_findAncestorScene(e){let t=null==e?void 0:e.getParent();for(;t;){if(t.classType===vl.SCENE)return t;t=(null==t?void 0:t.getParent)&&(null==t?void 0:t.getParent())}}_getViewportByCoord(e){const t=null==e?void 0:e.getViewports();return null==t?void 0:t.find((e=>e.isHit(Ml.FromArray([this._offsetX,this._offsetY]))))}static create(e,t){return new pQ(e,t)}}class mQ{constructor(e){this._range=e}getRange(){return this._range}getRect(){return this._rect}setRect(e){this._rect=e}setRange(e){this._range=e}}class _Q{constructor(e){this._sheetId=e,this._antLineList=[]}deleteAntLineById(e){const t=this._antLineList.findIndex((t=>t.getRange().id===e));t>-1&&this._antLineList.splice(t,1)}addAntLine(e){this._antLineList.push(e)}getSheetId(){return this._sheetId}getAntLineList(){return this._antLineList}getAntLineById(e){const t=this._antLineList.findIndex((t=>t.getRange().id===e));if(t>-1)return this._antLineList[t]}}class gQ{constructor(e){this._name=e}get name(){return this._name}setName(e){this._name=e}}class fQ{get copy(){return this._copy}get copyAs(){return this._copyAs}get paste(){return this._paste}get menuList(){return this._menuList}setValue(e){const{copy:t,copyAs:n,paste:r}=e;this._copy=t,this._copyAs=n,this._paste=r}setRightMenu(e){this._menuList=e}}class yQ{get config(){return this._config}get toolList(){return this._toolList}set config(e){this._config=e}set toolList(e){this._toolList=e}}class vQ{constructor(e){this._control=e,this._startOffsetX=0,this._startOffsetY=0,this._zIndex=e.zIndex+1,this._model=e.model,this._initialize()}_initialize(){this._control.getPlugin().getMainComponent();const{leftControl:e,rightControl:t,topControl:n,bottomControl:r,fillControl:a}=this._control;e.onPointerEnterObserver.add((t=>{e.cursor=_l.MOVE})),e.onPointerLeaveObserver.add((t=>{e.resetCursor()})),t.onPointerEnterObserver.add((e=>{t.cursor=_l.MOVE})),t.onPointerLeaveObserver.add((e=>{t.resetCursor()})),n.onPointerEnterObserver.add((e=>{n.cursor=_l.MOVE})),n.onPointerLeaveObserver.add((e=>{n.resetCursor()})),r.onPointerEnterObserver.add((e=>{r.cursor=_l.MOVE,console.log("onPointerEnterObserver")})),r.onPointerLeaveObserver.add((e=>{r.resetCursor(),console.log("onPointerLeaveObserver")})),r.onPointerDownObserver.add((e=>{console.log("onPointerDownObserver"),this.dragDown(e,wa.BOTTOM)})),r.onPointerUpObserver.add((e=>{r.resetCursor(),console.log("onPointerUpObserver")}));const i=this._zIndex;this._leftDragControl=new Sc("__LeftDragControl__"+i,{top:0,left:-xQ.strokeWidth/2,width:2*xQ.strokeWidth,fill:xQ.strokeColor,zIndex:i}),this._rightDragControl=new Sc("__RightDragControl__"+i,{width:2*xQ.strokeWidth,fill:xQ.strokeColor,zIndex:i}),this._topDragControl=new Sc("__TopDragControl__"+i,{top:-xQ.strokeWidth/2,left:-xQ.strokeWidth/2,height:2*xQ.strokeWidth,fill:xQ.strokeColor,zIndex:i}),this._bottomDragControl=new Sc("__BottomDragControl__"+i,{height:2*xQ.strokeWidth,fill:xQ.strokeColor,left:-xQ.strokeWidth/2,zIndex:i}),this._selectionDragShape=new Tc("__SelectionDragShape__"+i,this._leftDragControl,this._rightDragControl,this._topDragControl,this._bottomDragControl),this._selectionDragShape.evented=!1,this._selectionDragShape.zIndex=i;this._control.getScene().addObject(this._selectionDragShape)}dragEventInitial(){}dragDown(e,t){const n=this._control.getPlugin().getMainComponent(),r=this._model.getValue().selection;this._model=new dQ(wQ.NORMAL),this._model.setValue(r),this._updateControl();const{offsetX:a,offsetY:i}=e;this._startOffsetX=a,this._startOffsetY=i;const o=n.getAncestorScrollXY(this._startOffsetX,this._startOffsetY);let s=null;switch(t){case wa.LEFT:s=n.calculateCellIndexByPosition(a+xQ.strokeWidth,i,o);break;case wa.TOP:s=n.calculateCellIndexByPosition(a,i+xQ.strokeWidth,o);break;case wa.RIGHT:s=n.calculateCellIndexByPosition(a-xQ.strokeWidth,i,o);break;case wa.BOTTOM:s=n.calculateCellIndexByPosition(a,i-xQ.strokeWidth,o)}const l=Ao(s);if(!l)return!1;const{startRow:c,startColumn:u,endColumn:h,endRow:d,startY:p,endY:m,startX:_,endX:g}=l,f={startColumn:u,startRow:c,endColumn:h,endRow:d,startY:p,endY:m,startX:_,endX:g};this._oldSelectionRange=f,this._cellPositionOffset={top:f.startRow-this._model.startRow,bottom:this._model.endRow-f.endRow,left:f.startColumn-this._model.startColumn,right:this._model.endColumn-f.endColumn};const y=this._control.getScene();y.disableEvent();const v=pQ.create(y);v.startScroll(a,i),this._moveObserver=y.onPointerMoveObserver.add((e=>{this.dragMoving(e);const{offsetX:t,offsetY:n}=e;v.scrolling(t,n,(()=>{this.dragMoving(e)}))})),this._upObserver=y.onPointerUpObserver.add((e=>{this.dragUp(),y.onPointerMoveObserver.remove(this._moveObserver),y.onPointerUpObserver.remove(this._upObserver),y.enableEvent(),v.stopScroll()}))}dragMoving(e){const t=this._control.getPlugin().getMainComponent(),{offsetX:n,offsetY:r,clientX:a,clientY:i}=e,o=t.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),s=Ao(t.calculateCellIndexByPosition(n,r,o));if(!s)return!1;const{startRow:l,startColumn:c,endColumn:u,endRow:h,startX:d,startY:p,endX:m,endY:_}=s,g={startColumn:c,startRow:l,endColumn:u,endRow:h,startY:p||0,endY:_||0,startX:d||0,endX:m||0},{startRow:f,endRow:y,startColumn:v,endColumn:b}=this._oldSelectionRange;if(v!==c||f!==l||b!==u||y!==h){this._oldSelectionRange=g;const{left:e,right:n,top:r,bottom:a}=this._cellPositionOffset,i=l-r,o=h+a,s=c-e,d=u+n;if(i<0||o<0||s<0||d<0)return;const p={startRow:i,endRow:o,startColumn:s,endColumn:d},m=t.getNoMergeCellPositionByIndex(p.startRow,p.startColumn),_=t.getNoMergeCellPositionByIndex(p.endRow,p.endColumn),f=Object.assign(p,{startY:(null==m?void 0:m.startY)||0,endY:(null==_?void 0:_.endY)||0,startX:(null==m?void 0:m.startX)||0,endX:(null==_?void 0:_.endX)||0});this._model.setValue(f),this._updateControl()}}dragUp(){const e=this._control.getPlugin().getMainComponent();this.hide();const{selection:t}=this._model.getValue(),n=e.getCellByIndex(t.startRow,t.startColumn);this._control.update(t,n)}_updateControl(){const{startX:e,startY:t,endX:n,endY:r}=this._model;this._leftDragControl.resize(void 0,r-t),this._rightDragControl.transformByState({height:r-t,left:n-e-xQ.strokeWidth/2}),this._topDragControl.resize(n-e+xQ.strokeWidth),this._bottomDragControl.transformByState({width:n-e+xQ.strokeWidth,top:r-t-xQ.strokeWidth/2}),this._selectionDragShape.visible=!0,this._selectionDragShape.translate(e,t),this._selectionDragShape.makeDirty(!0)}hide(){this._selectionDragShape.visible=!1,this._selectionDragShape.makeDirty(!0)}dispose(){this._leftDragControl.dispose(),this._rightDragControl.dispose(),this._topDragControl.dispose(),this._bottomDragControl.dispose(),this._selectionDragShape.dispose()}remove(){const{leftControl:e,rightControl:t,topControl:n,bottomControl:r}=this._control;e.onPointerEnterObserver.clear(),e.onPointerLeaveObserver.clear(),t.onPointerEnterObserver.clear(),t.onPointerLeaveObserver.clear(),n.onPointerEnterObserver.clear(),n.onPointerLeaveObserver.clear(),r.onPointerEnterObserver.clear(),r.onPointerLeaveObserver.clear()}static create(e){return new vQ(e)}}class bQ{constructor(e){this._control=e,this._initialize()}_initialize(){const{fillControl:e}=this._control;this._control.getPlugin(),e.onPointerEnterObserver.add((t=>{e.cursor=_l.CROSSHAIR,console.log(_l.CROSSHAIR,t)})),e.onPointerLeaveObserver.add((t=>{e.resetCursor(),console.log(_l.CROSSHAIR,t)}))}remove(){const{fillControl:e}=this._control;e.onPointerEnterObserver.clear(),e.onPointerLeaveObserver.clear()}static create(e){return new bQ(e)}}const xQ={strokeColor:"rgb(1,136,251)",backgroundColor:"rgba(1,136,251, 0.1)",strokeWidth:2,fillSideLength:6,fillStrokeLength:1,fillStrokeColor:"rgb(255,255,255)"};var wQ=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ROW=1]="ROW",e[e.COLUMN=2]="COLUMN",e))(wQ||{});class TQ{constructor(e,t){this._manager=e,this._zIndex=t,this._selectionModel=new dQ(0),this._initialize()}_initialize(){const e=this._zIndex;this._leftControl=new Sc("__SpreadsheetSelectionShapeLeftControl__"+e,{top:0,left:-xQ.strokeWidth/2,width:xQ.strokeWidth,fill:xQ.strokeColor,zIndex:e}),this._rightControl=new Sc("__SpreadsheetSelectionShapeRightControl__"+e,{width:xQ.strokeWidth,fill:xQ.strokeColor,zIndex:e}),this._topControl=new Sc("__SpreadsheetSelectionTopControl__"+e,{top:-xQ.strokeWidth/2,left:-xQ.strokeWidth/2,height:xQ.strokeWidth,fill:xQ.strokeColor,zIndex:e}),this._bottomControl=new Sc("__SpreadsheetSelectionBottomControl__"+e,{height:xQ.strokeWidth,fill:xQ.strokeColor,left:-xQ.strokeWidth/2,zIndex:e}),this._backgroundControlTop=new Sc("__SpreadsheetSelectionBackgroundControlTop__"+e,{fill:xQ.backgroundColor,zIndex:e-1,evented:!1}),this._backgroundControlBottom=new Sc("__SpreadsheetSelectionBackgroundControlBottom__"+e,{fill:xQ.backgroundColor,zIndex:e-1,evented:!1}),this._backgroundControlMiddleLeft=new Sc("__SpreadsheetSelectionBackgroundControlMiddleLeft__"+e,{fill:xQ.backgroundColor,zIndex:e-1,evented:!1}),this._backgroundControlMiddleRight=new Sc("__SpreadsheetSelectionBackgroundControlMiddleRight__"+e,{fill:xQ.backgroundColor,zIndex:e-1,evented:!1});const t=xQ.fillSideLength-xQ.fillStrokeLength;this._fillControl=new Sc("__SpreadsheetSelectionFillControl__"+e,{width:t,height:t,fill:xQ.strokeColor,strokeWidth:xQ.fillStrokeLength,stroke:xQ.fillStrokeColor,zIndex:e+1}),this._selectionShape=new Tc("__SpreadsheetSelectionShape__"+e,this._fillControl,this._leftControl,this._rightControl,this._topControl,this._bottomControl,this._backgroundControlTop,this._backgroundControlMiddleLeft,this._backgroundControlMiddleRight,this._backgroundControlBottom),this._selectionShape.visible=!1,this._selectionShape.evented=!1,this._selectionShape.zIndex=e,this._selectionDragAndDrop=vQ.create(this),this._selectionControlFill=bQ.create(this);this.getScene().addObject(this._selectionShape)}get zIndex(){return this._zIndex}_updateControl(){const{startX:e,startY:t,endX:n,endY:r}=this._selectionModel;this.leftControl.resize(void 0,r-t),this.rightControl.transformByState({height:r-t,left:n-e-xQ.strokeWidth/2}),this.topControl.resize(n-e+xQ.strokeWidth),this.bottomControl.transformByState({width:n-e+xQ.strokeWidth,top:r-t-xQ.strokeWidth/2}),this.fillControl.translate(n-e-xQ.fillSideLength/2,r-t-xQ.fillSideLength/2),this._updateBackgroundControl(),this._updateDragAndFill(),this.selectionShape.visible=!0,this.selectionShape.translate(e,t),this.selectionShape.makeDirty(!0)}_updateBackgroundControl(){const{startColumn:e,startRow:t,endColumn:n,endRow:r,startX:a,startY:i,endX:o,endY:s}=this._selectionModel,l=this._selectionModel.highlightToSelection();if(!l)return this._backgroundControlTop.resize(o-a,s-i),this._backgroundControlBottom.resize(0,0),this._backgroundControlMiddleLeft.resize(0,0),void this._backgroundControlMiddleRight.resize(0,0);const{startX:c,startY:u,endX:h,endY:d}=l,p=xQ.strokeWidth/2,m={left:-p,top:-p,width:o-a+2*p,height:u-i+p};m.height<0&&(m.width=0,m.height=0),this._backgroundControlTop.transformByState(m);const _={left:-p,top:u-i,width:c-a+p,height:d-u};_.width<0&&(_.width=0,_.height=0),this._backgroundControlMiddleLeft.transformByState(_);const g={left:h-a-p,top:u-i,width:o-h+2*p,height:d-u};g.width<0&&(g.width=0,g.height=0),this._backgroundControlMiddleRight.transformByState(g);const f={left:-p,top:d-i,width:o-a+2*p,height:s-d+p};f.height<0&&(f.width=0,f.height=0),this._backgroundControlBottom.transformByState(f)}_updateDragAndFill(){this._selectionModel.highlightToSelection()||(this._selectionDragAndDrop.remove(),this._fillControl.resize(0,0),this._selectionControlFill.remove())}update(e,t){this._selectionModel.setValue(e,t),this._updateControl()}clearHighlight(){this._selectionModel.clearCurrentCell(),this._updateControl()}dispose(){var e,t,n,r,a,i,o,s,l,c;null==(e=this._leftControl)||e.dispose(),null==(t=this._rightControl)||t.dispose(),null==(n=this._topControl)||n.dispose(),null==(r=this._bottomControl)||r.dispose(),null==(a=this._backgroundControlTop)||a.dispose(),null==(i=this._backgroundControlMiddleLeft)||i.dispose(),null==(o=this._backgroundControlMiddleRight)||o.dispose(),null==(s=this._backgroundControlBottom)||s.dispose(),null==(l=this._fillControl)||l.dispose(),null==(c=this._selectionShape)||c.dispose(),this._selectionDragAndDrop.dispose()}getScene(){return this._manager.getScene()}getPlugin(){return this._manager.getPlugin()}get leftControl(){return this._leftControl}get rightControl(){return this._rightControl}get topControl(){return this._topControl}get bottomControl(){return this._bottomControl}get fillControl(){return this._fillControl}get backgroundControlTop(){return this._backgroundControlTop}get backgroundControlBottom(){return this._backgroundControlBottom}get backgroundControlMiddleLeft(){return this._backgroundControlMiddleLeft}get backgroundControlMiddleRight(){return this._backgroundControlMiddleRight}get selectionShape(){return this._selectionShape}get model(){return this._selectionModel}getCurrentCellInfo(){const e=this.model.currentCell;if(e){let t;if(e.isMerged){const n=e.mergeInfo;t={startRow:n.startRow,endRow:n.endRow,startColumn:n.startColumn,endColumn:n.endColumn,startX:n.startX,endX:n.endX,startY:n.startY,endY:n.endY}}else{const{row:n,column:r,startX:a,endX:i,startY:o,endY:s}=e;t={startRow:n,endRow:n,startColumn:r,endColumn:r,startX:a,endX:i,startY:o,endY:s}}return t}}static create(e,t){return new this(e,t)}static fromJson(e,t,n){const r=TQ.create(e,t);return r.update(n),r}}class CQ{constructor(e){this._sheetView=e,this._selectionControls=[],this._selectionModels=new Map,this._startOffsetX=0,this._startOffsetY=0,this.hasSelection=!1,this._plugin=this._sheetView.getPlugin(),this._initialize(),this._initializeObserver()}getScene(){return this._sheetView.getScene()}getContext(){return this._sheetView.getContext()}getMainComponent(){return this._mainComponent}updateToSheet(e){this._worksheet=e;const t=this.getWorksheetId();if(t){this._selectionModels.get(t)||this._selectionModels.set(t,[])}}getCurrentControls(){return this._selectionControls}getCurrentControl(){const e=this.getCurrentControls();if(e&&e.length>0)for(const t of e){if(t.model.currentCell)return t}}getCurrentModels(){const e=this.getWorksheetId();if(!e)return;return this._selectionModels.get(e)||this._selectionModels.set(e,[]),this._selectionModels.get(e)}getCurrentModel(){const e=this.getCurrentModels();if(e&&e.length>0)for(const t of e){const e=t.currentCell;if(e)return e}}getCurrentModelsValue(){const e=this.getCurrentModels();if(!e)return[];const t=[];for(let n of e)t.push(n.getValue());return t}renderCurrentControls(e){const t=this.getWorksheetId();if(t){if(this._selectionControls)for(let e of this._selectionControls)e.dispose();const n=e||this._selectionModels.get(t);this._selectionControls=[],null==n||n.forEach((e=>{const t=e.currentCell,n=this._mainComponent,r=TQ.create(this,this._selectionControls.length);let a=null;t&&(a=n.getCellByIndex(t.row,t.column));const{startRow:i,startColumn:o,endRow:s,endColumn:l}=e,c=n.getNoMergeCellPositionByIndex(i,o),u=n.getNoMergeCellPositionByIndex(s,l);r.update({startColumn:o,startRow:i,endColumn:l,endRow:s,startY:(null==c?void 0:c.startY)||0,endY:(null==u?void 0:u.endY)||0,startX:(null==c?void 0:c.startX)||0,endX:(null==u?void 0:u.endX)||0},a),this._selectionControls.push(r)})),this.setSelectionModel()}}getPlugin(){return this._plugin}getWorksheetId(){var e;return null==(e=this._worksheet)?void 0:e.getSheetId()}addControlToCurrentByRangeData(e,t){const n=this.getCurrentControls();if(!n)return;const r=this._mainComponent,a=TQ.create(this,n.length);let i=null;t&&(i=r.getCellByIndex(t.row,t.column));const{startRow:o,startColumn:s,endRow:l,endColumn:c}=e,u=r.getNoMergeCellPositionByIndex(o,s),h=r.getNoMergeCellPositionByIndex(l,c);a.update({startColumn:s,startRow:o,endColumn:c,endRow:l,startY:(null==u?void 0:u.startY)||0,endY:(null==h?void 0:h.endY)||0,startX:(null==u?void 0:u.startX)||0,endX:(null==h?void 0:h.endX)||0},i),n.push(a),this.setSelectionModel()}clearSelectionControls(){let e=this.getCurrentControls();if(e.length>0){for(let t of e)t.dispose();e.length=0}}setSelectionModel(e){if(!this._worksheet)return;e||(e=this._selectionControls.map((e=>e.model.getValue())));const t=this._worksheet.getContext().getWorkBook(),n=t.getCommandManager(),r={sheetId:this._worksheet.getSheetId(),actionName:iQ.SET_SELECTION_VALUE_ACTION,selections:e},a=new xs(t,r);n.invoke(a)}updateSelectionModel(e,t,n){const r=this.getWorksheetId();if(!this._worksheet||!r)return;const a=this._selectionModels.get(r),i=[];null==a||a.forEach(((r,a)=>{a===n?i.push({selection:e,cell:t}):i.push(r.getValue())}));const o=this._worksheet.getContext().getWorkBook(),s=o.getCommandManager(),l={sheetId:this._worksheet.getSheetId(),actionName:iQ.SET_SELECTION_VALUE_ACTION,selections:i},c=new xs(o,l);s.invoke(c)}setModels(e){const t=this.getWorksheetId();if(!t)return;const n=e.map((({selection:e,cell:t})=>{const n=new dQ(wQ.NORMAL);return n.setValue(e,t),n}));this._selectionModels.set(t,n)}recreateControlsByRangeData(){}move(e){var t,n;const r=this.getCurrentModel();if(!r)return;let{row:a,column:i}=r;const o=(null==(t=this._worksheet)?void 0:t.getRowCount())||1e3,s=(null==(n=this._worksheet)?void 0:n.getColumnCount())||50;switch(e){case wa.TOP:a--,a<0&&(a=0);break;case wa.BOTTOM:a++,a>o&&(a=o);break;case wa.LEFT:i--,i<0&&(i=0);break;case wa.RIGHT:i++,i>s&&(i=s)}let l={startRow:a,endRow:a,startColumn:i,endColumn:i},c={row:a,column:i};this.clearSelectionControls(),this.addControlToCurrentByRangeData(l,c)}_initialize(){this._mainComponent=this._sheetView.getSpreadsheet(),this._rowComponent=this._sheetView.getSpreadsheetRowTitle(),this._columnComponent=this._sheetView.getSpreadsheetColumnTitle(),this._leftTopComponent=this._sheetView.getSpreadsheetLeftTopPlaceholder(),this._mainEventInitial(),this._rowEventInitial(),this._columnEventInitial(),this._leftTopEventInitial(),this._worksheet=this.getContext().getWorkBook().getActiveSheet(),this._initModels()}_mainEventInitial(){const e=this._mainComponent;e.onPointerDownObserver.add((t=>{var n;const{offsetX:r,offsetY:a}=t;this._startOffsetX=r,this._startOffsetY=a;const i=e.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),o=e.calculateCellIndexByPosition(r,a,i),s=Ao(o);if(!s||!this._worksheet)return!1;const{startRow:l,startColumn:c,endColumn:u,endRow:h,startY:d,endY:p,startX:m,endX:_}=s,g={startColumn:c,startRow:l,endColumn:u,endRow:h,startY:d,endY:p,startX:m,endX:_};this._startSelectionRange=g;let f=this.getCurrentControl(),y=this.getCurrentControls();if(!y)return!1;for(let e of y){if(2===t.button&&e.model.isInclude(g,wQ.NORMAL))return void(f=e);if(e.model.isEqual(g,wQ.NORMAL)){f=e;break}t.shiftKey||e.clearHighlight()}if(y.length>0&&!t.ctrlKey&&!t.shiftKey){for(let e of y)e.dispose();y.length=0}const v=f&&f.model.currentCell;if(f&&t.shiftKey&&v){const{row:t,column:n}=v,r=e.getNoMergeCellPositionByIndex(t,n),a=e.getNoMergeCellPositionByIndex(h,u),i={startColumn:n,startRow:t,endColumn:g.startColumn,endRow:g.startRow,startY:(null==r?void 0:r.startY)||0,endY:(null==a?void 0:a.endY)||0,startX:(null==r?void 0:r.startX)||0,endX:(null==a?void 0:a.endX)||0};f.update(i,v)}else f=TQ.create(this,y.length),f.update(g,o),y.push(f);this.hasSelection=!0;const b=this.getScene();b.disableEvent();const x=pQ.create(this.getScene());x.startScroll(r,a),null==(n=this._plugin.getObserver("onChangeSelectionObserver"))||n.notifyObservers(f),this._moveObserver=b.onPointerMoveObserver.add((e=>{this.moving(e,f);const{offsetX:t,offsetY:n}=e;x.scrolling(t,n,(()=>{this.moving(e,f)}))})),this._upObserver=b.onPointerUpObserver.add((e=>{this.up(),b.onPointerMoveObserver.remove(this._moveObserver),b.onPointerUpObserver.remove(this._upObserver),b.enableEvent(),x.stopScroll()}))}))}moving(e,t){var n;const r=this._mainComponent,{offsetX:a,offsetY:i,clientX:o,clientY:s}=e,{startRow:l,startColumn:c,endRow:u,endColumn:h}=this._startSelectionRange,d=r.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),p=Ao(r.calculateCellIndexByPosition(a,i,d));if(!p)return!1;const{startRow:m,startColumn:_,endColumn:g,endRow:f}=p,y=Math.min(m,l),v=Math.min(_,c),b=Math.max(f,u),x=Math.max(g,h),w=r.getSelectionBounding(y,v,b,x);if(!w)return!1;const{startRow:T,startColumn:C,endRow:E,endColumn:A}=w,S=r.getNoMergeCellPositionByIndex(T,C),D=r.getNoMergeCellPositionByIndex(E,A),R={startColumn:C,startRow:T,endColumn:A,endRow:E,startY:(null==S?void 0:S.startY)||0,endY:(null==D?void 0:D.endY)||0,startX:(null==S?void 0:S.startX)||0,endX:(null==D?void 0:D.endX)||0},{startRow:N,endRow:M,startColumn:O,endColumn:k}=(null==t?void 0:t.model)||{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1};O===C&&N===T&&k===A&&M===E||(t&&t.update(R),t&&(null==(n=this._plugin.getObserver("onChangeSelectionObserver"))||n.notifyObservers(t)))}up(){this.setSelectionModel()}_rowEventInitial(){this._rowComponent.onPointerDownObserver.add((e=>{console.log("rowTitle_moveObserver",e)}))}_columnEventInitial(){this._columnComponent.onPointerDownObserver.add((e=>{console.log("columnTitle_moveObserver",e)}))}_leftTopEventInitial(){this._leftTopComponent.onPointerDownObserver.add((e=>{console.log("leftTop_moveObserver",e)}))}_initModels(){const e=this._plugin.config.selections;Object.keys(e).forEach((t=>{const n=e[t],r=[];n.forEach((e=>{const{startColumn:t,startRow:n,endColumn:a,endRow:i}=e.selection,o=e.cell,s=new dQ(wQ.NORMAL),l=o?{row:o.row,column:o.column,isMerged:!1,isMergedMainCell:!1,startY:0,endY:0,startX:0,endX:0,mergeInfo:{startColumn:t,startRow:n,endColumn:a,endRow:i,startY:0,endY:0,startX:0,endX:0}}:null;s.setValue({startColumn:t,startRow:n,endColumn:a,endRow:i,startY:0,endY:0,startX:0,endX:0},l),r.push(s)})),this._selectionModels.set(t,r)}))}_initControls(){const e=this._plugin.config.selections;Object.keys(e).forEach((t=>{const n=e[t],r=[];n.forEach((e=>{const t=e.selection,n=e.cell,a=this._mainComponent,i=TQ.create(this,r.length);let o=null;n&&(o=a.getCellByIndex(n.row,n.column));const{startRow:s,startColumn:l,endRow:c,endColumn:u}=t,h=a.getNoMergeCellPositionByIndex(s,l),d=a.getNoMergeCellPositionByIndex(c,u);i.model.setValue({startColumn:l,startRow:s,endColumn:u,endRow:c,startY:(null==h?void 0:h.startY)||0,endY:(null==d?void 0:d.endY)||0,startX:(null==h?void 0:h.startX)||0,endX:(null==d?void 0:d.endX)||0},o),r.push(i)}))}))}_initializeObserver(){var e;this._plugin.getContext().getContextObserver("onAfterChangeActiveSheetObservable").add((()=>{this.renderCurrentControls()})),null==(e=this._worksheet)||e.getContext().getContextObserver("onSheetRenderDidMountObservable").add((()=>{console.log("onSheetRenderDidMountObservable===id==",this.getContext().getWorkBook().getUnitId()),this.renderCurrentControls()}))}getActiveRangeListData(){const e=this.getCurrentModels();if(e&&e.length>0){return null==e?void 0:e.map((e=>({startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn})))}}getActiveRangeList(){var e;const t=this.getActiveRangeListData();return t&&(null==(e=this._worksheet)?void 0:e.getRangeList(t))}getActiveRangeData(){const e=this.getCurrentModels();if(e&&e.length>0)for(const t of e)if(t.currentCell)return{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn}}getActiveRange(){var e;const t=this.getActiveRangeData();return t&&(null==(e=this._worksheet)?void 0:e.getRange(t))}getCurrentCellData(){const e=this.getCurrentModels();if(e&&e.length>0)for(const t of e){const e=t.currentCell;if(e)return{startRow:e.row,startColumn:e.column,endRow:e.row,endColumn:e.column}}}getCurrentCell(){var e;const t=this.getCurrentCellData();return t&&(null==(e=this._worksheet)?void 0:e.getRange(t))}}nQ.add(new class extends eQ{constructor(){super(...arguments),this.viewKey=tQ.SHEET_VIEW}_initialize(){const e=this.getScene(),t=this.getContext().getWorkBook();let n=t.getActiveSheet();n||(n=t.getSheets()[0]);const r=this._buildSkeleton(n),{rowTotalHeight:a,columnTotalWidth:i,rowTitleWidth:o,columnTitleHeight:s}=r,l=new Wu("__SpreadsheetRender__",r),c=new zu("__SpreadsheetRowTitle__",r),u=new Yu("__SpreadsheetColumnTitle__",r),h=new Sc("__SpreadsheetLeftTopPlaceholder__",{zIndex:2,left:-1,top:-1,width:o,height:s,fill:Yl([248,249,250]),stroke:Yl([217,217,217]),strokeWidth:1});this._spreadsheetSkeleton=r,this._spreadsheet=l,this._spreadsheetRowTitle=c,this._spreadsheetColumnTitle=u,this._spreadsheetLeftTopPlaceholder=h,e.addObjects([l],0),e.addObjects([c,u,h],2),e.transformByState({width:this._columnWidthByTitle(n)+i+100,height:this._rowHeightByTitle(n)+a+200}),this._updateViewport(o,s),this._selectionManager=new CQ(this),new rQ(e)}getSelectionManager(){return this._selectionManager}getSelectionControls(){return this._selectionManager.getCurrentControls()}getSpreadsheetSkeleton(){return this._spreadsheetSkeleton}getSpreadsheet(){return this._spreadsheet}getSpreadsheetRowTitle(){return this._spreadsheetRowTitle}getSpreadsheetColumnTitle(){return this._spreadsheetColumnTitle}getSpreadsheetLeftTopPlaceholder(){return this._spreadsheetLeftTopPlaceholder}updateToSheet(e){const t=this.getScene(),n=this._buildSkeleton(e),{rowTotalHeight:r,columnTotalWidth:a,rowTitleWidth:i,columnTitleHeight:o}=n;this._spreadsheetSkeleton=n,this._spreadsheet.updateSkeleton(n),this._spreadsheetRowTitle.updateSkeleton(n),this._spreadsheetColumnTitle.updateSkeleton(n),this._spreadsheetLeftTopPlaceholder.transformByState({width:i,height:o}),t.transformByState({width:this._columnWidthByTitle(e)+a+100,height:this._rowHeightByTitle(e)+r+200}),this._updateViewport(i,o),this._selectionManager.updateToSheet(e)}_updateViewport(e,t){const n=this.getScene(),r=e*n.scaleX,a=t*n.scaleY,i=n.getViewport(tQ.VIEW_MAIN),o=n.getViewport(tQ.VIEW_TOP),s=n.getViewport(tQ.VIEW_LEFT),l=n.getViewport(tQ.VIEW_LEFT_TOP);null==i||i.resize({left:r,top:a}),null==o||o.resize({left:r,height:a}),null==s||s.resize({top:a,width:r}),null==l||l.resize({width:r,height:a})}_buildSkeleton(e){const t=this.getContext(),n=t.getWorkBook(),r=e.getConfig();return Gu.create(r,e.getCellMatrix(),n.getStyles(),t)}_rowHeightByTitle(e){const t=null==e?void 0:e.getConfig();return(null==t?void 0:t.columnTitle.height)||0}_columnWidthByTitle(e){const t=null==e?void 0:e.getConfig();return(null==t?void 0:t.rowTitle.width)||0}});nQ.add(new class extends eQ{_initialize(){const e=this.getScene(),t=new Sc("green",{top:100,left:100,width:250,height:180,radius:10,angle:45,fill:Yl([10,128,99],.8),zIndex:11});t.on(dl.PointerEnter,(()=>{console.log("EVENT_TYPE.POINTERENTER_111"),t.setProps({fill:Yl([10,128,199],.8)})})),t.on(dl.PointerLeave,(()=>{console.log("EVENT_TYPE.POINTERLEAVE_222"),t.setProps({fill:Yl([10,128,99],.8)})}));const n=new Sc("blue",{top:150,left:500,width:350,height:280,radius:10,fill:"rgba(10,11,99, 0.8)",zIndex:12});n.on(dl.PointerEnter,(()=>{n.setProps({fill:Yl([102,111,99],.8)})})),n.on(dl.PointerLeave,(()=>{n.setProps({fill:Yl([10,11,99],.8)})}));const r=new Sc("purple",{top:0,left:37.5,width:250,height:220,radius:10,strokeWidth:20,stroke:Yl([102,111,99],.8),fill:Yl([100,11,99],.8),zIndex:13});r.on(dl.PointerEnter,(()=>{r.setProps({fill:Yl([120,11,19],.8)})})),r.on(dl.PointerLeave,(()=>{r.setProps({fill:Yl([100,11,99],.8)})})),e.addObjects([t,n,r])}});nQ.add(new class extends eQ{_initialize(){const e=this.getScene(),t=new xc("sceneViewer1",{left:200,top:200,width:150,height:150,zIndex:10}),n=new bc("testSceneViewer",t,{width:800,height:800}),r=new wc("sceneViewerMain",n,{left:30,top:30,bottom:0,right:0,isWheelPreventDefaultX:!0});n.addViewport(r).attachControl(),new Rc(r,{mainScene:e}),n.on(dl.wheel,((e,t)=>{}));const a=new Sc("purple1",{top:37.5,left:37.5,width:250,height:220,radius:10,strokeWidth:20,stroke:"rgba(102,111,99, 0.8)",fill:"rgba(100,110,99, 0.8)",zIndex:3});a.on(dl.PointerEnter,(()=>{console.log("PointerEnter11112312313123132"),a.setProps({fill:"rgba(220,11,19, 0.8)"}),a.makeDirty(!0)})),a.on(dl.PointerLeave,(()=>{console.log("PointerLeave11112312313123132"),a.setProps({fill:"rgba(100,110,99, 0.8)"}),a.makeDirty(!0)})),n.addLayer(new fc(n,[a])),e.addObject(t)}});const EQ={documentId:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:100,height:400},positionH:{relativeFrom:Gs.COLUMN,posOffset:100},positionV:{relativeFrom:Xs.PARAGRAPH,posOffset:160},angle:0,imageProperties:{contentUrl:"https://cnbabylon.com/assets/img/agents.png"}},layoutType:Vs.WRAP_SQUARE,behindDoc:ka.FALSE,wrapText:Us.BOTH_SIDES}},lists:{unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:Is.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"●",hanging:21,indentStart:21},{bulletAlignment:Is.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"■",hanging:21,indentStart:42},{bulletAlignment:Is.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"◆",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:Is.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:ks.ROMAN,hanging:21,indentStart:21},{bulletAlignment:Is.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:ks.ROMAN,hanging:21,indentStart:42},{bulletAlignment:Is.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:ks.ROMAN,hanging:21,indentStart:63}]}},body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:Ps.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:qs.TEXT_RUN,tr:{ct:"在“第1题”工作表中完成以下操作",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},smallSub:{eId:"smallSub",st:0,ed:15,et:qs.TEXT_RUN,tr:{ct:"上标",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:Oa.SUPERSCRIPT}}},twoElement:{eId:"twoElement",st:0,ed:15,et:qs.TEXT_RUN,tr:{ct:"日期列单元格数据验证，限制只能输入日期（介于1949年1月1日至2099年1月1日）",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:qs.TEXT_RUN},{elementId:"shapeTest1",paragraphElementType:qs.DRAWING},{elementId:"smallSub",paragraphElementType:qs.TEXT_RUN},{elementId:"twoElement",paragraphElementType:qs.TEXT_RUN}]}},twoParagraph:{blockId:"twoParagraph",st:0,ed:15,blockType:Ps.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:qs.TEXT_RUN,tr:{ct:"细化埋点上报链路和指标方案梳理"}},twoElement:{eId:"twoElement",st:0,ed:15,et:qs.TEXT_RUN,tr:{ct:"目前通过每日定时任务发送报告"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:qs.TEXT_RUN},{elementId:"twoElement",paragraphElementType:qs.TEXT_RUN}]}},threeParagraph:{blockId:"threeParagraph",st:0,ed:15,blockType:Ps.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:qs.TEXT_RUN,tr:{ct:"自2018年首届进博会举办以来，进博会已经成为全球新品的首发地、前沿技术的首选地、创新服务的首推地。"}},twoElement:{eId:"twoElement",st:0,ed:15,et:qs.TEXT_RUN,tr:{ct:"中国这十年”对外开放成就展湖北展区主要以图文、图表、数据、视频、企业展品、实物模型、光电科技等体现湖北十年开放成就、重大开放平台及产业。湖北省共计17家企业、机构的展品将在这一展区展示"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:qs.TEXT_RUN},{elementId:"twoElement",paragraphElementType:qs.TEXT_RUN}]}},fourParagraph:{blockId:"fourParagraph",st:0,ed:15,blockType:Ps.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:qs.TEXT_RUN,tr:{ct:"国家主席习近平以视频方式出席在上海举行的第五届中国国际进口博览会开幕式并发表题为《共创开放繁荣的美好未来》的致辞"}},twoElement:{eId:"twoElement",st:0,ed:15,et:qs.TEXT_RUN,tr:{ct:"中国将推动各国各方共享深化国际合作机遇，全面深入参与世界贸易组织改革谈判"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:qs.TEXT_RUN},{elementId:"twoElement",paragraphElementType:qs.TEXT_RUN}]}},fiveParagraph:{blockId:"fiveParagraph",st:0,ed:15,blockType:Ps.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:2,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:qs.TEXT_RUN,tr:{ct:"中国男排两名现役国手彭世坤和张秉龙分别效力的三得利太阳鸟和东京大熊本轮遭遇。"}},twoElement:{eId:"twoElement",st:0,ed:15,et:qs.TEXT_RUN,tr:{ct:"双方经过激战，主场作战的卫冕冠军三得利技高一筹3-2逆转击败对手，力夺第3场胜利"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:qs.TEXT_RUN},{elementId:"twoElement",paragraphElementType:qs.TEXT_RUN}]}}},blockElementOrder:["oneParagraph","twoParagraph","threeParagraph","fourParagraph","fiveParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}};nQ.add(new class extends eQ{_initialize(){const e=this.getScene(),t=new Oc("path1",{data:"M848.2028 624.638c61.7667 0 111.9928-50.2538 111.9928-111.9928 0-61.7667-50.2262-111.9949-111.9928-111.9949h-19.414016c-3.9373-11.1831-8.448-22.1194-13.4779-32.7014l13.6704-13.698c21.0811-21.0801 32.7025-49.2165 32.7025-79.1828 0-29.995-11.6214-58.1028-32.7025-79.1839-21.0801-21.1098-49.2165-32.7035-79.1839-32.7035-29.9704 0-58.1048 11.5937-79.1818 32.7035l-13.6704 13.6714c-10.6107-5.033-21.5214-9.5437-32.7311-13.481v-19.412992c0-61.7656-50.2292-111.9939-111.9949-111.9939-61.7636 0-111.9928 50.2282-111.9928 111.9939v19.412992c-11.2118 3.9373-22.1225 8.448-32.7322 13.481l-13.6714-13.6714c-21.077-21.1098-49.2124-32.7035-79.1828-32.7035-29.9663 0-58.0987 11.5937-79.1839 32.7035-21.076 21.0801-32.7014 49.1889-32.7014 79.1839 0 29.9674 11.6255 58.1028 32.7014 79.1828l13.6714 13.6704c-5.0289 10.6097-9.5406 21.5194-13.4779 32.7291h-19.414016c-61.7636 0-111.9928 50.2282-111.9928 111.9949 0 61.739 50.2292 111.9928 111.9928 111.9928h19.414016c3.9373 11.2118 8.449 22.1215 13.4779 32.7291l-13.6714 13.6714c-21.076 21.0811-32.7014 49.1909-32.7014 79.1849 0 29.996 11.6255 58.1028 32.7014 79.1828 21.0852 21.078 49.2175 32.7035 79.1839 32.7035 29.9715 0 58.1059-11.6255 79.1828-32.7035l13.6714-13.6704c10.6097 5.0309 21.5204 9.5119 32.7322 13.4789v19.416064c0 61.7359 50.2292 111.9928 111.9928 111.9928 61.7656 0 111.9949-50.2569 111.9949-111.9928v-19.416064c11.2097-3.967 22.1204-8.448 32.7311-13.5045l13.6704 13.695c21.077 21.078 49.2124 32.7035 79.1818 32.7035 29.9674 0 58.1038-11.6255 79.1839-32.7035 21.0811-21.0801 32.7025-49.1868 32.7025-79.1828 0-29.994-11.6214-58.1038-32.7025-79.1849l-13.6704-13.698c5.0299-10.6076 9.5406-21.5194 13.4779-32.7025H848.202752zM789.3873 710.6294c10.5277 10.5001 16.297 24.5555 16.297 39.594 0 15.0108-5.7692 29.0673-16.297 39.5909-21.0504 21.0278-58.1294 21.0278-79.1808 0l-43.1186-43.1452-18.4842 10.3629c-18.647 10.4172-38.826 18.7556-60.0177 24.7695l-20.3694 5.7723v61.057024c0 30.8675-25.1279 55.9933-55.9985 55.9933s-55.9985-25.1259-55.9985-55.9933v-61.057024l-20.3674-5.7723c-21.2183-6.0416-41.4259-14.3534-60.0156-24.7695l-18.4852-10.3363-43.1206 43.1176c-21.0534 21.0278-58.1294 21.0278-79.1828 0-10.5267-10.5236-16.2939-24.5801-16.2939-39.5909 0-15.0385 5.7672-29.0939 16.2939-39.594l43.1176-43.1165-10.3588-18.4852c-10.3916-18.5907-18.7054-38.7697-24.746-60.0412l-5.7733-20.3448h-61.053951999999995c-30.8695 0-55.9954-25.1279-55.9954-55.9964 0-30.8705 25.1249-55.9985 55.9954-55.9985h61.053951999999995l5.7733-20.3704c6.0406-21.2449 14.3544-41.4505 24.746-60.0156l10.3588-18.4832-43.1176-43.1186c-10.5267-10.5277-16.2939-24.5811-16.2939-39.5919 0-15.0395 5.7672-29.0939 16.2939-39.5919 21.0545-21.0278 58.1304-21.0278 79.1828 0l43.1206 43.1176 18.4852-10.3608c18.5897-10.3905 38.7983-18.731 60.0156-24.746l20.3674-5.7702v-61.056000000000004c0-30.8951 25.1279-55.9964 55.9985-55.9964s55.9985 25.1013 55.9985 55.9964v61.056000000000004l20.3694 5.7702c21.1917 6.016 41.3706 14.3278 60.0177 24.7716l18.4842 10.3352 43.1186-43.1176c21.0524-21.0278 58.1315-21.0278 79.1808 0 10.5277 10.498 16.297 24.5524 16.297 39.5919 0 15.0108-5.7692 29.0642-16.297 39.5919l-43.0909 43.1186 10.3076 18.4832c10.4479 18.6737 18.7832 38.8813 24.7706 60.0156l5.7733 20.3704h61.053951999999995c30.8695 0 55.9974 25.1279 55.9974 55.9985 0 30.8685-25.1279 55.9964-55.9974 55.9964h-61.053951999999995l-5.7733 20.3448c-5.9884 21.161-14.3227 41.342-24.7706 60.0412l-10.3076 18.4852L789.3873 710.6294zM512.2181 344.6528c-92.6372 0-167.9913 75.3551-167.9913 167.9923 0 92.6351 75.3541 167.9913 167.9913 167.9913s167.9913-75.3562 167.9913-167.9913C680.2094 420.0079 604.8553 344.6528 512.2181 344.6528zM512.2181 624.638c-61.7636 0-111.9928-50.2538-111.9928-111.9928 0-61.7667 50.2292-111.9949 111.9928-111.9949 61.7656 0 111.9949 50.2282 111.9949 111.9949C624.213 574.3841 573.9848 624.638 512.2181 624.638z",width:200,height:200,left:600,top:300,zIndex:14,strokeWidth:1,stroke:Yl([102,111,99],1),fill:Yl([102,255,99],1)}),n=t.getRect();new Sc("pathRect",{...n,strokeWidth:1,stroke:"rgba(102,111,99, 0.8)",zIndex:11});const r=new Nc({url:"https://cnbabylon.com/assets/img/agents.png",top:500,left:800,zIndex:13}),a=new Ic("circle1",{left:800,top:200,radius:100,fill:"rgba(255,111,99, 0.8)",zIndex:14}),i=new $u(this.getContext(),"richText1",{richText:EQ,width:300,zIndex:20,left:100,top:400});console.log("insert path test",e),e.addObjects([t,r,a,i])}});class AQ{constructor(e,t){this._engine=e,this._plugin=t,this._views=[],this._initialize()}_initialize(){const e=this._engine,t=this._plugin.getContext(),n=t.getWorkBook();let r=n.getActiveSheet();r||(r=n.getSheets()[0]);const a=r.getConfig(),i=a.rowTitle,o=a.columnTitle,s=new bc(tQ.MAIN_SCENE,e,{width:1200,height:1e3});this._scene=s;const l=new wc(tQ.VIEW_MAIN,s,{left:i.width,top:o.height,bottom:0,right:0,isWheelPreventDefaultX:!0}),c=new wc(tQ.VIEW_TOP,s,{left:i.width,top:0,height:o.height,right:0,isWheelPreventDefaultX:!0}),u=new wc(tQ.VIEW_LEFT,s,{left:0,top:o.height,bottom:0,width:i.width,isWheelPreventDefaultX:!0}),h=new wc(tQ.VIEW_LEFT_TOP,s,{left:0,top:0,width:i.width,height:o.height,isWheelPreventDefaultX:!0});l.onScrollAfterObserver.add((e=>{const{scrollX:t,scrollY:n,actualScrollX:r,actualScrollY:a}=e;c.updateScroll({scrollX:t,actualScrollX:r}).makeDirty(!0),u.updateScroll({scrollY:n,actualScrollY:a}).makeDirty(!0)})),t.getContextObserver("onZoomRatioSheetObservable").add((e=>{const t=this._plugin;this._scene.scale(e.zoomRatio,e.zoomRatio),t.getCanvasView().updateToSheet(this._plugin.getContext().getWorkBook().getActiveSheet())})),s.addViewport(l,u,c,h).attachControl(),s.on(dl.wheel,((e,n)=>{const r=e;if(r.ctrlKey){const e=Math.abs(r.deltaX);let n=e<40?.2:e<80?.4:.2;if(n*=r.deltaY>0?-1:1,s.scaleX<1&&(n/=2),s.scaleX+n>4)s.scale(4,4);else if(s.scaleX+n<.1)s.scale(.1,.1);else{const e=t.getWorkBook().getActiveSheet(),n=r.deltaY>0?.1:-.1;e.setZoomRatio(e.getZoomRatio()+n),r.preventDefault()}}else l.onMouseWheel(r,n)})),new Rc(l),s.addLayer(fc.create(s,[],0),fc.create(s,[],2)),this._viewLoader(s,this._plugin),e.runRenderLoop((()=>{s.render();const t=document.getElementById("app");t&&(t.innerText=`fps:${Math.round(e.getFps()).toString()}`)}))}getView(e){for(let t of this._views)if(t.viewKey===e)return t}getSheetView(){return this.getView(tQ.SHEET_VIEW)}updateToSheet(e){for(let t of this._views)t.updateToSheet(e)}_viewLoader(e,t){nQ.getData().forEach((n=>{this._views.push(n.initialize(e,t))}))}}function SQ(){return SQ=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},SQ.apply(this,arguments)}function DQ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={mimeType:t.mimeType||null,onBeforeSend:t.onBeforeSend||Function.prototype,onSuccess:t.onSuccess||Function.prototype,onError:t.onError||Function.prototype,onComplete:t.onComplete||Function.prototype},r=Array.isArray(e)?e:[e],a=Array.apply(null,Array(r.length)).map((function(e){return null}));function i(e){var t="string"==typeof e,n=t&&"<"===e.trim().charAt(0);return t&&!n}function o(e,t){n.onError(e,r[t],t)}function s(e,t){var i=n.onSuccess(e,r[t],t);e=!1===i?"":i||e,a[t]=e,-1===a.indexOf(null)&&n.onComplete(a)}var l=document.createElement("a");r.forEach((function(e,t){if(l.setAttribute("href",e),l.href=String(l.href),Boolean(document.all&&!window.atob)&&l.host.split(":")[0]!==location.host.split(":")[0]){if(l.protocol===location.protocol){var r=new XDomainRequest;r.open("GET",e),r.timeout=0,r.onprogress=Function.prototype,r.ontimeout=Function.prototype,r.onload=function(){var e=r.responseText;i(e)?s(e,t):o(r,t)},r.onerror=function(e){o(r,t)},setTimeout((function(){r.send()}),0)}else console.warn("Internet Explorer 9 Cross-Origin (CORS) requests must use the same protocol (".concat(e,")")),o(null,t)}else{var a=new XMLHttpRequest;a.open("GET",e),n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),n.onBeforeSend(a,e,t),a.onreadystatechange=function(){if(4===a.readyState){var e=a.responseText;a.status<400&&i(e)||0===a.status&&i(e)?s(e,t):o(a,t)}},a.send()}}))}function RQ(e){var t=/\/\*[\s\S]+?\*\//g,n=/(?:@import\s*)(?:url\(\s*)?(?:['"])([^'"]*)(?:['"])(?:\s*\))?(?:[^;]*;)/g,r={rootElement:e.rootElement||document,include:e.include||'style,link[rel="stylesheet"]',exclude:e.exclude||null,filter:e.filter||null,skipDisabled:!1!==e.skipDisabled,useCSSOM:e.useCSSOM||!1,onBeforeSend:e.onBeforeSend||Function.prototype,onSuccess:e.onSuccess||Function.prototype,onError:e.onError||Function.prototype,onComplete:e.onComplete||Function.prototype},a=Array.apply(null,r.rootElement.querySelectorAll(r.include)).filter((function(e){return t=e,n=r.exclude,!(t.matches||t.matchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector).call(t,n);var t,n})),i=Array.apply(null,Array(a.length)).map((function(e){return null}));function o(){if(-1===i.indexOf(null)){i.reduce((function(e,t,n){return""===t&&e.push(n),e}),[]).reverse().forEach((function(e){return[a,i].forEach((function(t){return t.splice(e,1)}))}));var e=i.join("");r.onComplete(e,i,a)}}function s(e,t,n,a){var s=r.onSuccess(e,n,a);c(e=void 0!==s&&!1===Boolean(s)?"":s||e,n,a,(function(e,a){null===i[t]&&(a.forEach((function(e){return r.onError(e.xhr,n,e.url)})),!r.filter||r.filter.test(e)?i[t]=e:i[t]="",o())}))}function l(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i={};return i.rules=(e.replace(t,"").match(n)||[]).filter((function(e){return-1===a.indexOf(e)})),i.urls=i.rules.map((function(e){return e.replace(n,"$1")})),i.absoluteUrls=i.urls.map((function(e){return NQ(e,r)})),i.absoluteRules=i.rules.map((function(e,t){var n=i.urls[t],a=NQ(i.absoluteUrls[t],r);return e.replace(n,a)})),i}function c(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],s=l(e,n,o);s.rules.length?DQ(s.absoluteUrls,{onBeforeSend:function(e,n,a){r.onBeforeSend(e,t,n)},onSuccess:function(e,n,a){var i=r.onSuccess(e,t,n),s=l(e=!1===i?"":i||e,n,o);return s.rules.forEach((function(t,n){e=e.replace(t,s.absoluteRules[n])})),e},onError:function(r,l,u){i.push({xhr:r,url:l}),o.push(s.rules[u]),c(e,t,n,a,i,o)},onComplete:function(r){r.forEach((function(t,n){e=e.replace(s.rules[n],t)})),c(e,t,n,a,i,o)}}):a(e,i)}a.length?a.forEach((function(e,t){var n=e.getAttribute("href"),a=e.getAttribute("rel"),l="link"===e.nodeName.toLowerCase()&&n&&a&&-1!==a.toLowerCase().indexOf("stylesheet"),c=!1!==r.skipDisabled&&e.disabled,u="style"===e.nodeName.toLowerCase();if(l&&!c)if(-1!==n.indexOf("data:text/css")){var h=decodeURIComponent(n.substring(n.indexOf(",")+1));r.useCSSOM&&(h=Array.apply(null,e.sheet.cssRules).map((function(e){return e.cssText})).join("")),s(h,t,e,location.href)}else DQ(n,{mimeType:"text/css",onBeforeSend:function(t,n,a){r.onBeforeSend(t,e,n)},onSuccess:function(r,a,i){var o=NQ(n);s(r,t,e,o)},onError:function(n,a,s){i[t]="",r.onError(n,e,a),o()}});else if(u&&!c){var d=e.textContent;r.useCSSOM&&(d=Array.apply(null,e.sheet.cssRules).map((function(e){return e.cssText})).join("")),s(d,t,e,location.href)}else i[t]="",o()})):r.onComplete("",[])}function NQ(e,t){var n=document.implementation.createHTMLDocument(""),r=n.createElement("base"),a=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(a),r.href=t||document.baseURI||(document.querySelector("base")||{}).href||location.href,a.href=e,a.href}var MQ=OQ;function OQ(e,t,n){e instanceof RegExp&&(e=kQ(e,n)),t instanceof RegExp&&(t=kQ(t,n));var r=IQ(e,t,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+e.length,r[1]),post:n.slice(r[1]+t.length)}}function kQ(e,t){var n=t.match(e);return n?n[0]:null}function IQ(e,t,n){var r,a,i,o,s,l=n.indexOf(e),c=n.indexOf(t,l+1),u=l;if(l>=0&&c>0){if(e===t)return[l,c];for(r=[],i=n.length;u>=0&&!s;)u==l?(r.push(u),l=n.indexOf(e,u+1)):1==r.length?s=[r.pop(),c]:((a=r.pop())<i&&(i=a,o=c),c=n.indexOf(t,u+1)),u=l<c&&l>=0?l:c;r.length&&(s=[i,o])}return s}function PQ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={preserveStatic:!0,removeComments:!1},r=SQ({},n,t),a=[];function i(e){throw new Error("CSS parse error: ".concat(e))}function o(t){var n=t.exec(e);if(n)return e=e.slice(n[0].length),n}function s(){return o(/^{\s*/)}function l(){return o(/^}/)}function c(){o(/^\s*/)}function u(){if(c(),"/"===e[0]&&"*"===e[1]){for(var t=2;e[t]&&("*"!==e[t]||"/"!==e[t+1]);)t++;if(!e[t])return i("end of comment is missing");var n=e.slice(2,t);return e=e.slice(t+2),{type:"comment",comment:n}}}function h(){for(var e,t=[];e=u();)t.push(e);return r.removeComments?[]:t}function d(){for(c();"}"===e[0];)i("extra closing bracket");var t=o(/^(("(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^{])+)/);if(t){var n,r=t[0].trim();/\/\*/.test(r)&&(r=r.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,""));var a=/["']\w*,\w*["']/.test(r);return a&&(r=r.replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,(function(e){return e.replace(/,/g,"‌")}))),n=/,/.test(r)?r.split(/\s*(?![^(]*\)),\s*/):[r],a&&(n=n.map((function(e){return e.replace(/\u200C/g,",")}))),n}}function p(){if("@"===e[0])return A();o(/^([;\s]*)+/);var t=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=o(/^(\*?[-#/*\\\w.]+(\[[0-9a-z_-]+\])?)\s*/);if(n){if(n=n[0].trim(),!o(/^:\s*/))return i("property missing ':'");var r=o(/^((?:\/\*.*?\*\/|'(?:\\'|.)*?'|"(?:\\"|.)*?"|\((\s*'(?:\\'|.)*?'|"(?:\\"|.)*?"|[^)]*?)\s*\)|[^};])+)/),a={type:"declaration",property:n.replace(t,""),value:r?r[0].replace(t,"").trim():""};return o(/^[;\s]*/),a}}function m(){if(!s())return i("missing '{'");for(var e,t=h();e=p();)t.push(e),t=t.concat(h());return l()?t:i("missing '}'")}function _(){c();for(var e,t=[];e=o(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)t.push(e[1]),o(/^,\s*/);if(t.length)return{type:"keyframe",values:t,declarations:m()}}function g(){var e=o(/^@([-\w]+)?keyframes\s*/);if(e){var t=e[1];if(!(e=o(/^([-\w]+)\s*/)))return i("@keyframes missing name");var n,r=e[1];if(!s())return i("@keyframes missing '{'");for(var a=h();n=_();)a.push(n),a=a.concat(h());return l()?{type:"keyframes",name:r,vendor:t,keyframes:a}:i("@keyframes missing '}'")}}function f(){if(o(/^@page */))return{type:"page",selectors:d()||[],declarations:m()}}function y(){var e=o(/@(top|bottom|left|right)-(left|center|right|top|middle|bottom)-?(corner)?\s*/);if(e)return{type:"page-margin-box",name:"".concat(e[1],"-").concat(e[2])+(e[3]?"-".concat(e[3]):""),declarations:m()}}function v(){if(o(/^@font-face\s*/))return{type:"font-face",declarations:m()}}function b(){var e=o(/^@supports *([^{]+)/);if(e)return{type:"supports",supports:e[1].trim(),rules:D()}}function x(){if(o(/^@host\s*/))return{type:"host",rules:D()}}function w(){var e=o(/^@media([^{]+)*/);if(e)return{type:"media",media:(e[1]||"").trim(),rules:D()}}function T(){var e=o(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(e)return{type:"custom-media",name:e[1].trim(),media:e[2].trim()}}function C(){var e=o(/^@([-\w]+)?document *([^{]+)/);if(e)return{type:"document",document:e[2].trim(),vendor:e[1]?e[1].trim():null,rules:D()}}function E(){var e=o(/^@(import|charset|namespace)\s*([^;]+);/);if(e)return{type:e[1],name:e[2].trim()}}function A(){if(c(),"@"===e[0]){var t=E()||v()||w()||g()||b()||C()||T()||x()||f()||y();if(t&&!r.preserveStatic){var n=!1;if(t.declarations)n=t.declarations.some((function(e){return/var\(/.test(e.value)}));else n=(t.keyframes||t.rules||[]).some((function(e){return(e.declarations||[]).some((function(e){return/var\(/.test(e.value)}))}));return n?t:{}}return t}}function S(){if(!r.preserveStatic){var t=MQ("{","}",e);if(t){var n=/:(?:root|host)(?![.:#(])/.test(t.pre)&&/--\S*\s*:/.test(t.body),a=/var\(/.test(t.body);if(!n&&!a)return e=e.slice(t.end+1),{}}}var o=d()||[],s=r.preserveStatic?m():m().filter((function(e){var t=o.some((function(e){return/:(?:root|host)(?![.:#(])/.test(e)}))&&/^--\S/.test(e.property),n=/var\(/.test(e.value);return t||n}));return o.length||i("selector missing"),{type:"rule",selectors:o,declarations:s}}function D(t){if(!t&&!s())return i("missing '{'");for(var n,r=h();e.length&&(t||"}"!==e[0])&&(n=A()||S());)n.type&&r.push(n),r=r.concat(h());return t||l()?r:i("missing '}'")}return{type:"stylesheet",stylesheet:{rules:D(!0),errors:a}}}function LQ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={parseHost:!1,store:{},onWarning:function(){}},r=SQ({},n,t),a=new RegExp(":".concat(r.parseHost?"host":"root","$"));return"string"==typeof e&&(e=PQ(e,r)),e.stylesheet.rules.forEach((function(e){"rule"===e.type&&e.selectors.some((function(e){return a.test(e)}))&&e.declarations.forEach((function(e,t){var n=e.property,a=e.value;n&&0===n.indexOf("--")&&(r.store[n]=a)}))})),r.store}function BQ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r={charset:function(e){return"@charset "+e.name+";"},comment:function(e){return 0===e.comment.indexOf("__CSSVARSPONYFILL")?"/*"+e.comment+"*/":""},"custom-media":function(e){return"@custom-media "+e.name+" "+e.media+";"},declaration:function(e){return e.property+":"+e.value+";"},document:function(e){return"@"+(e.vendor||"")+"document "+e.document+"{"+a(e.rules)+"}"},"font-face":function(e){return"@font-face{"+a(e.declarations)+"}"},host:function(e){return"@host{"+a(e.rules)+"}"},import:function(e){return"@import "+e.name+";"},keyframe:function(e){return e.values.join(",")+"{"+a(e.declarations)+"}"},keyframes:function(e){return"@"+(e.vendor||"")+"keyframes "+e.name+"{"+a(e.keyframes)+"}"},media:function(e){return"@media "+e.media+"{"+a(e.rules)+"}"},namespace:function(e){return"@namespace "+e.name+";"},page:function(e){return"@page "+(e.selectors.length?e.selectors.join(", "):"")+"{"+a(e.declarations)+"}"},"page-margin-box":function(e){return"@"+e.name+"{"+a(e.declarations)+"}"},rule:function(e){var t=e.declarations;if(t.length)return e.selectors.join(",")+"{"+a(t)+"}"},supports:function(e){return"@supports "+e.supports+"{"+a(e.rules)+"}"}};function a(e){for(var a="",i=0;i<e.length;i++){var o=e[i];n&&n(o);var s=r[o.type](o);s&&(a+=s,s.length&&o.selectors&&(a+=t))}return a}return a(e.stylesheet.rules)}function FQ(e,t){e.rules.forEach((function(n){n.rules?FQ(n,t):n.keyframes?n.keyframes.forEach((function(e){"keyframe"===e.type&&t(e.declarations,n)})):n.declarations&&t(n.declarations,e)}))}OQ.range=IQ;function HQ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={preserveStatic:!0,preserveVars:!1,variables:{},onWarning:function(){}},r=SQ({},n,t);return"string"==typeof e&&(e=PQ(e,r)),FQ(e.stylesheet,(function(e,t){for(var n=0;n<e.length;n++){var a=e[n],i=a.type,o=a.property,s=a.value;if("declaration"===i)if(r.preserveVars||!o||0!==o.indexOf("--")){if(-1!==s.indexOf("var(")){var l=UQ(s,r);l!==a.value&&(l=qQ(l),r.preserveVars?(e.splice(n,0,{type:i,property:o,value:l}),n++):a.value=l)}}else e.splice(n,1),n--}})),BQ(e)}function qQ(e){return(e.match(/calc\(([^)]+)\)/g)||[]).forEach((function(t){var n="calc".concat(t.split("calc").join(""));e=e.replace(t,n)})),e}function UQ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(-1===e.indexOf("var("))return e;var r=MQ("(",")",e);function a(e){var r=e.split(",")[0].replace(/[\s\n\t]/g,""),a=(e.match(/(?:\s*,\s*){1}(.*)?/)||[])[1],i=Object.prototype.hasOwnProperty.call(t.variables,r)?String(t.variables[r]):void 0,o=i||(a?String(a):void 0),s=n||e;return i||t.onWarning('variable "'.concat(r,'" is undefined')),o&&"undefined"!==o&&o.length>0?UQ(o,t,s):"var(".concat(s,")")}if(r){if("var"===r.pre.slice(-3)){var i=0===r.body.trim().length;return i?(t.onWarning("var() must contain a non-whitespace string"),e):r.pre.slice(0,-3)+a(r.body)+UQ(r.post,t)}return r.pre+"(".concat(UQ(r.body,t),")")+UQ(r.post,t)}return-1!==e.indexOf("var(")&&t.onWarning('missing closing ")" in the value "'.concat(e,'"')),e}var VQ="undefined"!=typeof window,WQ=VQ&&window.CSS&&window.CSS.supports&&window.CSS.supports("(--a: 0)"),zQ={group:0,job:0},YQ={rootElement:VQ?document:null,shadowDOM:!1,include:"style,link[rel=stylesheet]",exclude:"",variables:{},onlyLegacy:!0,preserveStatic:!0,preserveVars:!1,silent:!1,updateDOM:!0,updateURLs:!0,watch:null,onBeforeSend:function(){},onError:function(){},onWarning:function(){},onSuccess:function(){},onComplete:function(){},onFinally:function(){}},GQ={cssComments:/\/\*[\s\S]+?\*\//g,cssKeyframes:/@(?:-\w*-)?keyframes/,cssMediaQueries:/@media[^{]+\{([\s\S]+?})\s*}/g,cssUrls:/url\((?!['"]?(?:data|http|\/\/):)['"]?([^'")]*)['"]?\)/g,cssVarDeclRules:/(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^}]*})/g,cssVarDecls:/(?:[\s;]*)(-{2}\w[\w-]*)(?:\s*:\s*)([^;]*);/g,cssVarFunc:/var\(\s*--[\w-]/,cssVars:/(?:(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^;]*;*\s*)|(?:var\(\s*))(--[^:)]+)(?:\s*[:)])/},XQ={dom:{},job:{},user:{}},$Q=!1,jQ=null,KQ=0,ZQ=null,QQ=!1;function JQ(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="cssVars(): ",n=SQ({},YQ,e);function r(e,r,a,i){!n.silent&&window.console&&console.error("".concat(t).concat(e,"\n"),r),n.onError(e,r,a,i)}function a(e){!n.silent&&window.console&&console.warn("".concat(t).concat(e)),n.onWarning(e)}function i(e){n.onFinally(Boolean(e),WQ,oJ()-n.__benchmark)}if(VQ){if(n.watch)return n.watch=YQ.watch,eJ(n),void JQ(n);if(!1===n.watch&&jQ&&(jQ.disconnect(),jQ=null),!n.__benchmark){if($Q===n.rootElement)return void tJ(e);var o=[].slice.call(n.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])'));if(n.__benchmark=oJ(),n.exclude=[jQ?'[data-cssvars]:not([data-cssvars=""])':'[data-cssvars="out"]',"link[disabled]:not([data-cssvars])",n.exclude].filter((function(e){return e})).join(","),n.variables=aJ(n.variables),o.forEach((function(e){var t="style"===e.nodeName.toLowerCase()&&e.__cssVars.text,n=t&&e.textContent!==e.__cssVars.text;t&&n&&(e.sheet&&(e.sheet.disabled=!1),e.setAttribute("data-cssvars",""))})),!jQ){var s=[].slice.call(n.rootElement.querySelectorAll('[data-cssvars="out"]'));s.forEach((function(e){var t=e.getAttribute("data-cssvars-group");(t?n.rootElement.querySelector('[data-cssvars="src"][data-cssvars-group="'.concat(t,'"]')):null)||e.parentNode.removeChild(e)})),KQ&&o.length<KQ&&(KQ=o.length,XQ.dom={})}}if("loading"!==document.readyState)if(WQ&&n.onlyLegacy){var l=!1;if(n.updateDOM){var c=n.rootElement.host||(n.rootElement===document?document.documentElement:n.rootElement);Object.keys(n.variables).forEach((function(e){var t=n.variables[e];l=l||t!==getComputedStyle(c).getPropertyValue(e),c.style.setProperty(e,t)}))}i(l)}else!QQ&&(n.shadowDOM||n.rootElement.shadowRoot||n.rootElement.host)?RQ({rootElement:YQ.rootElement,include:YQ.include,exclude:n.exclude,skipDisabled:!1,onSuccess:function(e,t,n){return!((t.sheet||{}).disabled&&!t.__cssVars)&&((e=((e=e.replace(GQ.cssComments,"").replace(GQ.cssMediaQueries,"")).match(GQ.cssVarDeclRules)||[]).join(""))||!1)},onComplete:function(e,t,r){LQ(e,{store:XQ.dom,onWarning:a}),QQ=!0,JQ(n)}}):($Q=n.rootElement,RQ({rootElement:n.rootElement,include:n.include,exclude:n.exclude,skipDisabled:!1,onBeforeSend:n.onBeforeSend,onError:function(e,t,n){var a=e.responseURL||iJ(n,location.href),i=e.statusText?"(".concat(e.statusText,")"):"Unspecified Error"+(0===e.status?" (possibly CORS related)":"");r("CSS XHR Error: ".concat(a," ").concat(e.status," ").concat(i),t,e,a)},onSuccess:function(e,t,r){if((t.sheet||{}).disabled&&!t.__cssVars)return!1;var a="link"===t.nodeName.toLowerCase(),i="style"===t.nodeName.toLowerCase()&&e!==t.textContent,o=n.onSuccess(e,t,r);return e=void 0!==o&&!1===Boolean(o)?"":o||e,n.updateURLs&&(a||i)&&(e=rJ(e,r)),e},onComplete:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=SQ({},XQ.dom,XQ.user);if(XQ.job={},o.forEach((function(e,i){var o=t[i];if(e.__cssVars=e.__cssVars||{},e.__cssVars.text=o,GQ.cssVars.test(o))try{var s=PQ(o,{preserveStatic:n.preserveStatic,removeComments:!0});LQ(s,{parseHost:Boolean(n.rootElement.host),store:XQ.dom,onWarning:a}),e.__cssVars.tree=s}catch(t){r(t.message,e)}})),SQ(XQ.job,XQ.dom),n.updateDOM?(SQ(XQ.user,n.variables),SQ(XQ.job,XQ.user)):(SQ(XQ.job,XQ.user,n.variables),SQ(s,n.variables)),zQ.job>0&&Boolean(Object.keys(XQ.job).length>Object.keys(s).length||Boolean(Object.keys(s).length&&Object.keys(XQ.job).some((function(e){return XQ.job[e]!==s[e]})))))sJ(n.rootElement),JQ(n);else{var l=[],c=[],u=!1;if(n.updateDOM&&zQ.job++,o.forEach((function(e,i){var o=!e.__cssVars.tree;if(e.__cssVars.tree)try{HQ(e.__cssVars.tree,SQ({},n,{variables:XQ.job,onWarning:a}));var s=BQ(e.__cssVars.tree);if(n.updateDOM){var h=t[i],d=GQ.cssVarFunc.test(h);if(e.getAttribute("data-cssvars")||e.setAttribute("data-cssvars","src"),s.length&&d){var p=e.getAttribute("data-cssvars-group")||++zQ.group,m=s.replace(/\s/g,""),_=n.rootElement.querySelector('[data-cssvars="out"][data-cssvars-group="'.concat(p,'"]'))||document.createElement("style");u=u||GQ.cssKeyframes.test(s),n.preserveStatic&&e.sheet&&(e.sheet.disabled=!0),_.hasAttribute("data-cssvars")||_.setAttribute("data-cssvars","out"),m===e.textContent.replace(/\s/g,"")?(o=!0,_&&_.parentNode&&(e.removeAttribute("data-cssvars-group"),_.parentNode.removeChild(_))):m!==_.textContent.replace(/\s/g,"")&&([e,_].forEach((function(e){e.setAttribute("data-cssvars-job",zQ.job),e.setAttribute("data-cssvars-group",p)})),_.textContent=s,l.push(s),c.push(_),_.parentNode||e.parentNode.insertBefore(_,e.nextSibling))}}else e.textContent.replace(/\s/g,"")!==s&&l.push(s)}catch(t){r(t.message,e)}o&&e.setAttribute("data-cssvars","skip"),e.hasAttribute("data-cssvars-job")||e.setAttribute("data-cssvars-job",zQ.job)})),KQ=n.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])').length,n.shadowDOM)for(var h,d=[].concat(n.rootElement).concat([].slice.call(n.rootElement.querySelectorAll("*"))),p=0;h=d[p];++p)if(h.shadowRoot&&h.shadowRoot.querySelector("style")){var m=SQ({},n,{rootElement:h.shadowRoot});JQ(m)}n.updateDOM&&u&&nJ(n.rootElement),$Q=!1,n.onComplete(l.join(""),c,JSON.parse(JSON.stringify(XQ.job)),oJ()-n.__benchmark),i(c.length)}}}));else document.addEventListener("DOMContentLoaded",(function t(n){JQ(e),document.removeEventListener("DOMContentLoaded",t)}))}}function eJ(e){function t(e){var t=n(e)&&e.hasAttribute("disabled"),r=(e.sheet||{}).disabled;return t||r}function n(e){return"link"===e.nodeName.toLowerCase()&&-1!==(e.getAttribute("rel")||"").indexOf("stylesheet")}function r(e){return"style"===e.nodeName.toLowerCase()}window.MutationObserver&&(jQ&&(jQ.disconnect(),jQ=null),(jQ=new MutationObserver((function(a){a.some((function(a){return function(r){var a=!1;if("attributes"===r.type&&n(r.target)&&!t(r.target)){var i="disabled"===r.attributeName,o="href"===r.attributeName,s="skip"===r.target.getAttribute("data-cssvars"),l="src"===r.target.getAttribute("data-cssvars");i?a=!s&&!l:o&&(s?r.target.setAttribute("data-cssvars",""):l&&sJ(e.rootElement,!0),a=!0)}return a}(a)||function(e){var t=!1;if("childList"===e.type){var n=r(e.target),a="out"===e.target.getAttribute("data-cssvars");t=n&&!a}return t}(a)||function(e){var a=!1;return"childList"===e.type&&(a=[].slice.call(e.addedNodes).some((function(e){var a=1===e.nodeType&&e.hasAttribute("data-cssvars"),i=r(e)&&GQ.cssVars.test(e.textContent);return!a&&(n(e)||i)&&!t(e)}))),a}(a)||function(t){var n=!1;return"childList"===t.type&&(n=[].slice.call(t.removedNodes).some((function(t){var n=1===t.nodeType,r=n&&"out"===t.getAttribute("data-cssvars"),a=n&&"src"===t.getAttribute("data-cssvars"),i=a;if(a||r){var o=t.getAttribute("data-cssvars-group"),s=e.rootElement.querySelector('[data-cssvars-group="'.concat(o,'"]'));a&&sJ(e.rootElement,!0),s&&s.parentNode.removeChild(s)}return i}))),n}(a)}))&&JQ(e)}))).observe(document.documentElement,{attributes:!0,attributeFilter:["disabled","href"],childList:!0,subtree:!0}))}function tJ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;clearTimeout(ZQ),ZQ=setTimeout((function(){e.__benchmark=null,JQ(e)}),t)}function nJ(e){var t=["animation-name","-moz-animation-name","-webkit-animation-name"].filter((function(e){return getComputedStyle(document.body)[e]}))[0];if(t){for(var n=[].slice.call(e.querySelectorAll("*")),r=[],a="__CSSVARSPONYFILL-KEYFRAMES__",i=0,o=n.length;i<o;i++){var s=n[i];"none"!==getComputedStyle(s)[t]&&(s.style[t]+=a,r.push(s))}document.body.offsetHeight;for(var l=0,c=r.length;l<c;l++){var u=r[l].style;u[t]=u[t].replace(a,"")}}}function rJ(e,t){return(e.replace(GQ.cssComments,"").match(GQ.cssUrls)||[]).forEach((function(n){var r=n.replace(GQ.cssUrls,"$1"),a=iJ(r,t);e=e.replace(n,n.replace(r,a))})),e}function aJ(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=/^-{2}/;return Object.keys(e).reduce((function(n,r){return n[t.test(r)?r:"--".concat(r.replace(/^-+/,""))]=e[r],n}),{})}function iJ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.href,n=document.implementation.createHTMLDocument(""),r=n.createElement("base"),a=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(a),r.href=t,a.href=e,a.href}function oJ(){return VQ&&(window.performance||{}).now?window.performance.now():(new Date).getTime()}function sJ(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[].slice.call(e.querySelectorAll('[data-cssvars="skip"],[data-cssvars="src"]'));n.forEach((function(e){return e.setAttribute("data-cssvars","")})),t&&(XQ.dom={})}JQ.reset=function(){for(var e in zQ.job=0,zQ.group=0,$Q=!1,jQ&&(jQ.disconnect(),jQ=null),KQ=0,ZQ=null,QQ=!1,XQ)XQ[e]={}};var lJ={successColor:"#52c41a",warningColor:"#faad14",errorColor:"#f5222d",borderRadiusBase:"2px",borderWidthBase:"1px",borderStyleBase:"solid",lineHeightBase:"1.5715",fontWeight:"400",fontSizeBase:"14px",fontSizeLg:"16px",fontSizeSm:"12px",paddingBase:"1em",marginBase:"1em",gray1:"#ffffff",gray2:"#fafafa",gray3:"#f5f5f5",gray4:"#f0f0f0",gray5:"#d9d9d9",gray6:"#bfbfbf",gray7:"#8c8c8c",gray8:"#595959",gray9:"#434343",gray10:"#262626",gray11:"#1f1f1f",gray12:"#141414",gray13:"#000000",gray14:"#efefef",gray15:"#e0e0e0",gray16:"#ececec",gray17:"#cbcbcb",primaryColor:"#0188fb",primaryColorHover:"#5391ff",linkColor:"#1890ff",bg:"#fff",fontSize:"14px",headingColor:"#262626",textColor:"#333",textColorSecondary:"#8c8c8c",disabledColor:"#bfbfbf",disabledBg:"#f5f5f5",borderColorBase:"#d9d9d9",boxShadowBase:"0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05)",borderColorBaseHover:"#bfbfbf"};var cJ={successColor:"#52c41a",warningColor:"#faad14",errorColor:"#f5222d",borderRadiusBase:"2px",borderWidthBase:"1px",borderStyleBase:"solid",lineHeightBase:"1.5715",fontWeight:"400",fontSizeBase:"14px",fontSizeLg:"16px",fontSizeSm:"12px",paddingBase:"1em",marginBase:"1em",gray1:"#ffffff",gray2:"#fafafa",gray3:"#f5f5f5",gray4:"#f0f0f0",gray5:"#d9d9d9",gray6:"#bfbfbf",gray7:"#8c8c8c",gray8:"#595959",gray9:"#434343",gray10:"#262626",gray11:"#1f1f1f",gray12:"#141414",gray13:"#000000",gray14:"#efefef",gray15:"#e0e0e0",gray16:"#ececec",gray17:"#cbcbcb",primaryColor:"#0188fb",primaryColorHover:"#5391ff",linkColor:"#1890ff",bg:"#0d1117",fontSize:"14px",headingColor:"rgba(255, 255, 255, 0.85)",textColor:"#8b949e",textColorSecondary:"rgba(255, 255, 255, 0.45)",disabledColor:"rgba(255, 255, 255, 0.25)",disabledBg:"rgba(255, 255, 255, 0.04)",borderColorBase:"rgba(255, 255, 255, 0.15)",boxShadowBase:"0 3px 6px -4px rgba(255, 255, 255, 0.12), 0 6px 16px 0 rgba(255, 255, 255, 0.08), 0 9px 28px 8px rgba(255, 255, 255, 0.05)",borderColorBaseHover:"#bfbfbf"};var uJ={successColor:"#52c41a",warningColor:"#faad14",errorColor:"#f5222d",borderRadiusBase:"2px",borderWidthBase:"1px",borderStyleBase:"solid",lineHeightBase:"1.5715",fontWeight:"400",fontSizeBase:"14px",fontSizeLg:"16px",fontSizeSm:"12px",paddingBase:"1em",marginBase:"1em",gray1:"#ffffff",gray2:"#fafafa",gray3:"#f5f5f5",gray4:"#f0f0f0",gray5:"#d9d9d9",gray6:"#bfbfbf",gray7:"#8c8c8c",gray8:"#595959",gray9:"#434343",gray10:"#262626",gray11:"#1f1f1f",gray12:"#141414",gray13:"#000000",gray14:"#efefef",gray15:"#e0e0e0",gray16:"#ececec",gray17:"#cbcbcb",primaryColor:"#004b1c",primaryColorHover:"#0e5c2f",linkColor:"#217346",bg:"#fff",fontSize:"14px",headingColor:"rgba(0, 0, 0, 0.85)",textColor:"rgba(0, 0, 0, 0.65)",textColorSecondary:"rgba(0, 0, 0, 0.45)",disabledColor:"rgba(0, 0, 0, 0.25)",disabledBg:"rgba(0, 0, 0, 0.04)",borderColorBase:"rgba(0, 0, 0, 0.15)",boxShadowBase:"0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05)",borderColorBaseHover:"#bfbfbf"};var hJ="univer-context-menu",dJ="univer-right-menu-center",pJ="univer-right-menu-item";class mJ extends bZ{constructor(){super(...arguments),this.ulRef={current:null},this.root={current:null},this.handleContextMenu=async(e,t,n)=>{e.preventDefault(),this.setState({visible:!0,srcElement:e.target,eventType:e.type},(()=>{new Promise(((e,t)=>{this.ulRef.current.showMenu(!0),e()})).then((()=>{const r=n?t.x:e.clientX,a=n?t.y:e.clientY,i=window.innerWidth,o=window.innerHeight,s=this.ulRef.current.base.offsetWidth,l=this.ulRef.current.base.offsetHeight,c=i-r>s,u=!c,h=o-a>l,d=!h;c&&(this.root.current.style.left=`${r}px`),u&&(this.root.current.style.left=r-s+"px"),h&&(this.root.current.style.top=`${a}px`),d&&(this.root.current.style.top=a-l+"px")}))}))},this.handleClick=e=>{const{visible:t,eventType:n,srcElement:r}=this.state;this.root.current&&("click"===n&&r&&r.contains(e.target)||this.root.current.contains(e.target)||t&&this.setState({visible:!1}))}}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={visible:!1,srcElement:null,eventType:null,children:[]}}resetMenuList(e){var t;const n=this._context.getPluginManager().getPluginByName(ti.SPREADSHEET);for(let r=0;r<e.length;r++){const a=e[r];if(a.customLabel){const e=n.getRegisterComponent(a.customLabel.name),r=null!=(t=a.customLabel.props)?t:{};e&&(a.label=rm(e,{...r}))}a.children&&(a.children=this.resetMenuList(a.children))}return e}setMenuList(e){this.setState({children:this.resetMenuList(e)})}componentDidMount(){var e;document.addEventListener("click",this.handleClick),null==(e=this._context.getObserverManager().getObserver("onRightMenuDidMountObservable",ti.SPREADSHEET))||e.notifyObservers(this)}componentWillUnmount(){document.removeEventListener("click",this.handleClick)}render(){if(!this.state.children.length)return;const e={...this.props.style},{visible:t}=this.state,n=this.Render.renderFunction("Menu");return t&&rm("div",{ref:this.root,className:hJ,style:e,onContextMenu:e=>{e.preventDefault()}},rm(n,{ref:this.ulRef,menu:this.state.children,onClick:this.handleClick}))}}class _J extends bZ{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const{prefix:e,buttons:t}=this.props,n=this._render.renderFunction("Button");return rm("div",null,e,t.map((e=>rm(n,{type:"primary"},e))))}}class gJ extends bZ{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const{prefix:e,suffix:t}=this.props;return rm("div",null,e,rm(this._render.renderFunction("Input"),{type:"number",placeholder:"1"}),t)}}class fJ extends bZ{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const{label:e}=this.props,t=this._render.renderFunction("RightIcon");return rm("div",{className:pJ},e,rm(t,null))}}class yJ extends bZ{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const{prefix:e,options:t}=this.props,n=this._render.renderFunction("Input");return rm("div",null,rm("div",null,e),rm("select",null,t.map((e=>rm("option",null,e.label)))),rm(n,{type:"number",placeholder:"2"}))}}var vJ="univer-info-detail",bJ="univer-info-return",xJ="univer-sheet-name",wJ="univer-info-detail-update",TJ="univer-info-detail-save";class CJ extends bZ{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={infoList:null}}componentDidMount(){var e;null==(e=this._context.getObserverManager().getObserver("onInfoBarDidMountObservable",ti.SPREADSHEET))||e.notifyObservers(this)}setInfoList(e){this.setState({infoList:e})}render(){if(!this.state.infoList)return;const e=this.Render.renderFunction("Button"),t=this.Render.renderFunction("Container"),n=this.Render.renderFunction("Input"),r=this.Render.renderFunction("Tooltip"),a=this.Render.renderFunction("DropDownIcon"),i=this.Render.renderFunction("LogoIcon"),{back:o,sheet:s,update:l,save:c,rename:u}=this.state.infoList;return rm(t,{className:vJ},rm("div",{style:{marginRight:"18px"}},rm(r,{title:o.label,placement:"bottom"},rm(e,{className:bJ,type:"text"},rm(a,{rotate:90})))),rm(i,{style:{width:"152px",height:"32px"}}),rm("div",{className:xJ},rm(r,{title:u.label,placement:"bottom"},rm(n,{bordered:!1,value:s.label,onBlur:s.onBlur}))),rm("div",{className:wJ},l.label),rm("div",{className:TJ},c.label))}}var EJ="univer-layout-container",AJ="univer-content-container-horizontal",SJ="univer-content-inner-left-container",DJ="univer-hover-cursor",RJ="univer-content-inner-right-container",NJ="univer-content-container-vertical",MJ="univer-main-content",OJ="univer-outer-right-container";var kJ="univer-select-item",IJ="univer-select-item-selected",PJ="univer-select-item-content",LJ="univer-select-item-suffix",BJ="univer-select-disabled-item";class FJ extends bZ{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender()}render(){const e=this.Render.renderFunction("CorrectIcon"),{selected:t,label:n,suffix:r,disabled:a}=this.props;return rm("div",{className:TZ(kJ,a?BJ:"")},t?rm("span",{className:IJ},rm(e,null)):"",rm("span",{className:PJ},n),r?rm("span",{className:LJ},r):"")}}var HJ="univer-select-component",qJ="univer-select-single",UJ="univer-select-input",VJ="univer-select-color",WJ="univer-select-double",zJ="univer-select-line",YJ="univer-select-label";class GJ extends bZ{constructor(){super(...arguments),this.handleSelected=e=>{const{children:t=[],hideSelectedIcon:n}=this.props;t.length&&(t.forEach((e=>{e.selected=!1})),null!==e&&(t[e].selected=!0));return this.resetMenu(t,n)},this.getSingle=()=>{const{content:e,menu:t}=this.state,{className:n=""}=this.props,r=this.Render.renderFunction("Button");return rm("div",{className:`${qJ} ${n}`},rm(r,{type:"text"},rm(Wj,{menu:{menu:t,onClick:this.onClick},showArrow:!0},rm("div",null,e))))},this.getInput=()=>{const{content:e,menu:t}=this.state,{className:n=""}=this.props,r=this.Render.renderFunction("Input"),a=this.Render.renderFunction("Button");return rm("div",{className:`${UJ} ${n}`},rm(a,{type:"text"},rm(Wj,{menu:{menu:t,onClick:this.onClick},showArrow:!0},rm(r,{onKeyUp:this.onKeyUp,type:"number",value:e}))))},this.getColor=()=>{const{label:e,className:t=""}=this.props,{color:n,menu:r}=this.state,a=this.Render.renderFunction("Button"),i=this.Render.renderFunction("NextIcon");return rm("div",{className:`${VJ} ${WJ} ${t}`},rm(a,{type:"text"},rm(Wj,{onClick:this.onClick,menu:{menu:r,onClick:this.onClick},icon:rm(i,null)},rm("div",{className:YJ},e),rm("div",{className:zJ,style:{background:n}}))))},this.getDouble=()=>{const{content:e,menu:t}=this.state,{className:n=""}=this.props,r=this.Render.renderFunction("NextIcon"),a=this.Render.renderFunction("Button");return rm("div",{className:`${WJ} ${n}`},rm(a,{type:"text"},rm(Wj,{menu:{menu:t,onClick:this.onClick},icon:rm(r,null)},rm("div",{className:YJ},e))))},this.getFix=()=>{const{label:e,className:t=""}=this.props,{menu:n}=this.state,r=this.Render.renderFunction("Button");return rm("div",{className:`${WJ} ${t}`},rm(r,{type:"text"},rm(Wj,{menu:{menu:n,onClick:this.onClick},showArrow:!0},rm("div",{className:YJ},e))))},this.getDoubleFix=()=>{const{label:e,className:t=""}=this.props,{menu:n}=this.state,r=this.Render.renderFunction("Button"),a=this.Render.renderFunction("NextIcon");return rm("div",{className:`${WJ} ${t}`},rm(r,{type:"text"},rm(Wj,{onClick:this.onClick,menu:{menu:n,onClick:this.onClick},icon:rm(a,null)},rm("div",{className:YJ},e))))}}initialize(){var e;const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=t.getComponentRender();const{children:n=[],hideSelectedIcon:r}=this.props,a=this.resetMenu(n,r);this.state={menu:a,color:null!=(e=this.props.defaultColor)?e:"#000",content:"",value:""}}getType(e){switch(e){case 0:return this.getSingle();case 1:return this.getInput();case 2:return this.getColor();case 3:return this.getDouble();case 4:return this.getFix();case 5:return this.getDoubleFix()}}initData(){const{type:e,display:t,children:n=[],label:r}=this.props;if(0===e||3===e){if(!n.length)return;let e=n.findIndex((e=>e.selected));e<0&&(e=0);const r=this.handleSelected(e),a=n[e];1===t?this.setState({content:a.suffix,menu:r}):this.setState({content:a.label,menu:r}),this.onClick=(...e)=>{var r,a;const i=n[e[2]];if(null==(a=(r=this.props).onClick)||a.call(r,e[1],e[2],e[3]),i.unSelectable)return;const o=this.handleSelected(e[2]);1===t?this.setState({content:n[e[2]].suffix,menu:o}):this.setState({content:n[e[2]].label,menu:o})}}else if(1===e){if(!n.length)return;const e=e=>{if(null!==e){if(""===e)return;let t=n.findIndex((t=>e===t.label)),r=this.handleSelected(t<0?null:t);this.setState({content:e,menu:r})}else{let e=n.findIndex((e=>e.selected));e<0&&(e=0);let t=this.handleSelected(e);const r=n[e];this.setState({content:r.label,menu:t})}};e(r),this.onClick=(...e)=>{var t,r;null==(r=(t=this.props).onClick)||r.call(t,e[1],e[2],e[3]);const a=this.handleSelected(e[2]);this.setState({content:n[e[2]].label,menu:a})},this.onKeyUp=t=>{var n,r;const a=t.currentTarget.value;null==(r=(n=this.props).onKeyUp)||r.call(n,a),e(a)}}else if(2===e){const e=this.handleSelected(null);this.setState({menu:e}),this.onClick=()=>{var e,t;const{color:n}=this.state;null==(t=(e=this.props).onClick)||t.call(e,n)}}else if(4===e||5===e){if(!n.length)return;let e=n.findIndex((e=>e.selected));e<0&&(e=0);const t=n[e],r=this.handleSelected(e);this.setState({menu:r,value:t.value}),this.onClick=(...e)=>{var t,r,a,i;if(e.length){null==(r=(t=this.props).onClick)||r.call(t,e[1],e[2],e[3]);const a=this.handleSelected(e[2]);this.setState({menu:a,value:n[e[2]].value})}else null==(i=(a=this.props).onClick)||i.call(a,this.state.value)}}}componentDidMount(){this.initData()}componentWillReceiveProps(){this.initData()}resetMenu(e,t){var n;const r=[];for(let a=0;a<e.length;a++){let i=!1;t||(i=null!=(n=e[a].selected)&&n),r[a]={label:""},r[a].label=rm(FJ,{disabled:e[a].disabled,border:e[a].border,selected:i,label:e[a].label,suffix:e[a].suffix}),r[a].disabled=e[a].disabled,r[a].style=e[a].style,r[a].value=e[a].value,r[a].className=e[a].className,r[a].onClick=e[a].onClick,r[a].border=e[a].border,e[a].children&&(r[a].children=this.resetMenu(e[a].children))}return 2===this.props.type&&(r[0]={label:rm(FJ,{label:rm(cx,{style:{display:"block"},ref:e=>this.ColorRef=e,color:"#000",onClick:e=>{this.ColorRef.hideSelect(),this.setState({color:e},(()=>{this.onClick()}))}})})}),r}render(){const{type:e=0}=this.props;return rm("div",{className:HJ},this.getType(e))}}var XJ="univer-text-button";class $J extends bZ{constructor(){super(...arguments),this.handleClick=()=>{var e,t;const n=!this.state.active;null==(t=(e=this.props).onClick)||t.call(e,n),this.setState({active:n})}}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={active:this.props.active}}render(){const{label:e}=this.props,{active:t}=this.state,n=this.Render.renderFunction("Button");return rm("div",{className:XJ},rm(n,{type:"text",active:t,onClick:this.handleClick},e))}}var jJ="univer-toolbar-warp",KJ="univer-single-button",ZJ="univer-more-show",QJ="univer-toolbar",JJ="univer-select-label-string",e0="univer-select-color-picker-parent",t0="univer-select-color-picker",n0="univer-more-tool";class r0 extends bZ{constructor(){super(...arguments),this.toolbarWarp={current:null},this.toolbarRef={current:null},this.moreBtn={current:null},this.moreToolRef={current:null},this.SelectRef={current:null},this.moreTool=()=>{let e=this.state.more;this.setState({more:!e}),e||document.addEventListener("click",this.hide,!0)},this.hide=e=>{this.moreToolRef.current.contains(e.target)||(e.stopImmediatePropagation(),this.setState({more:!1}),document.removeEventListener("click",this.hide,!0))},this.setToolbarListWidth=()=>{const e=this.toolbarWarp.current.querySelector(`.${QJ}`),t=e.getBoundingClientRect().left,n=[],r=[];e.childNodes.forEach(((e,r)=>{n.push(parseInt((e.getBoundingClientRect().left-t+e.getBoundingClientRect().width).toString()))}));let a=0,i=0;r.push(n[0]),n.reduce(((e,t)=>(e>t&&0===i&&(a=e,i++),r.push(t+a),t+a))),this.setState((()=>({toolbarListWidths:r})),this.resetToolbar)},this.resetLabel=e=>{var t,n;const r=this._context.getPluginManager().getPluginByName(ti.SPREADSHEET);for(let a=0;a<e.length;a++){const i=e[a];if(i.customLabel){const e=null==r?void 0:r.getRegisterComponent(i.customLabel.name);if(e){const n=null!=(t=i.customLabel.props)?t:{};i.label=rm(e,{...n})}}if(i.customSuffix){const e=null==r?void 0:r.getRegisterComponent(i.customSuffix.name);if(e){const t=null!=(n=i.customSuffix.props)?n:{};i.suffix=rm(e,{...t})}}i.children&&(i.children=this.resetLabel(i.children))}return e},this.setToolBar=e=>{e=this.resetLabel(e),this.setState({toolList:e},(()=>{this.resetToolbar()}))},this.resetToolbar=()=>{this.toolbarWarp,this.setState((e=>({defaultToolList:e.toolList,moreToolList:[]})),(()=>{var e;const t=`${(null==(e=this._context.getPluginManager().getPluginByName(ti.SPREADSHEET))?void 0:e.getContentRef().current).offsetHeight}px`,n=this.toolbarRef.current.querySelectorAll("ul");for(let e=0;e<n.length;e++)n[e].style.maxHeight=t}))}}initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=t.getComponentRender(),this.state={more:!1,toolList:[],defaultToolList:[],moreToolList:[],index:0,toolbarListWidths:[],moreText:""}}componentDidMount(){var e;null==(e=this._context.getObserverManager().getObserver("onToolBarDidMountObservable"))||e.notifyObservers(this)}render(e,t){const{defaultToolList:n}=t,r=this.Render.renderFunction("Button"),a=this.Render.renderFunction("Container"),i=this.Render.renderFunction("Tooltip");return rm(a,{style:{position:"relative"}},rm("div",{className:jJ,ref:this.toolbarWarp},rm("div",{className:QJ,ref:this.toolbarRef},n.map((e=>e.toolbarType?rm(i,{title:e.tooltip,placement:"bottom"},rm($J,{label:e.label,onClick:e.onClick})):rm(i,{title:e.tooltip,placement:"bottom"},rm(GJ,{type:e.type,display:e.display,children:e.children,customLabel:e.customLabel,customSuffix:e.customSuffix,label:e.label,onClick:e.onClick,onKeyUp:e.onKeyUp,defaultColor:e.defaultColor,hideSelectedIcon:e.hideSelectedIcon,className:e.className}))))),0===this.state.moreToolList.length?null:rm("div",{ref:this.moreBtn,className:KJ},rm(i,{title:this.state.moreText,placement:"bottom"},rm(r,{type:"text",onClick:this.moreTool},rm("div",{style:{fontSize:"14px"}},this.state.moreText))))),rm("div",{className:`${n0} ${this.state.more?ZJ:null}`,ref:this.moreToolRef}))}}var a0="univer-count-bar",i0="univer-count-zoom",o0="univer-count-slider",s0="univer-count-statistic";class l0 extends bZ{constructor(){super(...arguments),this.max=400,this.min=0,this.ref={current:null},this.setValue=(e,t)=>{this.setState((t=>({...e})),t)},this.onChange=e=>{let t=e.target;this.state.onChange&&this.state.onChange(t.value),this.setValue({zoom:t.value}),console.log(t.value),this.ref.current.changeInputValue(0,t.value)},this.handleClick=(e,t)=>{this.setValue({zoom:t})},this.addZoom=()=>{let e=10*(Math.floor(this.state.zoom/10)+1);e>=this.max&&(e=this.max),this.setValue({zoom:e}),this.state.onChange&&this.state.onChange(String(e))},this.reduceZoom=()=>{let e=10*(Math.ceil(this.state.zoom/10)-1);e<=this.min&&(e=this.min),this.setValue({zoom:e}),this.state.onChange&&this.state.onChange(String(e)),this.ref.current.changeInputValue(0,e)}}initialize(e){this.state={zoom:100,content:""}}setZoom(e){e!==this.state.zoom&&(this.setValue({zoom:e}),this.ref.current.changeInputValue(0,e))}componentDidMount(){var e;null==(e=this._context.getObserverManager().getObserver("onCountBarDidMountObservable",ti.SPREADSHEET))||e.notifyObservers(this)}render(e,t){const{zoom:n,content:r}=t,a=this.getComponentRender().renderFunction("ReduceIcon"),i=this.getComponentRender().renderFunction("RegularIcon"),o=this.getComponentRender().renderFunction("Slider"),s=this.getComponentRender().renderFunction("Button"),l=this.getComponentRender().renderFunction("AddIcon");return rm("div",{className:a0},rm(s,{type:"text",className:i0},n),rm(s,{type:"text",onClick:this.addZoom},rm(l,null)),rm("div",{className:o0},rm(o,{ref:this.ref,onChange:this.onChange,value:n,min:this.min,max:this.max,onClick:this.handleClick})),rm(s,{type:"text",onClick:this.reduceZoom},rm(a,null)),rm(s,{type:"text"},rm(i,null)),rm("span",{className:s0},r))}}class c0 extends bZ{initialize(){this.state={modalGroup:[]}}componentDidMount(){var e;null==(e=this._context.getObserverManager().getObserver("onModalGroupDidMountObservable"))||e.notifyObservers(this)}setModalGroup(e){const t=this._context.getPluginManager().getPluginByName(ti.SPREADSHEET),n=e.map((e=>{const n=null==t?void 0:t.getRegisterComponent(e);return n?rm(n,null):null}));this.setState({modalGroup:n})}render(){const{modalGroup:e}=this.state;return rm(im,null,e.map((e=>e)))}}var u0="univer-formula-box",h0="univer-formula-bar",d0="univer-formula-icon",p0="univer-formula-grey",m0="univer-formula-black",_0="univer-formula-input",g0="univer-formula-content";class f0 extends bZ{constructor(){super(...arguments),this.onkeyUp=e=>{},this.printChange=e=>{this.onkeyUp(e.target)}}initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=t.getComponentRender(),this.Render.renderFunction("NextIcon"),this.state={data:{children:[]},spanClass:p0,formulaContent:""},this.onkeyUp=function(e,t){let n=null;return function(...r){clearTimeout(n),n=setTimeout((()=>{e(...r)}),t)}}(this.onkeyUp,300)}setFormulaContent(e){this.setState({formulaContent:e})}componentDidMount(){var e;null==(e=this._context.getObserverManager().getObserver("onFormulaBarDidMountObservable"))||e.notifyObservers(this)}render(e,t){const{data:n}=t,r=this.Render.renderFunction("CloseIcon"),a=this.Render.renderFunction("CorrectIcon"),i=this.Render.renderFunction("FxIcon");return rm("div",{className:u0},rm(GJ,{children:n.children}),rm("div",{className:h0},rm("div",{className:d0},rm("span",{className:t.spanClass},rm(r,null)),rm("span",{className:t.spanClass},rm(a,null)),rm("span",{className:m0},rm(i,null))),rm("div",{className:_0},rm("div",{autoFocus:!0,contentEditable:!0,className:g0,onKeyUp:e=>this.printChange(e)},t.formulaContent))))}}const y0={outerLeft:!1,outerRight:!0,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!0,frozenHeaderRT:!0,frozenHeaderLM:!0,frozenContent:!0,infoBar:!0,formulaBar:!0,toolBar:!0,sheetBar:!0,countBar:!0,toolBarConfig:{undoRedo:!0,paintFormat:!0,currencyFormat:!0,percentageFormat:!0,numberDecrease:!0,numberIncrease:!0,moreFormats:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,border:!0,mergeCell:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0,image:!0,link:!0,chart:!0,comment:!0,pivotTable:!0,function:!0,frozenMode:!0,sortAndFilter:!0,conditionalFormat:!0,dataValidation:!0,splitColumn:!0,screenshot:!0,findAndReplace:!0,protection:!0,print:!0},contentSplit:!1};class v0 extends bZ{constructor(e){super(e,{coreContext:e.config.context}),this.splitLeftRef={current:null},this.rightRef={current:null},this.menuRef={current:null},this.cellRightRef={current:null},this.btnRef={current:null},this.contentRef={current:null},this.layoutContainerRef={current:null},this.containerRef={current:null},this.refMap={},this.resizeSplitContent=()=>{},this.handleSplitBarMouseDown=e=>{var t,n,r,a,i;this.leftContentLeft=null==(t=this.splitLeftRef.current)?void 0:t.getBoundingClientRect().left,this.leftContentTop=null==(n=this.splitLeftRef.current)?void 0:n.getBoundingClientRect().top;const o=null==(r=this.splitLeftRef.current)?void 0:r.parentElement;this.rightBorderX=null==(a=null==o?void 0:o.getBoundingClientRect())?void 0:a.width,this.rightBorderY=null==(i=null==o?void 0:o.getBoundingClientRect())?void 0:i.height,document.addEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.addEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleSplitBarMouseMove=e=>{let t=(e=e||window.event).clientX-this.leftContentLeft,n=e.clientY-this.leftContentTop;t=t>=this.rightBorderX?this.rightBorderX:t,n=n>=this.rightBorderY?this.rightBorderY:n,"vertical"===this.state.layout.contentSplit?this.splitLeftRef.current.style.height=`${n}px`:this.splitLeftRef.current.style.width=`${t}px`},this.handleSplitBarMouseUp=e=>{document.removeEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.removeEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleContentClick=e=>{};const{container:t,skin:n,layout:r,context:a,addSider:i,addMain:o,showSiderByName:s,showMainByName:l}=e.config;i(this.addSider.bind(this)),o(this.addMain.bind(this)),s(this.showSiderByName.bind(this)),l(this.showMainByName.bind(this));const c=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=c.getComponentRender(),this.setSkin(t,n),this.state={layout:"auto"===r?_a.deepClone(y0):_a.deepMerge(y0,r),currentLocale:a.getLocale().options.currentLocale,currentSkin:n,printVisible:!0,isCellEditorVisible:!1,siderPanelList:[],mainList:[],showSider:!1,renderState:0}}changeLocale(e){var t;const n=e.target.value;this.props.config.context.getLocale().change(n),this.setState({currentLocale:n}),null==(t=this.props.config.context.getContextObserver("onAfterChangeUILocaleObservable"))||t.notifyObservers()}setSkin(e,t){let n=document.documentElement;let r={default:lJ,dark:cJ,green:uJ}[t];if(r=Object.fromEntries(Object.keys(r).map((e=>[`--${e.replace(/([A-Z])/g,"-$1").toLowerCase()}`,r[e]]))),_a.isIEBrowser())JQ({rootElement:n,variables:r});else{(function(e){const t="universheet-skin-style";for(let n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].title===t)return a(document.styleSheets[n],e),document.styleSheets[n];const n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");return r.title=t,n.appendChild(r),document.styleSheets[document.styleSheets.length-1]})(e.id).insertRule(`#${e.id} ${JSON.stringify(r).replace(/"/g,"").replace(/,(?=--)/g,";")}`)}function a(e,t){let n=0;for(let r=0;r<e.cssRules.length;r++){const a=e.cssRules[r];if(a instanceof CSSStyleRule&&a.selectorText===`#${t}`){n=r,e.deleteRule(n);break}}}}changeSkin(e){var t;const n=e.target.value;this.setSkin(this.props.config.container,n),this.setState({currentSkin:n}),null==(t=this.props.config.context.getObserverManager().getObserver("onAfterChangeUISkinObservable"))||t.notifyObservers(this.props.config.context.getWorkBook())}addSider(e){return new Promise((t=>{this.setState((t=>{const n=Object.assign(e,{show:!1,zIndex:t.siderPanelList.length+1});return{siderPanelList:[...t.siderPanelList,n]}}),(()=>{t()}))}))}addMain(e){return new Promise((t=>{this.setState((t=>{const n=Object.assign(e,{show:!1,zIndex:t.mainList.length+1});return{mainList:[...t.mainList,n]}}),(()=>{t()}))}))}showSiderByName(e,t){return new Promise((n=>{this.setState((n=>{let r=!1,a=0,i=n.siderPanelList.map((t=>(t.name===e&&(a=t.zIndex),t.zIndex)));return{siderPanelList:n.siderPanelList.map((n=>(n.name===e?(n.show=t,n.zIndex=Math.max(...i)):n.zIndex>a&&n.zIndex--,n.show&&(r=!0),n))),showSider:r}}),(()=>{n()}))}))}showMainByName(e,t){return new Promise((n=>{this.setState((n=>({mainList:n.mainList.map((n=>(n.name===e&&(n.show=t),n)))})),(()=>{n()}))}))}componentWillUnmount(){}componentDidMount(){this.props.config.getSplitLeftRef(this.splitLeftRef),this.props.config.getContentRef(this.contentRef),this.props.config.onDidMount(),this.setState((e=>({...e,renderState:1})),(()=>{var e;null==(e=this.getContext().getPluginManager().getRequirePluginByName(ti.SPREADSHEET).getObserver("onSheetContainerDidMountObservable"))||e.notifyObservers(this)}))}render(){const{addButton:e,context:t}=this.props.config,{layout:n,currentLocale:r,currentSkin:a,siderPanelList:i,mainList:o,showSider:s,renderState:l}=this.state;return rm(PK.Provider,{value:{locale:t.getLocale(),currentLocale:t.getLocale().options.currentLocale,coreContext:t}},rm(gx,{ref:this.layoutContainerRef,className:EJ},rm(E$,null,rm(R$,{style:{display:n.outerLeft?"block":"none"}}),rm(E$,{className:MJ,style:{position:"relative"}},rm(A$,{style:{display:n.header?"block":"none"}},n.infoBar&&rm(CJ,null),n.toolBar&&rm(r0,{toolList:[]}),n.formulaBar&&rm(f0,null)),rm(E$,null,rm(R$,{style:{display:n.innerLeft?"block":"none"}}),rm(D$,{className:"vertical"===n.contentSplit?NJ:AJ},rm(c0,null),!!n.contentSplit&&rm(gx,{ref:this.splitLeftRef,className:SJ},rm("div",{className:DJ,onMouseDown:this.handleSplitBarMouseDown})),rm(gx,{ref:this.contentRef,className:RJ,onClick:this.handleContentClick},rm(mJ,null),rm("div",{style:{position:"fixed",right:"200px",top:"10px",fontSize:"14px"}},rm("span",{style:{display:"inline-block",width:50,margin:"5px 0 0 5px"}},"皮肤"),rm("select",{value:a,onChange:this.changeSkin.bind(this),style:{width:55}},rm("option",{value:"default"},"默认"),rm("option",{value:"dark"},"暗黑"),rm("option",{value:"green"},"绿色")),rm("span",{style:{display:"inline-block",width:50,margin:"5px 0 0 5px"}},"语言"),rm("select",{value:r,onChange:this.changeLocale.bind(this),style:{width:55}},rm("option",{value:"en"},"English"),rm("option",{value:"zh"},"中文")),rm("span",{style:{visibility:"hidden"}},l)))),rm(R$,{style:{display:n.innerRight?"block":"none"}})),rm(S$,{style:{display:n.footer?"block":"none"}},n.countBar&&rm(l0,null))),rm(R$,{style:{display:n.outerRight&&s?"block":"none"},className:OJ},i.map(((e,t)=>e.type===HK.JSX?Am(e.label,{style:{display:e.show?"":"none",zIndex:e.zIndex}}):e))))))}}class b0{_removeAntLineModelBySheetId(e){const t=this._antLineModelList.findIndex((t=>t.getSheetId()!==e));t>-1&&this._antLineModelList.splice(t,1)}_findAntLineModelBySheetId(e,t){var n;return null!=(n=this._antLineModelList.find((t=>t.getSheetId()===e)))?n:t}_saveOrUpdateAntLineModel(e){for(let t=0;t<this._antLineModelList.length;t++){if(this._antLineModelList[t].getSheetId()===e.getSheetId())return void(this._antLineModelList[t]=e)}this._antLineModelList.push(e)}_createAntLineRectBySheetIdAndRange(e,t){let n=this.getWorkBook().getSheetBySheetId(e);if(null==n)throw new Error(`not found sheet from id: ${e}`);let r=n.getConfig().rowTitle.width,a=n.getConfig().columnTitle.height,i=n.getRowManager(),o=n.getColumnManager(),s=0,l=0;for(let e=t.startRow;e<t.endRow;e++)s+=i.getRowHeight(e);for(let e=t.startColumn;e<t.endColumn;e++)l+=o.getColumnWidth(e);let c=0,u=0;for(let e=0;e<=t.startRow-1;e++)u+=i.getRowHeight(e);for(let e=0;e<=t.startColumn-1;e++)c+=o.getColumnWidth(e);return new Sc("__AntLineShape__",{stroke:"red",strokeWidth:2,left:c+r,top:u+a,height:s,width:l,strokeDashArray:[5]})}_deleteSceneAllAntLineRect(){for(let e=0;e<this._antLineModelList.length;e++){let t=this._antLineModelList[e].getAntLineList();for(let e=0;e<t.length;e++){let n=t[e].getRect();n&&this.getSheetViewScene().removeObject(n)}}}_makeUpdateSceneAntLineRect(){this._deleteSceneAllAntLineRect();for(let e=0;e<this._antLineModelList.length;e++){let t=this._antLineModelList[e],n=t.getAntLineList();if(t.getSheetId()===this._activeSheetId)for(let e=0;e<n.length;e++){let r=n[e],a=this._createAntLineRectBySheetIdAndRange(t.getSheetId(),r.getRange());r.setRect(a),console.log(a),this.getSheetViewScene().addObject(a)}}}constructor(e){this._plugin=e,this._antLineModelList=[],e.getContext().getContextObserver("onAfterChangeActiveSheetObservable").add((()=>{this._activeSheetId=e.getWorkbook().getActiveSheet().getSheetId(),this._makeUpdateSceneAntLineRect()})),e.getContext().getContextObserver("onSheetRenderDidMountObservable").add((()=>{this._activeSheetId=e.getWorkbook().getActiveSheet().getSheetId(),this._makeUpdateSceneAntLineRect()}))}removeSheetAntLine(e=this._activeSheetId){this._removeAntLineModelBySheetId(e),this._makeUpdateSceneAntLineRect()}addAntLineToSheet(e,t=this._activeSheetId){const n=this._findAntLineModelBySheetId(t,new _Q(t));n.addAntLine(new mQ(e)),this._saveOrUpdateAntLineModel(n),this._makeUpdateSceneAntLineRect()}getSheetView(){return this._plugin.getCanvasView().getSheetView()}getWorkBook(){return this._plugin.getWorkbook()}getSheetViewScene(){return this._plugin.getCanvasView().getSheetView().getScene()}}const x0={zh:[{n:"SUMIF",t:0,d:"对范围中符合指定条件的值求和。",a:"对范围中符合指定条件的值求和。",m:[2,3],p:[{name:"范围",detail:"要根据条件进行检测的范围。",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"条件",detail:"要应用于范围的模式或测试条件。\n\n如果范围包含的是要检测的文本，则条件必须为字符串。条件可以包含通配符，包括用于匹配单个字符的?或用于匹配零个或连续多个字符的*。要匹配问号星号本身，请在该字符前面加上波浪号(~)前缀（即~?和~*）。字符串条件必须用引号括起来。函数会检查范围中的每个单元格与条件是否相等或匹配（如果使用了通配符）。\n\n如果范围包含的是要检测的数字，则条件可以是字符串也可以是数字。如果给定的条件是一个数字，则检查范围中的每个单元格是否等于条件。另外，条件也可能是包含数字的字符串（也将对其进行相等检测），或者带有以下前缀的数字：=（检查是否相等）、>（检查范围单元格的值是否大于条件值）或<（检查范围单元格的值是否小于条件值）",example:'">20"',require:"m",repeat:"n",type:"rangeAll"},{name:"求和范围",detail:"要求和的范围（如果与范围不同）。",example:"B1:B10",require:"o",repeat:"n",type:"range"}]},{n:"TAN",t:0,d:"返回已知角度的正切值。",a:"返回已知角度的正切值。",m:[1,1],p:[{name:"角度",detail:"要求其正切值的角度，以弧度表示。",example:"45*PI()/180",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TANH",t:0,d:"返回给定实数的双曲正切值。",a:"返回给定实数的双曲正切值。",m:[1,1],p:[{name:"值",detail:"要计算其双曲正切值的实数。",example:"A2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"CEILING",t:0,d:"将数值向上取整为最接近的指定因数的倍数。",a:"将数值向上取整为最接近的指定因数的倍数。",m:[2,2],p:[{name:"值",detail:"要向上舍入的数值。",example:"23.25",require:"m",repeat:"n",type:"rangeNumber"},{name:"因数",detail:"要将值舍入到此数的整数倍。",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ATAN",t:0,d:"返回数值的反正切值，以弧度表示。",a:"返回数值的反正切值",m:[1,1],p:[{name:"值",detail:"要计算其反正切值的数值。",example:"0",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ASINH",t:0,d:"返回数值的反双曲正弦值。",a:"返回数值的反双曲正弦值。",m:[1,1],p:[{name:"值",detail:"要计算其反双曲正弦值的数值。",example:"0.9",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ABS",t:0,d:"返回数值的绝对值。",a:"返回数值的绝对值。",m:[1,1],p:[{name:"value",detail:"要返回其绝对值的数。",example:"-2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ACOS",t:0,d:"返回数值的反余弦值，以弧度表示。",a:"返回数值的反余弦值",m:[1,1],p:[{name:"值",detail:"要计算其反余弦值的数值。必须介于-1和1之间，包括两端值。",example:"0",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ACOSH",t:0,d:"返回数值的反双曲余弦值。",a:"返回数值的反双曲余弦值。",m:[1,1],p:[{name:"值",detail:"要计算其反双曲余弦值的数值。必须大于等于1。",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MULTINOMIAL",t:0,d:"返回参数和的阶乘除以各参数阶乘的乘积后得到的值。",a:"返回参数和的阶乘除以各参数阶乘的乘积后得到的值。",m:[1,255],p:[{name:"值1",detail:"用于计算的第一项数值或范围。",example:"1",require:"m",repeat:"n",type:"rangeAll"},{name:"值2",detail:"用于计算的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"ATANH",t:0,d:"返回数值的反双曲正切值。",a:"返回数值的反双曲正切值。",m:[1,1],p:[{name:"值",detail:"要计算其反双曲正切值的数值。必须介于-1和1之间（不包括-1和1）。",example:"0.9",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ATAN2",t:0,d:"以弧度为单位返回 x 轴与从原点 (0,0) 到指定坐标点 (`x`,`y`) 之间连线的夹角。",a:"以弧度为单位返回 x 轴与从原点 (0,0) 到指定坐标点 (`x`,`y`) 之间连线的夹角。",m:[2,2],p:[{name:"x",detail:"要计算其与x轴夹角大小的线段的终点x坐标。",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"y",detail:"要计算其与x轴夹角大小的线段的终点y坐标。",example:"3",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"COUNTBLANK",t:1,d:"返回给定范围内的空单元格数。",a:"返回给定范围内的空单元格数。",m:[1,1],p:[{name:"范围",detail:"要统计空白单元格数量的范围。",example:"A2:C100",require:"m",repeat:"n",type:"range"}]},{n:"COSH",t:0,d:"返回给定实数的双曲余弦值。",a:"返回给定实数的双曲余弦值。",m:[1,1],p:[{name:"值",detail:"要计算其双曲余弦值的实数值。",example:"A2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"INT",t:0,d:"将数值向下取整为小于或等于该数的最接近的整数。",a:"将数值向下取整为小于或等于该数的最接近的整数。",m:[1,1],p:[{name:"值",detail:"要向下取整为最接近的整数的数值。",example:"99.44",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ISEVEN",t:0,d:"检查所提供的数值是否为偶数。",a:"检查所提供的数值是否为偶数。",m:[1,1],p:[{name:"值",detail:"要验证其是否为偶数的数值。\n\n如果值为偶数或指向包含偶数的单元格的引用，ISEVEN将返回TRUE，否则返回FALSE。",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ISODD",t:0,d:"检查所提供的数值是否为奇数。",a:"检查所提供的数值是否为奇数。",m:[1,1],p:[{name:"值",detail:"要验证其是否为奇数的数值。\n\n如果值为奇数或指向包含奇数的单元格，ISODD将返回TRUE，否则返回FALSE。",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"LCM",t:0,d:"返回一个或多个整数的最小公倍数。",a:"返回一个或多个整数的最小公倍数。",m:[1,255],p:[{name:"值1",detail:"要在求最小公倍数数的计算中检查其因数的第一项数值或范围。",example:"A2:A5",require:"m",repeat:"n",type:"rangeAll"},{name:"值2",detail:"[可选] - 在求最小公倍数时要考虑其因数的其他数值或范围。",example:"3",require:"o",repeat:"y",type:"rangeAll"}]},{n:"LN",t:0,d:"返回数值以 e（欧拉数）为底的对数。",a:"返回数值以 e（欧拉数）为底的对数。",m:[1,1],p:[{name:"值",detail:"要以 e 为底数计算其对数的值。\n\n值必须为正数。",example:"100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"LOG",t:0,d:"根据指定底数返回数字的对数。",a:"根据指定底数返回数字的对数。",m:[1,2],p:[{name:"值",detail:"想要计算其对数的正实数。",example:"128",require:"m",repeat:"n",type:"rangeNumber"},{name:"底数",detail:"[可选] - 对数的底数。",example:"2",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"LOG10",t:0,d:"返回数值以10为底的对数。",a:"返回数值以10为底的对数。",m:[1,1],p:[{name:"值",detail:"要计算其以10为底的对数的数值。\n\n值必须为正值。",example:"100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MOD",t:0,d:"返回两数相除的余数, 结果的符号与除数相同。",a:"返回两数相除的余数。",m:[2,2],p:[{name:"被除数",detail:"要将其相除以得到余数的数值。",example:"10",require:"m",repeat:"n",type:"rangeNumber"},{name:"除数",detail:"用于除其他数的数值。",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MROUND",t:0,d:"将数值取整为另一整数最接近的整数倍。",a:"将数值取整为另一整数最接近的整数倍。",m:[2,2],p:[{name:"值",detail:"要取整为另一整数最接近的整数倍的数值。",example:"21",require:"m",repeat:"n",type:"rangeNumber"},{name:"因数",detail:"值将取此因数的整数倍。",example:"14",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ODD",t:0,d:"将数值向上取整为最接近的奇整数。",a:"将数值向上取整为最接近的奇整数。",m:[1,1],p:[{name:"值",detail:"要向上取整的数值，取整值为大于此值的最接近的奇数。\n\n如果值为负数，则将其取整为绝对值大于该值的相邻负奇数。",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SUMSQ",t:0,d:"返回一组数值和/或单元格的平方总和。",a:"返回一组数值和/或单元格的平方总和。",m:[1,255],p:[{name:"值1",detail:"要将其平方相加的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"值2, ...",detail:"[可选] - 要将其平方与值1的平方相加的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"COMBIN",t:0,d:"给定集合中的对象总数和要选择的对象数量，返回共有多少种不同选择方式。",a:"给定集合中的对象总数和要选择的对象数量",m:[2,2],p:[{name:"n",detail:"要从中进行选择的对象集合的大小。",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"k",detail:"要选择的对象数量。",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SUM",t:0,d:"返回一组数值和/或单元格的总和。",a:"返回一组数值和/或单元格的总和。",m:[1,255],p:[{name:"值1",detail:"要相加的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"值2",detail:"[可选] - 要相加的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"SUBTOTAL",t:0,d:"使用指定的汇总函数，返回一系列纵向单元格的分类汇总。",a:"使用指定的汇总函数",m:[2,256],p:[{name:"函数代码",detail:"用于计算分类汇总的函数。\n\n1代表AVERAGE\n\n2代表COUNT\n\n3代表COUNTA\n\n4代表MAX\n\n5代表MIN\n\n6代表PRODUCT\n\n7代表STDEV\n\n8代表STDEVP\n\n9代表SUM\n\n10代表VAR\n\n11代表VARP\n\n通过在这些2位代码前附加10（对于1位代码）或1（对于2位代码），可以将隐藏值忽略。例如，102代表忽略隐藏单元格的COUNT，而110则代表忽略隐藏值的VAR。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"范围1",detail:"要计算分类汇总的第一个范围。",example:"A2:A5",require:"m",repeat:"n",type:"range"},{name:"范围2",detail:"[可选] - 要计算分类汇总的其他范围。",example:"B2:B8",require:"o",repeat:"y",type:"range"}]},{n:"ASIN",t:0,d:"返回数值的反正弦值，以弧度表示。",a:"返回数值的反正弦值",m:[1,1],p:[{name:"值",detail:"要计算其反正弦值的数值。必须介于-1和1之间，包括两端值。",example:"0",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"COUNTIF",t:1,d:"返回范围内满足某个条件的单元格的数量。",a:"返回范围内满足某个条件的单元格的数量。",m:[2,2],p:[{name:"范围",detail:"要根据条件进行检测的范围。",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"条件",detail:"要应用于范围的模式或测试条件。\n\n如果范围包含的是要检测的文本，则条件必须为字符串。条件可以包含通配符，包括用于匹配单个字符的?或用于匹配零个或连续多个字符的*。要匹配问号星号本身，请在该字符前面加上波浪号(~)前缀（即~?和~*）。字符串条件必须用引号括起来。函数会检查范围中的每个单元格与条件是否相等或匹配（如果使用了通配符）。\n\n如果范围包含的是要检测的数字，则条件可以是字符串也可以是数字。如果给定的条件是一个数字，则检查范围中的每个单元格是否等于条件。另外，条件也可能是包含数字的字符串（也将对其进行相等检测），或者带有以下前缀的数字：=、>、>=、<或<=，这些条件将分别用于检查范围中的单元格是否等于、大于、大于等于、小于、小于等于条件值。",example:'">20"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"RADIANS",t:0,d:"将以度表示的角度值转换为弧度。",a:"将以度表示的角度值转换为弧度。",m:[1,1],p:[{name:"角度",detail:"要从度转换为弧度的角度。",example:"180",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"RAND",t:0,d:"返回一个介于0和1之间（包括0但不包括1）的随机数。",a:"返回一个介于0和1之间（包括0但不包括1）的随机数。",m:[0,0],p:[]},{n:"COUNTUNIQUE",t:0,d:"计算一列指定值和范围中不重复数值的个数。",a:"计算一列指定值和范围中不重复数值的个数。",m:[1,255],p:[{name:"值1",detail:"要检查其是否唯一的第一个值或范围。",example:"A1:C100",require:"m",repeat:"n",type:"rangeAll"},{name:"值2",detail:"[可选] - 要检查是否唯一的其他值或范围。",example:"1",require:"o",repeat:"n",type:"rangeAll"}]},{n:"DEGREES",t:0,d:"将以弧度表示的角度值转换为度。",a:"将以弧度表示的角度值转换为度。",m:[1,1],p:[{name:"角度",detail:"要从弧度转换为度的角度。",example:"PI()",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ERFC",t:9,d:"返回数值的互补高斯误差函数。",a:"返回数值的互补高斯误差函数。",m:[1,1],p:[{name:"z",detail:"要为其计算互补高斯误差函数的数值。",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"EVEN",t:0,d:"将数值向上取整为最接近的偶整数。",a:"将数值向上取整为最接近的偶整数。",m:[1,1],p:[{name:"值",detail:"要向上取整的数值，取整值为大于此值的最接近的偶数。\n\n如果值为负数，则将其取整为绝对值大于该值的相邻负偶数。",example:"3",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"EXP",t:0,d:"返回欧拉数 e (~2.718) 的指定次幂。",a:"返回欧拉数 e (~2.718) 的指定次幂。",m:[1,1],p:[{name:"指数",detail:"指定e的自乘幂次值。",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"FACT",t:0,d:"返回数值的阶乘。",a:"返回数值的阶乘。",m:[1,1],p:[{name:"值",detail:"要计算并返回其阶乘的数字或对数字（所在单元格）的引用。",example:"3",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"FACTDOUBLE",t:0,d:"返回数值的“双阶乘”。",a:"返回数值的“双阶乘”。",m:[1,1],p:[{name:"值",detail:"要计算并返回其双阶乘的数字或对数字（所在单元格）的引用。",example:"6",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"PI",t:0,d:"返回带有14位小数的 PI 值。",a:"返回带有14位小数的 PI 值。",m:[0,0],p:[]},{n:"FLOOR",t:0,d:"将数值向下取整为指定因数的最接近的整数倍。",a:"将数值向下取整为指定因数的最接近的整数倍。",m:[2,2],p:[{name:"值",detail:"要向下舍入为因数的最接近整数倍的数值。",example:"23.25",require:"m",repeat:"n",type:"rangeNumber"},{name:"因数",detail:"要将值舍入到此数的整数倍。\n\n因数不得为0。",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"GCD",t:0,d:"返回一个或多个整数的最大公约数。",a:"返回一个或多个整数的最大公约数。",m:[1,255],p:[{name:"值1",detail:"要在查找最大公约数的计算中检查其因数的第一项数值或范围。",example:"A2:A5",require:"m",repeat:"n",type:"rangeAll"},{name:"值2",detail:"[可选] - 在求最大公约数时要考虑其因数的其他数值或范围。",example:"96",require:"o",repeat:"y",type:"rangeAll"}]},{n:"RANDBETWEEN",t:0,d:"返回介于两个整数之间（包括这两个整数）的随机数。",a:"返回介于两个整数之间（包括这两个整数）的随机数。",m:[2,2],p:[{name:"下界",detail:"随机值范围的下界。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"上界",detail:"随机值范围的上界。",example:"10",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ROUND",t:0,d:"将数字四舍五入到指定的位数。",a:"将数字四舍五入到指定的位数。",m:[2,2],p:[{name:"值",detail:"要四舍五入的数字。",example:"99.44",require:"m",repeat:"n",type:"rangeNumber"},{name:"位数",detail:"要进行四舍五入运算的位数。\n\n位数可以取负值，在这种情况下会将值的小数点左侧部分舍入到指定的位数。",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ROUNDDOWN",t:0,d:"朝着零的方向将数字进行向下舍入。",a:"朝着零的方向将数字进行向下舍入。",m:[2,2],p:[{name:"值",detail:"需要向下舍入的任意实数。",example:"99.44",require:"m",repeat:"n",type:"rangeNumber"},{name:"位数",detail:"要通过舍入达到的小数位数。\n\n位数可以取负值，在这种情况下会将值的小数点左侧部分舍入到指定的位数。",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ROUNDUP",t:0,d:"朝着远离 0（零）的方向将数字进行向上舍入。",a:"朝着远离 0（零）的方向将数字进行向上舍入。",m:[2,2],p:[{name:"值",detail:"要将其舍入为位数位数字的值，始终向上舍入。",example:"99.44",require:"m",repeat:"n",type:"rangeNumber"},{name:"位数",detail:"要通过舍入达到的小数位数。\n\n位数可以取负值，在这种情况下会将值的小数点左侧部分舍入到指定的位数。",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SERIESSUM",t:0,d:"给定参数 x、n、m 和 a，返回幂级数的和 a1xn + a2x(n+m) + ... + aix(n+(i-1)m)，其中 i 为范围 a 中的项数。",a:"给定参数 x、n、m 和 a",m:[4,4],p:[{name:"x",detail:"幂级数的输入值。随相应的近似类型而变，有可能为角度、指数或其他一些值。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"n",detail:"在幂级数中x的初始自乘幂次。",example:"0",require:"m",repeat:"n",type:"rangeNumber"},{name:"m",detail:"x的幂次中的附加增量。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"a",detail:"包含幂级数系数的数组或范围。",example:"{FACT(0)",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SIGN",t:0,d:"给定输入数值，如果为负返回-1；如果为正返回1；如果为零则返回0。",a:"给定输入数值",m:[1,1],p:[{name:"值",detail:"要返回其符号的数值。",example:"-42",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SIN",t:0,d:"给定角度（以弧度表示），返回其正弦值。",a:"给定角度（以弧度表示）",m:[1,1],p:[{name:"角度",detail:"要返回其正弦值的角度，以弧度表示。",example:"PI()",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SINH",t:0,d:"返回给定实数的双曲正弦值。",a:"返回给定实数的双曲正弦值。",m:[1,1],p:[{name:"值",detail:"要计算其双曲正弦值的实数值。",example:"A2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SQRT",t:0,d:"返回一个正数的正平方根。",a:"返回一个正数的正平方根。",m:[1,1],p:[{name:"值",detail:"要计算其正平方根的数值。\n\n值必须为正数；如果为负，SQRT 将返回 #NUM! 错误。",example:"9",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SQRTPI",t:0,d:"返回 PI 与给定正数乘积的正平方根。",a:"返回 PI 与给定正数乘积的正平方根。",m:[1,1],p:[{name:"值",detail:"要将其与 PI 相乘并返回该乘积的平方根的数值\n\n值必须为正数；如果为负数，SQRTPI 将返回 #NUM! 错误。",example:"9",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"GAMMALN",t:1,d:"返回指定伽玛函数的以 e（欧拉数）为底的对数。",a:"返回指定伽玛函数的以 e（欧拉数）为底的对数。",m:[1,1],p:[{name:"值",detail:"伽玛函数的输入值。返回的将是伽玛 (值) 的自然对数。\n\n值必须为正数。",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"COS",t:0,d:"返回给定角度的余弦值（角度以弧度表示）。",a:"返回给定角度的余弦值（角度以弧度表示）。",m:[1,1],p:[{name:"角度",detail:"要取其余弦值的角度，以弧度表示。",example:"PI()",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TRUNC",t:0,d:"截除指定有效位之外的部分，取数据的指定有效位。",a:"截除指定有效位之外的部分",m:[1,2],p:[{name:"值",detail:"要截取的数据。",example:"3.141592654",require:"m",repeat:"n",type:"rangeNumber"},{name:"位数",detail:"[可选 - 默认值为0] - 小数点右侧要保留的有效位数。\n\n如果位数大于值中的有效位数，则将“值”原样返回。\n\n位数可以取负值，在这种情况下会将小数点左侧指定位数的值更改为零。小数点右侧的所有位数都会被舍弃。如果值的所有位都被更改为零，则TRUNC会返回0。",example:"2",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"QUOTIENT",t:0,d:"返回以一个数除以另一个数所得的结果，不包含余数。",a:"返回以一个数除以另一个数所得的结果",m:[2,2],p:[{name:"被除数",detail:"要被除的数值。",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"除数",detail:"用于除其他数的数值。\n\n除数不得为0。",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"POWER",t:0,d:"返回数值的指定次幂。",a:"返回数值的指定次幂。",m:[2,2],p:[{name:"底数",detail:"要计算其指数次幂的数值。\n\n如果底数为负，则指数必须为整数。",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"指数",detail:"指定底数的自乘幂次值。",example:"0.5",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SUMIFS",t:0,d:"根据多项条件返回范围之和。",a:"根据多项条件返回范围之和。",m:[3,257],p:[{name:"求和范围",detail:"要对其求和的范围。",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"条件范围1",detail:"要在哪个范围内检查条件1。",example:" B1:B10",require:"m",repeat:"n",type:"range"},{name:"条件1",detail:"要应用于条件范围1的模式或测试条件。",example:' ">20"',require:"m",repeat:"n",type:"rangeAll"},{name:"条件范围2, 条件2...",detail:"[ 可选 ] - 要检查的其他范围和条件。",example:" C1:C10",require:"o",repeat:"y",type:"rangeAll"}]},{n:"COUNTIFS",t:1,d:"根据多项条件返回范围中的单元格数量。",a:"根据多项条件返回范围中的单元格数量。",m:[2,256],p:[{name:"条件范围1",detail:"要在哪个范围内检查条件1。",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"条件1",detail:"要应用于条件范围1的模式或测试条件。",example:' ">20"',require:"m",repeat:"n",type:"rangeAll"},{name:"条件范围2, 条件2...",detail:"[ 可选 ] - 要检查的其他范围和条件，可重复。",example:" B1:B10",require:"o",repeat:"y",type:"rangeAll"}]},{n:"PRODUCT",t:0,d:"返回将一组数相乘所得的结果。",a:"返回将一组数相乘所得的结果。",m:[1,255],p:[{name:"乘数1",detail:"用于计算乘积的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"乘数2 ... 乘数30",detail:"[可选] - 要相乘的其他数值。",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"HARMEAN",t:1,d:"计算数据集的调和平均值。",a:"计算数据集的调和平均值。",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"HYPGEOMDIST",t:1,d:"返回超几何分布。 如果已知样本量、总体成功次数和总体大小，则 HYPGEOM.DIST 返回样本取得已知成功次数的概率。",a:"返回超几何分布。",m:[5,5],p:[{name:"Sample_s",detail:"样本中成功的次数。",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"Number_sample",detail:"样本量。",example:"12",require:"m",repeat:"n",type:"rangeNumber"},{name:"Population_s",detail:"总体中成功的次数。",example:"20",require:"m",repeat:"n",type:"rangeNumber"},{name:"Number_pop",detail:"总体大小。",example:"40",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"决定函数形式的逻辑值。\n\n如果 cumulative 为 TRUE()，则 HYPGEOM.DIST 返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"TRUE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"INTERCEPT",t:1,d:"计算数据集的线性回归方程直线与 Y 轴的相交点 (x=0) 的 y 值。",a:"计算数据集的线性回归方程直线与 Y 轴的相交点 (x=0) 的 y 值。",m:[2,2],p:[{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"KURT",t:1,d:"计算数据集的峭度，该指标指示数据集（分布）的形态，尤其是该形态的陡峭程度。",a:"计算数据集的峭度",m:[1,255],p:[{name:"值1",detail:"数据集中的第一个值或范围。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"LARGE",t:1,d:"返回数据集中第 n 个最大元素，n 由用户指定。",a:"返回数据集中第 n 个最大元素",m:[2,2],p:[{name:"数据",detail:"包含相关数据集的数组或范围。",example:"A2:B100",require:"m",repeat:"n",type:"rangeNumber"},{name:"n",detail:"要返回的元素的排行位置（从大到小顺序）。\n\n例如，将n设为4将使LARGE返回数据中排名第4的最大元素。",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"STDEVA",t:1,d:"基于样本计算标准偏差，将文本取值为0。",a:"基于样本计算标准偏差",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"值2,…",detail:"[可选] - 样本中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"STDEVP",t:1,d:"基于样本总体计算标准偏差。",a:"基于样本总体计算标准偏差。",m:[1,255],p:[{name:"值1",detail:"数据集中的第一个值或范围。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"GEOMEAN",t:1,d:"计算数据集的几何平均值。",a:"计算数据集的几何平均值。",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangeAll"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"RANK_EQ",t:1,d:"返回指定值在数据集中的排名。如果相同的值在数据集中存在多项，则返回其中的最高排名。",a:"返回指定值在数据集中的排名。如果相同的值在数据集中存在多项，则返回其中的最高排名。",m:[2,3],p:[{name:"number",detail:"要确定其排名的值。",example:"A10",require:"m",repeat:"n",type:"rangeNumber"},{name:"ref",detail:"包含相关数据集的数组或范围。",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"order",detail:"[可选 - 默认为按降序 (FALSE()) ] - 要按升序还是按降序考虑“data”中的值。",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"RANK_AVG",t:1,d:"返回指定值在数据集中的排名。如果相同的值在数据集中存在多项，则返回这些项排名的平均值。",a:"返回指定值在数据集中的排名。如果相同的值在数据集中存在多项，则返回这些项排名的平均值。",m:[2,3],p:[{name:"number",detail:"要确定其排名的值。",example:"A10",require:"m",repeat:"n",type:"rangeNumber"},{name:"ref",detail:"包含相关数据集的数组或范围。",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"order",detail:"[可选 - 默认为按降序 (FALSE()) ] - 要按升序还是按降序考虑“data”中的值。",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"PERCENTRANK_EXC",t:1,d:"以百分数形式返回指定值在给定数据集中的百分比排名（介于0和1之间，不包括两端值）。",a:"以百分数形式返回指定值在给定数据集中的百分比排名（介于0和1之间，不包括两端值）。",m:[2,3],p:[{name:"data",detail:"包含相关数据集的数组或范围。",example:"A1:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"x",detail:"要确定其百分比排位的值。",example:"A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"significance",detail:"[可选 - 默认值为 3] - 要在计算中使用的有效位数。",example:"4",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"PERCENTRANK_INC",t:1,d:"以百分比形式返回指定值在给定数据集中的百分比排名（介于0和1之间，包括两端值）。",a:"以百分比形式返回指定值在给定数据集中的百分比排名（介于0和1之间，包括两端值）。",m:[2,3],p:[{name:"data",detail:"包含相关数据集的数组或范围。",example:"A1:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"x",detail:"要确定其百分比排位的值。",example:" A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"significance",detail:"[可选 - 默认值为 3] - 要在计算中使用的有效位数。",example:"4",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"FORECAST",t:1,d:"基于数据集的线性回归，计算指定 x 的预期 y 值。",a:"基于数据集的线性回归",m:[3,3],p:[{name:"x",detail:"x轴上用于预测的值。",example:"A1",require:"m",repeat:"n",type:"rangeNumber"},{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"FISHERINV",t:1,d:"返回指定数值的 Fisher 逆变换。",a:"返回指定数值的 Fisher 逆变换。",m:[1,1],p:[{name:"y",detail:"要计算其Fisher逆变换的数值。",example:"0.962",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"FISHER",t:1,d:"返回指定数值的 Fisher 变换。",a:"返回指定数值的 Fisher 变换。",m:[1,1],p:[{name:"x",detail:"要计算其Fisher变换的数值。",example:"0.962",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MODE_SNGL",t:1,d:"返回数据集中出现次数最多的值。",a:"返回数据集中出现次数最多的值。",m:[1,255],p:[{name:"值1",detail:"计算模式时要检查的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"值2, ...",detail:"[可选] - 在计算模式时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"WEIBULL_DIST",t:1,d:"给定形状和尺度，返回韦伯分布函数（或韦伯累积分布函数）的值。",a:"给定形状和尺度",m:[4,4],p:[{name:"x",detail:"WEIBULL 分布函数的输入值。",example:"2.4",require:"m",repeat:"n",type:"rangeNumber"},{name:"alpha",detail:"Weibull 分布函数的形状参数。\n\nalpha 值必须大于 0。",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"beta",detail:"Weibull 分布函数的尺度参数。\n\nbeta 值必须大于 0。",example:"3",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"TRUE() 表示使用累积分布函数，FALSE() 则表示使用概率密度函数。",example:"TRUE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"COUNT",t:1,d:"返回数据集中数值的个数。",a:"返回数据集中数值的个数。",m:[1,255],p:[{name:"值1",detail:"计数时要检查的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"值2, ...",detail:"[可选] - 在计数时要检查的其他值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeAll"}]},{n:"COUNTA",t:1,d:"返回数据集中值的数量。",a:"返回数据集中值的数量。",m:[1,255],p:[{name:"值1",detail:"计数时要检查的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"值2, ...",detail:"[可选] - 在计数时要检查的其他值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeAll"}]},{n:"AVEDEV",t:1,d:"计算数据与数据集均值之间的偏差大小的平均值。",a:"计算数据与数据集均值之间的偏差大小的平均值。",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"值2, ...",detail:"[可选] - 样本中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"AVERAGE",t:1,d:"返回数据集的算术平均值，对文本忽略不计。",a:"返回数据集的算术平均值",m:[1,255],p:[{name:"值1",detail:"计算平均值时用到的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"值2, ...",detail:"[可选] - 在计算平均值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeAll"}]},{n:"AVERAGEA",t:1,d:"返回数据集的算术平均值。",a:"返回数据集的算术平均值。",m:[1,255],p:[{name:"值1",detail:"计算平均值时用到的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"值2, ...",detail:"[可选] - 在计算平均值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeAll"}]},{n:"BINOM_DIST",t:1,d:"返回一元二项式分布的概率。",a:"返回一元二项式分布的概率。",m:[4,4],p:[{name:"number_s",detail:"试验的成功次数。",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"trials",detail:"独立检验的次数。",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"probability_s",detail:"任一给定检验的成功概率。",example:"0.005",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"是否使用二项式累积分布。",example:"FALSE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"BINOM_INV",t:1,d:"计算累积二项式分布大于或等于指定条件的最小值。",a:"计算累积二项式分布大于或等于指定条件的最小值。",m:[3,3],p:[{name:"trials",detail:"贝努利试验次数。",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"probability_s",detail:"任一次给定检验的成功概率。",example:"0.005",require:"m",repeat:"n",type:"rangeNumber"},{name:"alpha",detail:"期望的临界概率。",example:"0.8",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"CONFIDENCE_NORM",t:1,d:"计算正态分布的置信区间的一半宽度。",a:"计算正态分布的置信区间的一半宽度。",m:[3,3],p:[{name:"alpha",detail:"用来计算置信水平的显著性水平。\n\n置信水平等于 100*(1 - alpha)%，亦即，如果 alpha 为 0.05，则置信水平为 95%。",example:"0.05",require:"m",repeat:"n",type:"rangeNumber"},{name:"standard_dev",detail:"数据区域的总体标准偏差。",example:"1.6",require:"m",repeat:"n",type:"rangeNumber"},{name:"size",detail:"样本总量的大小。",example:"250",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"CORREL",t:1,d:"计算给定数据集的皮尔逊积矩相关系数 r。",a:"计算给定数据集的皮尔逊积矩相关系数 r。",m:[2,2],p:[{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"COVARIANCE_P",t:1,d:"计算数据集的总体协方差。",a:"计算数据集的总体协方差。",m:[2,2],p:[{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"},{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"COVARIANCE_S",t:1,d:"计算数据集的样本协方差。",a:"计算数据集的样本协方差。",m:[2,2],p:[{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DEVSQ",t:1,d:"基于样本计算其偏差的平方和。",a:"基于样本计算其偏差的平方和。",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"值2, ...",detail:"[可选] - 样本中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"EXPON_DIST",t:1,d:"返回带有指定 Lambda 和指定值的指数分布函数的值。",a:"返回带有指定 Lambda 和指定值的指数分布函数的值。",m:[3,3],p:[{name:"x",detail:"指数分布函数的输入值。",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"lambda",detail:"用于指定指数分布函数的 lambda 值。",example:"0.5",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"是否使用指数累积分布。",example:"FALSE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"AVERAGEIF",t:1,d:"根据条件返回范围的平均值。",a:"根据条件返回范围的平均值。",m:[2,3],p:[{name:"criteria_range",detail:"要对其检查 criterion 的范围。",example:"A1:A10",require:"m",repeat:"n",type:"rangeAll"},{name:"criterion",detail:'要应用于 criteria_range 的模式或测试条件。\n\n等于："文本" 或 1 或 "=文本" 或 "=1"\n\n大于：">1"\n\n大于等于：">=1"\n\n小于："<1"\n\n小于等于："<=1"\n\n不等于："<>1"或"<>文本"',example:'">20"',require:"m",repeat:"n",type:"rangeAll"},{name:"average_range",detail:"[可选] - 要计算平均值的范围。如果未提供此参数，则改用 criteria_range 来计算平均值。",example:"B1:B10",require:"o",repeat:"n",type:"rangeAll"}]},{n:"AVERAGEIFS",t:1,d:"根据多项条件返回范围的平均值。",a:"根据多项条件返回范围的平均值。",m:[2,255],p:[{name:"average_range",detail:"要计算平均值的范围。",example:"A1:A10",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria_range1",detail:"要对其检查 criterion1 的范围。",example:" B1:B10",require:"m",repeat:"n",type:"rangeAll"},{name:"criterion1",detail:"要应用于 criteria_range1 的模式或测试条件。",example:' ">20"',require:"m",repeat:"n",type:"rangeAll"},{name:"criteria_range2, criterion2, ...",detail:"[可选] - 要检查的其他范围和条件。",example:" C1:C10",require:"m",repeat:"n",type:"rangeAll"}]},{n:"PERMUT",t:1,d:"返回可从数字对象中选择的给定数目对象的排列数。",a:"返回可从数字对象中选择的给定数目对象的排列数。",m:[2,2],p:[{name:"number",detail:"表示对象个数的整数。",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"number_chosen",detail:"表示每个排列中对象个数的整数。",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TRIMMEAN",t:1,d:"在排除数据集高低两端的部分数据之后计算所得的均值。",a:"在排除数据集高低两端的部分数据之后计算所得的均值。",m:[2,2],p:[{name:"数据",detail:"包含相关数据集的数组或范围。",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"排除比例",detail:"要从数据集的极值部分排除的数据占数据集的比例。\n\n排除比例必须大于等于0且小于1。",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"PERCENTILE_EXC",t:1,d:"返回数组的 K 百分点值，K 介于 0 到 1 之间，不含 0 与 1。",a:"返回数组的 K 百分点值，K 介于 0 到 1 之间，不含 0 与 1。",m:[2,2],p:[{name:"array",detail:"定义相对位置的数组或数据区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"k",detail:"0 到 1 之间的百分点值，不包含 0 和 1。",example:"0.25",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"PERCENTILE_INC",t:1,d:"返回数组的 K 百分点值，K 介于 0 到 1 之间，包含 0 与 1。",a:"返回数组的 K 百分点值，K 介于 0 到 1 之间，包含 0 与 1。",m:[2,2],p:[{name:"array",detail:"定义相对位置的数组或数据区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"k",detail:"0 到 1 之间的百分点值，包含 0 和 1。",example:"0.25",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"PEARSON",t:1,d:"返回皮尔生(Pearson)乘积矩相关系数 r。",a:"返回皮尔生(Pearson)乘积矩相关系数 r。",m:[2,2],p:[{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"NORM_S_INV",t:1,d:"返回标准正态累积分布函数的反函数值。 该分布的平均值为 0，标准偏差为 1。",a:"返回标准正态累积分布函数的反函数值。 该分布的平均值为 0，标准偏差为 1。",m:[1,1],p:[{name:"probability",detail:"对应于正态分布的概率。",example:"0.75",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"NORM_S_DIST",t:1,d:"返回标准正态分布函数（该分布的平均值为 0，标准偏差为 1）。",a:"返回标准正态分布函数（该分布的平均值为 0，标准偏差为 1）。",m:[2,2],p:[{name:"z",detail:"需要计算其分布的数值。",example:"2.4",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"决定函数形式的逻辑值。\n\n如果为 TRUE()，则返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"FALSE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"NORM_INV",t:1,d:"返回指定平均值和标准偏差的正态累积分布函数的反函数值。",a:"返回指定平均值和标准偏差的正态累积分布函数的反函数值。",m:[3,3],p:[{name:"probability",detail:"对应于正态分布的概率。",example:"0.75",require:"m",repeat:"n",type:"rangeNumber"},{name:"mean",detail:"分布的算术平均值。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"standard_dev",detail:"分布的标准偏差。",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"NORM_DIST",t:1,d:"返回指定平均值和标准偏差的正态分布函数。",a:"返回指定平均值和标准偏差的正态分布函数。",m:[4,4],p:[{name:"x",detail:"需要计算其分布的数值。",example:"2.4",require:"m",repeat:"n",type:"rangeNumber"},{name:"mean",detail:"分布的算术平均值。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"standard_dev",detail:"分布的标准偏差。",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"决定函数形式的逻辑值。\n\n如果为 TRUE()，则返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"FALSE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"NEGBINOM_DIST",t:1,d:"返回负二项式分布。",a:"返回负二项式分布。",m:[4,4],p:[{name:"number_f",detail:"要模拟的失败次数。",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"number_s",detail:"要模拟的成功次数。",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"probability_s",detail:"任一次给定检验的成功概率。",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"决定函数形式的逻辑值。\n\n如果为 TRUE()，则返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"FALSE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"MINA",t:1,d:"返回数据集中的最小数值。",a:"返回数据集中的最小数值。",m:[1,255],p:[{name:"值1",detail:"计算最小值时所用的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"值2",detail:"[可选] - 在计算最小值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"MIN",t:1,d:"返回数值数据集中的最小值。",a:"返回数值数据集中的最小值。",m:[1,255],p:[{name:"值1",detail:"计算最小值时所用的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"值2",detail:"[可选] - 在计算最小值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"MEDIAN",t:1,d:"返回数值数据集中的中值。",a:"返回数值数据集中的中值。",m:[1,255],p:[{name:"值1",detail:"计算中值时所用的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"值2",detail:"[可选] - 在计算中值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"MAXA",t:1,d:"返回数据集中的最大数值。",a:"返回数据集中的最大数值。",m:[1,255],p:[{name:"值1",detail:"计算最大值时所用的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"值2, ...",detail:"[可选] - 在计算最大值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"MAX",t:1,d:"返回数值数据集中的最大值。",a:"返回数值数据集中的最大值。",m:[1,255],p:[{name:"值1",detail:"计算最大值时所用的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"值2",detail:"[可选] - 在计算最大值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"LOGNORM_INV",t:1,d:"返回 x 的对数累积分布函数的反函数值。",a:"返回 x 的对数累积分布函数的反函数值。",m:[3,3],p:[{name:"probability",detail:"与对数分布相关的概率，介于 0 与 1 之间（不含 0 与 1）。",example:"0.4",require:"m",repeat:"n",type:"rangeNumber"},{name:"mean",detail:"ln(x) 的平均值。",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"standard_dev",detail:"ln(x) 的标准偏差，正数。",example:"6",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"LOGNORM_DIST",t:1,d:"返回 x 的对数分布函数。",a:"返回 x 的对数分布函数。",m:[4,4],p:[{name:"x",detail:"用来计算函数的值。",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"mean",detail:"ln(x) 的平均值。",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"standard_dev",detail:"ln(x) 的标准偏差，正数。",example:"6",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"决定函数形式的逻辑值。\n\n如果为 TRUE()，则返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"FALSE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"Z_TEST",t:1,d:"返回 z 检验的单尾 P 值。",a:"返回 z 检验的单尾 P 值。",m:[2,3],p:[{name:"array",detail:"用来检验 x 的数组或数据区域。",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"x",detail:"要测试的值。",example:"B2",require:"m",repeat:"n",type:"rangeNumber"},{name:"sigma",detail:"[可选] - 总体（已知）标准偏差。 如果省略，则使用样本标准偏差。",example:"3",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"PROB",t:1,d:"返回区域中的数值落在指定区间内的概率。",a:"返回区域中的数值落在指定区间内的概率。",m:[3,4],p:[{name:"x_range",detail:"具有各自相应概率值的 x 数值区域。",example:"A3:A6",require:"m",repeat:"n",type:"range"},{name:"prob_range",detail:"与 x_range 中的值相关联的一组概率值。",example:"2",require:"m",repeat:"n",type:"range"},{name:"lower_limit",detail:"要计算其概率的数值下界。",example:"3",require:"m",repeat:"n",type:"rangeNumber"},{name:"upper_limit",detail:"[可选 - 默认值为下界] - 要计算其概率的可选数值上界。\n\n如果省略上界，PROB则计算随机选取相应值的次数恰好等于下界的概率。",example:"4",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"QUARTILE_EXC",t:1,d:"基于 0 到 1 之间（不包括 0 和 1）的百分点值返回数据集的四分位数。",a:"基于 0 到 1 之间（不包括 0 和 1）的百分点值返回数据集的四分位数。",m:[2,2],p:[{name:"array",detail:"要求得四分位数值的数组或数字型单元格区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"quart",detail:"要返回第几个四分位值。\n\n1返回数据中最靠近第一个四分位值的值（25%标记）。\n\n2返回数据中最接近中值的值（50%标记）。\n\n3返回数据中最接近第三个四分位值的值（75%标记）。",example:"3",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"QUARTILE_INC",t:1,d:"根据 0 到 1 之间的百分点值（包含 0 和 1）返回数据集的四分位数。",a:"根据 0 到 1 之间的百分点值（包含 0 和 1）返回数据集的四分位数。",m:[2,2],p:[{name:"array",detail:"要求得四分位数值的数组或数字型单元格区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"quart",detail:"要返回第几个四分位值。\n\n0返回数据中的最小值（0%标记）。\n\n1返回数据中最靠近第一个四分位值的值（25%标记）。\n\n2返回数据中最接近中值的值（50%标记）。\n\n3返回数据中最接近第三个四分位值的值（75%标记）。\n\n4返回数据中的最大值（100%标记）。",example:"3",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"POISSON_DIST",t:1,d:"返回泊松分布。",a:"返回泊松分布。",m:[3,3],p:[{name:"x",detail:"事件数。",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"mean",detail:"期望值。非负数",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"一逻辑值，确定所返回的概率分布的形式。\n\n如果为 TRUE()，则返回发生的随机事件数在零（含零）和 x（含 x）之间的累积泊松概率；\n\n如果为 FALSE()，则返回发生的事件数正好是 x 的泊松概率密度函数。",example:"FALSE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"RSQ",t:1,d:"返回皮尔生(Pearson)乘积矩相关系数 r 的平方。",a:"返回皮尔生(Pearson)乘积矩相关系数 r 的平方。",m:[2,2],p:[{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"T_DIST",t:1,d:"返回学生的左尾 t 分布。",a:"返回学生的左尾 t 分布。",m:[3,3],p:[{name:"x",detail:"T-分布函数的输入。",example:"A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"degrees_freedom",detail:"自由度数值。",example:"30",require:"m",repeat:"n",type:"rangeNumber"},{name:"tails",detail:"决定函数形式的逻辑值。\n\n如果 cumulative 为 TRUE()，则 HYPGEOM.DIST 返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"TRUE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"T_DIST_2T",t:1,d:"返回学生的双尾 t 分布。",a:"返回学生的双尾 t 分布。",m:[2,2],p:[{name:"x",detail:"T-分布函数的输入。",example:"A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"degrees_freedom",detail:"自由度数值。",example:"30",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"T_DIST_RT",t:1,d:"返回学生的右尾 t 分布。",a:"返回学生的右尾 t 分布。",m:[2,2],p:[{name:"x",detail:"T-分布函数的输入。",example:"A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"degrees_freedom",detail:"自由度数值。",example:"30",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"T_INV",t:1,d:"返回学生的 t 分布的左尾反函数。",a:"返回学生的 t 分布的左尾反函数。",m:[2,2],p:[{name:"probability",detail:"与学生的 t 分布相关的概率。\n\n必须大于 0 且小于 1。",example:"0.35",require:"m",repeat:"n",type:"rangeNumber"},{name:"deg_freedom",detail:"自由度数值。\n\n如果所提供的参数不是整数，将截取其整数部分。\n\n必须大于等于 1。",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"T_INV_2T",t:1,d:"返回学生 t 分布的双尾反函数。",a:"返回学生 t 分布的双尾反函数。",m:[2,2],p:[{name:"probability",detail:"与学生的 t 分布相关的概率。\n\n必须大于 0 且小于1。",example:"0.35",require:"m",repeat:"n",type:"rangeNumber"},{name:"deg_freedom",detail:"自由度数值。\n\n如果所提供的参数不是整数，将截取其整数部分。\n\n必须大于等于 1。",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"T_TEST",t:1,d:"返回与t-检验相关的概率。用于判断两个样本是否可能是出自平均值相同的两个样本总体。",a:"返回与t-检验相关的概率。用于判断两个样本是否可能是出自平均值相同的两个样本总体。",m:[4,4],p:[{name:"array1",detail:"将用于 t 检验的第一个数据样本或第一组单元格。",example:"A1:A4",require:"m",repeat:"n",type:"rangeNumber"},{name:"array2",detail:"将用于 t 检验的第二个数据样本或第二组单元格。",example:"B1:B4",require:"m",repeat:"n",type:"rangeNumber"},{name:"tails",detail:"指定分布的尾数。\n\n如果为 1：使用单尾分布。\n\n如果为 2：使用双尾分布。",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"type",detail:"指定 t 检验的类型。\n\n如果为 1：执行配对检验。\n\n如果为 2：执行双样本等方差（同方差）检验。\n\n如果为3：执行双样本不等方差（异方差）检验。",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"F_DIST",t:1,d:"给定输入值 x，计算两个数据集的左尾 F 概率分布（差异程度）。此分布也称为 Fisher-Snedecor 分布或 Snedecor F 分布。",a:"给定输入值 x",m:[4,4],p:[{name:"x",detail:"用来计算函数的值。",example:"15.35",require:"m",repeat:"n",type:"rangeNumber"},{name:"degrees_freedom1",detail:"分子自由度。",example:"7",require:"m",repeat:"n",type:"rangeNumber"},{name:"degrees_freedom2",detail:"分母自由度。",example:"6",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"用于确定函数形式的逻辑值。默认值为 FALSE。\n\n如果为 TRUE()：F.DIST 将返回累积分布函数值。\n\n如果为 FALSE()：F.DIST 将返回概率密度函数值。",example:"TRUE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"F_DIST_RT",t:1,d:"给定输入x，计算两个数据集的右尾F概率分布（差异程度）。 此分布也称为Fisher-Snedecor分布或Snedecor F分布。",a:"给定输入x",m:[3,3],p:[{name:"x",detail:"用来计算函数的值。",example:"15.35",require:"m",repeat:"n",type:"rangeNumber"},{name:"degrees_freedom1",detail:"分子自由度。",example:"7",require:"m",repeat:"n",type:"rangeNumber"},{name:"degrees_freedom2",detail:"分母自由度。",example:"6",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"VAR_P",t:1,d:"基于样本总体计算方差。",a:"基于样本总体计算方差。",m:[1,255],p:[{name:"值1",detail:"数据集中的第一个值或范围。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"值2, …",detail:"[可选] - 数据集中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"VAR_S",t:1,d:"基于样本计算方差。",a:"基于样本计算方差。",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"值2, …",detail:"[可选] - 样本中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"VARA",t:1,d:"基于样本计算方差，将文本取值为0。",a:"基于样本计算方差",m:[1,255],p:[{name:"value1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2, ...",detail:"[可选] - 样本中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"VARPA",t:1,d:"基于样本总体计算方差，将文本取值为0。",a:"基于样本总体计算方差",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"STEYX",t:1,d:"返回通过线性回归法预测每个 x 的 y 值时所产生的标准误差。",a:"返回通过线性回归法预测每个 x 的 y 值时所产生的标准误差。",m:[2,2],p:[{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"STANDARDIZE",t:1,d:"给定分布的均值和标准偏差，计算一个随机变量正态化的相应值。",a:"给定分布的均值和标准偏差，计算一个随机变量正态化的相应值。",m:[3,3],p:[{name:"x",detail:"要正态化的随机变量值。",example:"96",require:"m",repeat:"n",type:"rangeNumber"},{name:"mean",detail:"分布的均值。",example:"80",require:"m",repeat:"n",type:"rangeNumber"},{name:"standard_dev",detail:"分布的标准偏差。",example:"6.7",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SMALL",t:1,d:"返回数据集中的第 k 个最小值。",a:"返回数据集中的第 k 个最小值。",m:[2,2],p:[{name:"array",detail:"需要找到第 k 个最小值的数组或数值数据区域。",example:"A2:B100",require:"m",repeat:"n",type:"range"},{name:"k",detail:"要返回的数据在数组或数据区域里的位置（从小到大）。",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SLOPE",t:1,d:"计算通过数据集的线性回归得到的直线的斜率。",a:"计算通过数据集的线性回归得到的直线的斜率。",m:[2,2],p:[{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SKEW",t:1,d:"返回分布的偏斜度。 偏斜度表明分布相对于平均值的不对称程度。 正偏斜度表明分布的不对称尾部趋向于更多正值。 负偏斜度表明分布的不对称尾部趋向于更多负值。",a:"返回分布的偏斜度。",m:[1,255],p:[{name:"值1",detail:"数据集中的第一个值或范围。",example:"1",require:"m",repeat:"n",type:"rangeAll"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"SKEW_P",t:1,d:"返回基于样本总体的分布不对称度：表明分布相对于平均值的不对称程度。",a:"返回基于样本总体的分布不对称度：表明分布相对于平均值的不对称程度。",m:[1,255],p:[{name:"值1",detail:"数据集中的第一个值或范围。",example:"1",require:"m",repeat:"n",type:"rangeAll"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"VLOOKUP",t:2,d:"纵向查找。在范围的第一列中自上而下搜索某个键值，并返回所找到的行中指定单元格的值。",a:"纵向查找。在范围的第一列中自上而下搜索某个键值",m:[3,4],p:[{name:"搜索键值",detail:'要搜索的值，如 42、"Cats" 或 I24。',example:"10003",require:"m",repeat:"n",type:"rangeAll"},{name:"范围",detail:"要进行搜索的范围。VLOOKUP 将在该范围的第一列中搜索搜索键值中指定的键值。",example:"A2:B26",require:"m",repeat:"n",type:"rangeAll"},{name:"索引",detail:"要返回的值的列索引，范围中的第一列编号为 1。\n\n如果索引不是介于 1 和范围中的列数之间，将返回 #VALUE! 。",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"已排序",detail:"[默认值为 TRUE() ] - 指示要搜索的列（指定范围的第一列）是否已排序。大多数情况下，建议设为 FALSE()。\n\n建议将已排序设为 FALSE。如果设为 FALSE，将返回完全匹配项。如果存在多个匹配值，将返回找到的第一个值对应的单元格的内容，如果找不到匹配值，则返回 #N/A。\n\n如果将已排序设为 TRUE 或省略，将返回（小于或等于搜索键值的）最接近的匹配项。如果搜索的列中所有的值均大于搜索键值，则返回 #N/A。",example:"FALSE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"HLOOKUP",t:2,d:"横向查找。在范围的第一行中搜索某个键值，并返回所找到的列中指定单元格的值。",a:"横向查找。在范围的第一行中搜索某个键值",m:[3,4],p:[{name:"搜索键值",detail:'要搜索的值。例如，42、"Cats"或I24。',example:"10003",require:"m",repeat:"n",type:"rangeAll"},{name:"范围",detail:"要进行搜索的范围。将在该范围的第一行中搜索在搜索键值中指定的键值。",example:"A2:Z6",require:"m",repeat:"n",type:"rangeAll"},{name:"索引",detail:"要返回的值的行索引，范围中的第一行编号为1。\n\n如果索引不是介于1和范围中的行数之间，将返回#VALUE!。",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"已排序",detail:"[可选 - 默认值为TRUE()] - 指示要搜索的行（指定范围的第一行）是否已排序。\n\n如果将已排序设为TRUE或省略，将返回最接近的匹配值（小于或等于搜索键值）。如果在搜索的行中所有的值均大于搜索键值，则返回#N/A。\n\n如果将已排序设为TRUE或将其省略，而范围的首行并非处于已排序状态，则返回值可能会是错误的。\n\n如果将已排序设为FALSE，则仅返回完全匹配。如果存在多个匹配值，将返回与找到的第一个值对应的单元格的内容，如果找不到匹配值则返回#N/A。",example:"FALSE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"LOOKUP",t:2,d:"在行或列中查找相应键，并将相应单元格的值返回到与搜索行或列所在位置相同的结果范围中。",a:"在行或列中查找相应键",m:[2,3],p:[{name:"搜索键值",detail:'要在行或列中搜索的值。例如，42、"Cats" 或 I24。',example:"10003",require:"m",repeat:"n",type:"rangeAll"},{name:"搜索范围 | 搜索结果数组",detail:"使用 LOOKUP 的一种方法是给定单行或单列形式的搜索范围进行搜索查找，这种方式要用到另一个参数结果范围。另一种方式是将这两个参数合并为一个搜索结果数组，其中第一行或第一列用于搜索，并将返回值放在该数组的最后一行或最后一列中。",example:"A1:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"结果范围",detail:"[ 可选 ] - 用于存放返回结果的范围。返回值对应于在搜索范围中找到搜索键值的位置。此范围必须仅为单行或单列，而如果您使用的是搜索结果数组方式，则不应提供此参数。",example:"B1:B100",require:"o",repeat:"n",type:"rangeAll"}]},{n:"ADDRESS",t:2,d:"返回字符串形式的单元格引用。",a:"返回字符串形式的单元格引用。",m:[2,5],p:[{name:"row_num",detail:"一个数值，指定要在单元格引用中使用的行号。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"column_num",detail:"一个数值，指定要在单元格引用中使用的列号（而非名称）。A列的编号为1。",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"abs_num",detail:"[可选 - 默认值为1] - 一个数值，指定要返回的引用类型。\n\n1 表示行列均采用绝对值（例如$A$1）；\n\n2 表示采用绝对行号，相对列标（例如A$1）；\n\n3 表示采用相对行号，绝对列标（例如$A1）；\n\n4 表示行列均采用相对值（例如A1）。",example:"4",require:"o",repeat:"n",type:"rangeNumber"},{name:"A1",detail:"[可选 - 默认值为TRUE()] - 一个布尔值，指示采用A1标记形式(TRUE)还是R1C1标记形式(FALSE)。",example:"FALSE()",require:"o",repeat:"n",type:"rangeAll"},{name:"sheet_text",detail:"[可选 - 默认缺省] - 用于指定地址所指向的工作表名称。",example:'"Sheet2"',require:"o",repeat:"n",type:"rangeAll"}]},{n:"INDIRECT",t:2,d:"返回以字符串指定的单元格引用。",a:"返回以字符串指定的单元格引用。",m:[1,2],p:[{name:"ref_text",detail:"以带引号的字符串形式提供的单元格引用。",example:'"Sheet2!"&B10',require:"m",repeat:"n",type:"rangeAll"},{name:"A1",detail:"[可选 - 默认值为TRUE()] - 一个布尔值，指示采用A1标记形式(TRUE)还是R1C1标记形式(FALSE)。",example:"FALSE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"ROW",t:2,d:"返回指定单元格的行号",a:"返回指定单元格的行号",m:[0,1],p:[{name:"reference",detail:"[可选 - 默认为此公式所在的单元格] - 要返回其行号的单元格。\n\n如果单元格引用指向的范围其宽度大于一个单元格，而此公式不是用作数组公式的，这时会仅返回单元格引用中首行的编号值。",example:"A9",require:"o",repeat:"n",type:"rangeAll"}]},{n:"ROWS",t:2,d:"返回指定数组或范围中的行数。",a:"返回指定数组或范围中的行数。",m:[1,1],p:[{name:"array",detail:"要返回其行数的范围。",example:"A9:A62",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"COLUMN",t:2,d:"按照 `A=1` 的规则返回指定单元格的列号。",a:"按照 `A=1` 的规则返回指定单元格的列号。",m:[0,1],p:[{name:"reference",detail:"[可选 - 默认为包含此公式的单元格] - 要返回其列号的单元格。A列对应的编号为1。\n\n如果单元格引用是宽度超过一个单元格的范围，而此公式不是作为数组公式来使用的，因此将返回单元格引用中的第一列的位置。",example:"A9",require:"o",repeat:"n",type:"rangeAll"}]},{n:"COLUMNS",t:2,d:"返回指定数组或范围中的列数。",a:"返回指定数组或范围中的列数。",m:[1,1],p:[{name:"array",detail:"要返回其列数的范围。",example:"A9:W62",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"OFFSET",t:2,d:"给定某范围的起始单元格引用以及该范围涵盖的行列数量，返回该范围的引用。",a:"给定某范围的起始单元格引用以及该范围涵盖的行列数量，返回该范围的引用。",m:[3,5],p:[{name:"reference",detail:"用于计算行列偏移量的起点。",example:"A2",require:"m",repeat:"n",type:"range"},{name:"rows",detail:"要偏移的行数。\n\n行偏移量必须是整数，但也可以是负数。如果提供的参数带有小数，小数部分将被截去。",example:"3",require:"m",repeat:"n",type:"rangeNumber"},{name:"cols",detail:"要偏移的列数。\n\n列偏移量必须是整数，但也可以是负数。如果提供的参数带有小数，小数部分将被截去。",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"height",detail:"[可选] - 要从偏移目标开始返回的范围的高度。",example:"2",require:"o",repeat:"n",type:"rangeNumber"},{name:"width",detail:"[可选] - 要从偏移目标开始返回的范围的宽度。",example:"2",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"MATCH",t:2,d:"在单元格中搜索指定项，然后返回该项在单元格区域中的相对位置。",a:"在单元格中搜索指定项，然后返回该项在单元格区域中的相对位置。",m:[2,3],p:[{name:"lookup_value",detail:"要在 lookup_array 中匹配的值。",example:'"Sunday"',require:"m",repeat:"n",type:"rangeAll"},{name:"lookup_array",detail:"要搜索的单元格区域。\n\n如果所用的范围的高度和宽度均大于1，MATCH将返回#N/A!。",example:"A2:A9",require:"m",repeat:"n",type:"range"},{name:"match_type",detail:"[可选 - 默认值为1] - 要采用的搜索方式。\n\n1为默认类型，此时MATCH会假设范围已按升序排序，并返回小于等于搜索键值的最大值。\n\n0表示完全匹配，在范围未排序的情况下需要使用此方式。\n\n-1让MATCH假设范围是按降序排序的，并返回大于等于搜索键值的最小值。",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"INDEX",t:2,d:"返回表格或中的元素值，此元素由行号和列号的索引值给定。",a:"返回表格或中的元素值，此元素由行号和列号的索引值给定。",m:[2,3],p:[{name:"array",detail:"单元格区域或数组常量。",example:"A1:C20",require:"m",repeat:"n",type:"range"},{name:"row_num",detail:"选择数组中的某行，函数从该行返回数值。",example:"5",require:"m",repeat:"n",type:"rangeNumber"},{name:"column_num",detail:"选择数组中的某列，函数从该列返回数值。",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"GETPIVOTDATA",t:2,d:"从与指定行和列标题对应的数据透视表中提取汇总值。",a:"从与指定行和列标题对应的数据透视表中提取汇总值。",m:[2,254],p:[{name:"data_field",detail:"您想从数据透视表中获取其数据的值名称。\n值名称必须括在引号中或是指向包含相关文本的任何单元格的引用。\n如果有多个值字段，则必须使用数据透视表中显示的确切名称（如“销售总额”）。",example:'"SUM of number of units"',require:"m",repeat:"n",type:"rangeAll"},{name:"pivot_table",detail:"目标数据透视表中的任何单元格的引用（推荐位于顶角的单元格）。",example:"'Pivot table'!A1",require:"m",repeat:"n",type:"rangeAll"},{name:"field1",detail:"[可选] - 源数据集（不是数据透视表）中列的名称。",example:'"division"',require:"o",repeat:"y",type:"rangeAll"},{name:"item1",detail:"[可选] - 数据透视表中显示的与您要检索的字段名称 1 相对应的行或列的名称。",example:'"east"',require:"o",repeat:"y",type:"rangeAll"}]},{n:"CHOOSE",t:2,d:"基于索引返回选项列表中的元素。",a:"基于索引返回选项列表中的元素。",m:[2,255],p:[{name:"index_num",detail:"指定要返回哪一项。\n\n如果索引为零、负值或大于提供的选择数量，将返回#VALUE!错误。",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"value1",detail:"一项可能的返回值。必须提供。可以是单元格引用或单独的值。",example:'"A"',require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"[可选] - 其他可以选择的值。选择",example:'"B"',require:"o",repeat:"y",type:"rangeAll"}]},{n:"HYPERLINK",t:2,d:"在单元格内创建一个超链接。",a:"在单元格内创建一个超链接。",p:[{name:"网址",detail:"以引号括住的链接位置的完整网址，或对包含这种网址的单元格的引用。\n\n仅允许某些链接类型。其中包括：http://、https://、mailto:、aim:、ftp://、gopher://、telnet://和news://，明确禁用使用其他协议。如果指定的是其他协议，将会在单元格中显示链接标签，但该标签不会以链接形式呈现。\n\n如果未指定协议，则假设使用http://，并将其作为网址的前缀。",example:'"http://www.google.com/"',require:"m",repeat:"n",type:"rangeAll"},{name:"链接标签",detail:'[可选 - 默认为网址] - 要在单元格中作为链接显示的文本（用引号括起来的），或者指向包含这种标签的单元格的引用。\n\n如果链接标签是指向某个空单元格的引用，如果网址有效，就将其作为链接显示，否则作为纯文本显示。\n\n如果链接标签为空字符串常量("")，所在单元格显示的内容将为空白，但通过点击该单元格或转入该单元格仍然可以访问链接。',example:'"Google"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"TIME",t:6,d:"将给定的小时、分钟和秒转换为时间。",a:"将给定的小时、分钟和秒转换为时间。",m:[3,3],p:[{name:"小时",detail:"0（零）到 32767 之间的数字，代表小时。\n\n任何大于 23 的值都会除以 24，余数将作为小时值。",example:"11",require:"m",repeat:"n",type:"rangeNumber"},{name:"分钟",detail:"0（零）到 32767 之间的数字，代表分钟。\n\n任何大于 59 的值将转换为小时和分钟。",example:"40",require:"m",repeat:"n",type:"rangeNumber"},{name:"秒",detail:"0（零）到 32767 之间的数字，代表秒。\n\n任何大于 59 的值将转换为小时、分钟和秒。",example:"59",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TIMEVALUE",t:6,d:"按一天24小时返回该时间的分数表示。",a:"按一天24小时返回该时间的分数表示。",m:[1,1],p:[{name:"time_text",detail:"用于表示时间的字符串。",example:'"2:15 PM"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"EOMONTH",t:6,d:"返回某个月份最后一天的序列号，该月份在另一个日期之前或之后的数个月（月数由参数指定）。",a:"返回某个月份最后一天的序列号",m:[2,2],p:[{name:"start_date",detail:"用于计算结果的参照日期。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"months",detail:"用于计算的起始日期之前（负）或之后（正）的月数。返回的是计算所得月份的最后那天。",example:"7",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"EDATE",t:6,d:"返回表示某个日期的序列号，该日期在另一个日期的数月之前/之后。",a:"返回表示某个日期的序列号",m:[2,2],p:[{name:"start_date",detail:"用于计算结果的参照日期。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"months",detail:"用于计算的起始日期之前（负）或之后（正）的月数。",example:"7",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SECOND",t:6,d:"返回时间值的秒数。 秒数是 0（零）到 59 范围内的整数。",a:"返回时间值的秒数。 秒数是 0（零）到 59 范围内的整数。",m:[1,1],p:[{name:"时间",detail:"用于计算秒钟部分的时间。必须为以下值之一：指向包含日期/时间值的单元格的引用、返回日期/时间的函数或者数字。",example:"TIME(11",require:"m",repeat:"n",type:"rangeAll"}]},{n:"MINUTE",t:6,d:"以数字格式返回特定时间的分钟部分。",a:"以数字格式返回特定时间的分钟部分。",m:[1,1],p:[{name:"时间",detail:"用于计算分钟部分的时间。必须为以下值之一：指向包含日期/时间值的单元格的引用、返回日期/时间的函数或者数字。",example:"TIME(11",require:"m",repeat:"n",type:"rangeAll"}]},{n:"HOUR",t:6,d:"以数字格式返回特定时间的小时部分。",a:"以数字格式返回特定时间的小时部分。",m:[1,1],p:[{name:"时间",detail:"用于计算小时部分的时间。必须为以下值之一：指向包含日期/时间值的单元格的引用、返回日期/时间的函数或者数字。",example:"TIME(11",require:"m",repeat:"n",type:"rangeAll"}]},{n:"NOW",t:6,d:"以日期值格式返回当前日期和时间。",a:"以日期值格式返回当前日期和时间。",m:[0,0],p:[]},{n:"NETWORKDAYS",t:6,d:"返回所提供的两个日期之间的净工作日天数。",a:"返回所提供的两个日期之间的净工作日天数。",m:[2,3],p:[{name:"start_date",detail:"用于计算净工作日天数的时间段开始日期。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"end_date",detail:"用于计算净工作日天数的时间段结束日期。",example:"7",require:"m",repeat:"n",type:"rangeAll"},{name:"holidays",detail:"[可选] - 一个范围或数组常量，其中包含作为节假日的日期序号。\n\n在节假日数组中提供的值必须是日期序号值（例如由N所返回的值）或日期值（例如由DATE、DATEVALUE或TO_DATE返回的值）。由范围指定的值应该是标准的日期值或日期序数值。",example:"16)",require:"o",repeat:"n",type:"rangeAll"}]},{n:"NETWORKDAYS_INTL",t:6,d:"返回给定的两个日期之间的净工作日天数（排除指定的周末和节假日）。",a:"返回给定的两个日期之间的净工作日天数（排除指定的周末和节假日）。",m:[2,4],p:[{name:"start_date",detail:"用于计算净工作日天数的时间段开始日期。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"end_date",detail:"用于计算净工作日天数的时间段结束日期。",example:"7",require:"m",repeat:"n",type:"rangeAll"},{name:"weekend",detail:"[可选 - 默认值为1] - 用于表示哪些天为周末的数字或字符串。\n字符串方式：可以使用由0和1组成的字符串来指定周末，串中的第一个数字字符代表周一，最后一个则代表周日。零表示这一天是工作日，1表示这一天为周末。例如，“0000011”表示将周六和周日作为周末。\n数字方式：这种方式不使用上述字符串形式，而是使用一个数字。1 =周六/周日为周末，2 =周日/周一为周末，依此类推则7 =周五/周六。11 =周日为唯一周末，12 =周一为唯一周末，依此类推则17 =周六为唯一周末。",example:"16)",require:"o",repeat:"n",type:"rangeAll"},{name:"holidays",detail:"[ 可选 ] - 这是一个范围或数组常量，其中包含作为节假日的日期。\n在节假日数组内提供的值必须为日期序数值（例如N的返回值）或日期值（例如DATE、DATEVALUE或TO_DATE的返回值）。由范围指定的值应该是标准的日期值或日期序数值。",example:"DATE(1969",require:"o",repeat:"n",type:"rangeAll"}]},{n:"ISOWEEKNUM",t:6,d:"返回给定日期在全年中的 ISO 周数。",a:"返回给定日期在全年中的 ISO 周数。",m:[1,1],p:[{name:"date",detail:"用于日期和时间计算的日期-时间代码。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"}]},{n:"WEEKNUM",t:6,d:"返回特定日期的周数。",a:"返回特定日期的周数。",m:[1,2],p:[{name:"serial_number",detail:"要确定其位于第几周的日期，必须是对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"return_type",detail:"[可选 - 默认值为 1 ] - 代表一周起始日的数字，系统也使用该数字来确定一年的第一周（1=周日，2=周一）。",example:"7",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"WEEKDAY",t:6,d:"返回一个数字，对应于给定日期所在的星期几。",a:"返回一个数字，对应于给定日期所在的星期几。",m:[1,2],p:[{name:"serial_number",detail:"要为其确定星期几的日期。必须是对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"return_type",detail:"[可选 - 默认值为 1] - 以数字指示使用哪种编号顺序来表示星期几。默认情况下，按星期日 (= 1) 开始计算。\n\n如果类型为 1，则星期值将从星期日开始算起，并且星期日的值为 1，因此星期六的值就是 7。\n\n如果类型为 2，则星期值将从星期一开始算起，并且星期一的值为 1，因此星期日的值就是 7。\n\n如果类型为 3，则星期值将从星期一算起，并且星期一的值为 0，因此星期日的值就是 6。",example:"7",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DAY",t:6,d:"以数字格式返回特定日期所在的当月几号。",a:"以数字格式返回特定日期所在的当月几号。",m:[1,1],p:[{name:"serial_number",detail:"要从中提取具体几号的日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"}]},{n:"DAYS",t:6,d:"返回两个日期之间的天数。",a:"返回两个日期之间的天数。",m:[2,2],p:[{name:"end_date",detail:"计算中要使用的结束日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"2011-3-15",require:"m",repeat:"n",type:"rangeAll"},{name:"start_date",detail:"计算中要使用的开始日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"2011-2-1",require:"m",repeat:"n",type:"rangeAll"}]},{n:"DAYS360",t:6,d:"按照每年360天，返回两个日期之间的差（用于计算利息）。",a:"按照每年360天，返回两个日期之间的差（用于计算利息）。",m:[2,3],p:[{name:"start_date",detail:"计算中要使用的开始日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"end_date",detail:"计算中要使用的结束日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"7",require:"m",repeat:"n",type:"rangeAll"},{name:"method",detail:"[可选 - 默认为FALSE()] - 指示要使用哪种天数计算方法。\n\nFALSE - 采用美国 (NASD) 方法时，如果起始日期为某月的最后一天，为便于计算，会将起始日期的当月几号更改为30。此外，如果结束日期是所在月份的最后一天，而且起始日期在其所在月的30号之前，则将结束日期更改为结束日期之后那个月的第一天，否则将结束日期更改为该月的30号。\n\nTRUE - 采用欧洲方法时，会将所有日期在31号的起始日期或结束日期更改为当月的30号。",example:"FALSE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"DATE",t:6,d:"将提供的年、月、日转换为日期。",a:"将提供的年、月、日转换为日期。",m:[3,3],p:[{name:"year",detail:"日期的年份部分，包含一到四位数字。\n\n介于 0（零）到 1899 之间，会将该值与 1900 相加来计算年份；\n\n介于 1900 到 9999 之间，将使用该数值作为年份；\n\n小于 0 或大于等于 10000，返回 错误值 #NUM!。",example:"1969",require:"m",repeat:"n",type:"rangeNumber"},{name:"month",detail:"日期的月份部分，一个正整数或负整数。\n\n如果 month 大于 12，则 month 会将该月份数与指定年中的第一个月相加。\n\n如果 month 小于 1，month 则从指定年份的一月份开始递减该月份数，然后再加上 1 个月。",example:"7",require:"m",repeat:"n",type:"rangeNumber"},{name:"day",detail:"日期的日部分，一个正整数或负整数。\n\n如果 day 大于月中指定的天数，则 day 会将天数与该月中的第一天相加。\n\n如果 day 小于 1，则 day 从指定月份的第一天开始递减该天数，然后再加上 1 天。",example:"20",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DATEVALUE",t:6,d:"将提供的日期字符串转换为日期的序列号。",a:"将提供的日期字符串转换为日期的序列号。",m:[1,1],p:[{name:"date_text",detail:"表示日期的字符串。",example:'"1969-7-20"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"DATEDIF",t:6,d:"计算两个日期之间的天数、月数或年数。",a:"计算两个日期之间的天数、月数或年数。",m:[3,3],p:[{name:"起始日期",detail:"计算中要使用的开始日期。必须是对包含DATE值的单元格的引用、返回DATE类型的函数或数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"结束日期",detail:"计算中要使用的结束日期。必须是对包含DATE值的单元格的引用、返回DATE类型的函数或数字。",example:"7",require:"m",repeat:"n",type:"rangeAll"},{name:"单位",detail:'时间单位的缩写文字。例如 "M" 代表月。有效值包括："Y"、"M"、"D"、"MD"、"YM" 和 "YD"。\n\n"Y"：返回起始日期和结束日期之间的整年数。\n\n"M"：返回起始日期和结束日期之间的整月数。\n\n"D"：返回起始日期和结束日期之间的天数。\n\n"MD"：返回起始日期和结束日期之间的天数（不计整月数）。\n\n"YM"：返回起始日期和结束日期之间的整月数（不计整年数）。\n\n"YD"：返回起始日期和结束日期之间的天数（假设起始日期和结束日期的间隔不超过一年）。',example:"16)",require:"m",repeat:"n",type:"rangeAll"}]},{n:"WORKDAY",t:6,d:"指定工作日天数，计算结束日期。",a:"指定工作日天数，计算结束日期。",m:[2,3],p:[{name:"start_date",detail:"计算的开始日期。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"days",detail:"start_date 之前或之后不含周末及节假日的天数。\n\n为正值将生成未来日期；\n\n为负值生成过去日期。",example:"7",require:"m",repeat:"n",type:"rangeNumber"},{name:"holidays",detail:"[可选] - 一个范围或数组常量，其中包含作为节假日的日期序号。\n\n在节假日数组中提供的值必须是日期序号值（例如由N所返回的值）或日期值（例如由DATE、DATEVALUE或TO_DATE返回的值）。由范围指定的值应该是标准的日期值或日期序数值。",example:"16)",require:"o",repeat:"n",type:"rangeAll"}]},{n:"WORKDAY_INTL",t:6,d:"返回指定的若干个工作日之前或之后的日期的序列号（使用自定义周末参数）。 ",a:"返回指定的若干个工作日之前或之后的日期的序列号（使用自定义周末参数）。 ",m:[2,4],p:[{name:"start_date",detail:"开始日期（将被截尾取整）。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"days",detail:"start_date 之前或之后的工作日的天数。\n\n正值表示未来日期；\n\n负值表示过去日期；\n\n零值表示开始日期。",example:"7",require:"m",repeat:"n",type:"rangeNumber"},{name:"weekend",detail:"[可选 - 默认值为1] - 用于表示哪些天为周末的数字或字符串。\n字符串方式：可以使用由0和1组成的字符串来指定周末，串中的第一个数字字符代表周一，最后一个则代表周日。零表示这一天是工作日，1表示这一天为周末。例如，“0000011”表示将周六和周日作为周末。\n数字方式：这种方式不使用上述字符串形式，而是使用一个数字。1 =周六/周日为周末，2 =周日/周一为周末，依此类推则7 =周五/周六。11 =周日为唯一周末，12 =周一为唯一周末，依此类推则17 =周六为唯一周末。",example:"16)",require:"o",repeat:"n",type:"rangeAll"},{name:"holidays",detail:"[ 可选 ] - 这是一个范围或数组常量，其中包含作为节假日的日期。\n在节假日数组内提供的值必须为日期序数值（例如N的返回值）或日期值（例如DATE、DATEVALUE或TO_DATE的返回值）。由范围指定的值应该是标准的日期值或日期序数值。",example:"DATE(1969",require:"o",repeat:"n",type:"rangeAll"}]},{n:"YEAR",t:6,d:"返回对应于某个日期的年份。 Year 作为 1900 - 9999 之间的整数返回。",a:"返回对应于某个日期的年份。 Year 作为 1900 - 9999 之间的整数返回。",m:[1,1],p:[{name:"serial_number",detail:"用于计算年份的日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"}]},{n:"YEARFRAC",t:6,d:"返回 start_date 和 end_date 之间的天数占全年天数的百分比。",a:"返回 start_date 和 end_date 之间的天数占全年天数的百分比。",m:[2,3],p:[{name:"start_date",detail:"计算中要使用的开始日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"end_date",detail:"计算中要使用的结束日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"7",require:"m",repeat:"n",type:"rangeAll"},{name:"basis",detail:"[可选 - 默认为0] - 要使用的日计数基准类型。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"16)",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"TODAY",t:6,d:"以日期值格式返回当前日期。",a:"以日期值格式返回当前日期。",m:[0,0],p:[]},{n:"MONTH",t:6,d:"返回日期（以序列数表示）中的月份。 月份是介于 1（一月）到 12（十二月）之间的整数。",a:"返回日期（以序列数表示）中的月份。 月份是介于 1（一月）到 12（十二月）之间的整数。",m:[1,1],p:[{name:"serial_number",detail:"要从中提取月份的日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"}]},{n:"EFFECT",t:8,d:"根据名义利率及每年的复利计息期数来计算实际年利率。",a:"根据名义利率及每年的复利计息期数来计算实际年利率。",m:[2,2],p:[{name:"nominal_rate",detail:"每年的名义利率。",example:"0.99",require:"m",repeat:"n",type:"rangeNumber"},{name:"npery",detail:"每年的复利计算期数。",example:"12",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DOLLAR",t:12,d:"将数字格式设置为与语言区域相对应的货币格式。",a:"将数字格式设置为与语言区域相对应的货币格式。",m:[1,2],p:[{name:"number",detail:"要设置格式的值。",example:"1.2351",require:"m",repeat:"n",type:"rangeNumber"},{name:"decimals",detail:"[可选 - 默认值为 2] - 要显示的小数位数。\n\n如果这是负数，则将数字四舍五入到小数点左侧。",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DOLLARDE",t:8,d:"将以整数部分和分数部分转换为以小数部分表示的金额数字",a:"将以整数部分和分数部分转换为以小数部分表示的金额数字",m:[2,2],p:[{name:"fractional_dollar",detail:"以整数部份和分数部分表示的数字，用小数点隔开。",example:"100.10",require:"m",repeat:"n",type:"rangeNumber"},{name:"fraction",detail:"用作分数中的分母的整数。",example:"32",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DOLLARFR",t:8,d:"将小数转换为分数表示的金额数字。",a:"将小数转换为分数表示的金额数字。",m:[2,2],p:[{name:"decimal_dollar",detail:"小数。",example:"100.125",require:"m",repeat:"n",type:"rangeNumber"},{name:"fraction",detail:"用作分数中的分母的整数。",example:"32",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DB",t:8,d:"使用固定余额递减法，返回指定期间内某项固定资产的折旧值。",a:"使用固定余额递减法，返回指定期间内某项固定资产的折旧值。",m:[4,5],p:[{name:"cost",detail:"资产原值。",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"salvage",detail:"折旧末尾时的值（有时也称为资产残值）。",example:"50",require:"m",repeat:"n",type:"rangeNumber"},{name:"life",detail:"资产的折旧期数（有时也称作资产的使用寿命）。",example:"10",require:"m",repeat:"n",type:"rangeNumber"},{name:"period",detail:"在使用期限内要计算折旧的折旧期。",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"month",detail:"[可选 - 默认值为12] - 折旧第一年中的月数。",example:"10",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DDB",t:8,d:"用双倍余额递减法，返回指定期间内某项固定资产的折旧值。",a:"用双倍余额递减法，返回指定期间内某项固定资产的折旧值。",m:[4,5],p:[{name:"cost",detail:"资产原值。",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"salvage",detail:"折旧末尾时的值（有时也称为资产残值）。",example:"50",require:"m",repeat:"n",type:"rangeNumber"},{name:"life",detail:"资产的折旧期数（有时也称作资产的使用寿命）。",example:"10",require:"m",repeat:"n",type:"rangeNumber"},{name:"period",detail:"在使用期限内要计算折旧的折旧期。",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"factor",detail:"[可选 - 默认值为2] - 折旧的递减系数。",example:"2.25",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"RATE",t:8,d:"返回年金每期的利率。",a:"返回年金每期的利率。",m:[3,6],p:[{name:"nper",detail:"年金的付款总期数。",example:"12",require:"m",repeat:"n",type:"rangeNumber"},{name:"pmt",detail:"每期的付款金额，在年金周期内不能更改。",example:"-100",require:"m",repeat:"n",type:"rangeNumber"},{name:"pv",detail:"现值即一系列未来付款当前值的总和。",example:"400",require:"m",repeat:"n",type:"rangeNumber"},{name:"fv",detail:"[可选 - 默认值为0] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"0",require:"o",repeat:"n",type:"rangeNumber"},{name:"type",detail:"[可选 - 默认值为0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"0",require:"o",repeat:"n",type:"rangeNumber"},{name:"guess",detail:"[可选 - 默认值为0.1] - 预期利率。",example:"0.1",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"CUMPRINC",t:8,d:"基于等额分期付款和固定利率，计算投资在多个付款期内的累计本金偿还额。",a:"基于等额分期付款和固定利率，计算投资在多个付款期内的累计本金偿还额。",m:[6,6],p:[{name:"rate",detail:"利率。",example:"0.12",require:"m",repeat:"n",type:"rangeNumber"},{name:"nper",detail:"总付款期数。",example:"12",require:"m",repeat:"n",type:"rangeNumber"},{name:"pv",detail:"年金的现值。",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"start_period",detail:"开始累计计算的付款期序号。\n\n首期必须大于等于1。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"end_period",detail:"结束累计计算的付款期序号。\n\n末期必须大于首期。",example:"5",require:"m",repeat:"n",type:"rangeNumber"},{name:"type",detail:"指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"0",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"COUPNUM",t:8,d:"返回在结算日和到期日之间的付息次数，向上舍入到最近的整数。",a:"返回在结算日和到期日之间的付息次数，向上舍入到最近的整数。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"有价证券的到期日。到期日是有价证券有效期截止时的日期。",example:"02",require:"m",repeat:"n",type:"rangeAll"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"SYD",t:8,d:"返回在指定期间内资产按年限总和折旧法计算的折旧。",a:"返回在指定期间内资产按年限总和折旧法计算的折旧。",m:[4,4],p:[{name:"cost",detail:"资产原值。",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"salvage",detail:"折旧末尾时的值（有时也称为资产残值）。",example:"50",require:"m",repeat:"n",type:"rangeNumber"},{name:"life",detail:"资产的折旧期数（有时也称作资产的使用寿命）。",example:"10",require:"m",repeat:"n",type:"rangeNumber"},{name:"period",detail:"在使用期限内要计算折旧的折旧期。",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TBILLEQ",t:8,d:"基于贴现率计算美国政府短期债券的等效年化收益率。",a:"基于贴现率计算美国政府短期债券的等效年化收益率。",m:[3,3],p:[{name:"settlement",detail:"债券的结算日期，此日期为债券发行后交付给买家的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"债券的到期或结束日期，届时可将其以面值或票面价值赎回。",example:"1",require:"m",repeat:"n",type:"rangeAll"},{name:"discount",detail:"债券购买时的贴现率。",example:"2)",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TBILLYIELD",t:8,d:"基于价格计算美国政府短期债券的收益率。",a:"基于价格计算美国政府短期债券的收益率。",m:[3,3],p:[{name:"settlement",detail:"债券的结算日期，此日期为债券发行后交付给买家的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"债券的到期或结束日期，届时可将其以面值或票面价值赎回。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"pr",detail:"债券的购买价格。",example:"95",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TBILLPRICE",t:8,d:"基于贴现率计算美国政府短期债券的价格。",a:"基于贴现率计算美国政府短期债券的价格。",m:[3,3],p:[{name:"settlement",detail:"债券的结算日期，此日期为债券发行后交付给买家的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"债券的到期或结束日期，届时可将其以面值或票面价值赎回。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"discount",detail:"债券购买时的贴现率。",example:"0.09",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"PV",t:8,d:"基于等额分期付款和固定利率，计算年金投资的现值。",a:"基于等额分期付款和固定利率，计算年金投资的现值。",m:[3,5],p:[{name:"rate",detail:"各期利率。",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"nper",detail:"年金的付款总期数。",example:"12",require:"m",repeat:"n",type:"rangeNumber"},{name:"pmt",detail:"每期的付款金额，在年金周期内不能更改。",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"fv",detail:"[可选] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"D2",require:"o",repeat:"n",type:"rangeNumber"},{name:"type",detail:"[可选 - 默认值为0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"1",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"ACCRINT",t:8,d:"返回定期付息证券的应计利息。",a:"返回定期付息证券的应计利息。",m:[6,8],p:[{name:"issue",detail:"有价证券的发行日。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"first_interest",detail:"有价证券的首次计息日。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"rate",detail:"有价证券的年息票利率。",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"},{name:"par",detail:"证券的票面值。",example:"10000",require:"m",repeat:"n",type:"rangeNumber"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示““欧洲30/360”方法” - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangeNumber"},{name:"calc_method",detail:"[可选 - 默认为TRUE()] - 一个逻辑值，指定当结算日期晚于首次计息日期时用于计算总应计利息的方法。\n\n如果值为 TRUE，则返回从发行日到结算日的总应计利息。\n\n如果值为 FALSE，则返回从首次计息日到结算日的应计利息。",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"ACCRINTM",t:8,d:"返回在到期日支付利息的有价证券的应计利息。",a:"返回在到期日支付利息的有价证券的应计利息。",m:[4,5],p:[{name:"issue",detail:"有价证券的发行日。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"settlement",detail:"有价证券的到期日。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"rate",detail:"有价证券的年息票利率。",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"},{name:"par",detail:"证券的票面值。",example:"1000",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"12",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"COUPDAYBS",t:8,d:"返回从付息期开始到结算日的天数。",a:"返回从付息期开始到结算日的天数。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"COUPDAYS",t:8,d:"返回结算日所在的付息期的天数。",a:"返回结算日所在的付息期的天数。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"COUPDAYSNC",t:8,d:"返回从结算日到下一票息支付日之间的天数。",a:"返回从结算日到下一票息支付日之间的天数。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"COUPNCD",t:8,d:"计算结算日之后的下一票息或利息派发日期。",a:"计算结算日之后的下一票息或利息派发日期。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"01)",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"DATE(2019",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"COUPPCD",t:8,d:"计算结算日之前的最后一个票息或利息支付日。",a:"计算结算日之前的最后一个票息或利息支付日。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"01)",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"DATE(2019",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"FV",t:8,d:"基于等额分期付款和固定利率，计算年金投资的未来价值。",a:"基于等额分期付款和固定利率，计算年金投资的未来价值。",m:[3,5],p:[{name:"rate",detail:"各期利率。",example:"0.12",require:"m",repeat:"n",type:"rangeNumber"},{name:"nper",detail:"年金的付款总期数。",example:"12",require:"m",repeat:"n",type:"rangeNumber"},{name:"pmt",detail:"各期所应支付的金额，在整个年金期间保持不变。",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"pv",detail:"[可选 - 默认值为 0 ] - 现值，或一系列未来付款的当前值的累积和。",example:"400",require:"m",repeat:"n",type:"rangeNumber"},{name:"type",detail:"[可选 - 默认值为 0 ] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"FVSCHEDULE",t:8,d:"返回应用一系列复利率计算的初始本金的未来值。",a:"返回应用一系列复利率计算的初始本金的未来值。",m:[2,2],p:[{name:"principal",detail:"现值。",example:"10000",require:"m",repeat:"n",type:"rangeNumber"},{name:"schedule",detail:"用于计算本金复利的一组利率。\n\n利率表必须是范围或数组，其中包含要用于计算复利的一组利率。这些利率值应该以十进制小数形式表示，或者使用UNARY_PERCENT以百分比形式表示，即表示为0.09或UNARY_PERCENT(9)，而不要表示为9。",example:"A2:A100",require:"m",repeat:"n",type:"range"}]},{n:"YIELD",t:8,d:"返回定期支付利息的债券的收益率。",a:"返回定期支付利息的债券的收益率。",m:[6,7],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"rate",detail:"有价证券的年息票利率。",example:"0.057",require:"m",repeat:"n",type:"rangeNumber"},{name:"pr",detail:"有价证券的价格。",example:"95",require:"m",repeat:"n",type:"rangeNumber"},{name:"redemption",detail:"有价证券的清偿价值。",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"YIELDDISC",t:8,d:"基于价格计算折价发行的（不带息）债券的年收益率。",a:"基于价格计算折价发行的（不带息）债券的年收益率。",m:[4,5],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"pr",detail:"有价证券的价格。",example:"95",require:"m",repeat:"n",type:"rangeNumber"},{name:"redemption",detail:"有价证券的清偿价值。",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"NOMINAL",t:8,d:"基于给定的实际利率和年复利期数，返回名义年利率。",a:"基于给定的实际利率和年复利期数，返回名义年利率。",m:[2,2],p:[{name:"effect_rate",detail:"每年的实际利率。",example:"0.85",require:"m",repeat:"n",type:"rangeNumber"},{name:"npery",detail:"每年的复利期数。",example:"12",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"XIRR",t:8,d:"返回一组不一定定期发生的现金流的内部收益率。",a:"返回一组不一定定期发生的现金流的内部收益率。",m:[2,3],p:[{name:"values",detail:"其中含有投资相关收益或支出的数组或范围。\n\n现金流数额中必须至少包含一项负的和一项正的现金流金额才能计算回报率。",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"dates",detail:"与现金流数额参数中的现金流对应的日期数组或范围。",example:"C2:C25",require:"m",repeat:"n",type:"range"},{name:"guess",detail:"[可选 - 默认值为0.1] - 对内部回报率的估算值。",example:"250",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"MIRR",t:8,d:"返回一系列定期现金流的修改后内部收益率。",a:"返回一系列定期现金流的修改后内部收益率。",m:[3,3],p:[{name:"values",detail:"其中含有投资相关收益或支出的数组或范围。\n\n现金流数额中必须至少包含一项负的和一项正的现金流金额才能计算回报率。",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"finance_rate",detail:"现金流中使用的资金支付的利率。",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"},{name:"reinvest_rate",detail:"将现金流再投资的收益率。",example:"0.12",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"IRR",t:8,d:"返回由值中的数字表示的一系列现金流的内部收益率。 ",a:"返回由值中的数字表示的一系列现金流的内部收益率。 ",m:[1,2],p:[{name:"values",detail:"其中含有投资相关收益或支出的数组或范围。\n\n现金流数额中必须至少包含一项负的和一项正的现金流金额才能计算回报率。",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"guess",detail:"[可选 - 默认为 0.1] - 内部收益率的估值。",example:"200",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"NPV",t:8,d:"使用贴现率和一系列未来支出（负值）和收益（正值）来计算一项投资的净现值。",a:"使用贴现率和一系列未来支出（负值）和收益（正值）来计算一项投资的净现值。",m:[2,255],p:[{name:"rate",detail:"某一期间的贴现率。",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"},{name:"value1",detail:"第一笔支出（负值）和收益（正值）。",example:"200",require:"m",repeat:"n",type:"rangeAll"},{name:"value2, ...",detail:"[可选] - 其他支出（负值）和收益（正值）。",example:"250",require:"o",repeat:"y",type:"rangeAll"}]},{n:"XNPV",t:8,d:"返回一组现金流的净现值，这些现金流不一定定期发生。",a:"返回一组现金流的净现值，这些现金流不一定定期发生。",m:[3,3],p:[{name:"rate",detail:"应用于现金流的贴现率。",example:"A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"values",detail:"与 dates 中的支付时间相对应的一系列现金流。",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"dates",detail:"与现金流支付相对应的支付日期表。",example:"C2:C25",require:"m",repeat:"n",type:"range"}]},{n:"CUMIPMT",t:8,d:"基于等额分期付款和固定利率，计算投资在一系列付款期内的累计利息。",a:"基于等额分期付款和固定利率，计算投资在一系列付款期内的累计利息。",m:[6,6],p:[{name:"rate",detail:"利息率。",example:"0.12",require:"m",repeat:"n",type:"rangeNumber"},{name:"nper",detail:"总付款期数。",example:"12",require:"m",repeat:"n",type:"rangeNumber"},{name:"pv",detail:"现值。",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"start_period",detail:"开始累计计算的付款期序号。\n\n首期必须大于等于1。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"end_period",detail:"结束累计计算的付款期序号。\n\n末期必须大于首期。",example:"5",require:"m",repeat:"n",type:"rangeNumber"},{name:"type",detail:"指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"0",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"PMT",t:8,d:"用于根据固定付款额和固定利率计算贷款的付款额。",a:"用于根据固定付款额和固定利率计算贷款的付款额。",m:[3,5],p:[{name:"rate",detail:"贷款利率。",example:"0.08",require:"m",repeat:"n",type:"rangeNumber"},{name:"nper",detail:"该项贷款的付款总数。",example:"12",require:"m",repeat:"n",type:"rangeNumber"},{name:"pv",detail:"现值，或一系列未来付款额现在所值的总额，也叫本金。",example:" 100000",require:"m",repeat:"n",type:"rangeNumber"},{name:"fv",detail:"[可选 - 默认值为 0] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"D2",require:"m",repeat:"n",type:"rangeNumber"},{name:"type",detail:"[可选 - 默认值为 0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"IPMT",t:8,d:"基于固定利率及等额分期付款方式，返回给定期数内对投资的利息偿还额。",a:"基于固定利率及等额分期付款方式，返回给定期数内对投资的利息偿还额。",m:[4,6],p:[{name:"rate",detail:"各期利率。",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"},{name:"per",detail:"用于计算其利息数额的期数，必须在 1 到 nper 之间。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"nper",detail:"年金的付款总期数。",example:"12",require:"m",repeat:"n",type:"rangeNumber"},{name:"pv",detail:"现值，或一系列未来付款的当前值的累积和。",example:"80000",require:"m",repeat:"n",type:"rangeNumber"},{name:"fv",detail:"[可选 - 默认值为 0] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"E2",require:"m",repeat:"n",type:"rangeNumber"},{name:"type",detail:"[可选 - 默认值为 0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"PPMT",t:8,d:"返回根据定期固定付款和固定利率而定的投资在已知期间内的本金偿付额。",a:"返回根据定期固定付款和固定利率而定的投资在已知期间内的本金偿付额。",m:[4,6],p:[{name:"rate",detail:"各期利率。",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"},{name:"per",detail:"指定期数，该值必须在 1 到 nper 范围内。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"nper",detail:"年金的付款总期数。",example:"3*12",require:"m",repeat:"n",type:"rangeNumber"},{name:"pv",detail:"现值即一系列未来付款当前值的总和。",example:"100000",require:"m",repeat:"n",type:"rangeNumber"},{name:"fv",detail:"[可选 - 默认值为 0] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"0",require:"o",repeat:"n",type:"rangeNumber"},{name:"type",detail:"[可选 - 默认值为 0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"INTRATE",t:8,d:"返回完全投资型证券的利率。",a:"返回完全投资型证券的利率。",m:[4,5],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"investment",detail:"有价证券的投资额。",example:"100000",require:"m",repeat:"n",type:"rangeNumber"},{name:"redemption",detail:"有价证券到期时的兑换值。",example:"101200",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"12",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"PRICE",t:8,d:"返回定期付息的面值 ￥100 的有价证券的价格。",a:"返回定期付息的面值 ￥100 的有价证券的价格。",m:[6,7],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"rate",detail:"有价证券的年息票利率。",example:"0.057",require:"m",repeat:"n",type:"rangeNumber"},{name:"yld",detail:"有价证券的年收益率。",example:"0.065",require:"m",repeat:"n",type:"rangeNumber"},{name:"redemption",detail:"面值 ￥100 的有价证券的清偿价值。",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"PRICEDISC",t:8,d:"返回折价发行的面值 ￥100 的有价证券的价格。",a:"返回折价发行的面值 ￥100 的有价证券的价格。",m:[4,5],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"discount",detail:"有价证券的贴现率。",example:"0.0525",require:"m",repeat:"n",type:"rangeNumber"},{name:"redemption",detail:"面值 ￥100 的有价证券的清偿价值。",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"PRICEMAT",t:8,d:"返回到期付息的面值 ￥100 的有价证券的价格。",a:"返回到期付息的面值 ￥100 的有价证券的价格。",m:[5,6],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"issue",detail:"有价证券的发行日。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"rate",detail:"有价证券在发行日的利率。",example:"0.061",require:"m",repeat:"n",type:"rangeNumber"},{name:"yld",detail:"有价证券的年收益率。",example:"0.061",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"RECEIVED",t:8,d:"返回一次性付息的有价证券到期收回的金额。",a:"返回一次性付息的有价证券到期收回的金额。",m:[4,5],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"investment",detail:"有价证券的投资额。",example:"10000000",require:"m",repeat:"n",type:"rangeNumber"},{name:"discount",detail:"有价证券的贴现率。",example:"0.0575",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"12",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DISC",t:8,d:"返回有价证券的贴现率。",a:"返回有价证券的贴现率。",m:[4,5],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"pr",detail:"有价证券的价格（按面值为 ￥100 计算）。",example:"97.975",require:"m",repeat:"n",type:"rangeNumber"},{name:"redemption",detail:"面值 ￥100 的有价证券的清偿价值。",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"12",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"NPER",t:8,d:"基于固定利率及等额分期付款方式，返回某项投资的总期数。",a:"基于固定利率及等额分期付款方式，返回某项投资的总期数。",m:[3,5],p:[{name:"rate",detail:"各期利率。",example:"0.12",require:"m",repeat:"n",type:"rangeNumber"},{name:"pmt",detail:"各期所应支付的金额，在整个年金期间保持不变。",example:"500",require:"m",repeat:"n",type:"rangeNumber"},{name:"pv",detail:"现值，或一系列未来付款的当前值的累积和。",example:"40000",require:"m",repeat:"n",type:"rangeNumber"},{name:"fv",detail:"[可选 - 默认值为0] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"0",require:"o",repeat:"n",type:"rangeNumber"},{name:"type",detail:"[可选 - 默认值为0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"SLN",t:8,d:"返回一个期间内的资产的直线折旧。",a:"返回一个期间内的资产的直线折旧。",m:[3,3],p:[{name:"cost",detail:"资产原值。",example:"300000",require:"m",repeat:"n",type:"rangeNumber"},{name:"salvage",detail:"折旧末尾时的值（有时也称为资产残值）。",example:"75000",require:"m",repeat:"n",type:"rangeNumber"},{name:"life",detail:"资产的折旧期数（有时也称作资产的使用寿命）。",example:"10",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DURATION",t:8,d:"返回假设面值 ￥100 的定期付息有价证券的修正期限。",a:"返回假设面值 ￥100 的定期付息有价证券的修正期限。",m:[5,6],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"coupon",detail:"有价证券的年息票利率。",example:"0.08",require:"m",repeat:"n",type:"rangeNumber"},{name:"yld",detail:"有价证券的年收益率。",example:"0.09",require:"m",repeat:"n",type:"rangeNumber"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"MDURATION",t:8,d:"返回假设面值 ￥100 的有价证券的 Macauley 修正期限。",a:"返回假设面值 ￥100 的有价证券的 Macauley 修正期限。",m:[5,6],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"coupon",detail:"有价证券的年息票利率。",example:"0.08",require:"m",repeat:"n",type:"rangeNumber"},{name:"yld",detail:"有价证券的年收益率。",example:"0.09",require:"m",repeat:"n",type:"rangeNumber"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"BIN2DEC",t:9,d:"将二进制数转换为十进制数。",a:"将二进制数转换为十进制数。",m:[1,1],p:[{name:"number",detail:'要转换为十进制数的带符号的10位二进制数值（以字符串形式提供）。\n\n带符号的二进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n对于此函数，最大的正数输入值为0111111111，最小的负数输入值为1000000000。\n\n如果所提供的带符号的二进制数是有效的二进制数，会自动将其转换为相应的字符串输入。例如，BIN2DEC(100)和BIN2DEC("100")得出的结果相同，均为4。',example:"101",require:"m",repeat:"n",type:"rangeAll"}]},{n:"BIN2HEX",t:9,d:"将二进制数转换为十六进制数。",a:"将二进制数转换为十六进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的十六进制数的带符号的10位二进制数值（以字符串形式提供）。\n\n带符号的二进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n对于此函数，最大的正数输入值为0111111111，最小的负数输入值为1000000000。\n\n如果所提供的带符号的二进制数是有效的二进制数，会自动将其转换为相应的字符串输入。例如，BIN2HEX(11111)和BIN2HEX("11111")得出 的结果相同，均为1F。',example:"101",require:"m",repeat:"n",type:"rangeAll"},{name:"places",detail:'[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。例如，BIN2HEX("11111",8)所得的结果值为0000001F。\n\n如果带符号的二进制数的最高位为1，则忽略此值；即当提供的带符号的二进制数大于等于1000000000时忽略此值。',example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"BIN2OCT",t:9,d:"将二进制数转换为八进制数。",a:"将二进制数转换为八进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的八进制数的带符号的10位二进制数值（以字符串形式提供）。\n\n带符号的二进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n对于此函数，最大的正数输入值为0111111111，最小的负数输入值为1000000000。\n\n如果所提供的带符号的二进制数是有效的二进制数，会自动将其转换为相应的字符串输入。例如，BIN2OCT(11111)和BIN2OCT("11111")得出的结果相同，均为37。',example:"101",require:"m",repeat:"n",type:"rangeAll"},{name:"places",detail:'[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。例如，BIN2OCT("11111")得到的结果值为00000037。\n\n如果带符号的二进制数的最高位为1，则忽略此值；即当提供的带符号的二进制数大于等于1000000000时忽略此值。',example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DEC2BIN",t:9,d:"将十进制数转换为二进制数。",a:"将十进制数转换为二进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的二进制数的十进制数值（以字符串形式提供）。\n\n对于此函数，最大的正数输入值为511，最小的负数输入值为-512。\n\n如果所提供的十进制数是有效的十进制数，会自动将其转换为相应的字符串输入。例如，DEC2BIN(199)和DEC2BIN("199")得出的结果相同，均为11000111。',example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果十进制数为负数，则忽略此值。",example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DEC2HEX",t:9,d:"将十进制数转换为十六进制数。",a:"将十进制数转换为十六进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的十六进制数的十进制数值（以字符串形式提供）。\n\n此函数可接受的最大正数值为549755813887，最小负数值为-549755814888。\n\n如果所提供的十进制数是有效的十进制数，会自动将其转换为相应的字符串输入。例如，DEC2HEX(100)和DEC2HEX("100")得出的结果相同，均为64。',example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果十进制数为负数，则忽略此值。",example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DEC2OCT",t:9,d:"将十进制数转换为八进制数。",a:"将十进制数转换为八进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的八进制数的十进制数值（以字符串形式提供）。\n\n此函数可接受的最大正数值为536870911，最小负数值为-53687092。\n\n如果所提供的十进制数是有效的十进制数，会自动将其转换为相应的字符串输入。例如，DEC2OCT(199)和DEC2OCT("199")得出的结果相同，均为307。',example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果十进制数为负数，则忽略此值。",example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"HEX2BIN",t:9,d:"将十六进制数转换为二进制数。",a:"将十六进制数转换为二进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的二进制数的带符号的40位十六进制数值（以字符串形式提供）。\n\n带符号的十六进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为1FF，最小负数值为FFFFFFFE00。\n\n如果所提供的带符号的十六进制数是有效的十六进制数，函数会自动将其转换为相应的字符串输入。例如，HEX2BIN(199)和HEX2BIN("199")得出的结果相同，均为110011001。',example:'"f3"',require:"m",repeat:"n",type:"rangeAll"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果带符号的十六进制数的最高位为1，则忽略此值；即当提供的带符号的十六进制数大于等于8000000000时忽略此值。",example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"HEX2DEC",t:9,d:"将十六进制数转换为十进制数。",a:"将十六进制数转换为十进制数。",m:[1,1],p:[{name:"number",detail:'要转换为十进制数的带符号的40位十六进制数值（以字符串形式提供）。\n\n带符号的十六进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为7fffffffff，最小负数值为8000000000。\n\n如果所提供的带符号的十六进制数是有效的十六进制数，函数会自动将其转换为相应的字符串输入。例如，HEX2DEC(199)和HEX2DEC("199")得出的结果相同，均为409。',example:'"f3"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"HEX2OCT",t:9,d:"将十六进制数转换为八进制数。",a:"将十六进制数转换为八进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的八进制数的带符号的40位十六进制数值（以字符串形式提供）。\n\n带符号的十六进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为1FFFFFFF，最小负数值为FFE0000000。\n\n如果所提供的带符号的十六进制数是有效的十六进制数，函数会自动将其转换为相应的字符串输入。例如，HEX2OCT(199)和HEX2OCT("199")得出的结果相同，均为631。',example:'"f3"',require:"m",repeat:"n",type:"rangeAll"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果带符号的十六进制数的最高位为1，则忽略此值；即当给定的带符号的十六进制数大于等于8000000000时忽略此值。",example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"OCT2BIN",t:9,d:"将八进制数转换为二进制数。",a:"将八进制数转换为二进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的二进制数的带符号的30位八进制数值（以字符串形式提供）。\n\n带符号的八进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为777，最小负数值为7777777000。\n\n如果所提供的带符号的八进制数是有效的八进制数，函数会自动将其转换为相应的字符串输入。例如，OCT2BIN(177)和OCT2BIN("177")得出的结果相同，均为1111111。',example:"37",require:"m",repeat:"n",type:"rangeAll"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果带符号的八进制数的最高位为1，则忽略此值；即当给定的带符号的八进制数大于等于4000000000时忽略此值。",example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"OCT2DEC",t:9,d:"将八进制数转换为十进制数。",a:"将八进制数转换为十进制数。",m:[1,1],p:[{name:"number",detail:'要转换为十进制数的带符号的30位八进制数值（以字符串形式提供）。\n\n带符号的ba进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为3777777777，最小负数值为4000000000。\n\n如果所提供的带符号的八进制数是有效的八进制数，函数会自动将其转换为相应的字符串输入。例如，OCT2DEC(177)和OCT2DEC("177")得出的结果相同，均为127。',example:"37",require:"m",repeat:"n",type:"rangeAll"}]},{n:"OCT2HEX",t:9,d:"将八进制数转换为十六进制数。",a:"将八进制数转换为十六进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的十六进制数的带符号的30位八进制数值（以字符串形式提供）。\n\n带符号的ba进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为3777777777，最小负数值为4000000000。\n\n如果所提供的带符号的八进制数是有效的八进制数，函数会自动将其转换为相应的字符串输入。例如，OCT2HEX(177)和OCT2HEX("177")得出的结果相同，均为7F。',example:"37",require:"m",repeat:"n",type:"rangeAll"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果带符号的八进制数的最高位为1，则忽略此值；即当给定的带符号的八进制数大于等于4000000000时忽略此值。",example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"COMPLEX",t:9,d:"将实系数及虚系数转换为 x+yi 或 x+yj 形式的复数。",a:"将实系数及虚系数转换为 x+yi 或 x+yj 形式的复数。",m:[2,3],p:[{name:"real_num",detail:"复数的实系数。",example:"3",require:"m",repeat:"n",type:"rangeNumber"},{name:"i_num",detail:"复数的虚系数。",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"suffix",detail:'[可选 - 默认为 "i"] - 复数中虚系数的后缀。',example:'"j"',require:"o",repeat:"n",type:"rangestring"}]},{n:"IMREAL",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的复数的实系数。",a:"返回以 x+yi 或 x+yj 文本格式表示的复数的实系数。",m:[1,1],p:[{name:"inumber",detail:"需要计算其实系数的复数。",example:'"4+5i"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"IMAGINARY",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的复数的虚系数。",a:"返回以 x+yi 或 x+yj 文本格式表示的复数的虚系数。",m:[1,1],p:[{name:"inumber",detail:"需要计算其虚系数的复数。",example:'"4+5i"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"IMCONJUGATE",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的复数的共轭复数。",a:"返回以 x+yi 或 x+yj 文本格式表示的复数的共轭复数。",m:[1,1],p:[{name:"inumber",detail:"需要计算其共轭数的复数。",example:'"3+4i"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"IMABS",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的复数的绝对值（模）。",a:"返回以 x+yi 或 x+yj 文本格式表示的复数的绝对值（模）。",m:[1,1],p:[{name:"inumber",detail:"要计算其绝对值的复数。",example:'"3+4i"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"DELTA",t:9,d:"检验两个值是否相等。 如果 number1=number2，则返回 1；否则返回 0。",a:"检验两个值是否相等。 如果 number1=number2，则返回 1；否则返回 0。",m:[1,2],p:[{name:"number1",detail:"第一个数字。",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"number2",detail:"[可选 - 默认为 0] - 第二个数字。",example:"1",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"IMSUM",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的 1 至 255 个复数的和。",a:"返回以 x+yi 或 x+yj 文本格式表示的 1 至 255 个复数的和。",m:[1,255],p:[{name:"inumber1",detail:"要相加的第一个复数",example:'"3+4i"',require:"m",repeat:"n",type:"rangeAll"},{name:"inumber2, …",detail:"[可选] - 要与值1 相加的其他复数",example:'"5-3i"',require:"o",repeat:"y",type:"rangeAll"}]},{n:"IMSUB",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的两个复数的差。",a:"返回以 x+yi 或 x+yj 文本格式表示的两个复数的差。",m:[2,2],p:[{name:"inumber1",detail:"从（复）数中减去 inumber2。",example:'"6+5i"',require:"m",repeat:"n",type:"rangeAll"},{name:"inumber2",detail:"从 inumber1 中减（复）数。",example:'"2+3i"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"IMPRODUCT",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的 1 至 255 个复数的乘积。",a:"返回以 x+yi 或 x+yj 文本格式表示的 1 至 255 个复数的乘积。",m:[1,255],p:[{name:"inumber1",detail:"用于计算乘积的第一个复数",example:'"3+4i"',require:"m",repeat:"n",type:"rangeAll"},{name:"inumber2, …",detail:"[可选] - 要相乘的其他复数。",example:'"5-3i"',require:"o",repeat:"y",type:"rangeAll"}]},{n:"IMDIV",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的两个复数的商。",a:"返回以 x+yi 或 x+yj 文本格式表示的两个复数的商。",m:[2,2],p:[{name:"inumber1",detail:"复数分子或被除数。",example:'"11+16i"',require:"m",repeat:"n",type:"rangeAll"},{name:"inumber2",detail:"复数分母或除数。",example:'"3+2i"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"NOT",t:10,d:"返回某个逻辑值的相反值 - “NOT(TRUE())”将返回 FALSE；“NOT(FALSE())”将返回 TRUE。",a:"返回某个逻辑值的相反值 - “NOT(TRUE())”将返回 FALSE；“NOT(FALSE())”将返回 TRUE。",m:[1,1],p:[{name:"logical",detail:"计算结果为 TRUE 或 FALSE 的任何值或表达式。",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"TRUE",t:10,d:"返回逻辑值 TRUE。",a:"返回逻辑值 TRUE。",m:[0,0],p:[]},{n:"FALSE",t:10,d:"返回逻辑值 FALSE。",a:"返回逻辑值 FALSE。",m:[0,0],p:[]},{n:"AND",t:10,d:"所有参数的计算结果为 TRUE 时，返回 TRUE；只要有一个参数的计算结果为 FALSE，即返回 FALSE。",a:"所有参数的计算结果为 TRUE 时，返回 TRUE；只要有一个参数的计算结果为 FALSE，即返回 FALSE。",m:[1,255],p:[{name:"logical1",detail:"要测试的第一个条件，其计算结果可以为 TRUE 或 FALSE。",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeAll"},{name:"logical2,...",detail:"[可选] - 要测试的其他条件，其计算结果可以为 TRUE 或 FALSE，最多可包含 255 个条件。",example:'A3 = "bar"',require:"o",repeat:"y",type:"rangeAll"}]},{n:"IFERROR",t:10,d:"如果第一个参数不是错误值，就返回第一个参数；否则，返回第二个参数。",a:"如果第一个参数不是错误值",m:[2,2],p:[{name:"value",detail:"检查是否存在错误的参数。",example:"A1",require:"m",repeat:"n",type:"rangeAll"},{name:"value_if_error",detail:"公式的计算结果错误时返回的值。 计算以下错误类型：#N/A、#VALUE!、#REF!、#DIV/0!、#NUM!、#NAME? 或 #NULL!。",example:'"Error in cell A1"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"IF",t:10,d:"当逻辑表达式的值为 TRUE 时返回一个值，而当其为 FALSE 时返回另一个值。",a:"当逻辑表达式的值为 TRUE 时返回一个值，而当其为 FALSE 时返回另一个值。",m:[2,3],p:[{name:"logical_test",detail:"一个表达式或对包含表达式的单元格的引用，该表达式代表某种逻辑值（即TRUE或FALSE）。",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeAll"},{name:"value_if_true",detail:"当逻辑表达式为TRUE时的返回值。",example:'"A2 is foo"',require:"m",repeat:"n",type:"rangeAll"},{name:"value_if_false",detail:"[可选 - 默认为空白] - 当逻辑表达式等于FALSE时的函数返回值。",example:'"A2 was false"',require:"o",repeat:"n",type:"rangeAll"}]},{n:"OR",t:10,d:"只要有一个参数的计算结果为 TRUE 时，返回 TRUE；所有参数的计算结果为 FALSE，即返回 FALSE。",a:"只要有一个参数的计算结果为 TRUE 时，返回 TRUE；所有参数的计算结果为 FALSE，即返回 FALSE。",m:[1,255],p:[{name:"logical1",detail:"要测试的第一个条件，其计算结果可以为 TRUE 或 FALSE。",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeAll"},{name:"逻辑表达式2",detail:"[可选] - 其他表达式或对包含表达式的单元格的引用，这些表达式代表某种逻辑值（即TRUE或FALSE）或者可以强制转换为逻辑值。",example:' A3 = "bar"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"NE",t:11,d:"如果指定的值不相等，则返回“TRUE”；否则返回“FALSE”。相当于“<>”运算符。",a:"如果指定的值不相等，则返回“TRUE”；否则返回“FALSE”。相当于“<>”运算符。",m:[2,2],p:[{name:"value1",detail:"第一个值。",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"要检查是否与 value1 不相等的值。",example:"A3",require:"m",repeat:"n",type:"rangeAll"}]},{n:"EQ",t:11,d:"如果指定的值相等，则返回“TRUE”；否则返回“FALSE”。相当于“=”运算符。",a:"如果指定的值相等，则返回“TRUE”；否则返回“FALSE”。相当于“=”运算符。",m:[2,2],p:[{name:"value1",detail:"第一个值。",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"要检查是否与 value1 相等的值。",example:"A3",require:"m",repeat:"n",type:"rangeAll"}]},{n:"GT",t:11,d:"如果第一个参数严格大于第二个，则返回 TRUE；否则返回 FALSE。相当于“>”运算符。",a:"如果第一个参数严格大于第二个，则返回 TRUE；否则返回 FALSE。相当于“>”运算符。",m:[2,2],p:[{name:"value1",detail:"要测试其是否大于 value2 的值。",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"第二个值。",example:"A3",require:"m",repeat:"n",type:"rangeAll"}]},{n:"GTE",t:11,d:"如果第一个参数大于或等于第二个，则返回 TRUE；否则返回 FALSE。相当于“>=”运算符。",a:"如果第一个参数大于或等于第二个，则返回 TRUE；否则返回 FALSE。相当于“>=”运算符。",m:[2,2],p:[{name:"value1",detail:"要测试其是否大于等于 value2 的值。",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"第二个值。",example:"A3",require:"m",repeat:"n",type:"rangeAll"}]},{n:"LT",t:11,d:"如果第一个参数严格小于第二个，则返回 TRUE；否则返回 FALSE。相当于“<”运算符。",a:"如果第一个参数严格小于第二个，则返回 TRUE；否则返回 FALSE。相当于“<”运算符。",m:[2,2],p:[{name:"value1",detail:"要测试其是否小于 value2 的值。",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"第二个值。",example:"A3",require:"m",repeat:"n",type:"rangeAll"}]},{n:"LTE",t:11,d:"如果第一个参数小于或等于第二个，则返回 TRUE；否则返回 FALSE。相当于“<=”运算符。",a:"如果第一个参数小于或等于第二个，则返回 TRUE；否则返回 FALSE。相当于“<=”运算符。",m:[2,2],p:[{name:"value1",detail:"要测试其是否小于等于 value2 的值。",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"第二个值。",example:"A3",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ADD",t:11,d:"返回两个数值之和。相当于 `+` 运算符。",a:"返回两个数值之和。相当于 `+` 运算符。",m:[2,2],p:[{name:"value1",detail:"第一个加数。",example:"A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"第二个加数。",example:"A3",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MINUS",t:11,d:"返回两个数值之差。相当于“-”运算符。",a:"返回两个数值之差。相当于“-”运算符。",m:[2,2],p:[{name:"value1",detail:"被减数，即要对其计减的数值。",example:"A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"减数，即要从 value1 中减除的数值。",example:"A3",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MULTIPLY",t:11,d:"返回两个数的乘积。相当于“*”运算符。",a:"返回两个数的乘积。相当于“*”运算符。",m:[2,2],p:[{name:"value1",detail:"第一个乘数。",example:"A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"第二个乘数。",example:"B2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DIVIDE",t:11,d:"返回两个参数相除所得的结果。相当于 `/` 运算符。",a:"返回两个参数相除所得的结果。相当于 `/` 运算符。",m:[2,2],p:[{name:"value1",detail:"要被除的数值。",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"用于除其他数的数值。\n\n除数不得为0。",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"CONCAT",t:11,d:"返回两个值的串联。相当于 `&` 运算符。",a:"返回两个值的串联。相当于 `&` 运算符。",m:[2,2],p:[{name:"value1",detail:"value2 将附于其后的值。",example:'"de"',require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"要附于 value1 之后的值。",example:'"mystify"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"UNARY_PERCENT",t:11,d:"返回按百分比解释的数值。例如，“UNARY_PERCENT(100)”等于1。",a:"返回按百分比解释的数值。例如，“UNARY_PERCENT(100)”等于1。",m:[1,1],p:[{name:"number",detail:"要作为百分比解释的数值。",example:"A2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"CONCATENATE",t:12,d:"将两个或多个文本字符串联接为一个字符串。",a:"将两个或多个文本字符串联接为一个字符串。",m:[1,255],p:[{name:"text1",detail:"初始字符串。",example:'"Super"',require:"m",repeat:"n",type:"rangeAll"},{name:"text2 ...",detail:"[可选] - 要按顺序连接在一起的其他字符串。",example:'"calla"',require:"o",repeat:"y",type:"rangeAll"}]},{n:"CODE",t:12,d:"返回所提供的字符串中首字符的 Unicode 映射值。",a:"返回所提供的字符串中首字符的 Unicode 映射值。",m:[1,1],p:[{name:"text",detail:"要返回其首字符的Unicode映射值的字符串。",example:'"a"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"CHAR",t:12,d:"按照当前 Unicode 编码表，将数字转换为对应的字符。",a:"按照当前 Unicode 编码表，将数字转换为对应的字符。",m:[1,1],p:[{name:"number",detail:"介于 1 到 255 之间的数字。",example:"97",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ARABIC",t:12,d:"将罗马数字转换为阿拉伯数字。",a:"将罗马数字转换为阿拉伯数字。",m:[1,1],p:[{name:"text",detail:"要转换格式的罗马数字",example:'"XIV"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"ROMAN",t:12,d:"将数字格式设置为罗马数字形式。",a:"将数字格式设置为罗马数字形式。",m:[1,1],p:[{name:"number",detail:"要设置格式的数字，介于1到3999之间（包括这两个数字）。",example:"499",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"REGEXEXTRACT",t:12,d:"按照正则表达式提取匹配的子串。",a:"按照正则表达式提取匹配的子串。",m:[2,2],p:[{name:"text",detail:"输入文本。",example:'"Needle in a haystack"',require:"m",repeat:"n",type:"rangeAll"},{name:"regular_expression",detail:"此函数将返回文本中符合此表达式的第一个子串。",example:'".e{2}dle"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"REGEXMATCH",t:12,d:"判断一段文本是否与正则表达式相匹配。",a:"判断一段文本是否与正则表达式相匹配。",m:[2,2],p:[{name:"text",detail:"要用正则表达式测试的文本。",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeAll"},{name:"regular_expression",detail:"用来测试文本的正则表达式。",example:'"S.r"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"REGEXREPLACE",t:12,d:"使用正则表达式将文本字符串中的一部分替换为其他文本字符串。",a:"使用正则表达式将文本字符串中的一部分替换为其他文本字符串。",m:[3,3],p:[{name:"text",detail:"要对其局部进行替换操作的文本。",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeAll"},{name:"regular_expression",detail:"正则表达式。 text 中所有匹配的实例都将被替换。",example:'"S.*d"',require:"m",repeat:"n",type:"rangeAll"},{name:"replacement",detail:"要插入到原有文本中的文本。",example:'"Bed"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"T",t:12,d:"返回文本格式的字符串参数。",a:"返回文本格式的字符串参数。",m:[1,1],p:[{name:"value",detail:"要转换为文本的参数。\n\n如果值为文本，T将返回值本身。\n\n如果值为指向包含文本的单元格的引用，T将返回值中的内容。\n\n如果值为错误值或包含错误值的单元格，T将返回该错误值。\n\n对于所有其他情况，T将返回空串。",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"FIXED",t:12,d:"以固定的小数位数设置数字的格式。",a:"以固定的小数位数设置数字的格式。",m:[1,3],p:[{name:"number",detail:"要进行舍入并转换为文本的数字。",example:"3.141592653",require:"m",repeat:"n",type:"rangeNumber"},{name:"decimals",detail:"[可选 - 默认值为2] - 结果中要显示的小数位数。\n\n如果数值的有效位数小于小数位数，将以零填充。如果数值的有效位数大于小数位数，则将其舍入到所需的小数位数而不是将其截断。",example:"2",require:"o",repeat:"n",type:"rangeNumber"},{name:"no_commas",detail:"[可选 - 默认值为FALSE()] - 一个逻辑值，如果为 TRUE()，则会禁止 FIXED 在返回的文本中包含逗号。",example:"FALSE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"FIND",t:12,d:"返回字符串在文本中首次出现的位置（区分大小写）。",a:"返回字符串在文本中首次出现的位置（区分大小写）。",m:[2,3],p:[{name:"find_text",detail:"要在要搜索的文本中查找的字符串。",example:'"n"',require:"m",repeat:"n",type:"rangeAll"},{name:"within_text",detail:"要在其中搜索搜索字符串的首次出现位置的文本。",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"start_num",detail:"[可选 - 默认值为1] - 要在要搜索的文本中开始搜索的字符位置。",example:"14",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"FINDB",t:12,d:"返回某个字符串在文本中首次出现的位置（每个双字节字符占两个位置）。",a:"返回某个字符串在文本中首次出现的位置（每个双字节字符占两个位置）。",m:[2,3],p:[{name:"find_text",detail:"要在要搜索的文本中查找的字符串。",example:'"新"',require:"m",repeat:"n",type:"rangeAll"},{name:"within_text",detail:"要在其中搜索搜索字符串的首次出现位置的文本。",example:'"农历新年"',require:"m",repeat:"n",type:"rangeAll"},{name:"start_num",detail:"[可选 - 默认值为 1] - 要在要搜索的文本中开始搜索的字符位置。",example:"2",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"JOIN",t:12,d:"将一个或多个使用指定定界符的一维数组的元素连接到一起。",a:"将一个或多个使用指定定界符的一维数组的元素连接到一起。",m:[2,255],p:[{name:"separator",detail:"置于相互连接的值之间的字符或字符串。\n\n定界符可以为空，例如JOIN(,{1,2,3})。",example:'" and-a "',require:"m",repeat:"n",type:"rangeAll"},{name:"array1",detail:"要使用定界符连接的一个或多个值。",example:"{1",require:"m",repeat:"n",type:"rangeAll"},{name:"array2, ...",detail:"[可选] - 要使用定界符连接的其他值或数组。",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"LEFT",t:12,d:"从文本字符串的第一个字符开始返回指定个数的字符。",a:"从文本字符串的第一个字符开始返回指定个数的字符。",m:[1,2],p:[{name:"text",detail:"包含要提取的字符的文本字符串。",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"num_chars",detail:"[可选 - 默认值为1] - 指定要由 LEFT 提取的字符的数量。",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"RIGHT",t:12,d:"根据所指定的字符数返回文本字符串中最后一个或多个字符。",a:"根据所指定的字符数返回文本字符串中最后一个或多个字符。",m:[1,2],p:[{name:"text",detail:"包含要提取的字符的文本字符串。",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"num_chars",detail:"[可选 - 默认值为1] - 指定要由 RIGHT 提取的字符的数量。",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MID",t:12,d:"返回文本字符串中从指定位置开始的特定数目的字符。",a:"返回文本字符串中从指定位置开始的特定数目的字符。",m:[3,3],p:[{name:"text",detail:"包含要提取的字符的文本字符串。",example:'"get this"',require:"m",repeat:"n",type:"rangeAll"},{name:"start_num",detail:"要从字符串中开始提取的位置。字符串中第一个字符的索引为1。",example:"5",require:"m",repeat:"n",type:"rangeNumber"},{name:"num_chars",detail:"指定要由 MID 提取的字符的数量。\n\n如果提取的字符数尚不足提取长度个字符时就到达了字符串尾部，则MID返回从开始位置到字符串尾部的字符。",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"LEN",t:12,d:"返回给定字符串的长度。",a:"返回给定字符串的长度。",m:[1,1],p:[{name:"text",detail:"要返回其长度的字符串。",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"LENB",t:12,d:"返回文本中所包含的字符数。与双字节字符集(DBCS)一起使用。",a:"返回文本中所包含的字符数。与双字节字符集(DBCS)一起使用。",m:[1,1],p:[{name:"text",detail:"要返回其字节数的字符串。（一个汉字为两个字节数）",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"LOWER",t:12,d:"将指定字符串中的字母转换为小写。",a:"将指定字符串中的字母转换为小写。",m:[1,1],p:[{name:"text",detail:"要转换为小写的字符串。",example:'"LOREM IPSUM"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"UPPER",t:12,d:"将指定字符串中的字母转换为大写。",a:"将指定字符串中的字母转换为大写。",m:[1,1],p:[{name:"text",detail:"要转换为大写的字符串。",example:'"lorem ipsum"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"EXACT",t:12,d:"比较两个字符串是否相同。",a:"比较两个字符串是否相同。",m:[2,2],p:[{name:"text1",detail:"要比较的第一个字符串。",example:"A1",require:"m",repeat:"n",type:"rangeAll"},{name:"text2",detail:"要比较的第二个字符串。",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"REPLACE",t:12,d:"将文本字符串的一部分替换为其他文本字符串。",a:"将文本字符串的一部分替换为其他文本字符串。",m:[4,4],p:[{name:"old_text",detail:"要对其局部进行替换操作的文本。",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeAll"},{name:"start_num",detail:"开始进行替换操作的位置（文本开头位置为 1）。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"num_chars",detail:"要在文本中替换的字符个数。",example:"6",require:"m",repeat:"n",type:"rangeNumber"},{name:"new_text",detail:"要插入到原有文本中的文本。",example:'"Bed"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"REPT",t:12,d:"返回指定文本的多次重复。",a:"返回指定文本的多次重复。",m:[2,2],p:[{name:"text",detail:"要重复的字符或字符串。",example:'"ha"',require:"m",repeat:"n",type:"rangeAll"},{name:"number_times",detail:"要重复的文本要在返回值中出现的次数。\n\n最大重复次数为100。即使重复次数大于100，REPT也仅将相应文本重复100次。",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SEARCH",t:12,d:"返回字符串在文本中首次出现的位置（不区分大小写）。",a:"返回字符串在文本中首次出现的位置（不区分大小写）。",m:[2,3],p:[{name:"find_text",detail:"要在要搜索的文本中查找的字符串。",example:'"n"',require:"m",repeat:"n",type:"rangeAll"},{name:"within_text",detail:"要在其中搜索搜索字符串的首次出现位置的文本。",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"start_num",detail:"[ 可选 - 默认值为1 ] - 要在要搜索的文本中开始搜索的字符位置。",example:"14",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SUBSTITUTE",t:12,d:"在文本字符串中用 new_text 替换 old_text。",a:"在文本字符串中用 new_text 替换 old_text。",m:[3,4],p:[{name:"text",detail:"需要替换其中字符的文本，或对含有文本（需要替换其中字符）的单元格的引用。",example:'"search for it"',require:"m",repeat:"n",type:"rangeAll"},{name:"old_text",detail:"需要替换的文本。",example:'"search for"',require:"m",repeat:"n",type:"rangeAll"},{name:"new_text",detail:"用于替换 old_text 的文本。",example:'"Google"',require:"m",repeat:"n",type:"rangeAll"},{name:"instance_num",detail:"[ 可选 ] - 指定要用 new_text 替换 old_text 的事件。 如果指定了 instance_num，则只有满足要求的 old_text 被替换。 否则，文本中出现的所有 old_text 都会更改为 new_text。",example:"3",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"CLEAN",t:12,d:"移除文本中的不可打印 ASCII 字符后将其返回。",a:"移除文本中的不可打印 ASCII 字符后将其返回。",m:[1,1],p:[{name:"text",detail:"要移除其中不可打印字符的文本。",example:'"AF"&CHAR(31)',require:"m",repeat:"n",type:"rangeAll"}]},{n:"TEXT",t:12,d:"按照指定格式将数字转换为文本。",a:"按照指定格式将数字转换为文本。",m:[2,2],p:[{name:"value",detail:"要设置格式的数字、日期或时间。",example:"1.23",require:"m",repeat:"n",type:"rangeNumber"},{name:"format_text",detail:'以括号括起来的模式串，将按该模式设置数字的格式。\n\n0表示在数值位数少于格式指定的位数时必定以零填充。例如，TEXT(12.3,"000.00")将返回012.30。当数值的小数位数超过模式指定的小数位数时，四舍五入为指定的小数位数。例如，TEXT(12.305,"00.00")将返回12.31。\n\n#类似于0，但并不是在小数点的两侧都以零填充。例如，TEXT(12.3,"###.##")将返回12.3。',example:'"$0.00"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"TRIM",t:12,d:"删除指定字符串前后的空格。",a:"删除指定字符串前后的空格。",m:[1,1],p:[{name:"text",detail:"要修剪的字符串或指向包含该字符串的单元格的引用。",example:'" lorem ipsum"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"VALUE",t:12,d:"将可识别的任何日期、时间或数字格式的字符串转换为数字。",a:"将可识别的任何日期、时间或数字格式的字符串转换为数字。",m:[1,1],p:[{name:"text",detail:"包含要转换的值的字符串。",example:'"123"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"PROPER",t:12,d:"将指定字符串中每个单词的首字母转为大写。",a:"将指定字符串中每个单词的首字母转为大写。",m:[1,1],p:[{name:"text",detail:"要转换的文本，其中每个单词的首字母都将转为大写，所有其他字母则转为小写。",example:'"united states"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"CONVERT",t:13,d:"将数字从一种度量系统转换为另一种度量系统。",a:"将数字从一种度量系统转换为另一种度量系统。",m:[3,3],p:[{name:"number",detail:"是以 from_unit 为单位的需要进行转换的数值。",example:"5.1",require:"m",repeat:"n",type:"rangeNumber"},{name:"from_unit",detail:"是数值的单位。",example:'"g"',require:"m",repeat:"n",type:"rangeAll"},{name:"to_unit",detail:"是结果的单位。",example:'"kg"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"SUMX2MY2",t:14,d:"返回两数组中对应数值的平方差之和。",a:"返回两数组中对应数值的平方差之和。",m:[2,2],p:[{name:"array_x",detail:"第一个数组或数值区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"array_y",detail:"第二个数组或数值区域。",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SUMX2PY2",t:14,d:"返回两数组中对应数值的平方和之和。",a:"返回两数组中对应数值的平方和之和。",m:[2,2],p:[{name:"array_x",detail:"第一个数组或数值区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"array_y",detail:"第二个数组或数值区域。",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SUMXMY2",t:14,d:"返回两数组中对应数值之差的平方和。",a:"返回两数组中对应数值之差的平方和。",m:[2,2],p:[{name:"array_x",detail:"第一个数组或数值区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"array_y",detail:"第二个数组或数值区域。",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TRANSPOSE",t:14,d:"将数组或单元格范围的行列转置。",a:"将数组或单元格范围的行列转置。",m:[1,1],p:[{name:"array",detail:"要将其行列互换的数组或范围。",example:"{1,2}",require:"m",repeat:"n",type:"range"}]},{n:"TREND",t:14,d:"返回线性趋势值。",a:"返回线性趋势值。",m:[1,4],p:[{name:"known_y",detail:"关系表达式 y = mx + b 中已知的 y 值集合。\n\n如果 known_y 为二维数组或范围，则 known_x 的维数必须与之相同，或者省略此参数。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"B2:B10",require:"m",repeat:"n",type:"rangeNumber"},{name:"known_x",detail:"[可选 - 默认该数组为{1,2,3,...},其大小与 known_y 相同] - 关系表达式 y = mx + b 中已知的可选 x 值集合。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"A2:A10",require:"o",repeat:"n",type:"rangeNumber"},{name:"new_x",detail:"[可选 - 默认与 known_x 相同] -  需要函数 TREND 返回对应 y 值的新 x 值。",example:"A11:A13",require:"o",repeat:"n",type:"rangeNumber"},{name:"const",detail:"[可选 - 默认值为TRUE()] - 一个逻辑值，用于指定是否将常量 b 强制设为 0。\n\nTRUE() 表示 b 将按正常计算；\n\nFALSE() 表示 b 将被设为 0（零），m 将被调整以使 y = mx。",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"FREQUENCY",t:14,d:"计算数值在某个区域内的出现频率，然后返回一个垂直数组。",a:"计算数值在某个区域内的出现频率，然后返回一个垂直数组。",m:[2,2],p:[{name:"data_array",detail:"要对其频率进行计数的一组数值或对这组数值的引用。",example:"A2:A40",require:"m",repeat:"n",type:"rangeNumber"},{name:"bins_array",detail:"要将 data_array 中的值插入到的间隔数组或对间隔的引用。\n\n为清晰起见，应将类别排序，但如果未排序，FREQUENCY会在内部对这些指定的值进行排序并返回正确结果。",example:"B2:B5",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"GROWTH",t:14,d:"使用现有数据计算预测的指数等比。",a:"使用现有数据计算预测的指数等比。",m:[1,4],p:[{name:"known_y",detail:"关系表达式 y = b*m^x 中已知的 y 值集合。\n\n如果已知数据_y为二维数组或范围，则已知数据_x的维数必须与之相同，或者省略此参数。\n\n如果已知数据_y为一维数组或范围，已知数据_x则可代表二维数组或范围中的多个自变量。也就是说，如果已知数据_y为单行，则将已知数据_x中的每行解释为各自独立的值，类似情况也适用于已知数据_y为单列的情况。",example:"B2:B10",require:"m",repeat:"n",type:"rangeNumber"},{name:"known_x",detail:"[可选 - 默认该数组为{1,2,3,...},其大小与 known_y 相同] - 关系表达式 y = b*m^x 中已知的可选 x 值集合。\n\n如果已知数据_y为一维数组或范围，已知数据_x则可代表二维数组或范围中的多个自变量。也就是说，如果已知数据_y为单行，则将已知数据_x中的每行解释为各自独立的值，类似情况也适用于已知数据_y为单列的情况。",example:"A2:A10",require:"o",repeat:"n",type:"rangeNumber"},{name:"new_x",detail:"[可选 - 默认与 known_x 相同] - 需要函数 GROWTH 返回对应 y 值的新 x 值。",example:"A11:A13",require:"o",repeat:"n",type:"rangeNumber"},{name:"const",detail:"[可选 - 默认值为TRUE()] -一个逻辑值，用于指定是否将常量 b 强制设为 1。\n\nTRUE() 表示 b 将按正常计算；\n\nFALSE() 表示 b 将被设为 1，m 将被调整以使 y = m^x。",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"LINEST",t:14,d:"可通过使用最小二乘法计算与现有数据最佳拟合的直线，来计算某直线的统计值，然后返回描述此直线的数组。",a:"可通过使用最小二乘法计算与现有数据最佳拟合的直线，来计算某直线的统计值，然后返回描述此直线的数组。",m:[1,4],p:[{name:"known_y",detail:"关系表达式 y = mx + b 中已知的 y 值集合。\n\n如果 known_y 为二维数组或范围，则 known_x 的维数必须与之相同，或者省略此参数。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"B2:B10",require:"m",repeat:"n",type:"rangeNumber"},{name:"known_x",detail:"[可选 - 默认该数组为{1,2,3,...},其大小与 known_y 相同] - 关系表达式 y = mx + b 中已知的可选 x 值集合。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"A2:A10",require:"o",repeat:"n",type:"rangeNumber"},{name:"const",detail:"[可选 - 默认值为TRUE()] - 一个逻辑值，用于指定是否将常量 b 强制设为 0。\n\nTRUE() 表示 b 将按正常计算；\n\nFALSE() 表示 b 将被设为 0（零），m 将被调整以使 y = mx。",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"},{name:"stats",detail:"[可选 - 默认值为FALSE()] - 一个逻辑值，用于指定是否返回附加回归统计值。\n\n如果详细为TRUE，除了对应于每个自变量的一组线性系数和y截距之外，LINEST还返回以下信息：\n\n每项系数和截距的标准误差、\n\n限定系数（介于0和1之间，1表示完全相关）、\n\n因变量值的标准误差、\n\nF统计或F观测值，指示所观测到的因变量和自变量变量之间的关系是随机的还是线性的、\n\n自由度，用于在参照表中查找F统计值以估算可信度、\n\n回归平方和，以及\n\n残差平方和。",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"LOGEST",t:14,d:"在回归分析中，计算最符合数据的指数回归拟合曲线，并返回描述该曲线的数值数组。",a:"在回归分析中，计算最符合数据的指数回归拟合曲线，并返回描述该曲线的数值数组。",m:[1,4],p:[{name:"known_y",detail:"关系表达式 y = mx + b 中已知的 y 值集合。\n\n如果 known_y 为二维数组或范围，则 known_x 的维数必须与之相同，或者省略此参数。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"B2:B10",require:"m",repeat:"n",type:"rangeNumber"},{name:"known_x",detail:"[可选 - 默认该数组为{1,2,3,...},其大小与 known_y 相同] - 关系表达式 y = mx + b 中已知的可选 x 值集合。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"A2:A10",require:"o",repeat:"n",type:"rangeNumber"},{name:"const",detail:"[可选 - 默认值为TRUE()] - 一个逻辑值，用于指定是否将常量 b 强制设为 0。\n\nTRUE() 表示 b 将按正常计算；\n\nFALSE() 表示 b 将被设为 0（零），m 将被调整以使 y = mx。",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"},{name:"stats",detail:"[可选 - 默认值为FALSE()] - 一个逻辑值，用于指定是否返回附加回归统计值。\n\n如果详细为TRUE，则除了为每个自变量和系数 b 返回一组指数值之外，LOGEST 还将返回以下数据：\n\n每项指数和系数的标准误差、\n\n限定系数（介于 0 和 1 之间，1 表示完全相关）、\n\n因变量值的标准误差、\n\nF 统计或 F 观测值，指示所观测到的因变量和自变量之间的关系是随机的还是指数的、\n\n自由度 - 用于在参照表中查找 F 统计值以估算可信度、\n\n回归平方和，以及\n\n残差平方和。",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"MDETERM",t:14,d:"返回一个数组的矩阵行列式的值。",a:"返回一个数组的矩阵行列式的值。",m:[1,1],p:[{name:"array",detail:"行数和列数相等的数值数组。",example:"A1:D4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MINVERSE",t:14,d:"返回数组中存储的矩阵的逆矩阵。",a:"返回数组中存储的矩阵的逆矩阵。",m:[1,1],p:[{name:"array",detail:"行数和列数相等的数值数组。",example:"A1:D4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MMULT",t:14,d:"返回两个数组的矩阵乘积。结果矩阵的行数与 array1 的行数相同，矩阵的列数与 array2 的列数相同。",a:"返回两个数组的矩阵乘积。结果矩阵的行数与 array1 的行数相同，矩阵的列数与 array2 的列数相同。",m:[2,2],p:[{name:"array1",detail:"要进行矩阵乘法运算的第一个矩阵数组。\n\narray1 列数必须与 array2 的行数相同",example:"A1:B3",require:"m",repeat:"n",type:"rangeNumber"},{name:"array2",detail:"要进行矩阵乘法运算的第二个矩阵数组。\n\narray2 的行数必须与 array1 列数相同",example:"C1:F2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SUMPRODUCT",t:14,d:"在给定的几组数组中，将数组间对应的元素相乘，并返回乘积之和。",a:"在给定的几组数组中，将数组间对应的元素相乘，并返回乘积之和。",m:[1,255],p:[{name:"array1",detail:"其相应元素需要进行相乘并求和的第一个数组参数。",example:"A2:C5",require:"m",repeat:"n",type:"rangeNumber"},{name:"array2",detail:"[可选] - 其相应元素需要进行相乘并求和的其它数组参数。",example:"D2:F5",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"ISFORMULA",t:15,d:"检查公式是否位于引用的单元格中。",a:"检查公式是否位于引用的单元格中。",m:[1,1],p:[{name:"cell",detail:"要检查是否存在公式的单元格。\n\n如果 cell 为包含公式的单元格，则 ISFORMULA 将返回 TRUE。如果 cell 为相应单元格范围，则当该范围内的首个单元格包含公式时，系统会返回 TRUE。如果是任何其他值，系统都将返回 FALSE。",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"CELL",t:15,d:"返回有关单元格的格式、位置或内容的信息。",a:"返回有关单元格的格式、位置或内容的信息。",m:[2,2],p:[{name:"info_type",detail:"一个文本值，指定要返回的单元格信息的类型。",example:'"type"',require:"m",repeat:"n",type:"rangeAll"},{name:"reference",detail:"需要其相关信息的单元格。",example:"C2",require:"m",repeat:"n",type:"range"}]},{n:"NA",t:15,d:"返回错误值 #N/A。",a:"返回错误值 #N/A。",m:[0,0],p:[]},{n:"ERROR_TYPE",t:15,d:"返回与其他单元格中的错误值相对应的数字。",a:"返回与其他单元格中的错误值相对应的数字。",m:[1,1],p:[{name:"error_val",detail:"用于查找错误号的单元格，虽然您也可以直接提供错误值。",example:"A3",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ISBLANK",t:15,d:"检查所引用的单元格是否为空。",a:"检查所引用的单元格是否为空。",m:[1,1],p:[{name:"value",detail:"对要检查其是否为空的单元格的引用。\n\n如果是空单元格，则 TRUE；否则返回 FALSE。",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISERR",t:15,d:"检查某个值是否为 #N/A 以外的错误值。",a:"检查某个值是否为 #N/A 以外的错误值。",m:[1,1],p:[{name:"value",detail:"要验证其是否为#N/A以外的错误类型的值。\n\n如果值是除#N/A之外的任何错误（包括#DIV/0!、#NAME?、#NULL!、#NUM!、#VALUE!和#REF!），ISERR将返回TRUE。",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ISERROR",t:15,d:"检查某个值是否为错误值。",a:"检查某个值是否为错误值。",m:[1,1],p:[{name:"value",detail:"要验证其是否为错误类型的值。\n\n只要值是某种错误值（包括#DIV/0!、#N/A、#NAME?、#NULL!、#NUM!、#VALUE!和#REF!），ISERROR就会返回TRUE。",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ISLOGICAL",t:15,d:"检查某个值是 TRUE 还是 FALSE。",a:"检查某个值是 TRUE 还是 FALSE。",m:[1,1],p:[{name:"value",detail:"要验证其为逻辑TRUE还是逻辑FALSE的值。\n\n*如果值为TRUE或FALSE，或为指向值为TRUE或FALSE的单元格的引用，ISLOGICAL将返回TRUE。",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ISNA",t:15,d:"检查某个值是否为错误值 #N/A。",a:"检查某个值是否为错误值 #N/A。",m:[1,1],p:[{name:"value",detail:"要与错误值#N/A进行比较的值。\n\n*如果值为#N/A或指向包含#N/A的单元格的引用，则ISNA将返回TRUE，否则返回FALSE。",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ISNONTEXT",t:15,d:"检查某个值是否为非文本。",a:"检查某个值是否为非文本。",m:[1,1],p:[{name:"value",detail:"要检查的文本。\n\n*如果参数为文本值或指向包含文本的单元格的引用，ISNONTEXT将返回FALSE，否则返回TRUE。\n\n当值为指向空单元格的引用时，ISNONTEXT会返回TRUE。\n\n当值为空字符串时，ISNONTEXT将返回FALSE，因为空串被视作文本。",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ISNUMBER",t:15,d:"检查某个值是否为数字。",a:"检查某个值是否为数字。",m:[1,1],p:[{name:"value",detail:"要验证其是否为数字的值。\n\n*如果参数为数字或指向内容为数字值的单元格的引用，ISNUMBER将返回TRUE，否则返回FALSE。",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ISREF",t:15,d:"检查某个值是否为有效的单元格引用。",a:"检查某个值是否为有效的单元格引用。",m:[1,1],p:[{name:"value",detail:"要验证其是否为单元格引用的值。\n\n*如果参数是有效的单元格引用，ISREF将返回TRUE，否则返回FALSE。",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISTEXT",t:15,d:"检查某个值是否为文本。",a:"检查某个值是否为文本。",m:[1,1],p:[{name:"value",detail:"要验证其是否为文本的值。\n\n如果参数为文本值或指向包含文本值的单元格的引用，ISTEXT将返回TRUE，否则返回FALSE。",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"TYPE",t:15,d:"返回数值的类型。",a:"返回数值的类型。",m:[1,1],p:[{name:"value",detail:"要确定其类型的数据。\n\n数字 返回 1;\n\n文本 返回 2;\n\n逻辑值 返回 4;\n\n错误值 返回 16;\n\n数组 返回 64;",example:"C4",require:"m",repeat:"n",type:"rangeAll"}]},{n:"N",t:15,d:"返回转化为数值后的值。",a:"返回转化为数值后的值。",m:[1,1],p:[{name:"value",detail:"要转换为数字的参数。\n\n如果值为数字，则返回该数字。\n\n如果值为日期，则返回该日期的序列号。\n\n如果值为TRUE，则返回1。\n\n如果值为FALSE，则返回0。\n\n如果值为错误值，则返回错误值。\n\n如果值为其他值，则返回0。",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"TO_DATE",t:16,d:"将指定的数字转换为日期。",a:"将指定的数字转换为日期。",m:[1,1],p:[{name:"value",detail:"要转换为日期的参数或其单元格引用。\n\n如果值为数字或指向内容为数值的单元格的引用，TO_DATE会将值转换为相应的日期并返回，值代表从十二月30日到对应的日期之间的天数，\n\n负值表示对应的日期在十二月30日之前，而小数值则代表一天中从午夜算起的时间。\n如果值不是数字或指向内容为数值的单元格的引用，则TO_DATE将在不做任何修改的情况下返回值。",example:"25405",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TO_PURE_NUMBER",t:16,d:"将给定的日期/时间、百分比、货币金额或其他格式的数值转换为不带格式的纯数字。",a:"将给定的日期/时间、百分比、货币金额或其他格式的数值转换为不带格式的纯数字。",m:[1,1],p:[{name:"value",detail:"要转换为纯数字的参数或其单元格引用。\n\n如果值为数字或指向包含数值的单元格的引用，TO_PURE_NUMBER将以不带任何格式与解释的形式返回值。\n\n如果值不是数字或指向内容为数值的单元格的引用，则TO_PERCENT将在不做任何修改的情况下返回值。",example:"50%",require:"m",repeat:"n",type:"rangeAll"}]},{n:"TO_TEXT",t:16,d:"将给定的数字值转换为文本格式。",a:"将给定的数字值转换为文本格式。",m:[1,1],p:[{name:"value",detail:"要转换为文本的参数或其单元格引用。\n\n如果值为数字或指向包含数值的单元格的引用，TO_TEXT将返回字符串形式的值，并保持现有格式。即原为货币的仍为货币，原为十进制数的仍为十进制数，原为百分比的仍为百分比，原为日期的仍为日期。\n\n如果值不是数字或指向内容为数值的单元格的引用，则TO_TEXT将在不做任何修改的情况下返回值。",example:"24",require:"m",repeat:"n",type:"rangeAll"}]},{n:"TO_DOLLARS",t:16,d:"将指定的数字转换为美元金额。",a:"将指定的数字转换为美元金额。",m:[1,1],p:[{name:"value",detail:"要转换为美元金额的参数或其单元格引用。\n\n如果值不是数字或指向内容为数值的单元格的引用，则 TO_DOLLARS 将在不做任何修改的情况下返回值。",example:"A2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TO_PERCENT",t:16,d:"将指定的数字转换为百分比。",a:"将指定的数字转换为百分比。",m:[1,1],p:[{name:"value",detail:"要转换为百分比的参数或其单元格引用。\n\n如果值为数字或指向包含数值的单元格的引用，TO_PERCENT会以1 = 100%为标准，将值转换为百分比。\n\n如果值不是数字或指向内容为数值的单元格的引用，则TO_PERCENT将在不做任何修改的情况下返回值。",example:"A2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DGET",t:17,d:"使用 SQL 式查询，从列表或数据库的列中提取符合指定条件的单个值。",a:"使用 SQL 式查询，从列表或数据库的列中提取符合指定条件的单个值。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMAX",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的最大数字。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的最大数字。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMIN",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的最小数字。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的最小数字。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DAVERAGE",t:17,d:"使用 SQL 式查询，对列表或数据库中满足指定条件的记录字段（列）中的数值求平均值。",a:"使用 SQL 式查询，对列表或数据库中满足指定条件的记录字段（列）中的数值求平均值。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNT",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中包含数字的单元格的个数。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中包含数字的单元格的个数。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNTA",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的非空单元格的个数。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的非空单元格的个数。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DPRODUCT",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的数值的乘积。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的数值的乘积。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEV",t:17,d:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为一个样本估算出的总体标准偏差。",a:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为一个样本估算出的总体标准偏差。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEVP",t:17,d:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为样本总体计算出的总体标准偏差。",a:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为样本总体计算出的总体标准偏差。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSUM",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的数字之和。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的数字之和。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVAR",t:17,d:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为一个样本估算出的总体方差。",a:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为一个样本估算出的总体方差。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVARP",t:17,d:"使用 SQL 式查询，通过使用列表或数据库中满足指定条件的记录字段（列）中的数字计算样本总体的样本总体方差。",a:"使用 SQL 式查询，通过使用列表或数据库中满足指定条件的记录字段（列）中的数字计算样本总体的样本总体方差。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"AGE_BY_IDCARD",t:"3",d:"根据中国身份证号计算出年龄。支持15位或18位身份证",a:"根据身份证号得到年龄。",m:[1,2],p:[{name:"身份证号",example:"A1",detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeAll"},{name:"截止日期",example:'"2017-10-01"',detail:"年龄计算的截止日期或范围，默认为当日。",require:"o",repeat:"n",type:"rangedatetime"}]},{n:"SEX_BY_IDCARD",t:"3",d:"根据中国身份证号计算出性别。支持15位或18位身份证",a:"根据身份证号得到性别。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeAll"}]},{n:"BIRTHDAY_BY_IDCARD",t:"3",d:"根据中国身份证号计算出生日。支持15位或18位身份证",a:"根据身份证号得到生日。",m:[1,2],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeAll"},{name:"生日格式",example:"0",detail:"日期类型,默认0:[1900/01/01], 1:[1900-01-01], 2:[1900年1月1日]",require:"o",repeat:"n",type:"rangeAll"}]},{n:"PROVINCE_BY_IDCARD",t:"3",d:"根据中国身份证号计算出籍贯的省份。支持15位或18位身份证",a:"根据身份证号得到籍贯的省份。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeAll"}]},{n:"CITY_BY_IDCARD",t:"3",d:"根据中国身份证号计算出籍贯的城市。支持15位或18位身份证",a:"根据身份证号得到籍贯的城市。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeAll"}]},{n:"STAR_BY_IDCARD",t:"3",d:"根据中国身份证号计算出星座。支持15位或18位身份证",a:"根据身份证号得到星座。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ANIMAL_BY_IDCARD",t:"3",d:"根据中国身份证号计算出生肖（鼠、牛、虎、兔...）。支持15位或18位身份证",a:"根据身份证号得到生肖。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ISIDCARD",t:"3",d:"验证身份证的格式是否正确。支持15位或18位身份证",a:"验证身份证格式正确性。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeAll"}]},{n:"DM_TEXT_CUTWORD",t:"4",d:"文本分词。把一连串文字拆分为一系列单独词语",a:"中文文本分词。",m:[1,2],p:[{name:"文本",example:'"我来到北京清华大学"',detail:"任意需要分词的文本。",require:"m",repeat:"n",type:"rangeAll"},{name:"分词模式",example:"0",detail:"默认为0[精确模式], 1[全模式], 2[搜索引擎模式]。",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DM_TEXT_TFIDF",t:"4",d:"采用tf-idf算法进行关键词提取。从一连串文字中识别关键词",a:"tf-idf关键词识别。",m:[1,3],p:[{name:"文本",example:'"我来到北京清华大学"',detail:"任意需要分词的文本。",require:"m",repeat:"n",type:"rangeAll"},{name:"关键词个数",example:"20",detail:"算法返回的关键词个数，默认20",require:"o",repeat:"n",type:"rangeNumber"},{name:"语料库",example:"1",detail:"选择特定领域的语料库，默认0[通用], 1[金融], 2[医疗]",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DM_TEXT_TEXTRANK",t:"4",d:"采用TextRank算法进行关键词提取。从一连串文字中识别关键词",a:"TextRank关键词识别。",m:[1,3],p:[{name:"文本",example:'"我来到北京清华大学"',detail:"任意需要分词的文本。",require:"m",repeat:"n",type:"rangeAll"},{name:"关键词个数",example:"20",detail:"算法返回的关键词个数，默认20",require:"o",repeat:"n",type:"rangeNumber"},{name:"语料库",example:"1",detail:"选择特定领域的语料库，默认0[通用], 1[金融], 2[医疗]",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DATA_CN_STOCK_CLOSE",t:"5",d:"根据股票代码和日期，返回A股对应股票收盘价。",a:"返回A股对应股票收盘价。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeAll"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DATA_CN_STOCK_OPEN",t:"5",d:"根据股票代码和日期，返回A股对应股票开盘价。",a:"返回A股对应股票开盘价。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeAll"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DATA_CN_STOCK_MAX",t:"5",d:"根据股票代码和日期，返回A股对应股票最高价。",a:"返回A股对应股票最高价。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeAll"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DATA_CN_STOCK_MIN",t:"5",d:"根据股票代码和日期，返回A股对应股票最低价。",a:"返回A股对应股票最低价。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeAll"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DATA_CN_STOCK_VOLUMN",t:"5",d:"根据股票代码和日期，返回A股对应股票成交量。",a:"返回A股对应股票成交量。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeAll"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DATA_CN_STOCK_AMOUNT",t:"5",d:"根据股票代码和日期，返回A股对应股票成交额。",a:"返回A股对应股票成交额。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeAll"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"ISDATE",t:"6",d:"验证日期的格式是否正确。支持多种日期格式",a:"验证日期格式正确性。",m:[1,1],p:[{name:"日期",example:'"1990-01-01"',detail:"日期值，例如1990/01/01, 1990年1月1日等。",require:"m",repeat:"n",type:"rangeAll"}]},{n:"LINESPLINES",t:"3",d:"生成嵌入在单元格内的折线图sparklines，用于描述数据的连续走势",a:"生成单元格折线图",m:[1,8],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeAll"},{name:"线条颜色",example:"#2ec7c9",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#2ec7c9",require:"o",repeat:"n",type:"rangeAll"},{name:"线条粗细",example:"1",detail:"折线图线段粗细，默认为1px",require:"o",repeat:"n",type:"rangeAll"},{name:"辅助线",example:"avg",detail:"一条横线，可以是min、max、avg、median、范围或自定义数值，默认0无",require:"o",repeat:"n",type:"rangeAll"},{name:"辅助线颜色",example:"#000",detail:"辅助线的颜色设置，同线条颜色配置，默认#000",require:"o",repeat:"n",type:"rangeAll"},{name:"最大值标识",example:"#fc5c5c",detail:"标识线图最大值，同线条颜色配置，默认0不显示",require:"o",repeat:"n",type:"rangeAll"},{name:"最小值标识",example:"#fc5c5c",detail:"标识线图最小值，同线条颜色配置，默认0不显示",require:"o",repeat:"n",type:"rangeAll"},{name:"标识大小",example:"1.5",detail:"最大值和最小值的标识大小设置，默认为1.5",require:"o",repeat:"n",type:"rangeAll"}]},{n:"AREASPLINES",t:"3",d:"生成嵌入在单元格内的面积图sparklines，一般用于描述数据的连续累积值走势",a:"生成单元格面积图",m:[1,5],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeAll"},{name:"线条颜色",example:"#2ec7c9",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#2ec7c9",require:"o",repeat:"n",type:"rangeAll"},{name:"填充颜色",example:"#CCF3F4",detail:"形成面积图，同线条颜色配置，默认0不显示",require:"o",repeat:"n",type:"rangeAll"},{name:"线条粗细",example:"1",detail:"折线图线段粗细，默认为1px",require:"o",repeat:"n",type:"rangeAll"},{name:"辅助线",example:"avg",detail:"一条横线，可以是min、max、avg、median、范围或自定义数值，默认0无",require:"o",repeat:"n",type:"rangeAll"},{name:"辅助线颜色",example:"#000",detail:"辅助线的颜色设置，同线条颜色配置，默认#000",require:"o",repeat:"n",type:"rangeAll"}]},{n:"COLUMNSPLINES",t:"3",d:"生成嵌入在单元格内的垂直柱状图sparklines，一般用于描述离散数据之间的大小情况",a:"生成单元格垂直柱状图",m:[1,6],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeAll"},{name:"柱条间隔",example:"1",detail:"柱条之间的间隔距离，默认为1",require:"o",repeat:"n",type:"rangeAll"},{name:"柱条颜色",example:"#fc5c5c",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#fc5c5c",require:"o",repeat:"n",type:"rangeAll"},{name:"负向柱条颜色",example:"#97b552",detail:"负向柱条颜色设置，代表负值的颜色，同柱条颜色配置，默认#97b552",require:"o",repeat:"n",type:"rangeAll"},{name:"最大值",example:"100",detail:"柱图最大值，用于规范柱图长度，默认为自动计算false、auto、null",require:"o",repeat:"n",type:"rangeAll"},{name:"色板",example:"#97b552",detail:"调色板可以单独设置每个柱条的颜色，可设置多个，支持两种格式：1颜色例如#000，代表第一个柱的颜色是黑色；2数值范围:颜色，例如-2:#000表示数值为-2的柱为黑色，0:5:#000表示数值0-5的柱为黑色，默认为空",require:"o",repeat:"y",type:"rangeAll"}]},{n:"STACKCOLUMNSPLINES",t:"3",d:"生成嵌入在单元格内的累积垂直柱状图sparklines，一般用于描述离散数据多个维度的数值大小",a:"生成单元格累积垂直柱状图",m:[1,5],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeAll"},{name:"按列堆积",example:"1",detail:"如果需要按行堆积则本项设为false或0，默认为是1",require:"o",repeat:"n",type:"rangeAll"},{name:"柱条间隔",example:"1",detail:"柱条之间的间隔距离，默认为1",require:"o",repeat:"n",type:"rangeAll"},{name:"最大值",example:"100",detail:"累积柱图最大值，用于规范柱图长度，默认为自动计算false、auto、null",require:"o",repeat:"n",type:"rangeAll"},{name:"累积色板",example:"#97b552",detail:"调色板可以单独设置每个维度的柱条颜色，可设置为A1:A10等范围，默认为#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeAll"}]},{n:"BARSPLINES",t:"3",d:"生成嵌入在单元格内的横向条形图sparklines，一般用于描述离散数据之间的大小情况",a:"生成单元格横向条形图",m:[1,6],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeAll"},{name:"柱条间隔",example:"1",detail:"柱条之间的间隔距离，默认为1",require:"o",repeat:"n",type:"rangeAll"},{name:"柱条颜色",example:"#fc5c5c",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#fc5c5c",require:"o",repeat:"n",type:"rangeAll"},{name:"负向柱条颜色",example:"#97b552",detail:"负向柱条颜色设置，代表负值的颜色，同柱条颜色配置，默认#97b552",require:"o",repeat:"n",type:"rangeAll"},{name:"最大值",example:"100",detail:"柱图最大值，用于规范柱图长度，默认为自动计算false、auto、null",require:"o",repeat:"n",type:"rangeAll"},{name:"色板",example:"#97b552",detail:"调色板可以单独设置每个柱条的颜色，可设置多个，支持两种格式：1颜色例如#000，代表第一个柱的颜色是黑色；2数值范围:颜色，例如-2:#000表示数值为-2的柱为黑色，0:5:#000表示数值0-5的柱为黑色，默认为空",require:"o",repeat:"y",type:"rangeAll"}]},{n:"STACKBARSPLINES",t:"3",d:"生成嵌入在单元格内的累积横向条形图sparklines，一般用于描述离散数据多个维度的数值大小",a:"生成单元格累积横向条形图",m:[1,5],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeAll"},{name:"按列堆积",example:"1",detail:"如果需要按行堆积则本项设为false或0，默认为是1",require:"o",repeat:"n",type:"rangeAll"},{name:"柱条间隔",example:"1",detail:"柱条之间的间隔距离，默认为1",require:"o",repeat:"n",type:"rangeAll"},{name:"最大值",example:"100",detail:"累积柱图最大值，用于规范柱图长度，默认为自动计算false、auto、null",require:"o",repeat:"n",type:"rangeAll"},{name:"累积色板",example:"#97b552",detail:"调色板可以单独设置每个维度的柱条颜色，可设置为A1:A10等范围，默认为#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeAll"}]},{n:"DISCRETESPLINES",t:"3",d:"生成嵌入在单元格内的离散图sparklines，一般用于描述离散数据走势",a:"生成单元格离散图",m:[1,4],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeAll"},{name:"分割阈值",example:"1",detail:"离散图柱形颜色的区分，例如：该值为0，则大于0为蓝色，小于0为红色，默认为0",require:"o",repeat:"n",type:"rangeAll"},{name:"阈值以上颜色",example:"#2ec7c9",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#2ec7c9",require:"o",repeat:"n",type:"rangeAll"},{name:"阈值以下颜色",example:"#fc5c5c",detail:"阈值以下柱条颜色设置，同阈值以上颜色，默认#fc5c5c",require:"o",repeat:"n",type:"rangeAll"}]},{n:"TRISTATESPLINES",t:"3",d:"生成嵌入在单元格内的三态图sparklines，一般用于描述三种态势的走势例如胜负平",a:"生成单元格三态图",m:[1,6],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeAll"},{name:"柱条间隔",example:"1",detail:"柱条之间的间隔距离，默认为1",require:"o",repeat:"n",type:"rangeAll"},{name:"柱条颜色",example:"#fc5c5c",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#fc5c5c",require:"o",repeat:"n",type:"rangeAll"},{name:"负向柱条颜色",example:"#97b552",detail:"负向柱条颜色设置，代表负值的颜色，同柱条颜色配置，默认#97b552",require:"o",repeat:"n",type:"rangeAll"},{name:"零值柱条颜色",example:"#999",detail:"零值柱条颜色设置，代表0值颜色，同柱条颜色配置，默认#999",require:"o",repeat:"n",type:"rangeAll"},{name:"色板",example:"#97b552",detail:"调色板可以单独设置每个柱条的颜色，可设置多个，支持两种格式：1颜色例如#000，代表第一个柱的颜色是黑色；2数值范围:颜色，例如-2:#000表示数值为-2的柱为黑色，0-5:#000表示数值0-5的柱为黑色，默认为空",require:"o",repeat:"y",type:"rangeAll"}]},{n:"PIESPLINES",t:"3",d:"生成嵌入在单元格内的饼图sparklines，一般用于描述数据占比",a:"生成单元格饼图",m:[1,5],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeAll"},{name:"旋转角度",example:"0",detail:"饼图的旋转角度，默认为0",require:"o",repeat:"n",type:"rangeAll"},{name:"饼图边框",example:"0",detail:"饼图边框大小，默认为无0",require:"o",repeat:"n",type:"rangeAll"},{name:"边框颜色",example:"#000",detail:"饼图边框颜色，默认为#000",require:"o",repeat:"n",type:"rangeAll"},{name:"饼图色板",example:"#97b552",detail:"调色板可以设置切片的颜色，可设置为A1:A10等范围，默认为#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeAll"}]},{n:"BOXSPLINES",t:"3",d:"生成嵌入在单元格内的箱线图sparklines，一般用于描述数据集的统计分布",a:"生成单元格箱线图",m:[1,4],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeAll"},{name:"离群点比例",example:"1.5",detail:"离群点的阈值范围，如果为0或false则不显示，默认为1.5倍",require:"o",repeat:"n",type:"rangeAll"},{name:"目标点值",example:"10",detail:"箱线图上的目标值设置，默认为false不显示",require:"o",repeat:"n",type:"rangeAll"},{name:"数据点大小",example:"1.5",detail:"目标点和离群点的半径大小设置，默认为1.5",require:"o",repeat:"n",type:"rangeAll"}]},{n:"BULLETSPLINES",t:"3",d:"生成嵌入在单元格内的子弹图sparklines，一般用于描述任务达成率",a:"生成单元格子弹图",m:[2,3],p:[{name:"目标",example:"10",detail:"达成的目标值，数值才能被有效计算，例如A1， 100等。",require:"m",repeat:"n",type:"rangeAll"},{name:"实际完成",example:"8",detail:"目前完成值，数值才能被有效计算，例如A1， 100等。",require:"m",repeat:"n",type:"rangeAll"},{name:"对比值",example:"12",detail:"对比值，例如超额、最低、获奖底线等，数值才能被有效计算，例如A1， 100等。可以设置最多9个对比值",require:"o",repeat:"y",type:"rangeAll"}]},{n:"COMPOSESPLINES",t:"3",d:"支持多个类型的图画在同一个单元格,每个参数代表一个sparklines图",a:"组合sparklines图到一个单元格",m:[1,1],p:[{name:"图设置",example:"PIESPLINES(A1:A20)",detail:"sparklines图设置，例如A1:A20， 一个完成的饼图、线图设置等。",require:"m",repeat:"y",type:"rangeAll"}]},{n:"SORT",t:"14",d:"返回数组中元素的排序数组。返回的数组与提供的数组参数形状相同。",a:"返回数组中元素的排序数组。返回的数组与提供的数组参数形状相同。",m:[1,4],p:[{name:"array",detail:"要排序的范围或数组。",example:"A2:A17",require:"m",repeat:"n",type:"rangeNumber"},{name:"sort_index",detail:"[可选] - 表示要排序的行或列的数字。（默认row1/col1）",example:"1",require:"o",repeat:"n",type:"rangeNumber"},{name:"sort_order",detail:"[可选] - 表示所需排序顺序的数字；1表示升序（默认），-1表示降序。",example:"-1",require:"o",repeat:"n",type:"rangeNumber"},{name:"by_col",detail:"[可选] - 表示所需排序方向的逻辑值；按行排序为FALSE()（默认），按列排序为TRUE()。",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"FILTER",t:"14",d:"基于一个布尔（真/假）数组过滤一个数组。",a:"基于一个布尔（真/假）数组过滤一个数组。",m:[2,3],p:[{name:"array",detail:"要筛选的数组或范围。",example:"A5:D20",require:"m",repeat:"n",type:"range"},{name:"include",detail:"布尔数组，其高度或宽度与数组相同",example:"1",require:"m",repeat:"n",type:"range"},{name:"if_empty",detail:"[可选] - 如果包含数组中的所有值都为空(filter不返回任何值)，则返回的值。",example:'""',require:"o",repeat:"n",type:"rangeAll"}]},{n:"UNIQUE",t:"14",d:"返回列表或区域中的唯一值的列表。",a:"返回列表或区域中的唯一值的列表。",m:[1,3],p:[{name:"array",detail:"从其返回唯一值的数组或区域。",example:"A2:B26",require:"m",repeat:"n",type:"rangeNumber"},{name:"by_col",detail:"[可选] - 逻辑值，指示如何比较；按行 = FALSE() 或省略；按列 = TRUE()。",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"},{name:"occurs_once",detail:"[可选] - 逻辑值，仅返回唯一值中出现一次 = TRUE()；包括所有唯一值 = FALSE() 或省略。",example:"FALSE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"RANDARRAY",t:"14",d:"返回 0 到 1 之间的随机数字数组。",a:"返回 0 到 1 之间的随机数字数组。",m:[0,2],p:[{name:"rows",detail:"[可选] - 要返回的行数。",example:"1",require:"o",repeat:"n",type:"rangeNumber"},{name:"cols",detail:"[可选] - 要返回的列数。",example:"1",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"SEQUENCE",t:"14",d:"生成数字序列的列表。",a:"生成数字序列的列表。",m:[1,4],p:[{name:"rows",detail:"要返回的行数。",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"cols",detail:"[可选] - 要返回的列数。",example:"1",require:"o",repeat:"n",type:"rangeNumber"},{name:"start",detail:"[可选] - 序列中的第一个数字。",example:"1",require:"o",repeat:"n",type:"rangeNumber"},{name:"step",detail:"[可选] - 序列中每个序列值的增量。",example:"1",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"EVALUATE",t:"3",d:"对以文字表示的公式或者表达式求值，并返回结果。",a:"根据文字公式或者表达式求值。",m:[1,1],p:[{name:"公式",example:'"A1+5*2^2"',detail:"公式或表达式",require:"m",repeat:"n",type:"rangeAll"}]}],en:[{n:"SUMIF",t:0,d:"Returns a conditional sum across a range.",a:"A conditional sum across a range.",m:[2,3],p:[{name:"range",detail:"The range which is tested against `criterion`.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criterion",detail:"The pattern or test to apply to `range`.",example:'">20"',require:"m",repeat:"n",type:"rangeAll"},{name:"sum_range",detail:"The range to be summed, if different from `range`.",example:"B1:B10",require:"o",repeat:"n",type:"range"}]},{n:"TAN",t:0,d:"Returns the tangent of an angle provided in radians.",a:"Tangent of an angle provided in radians.",m:[1,1],p:[{name:"angle",detail:"The angle to find the tangent of, in radians.",example:"45*PI()/180",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TANH",t:0,d:"Returns the hyperbolic tangent of any real number.",a:"Hyperbolic tangent of any real number.",m:[1,1],p:[{name:"value",detail:"Any real value to calculate the hyperbolic tangent of.",example:"A2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"CEILING",t:0,d:"Rounds a number up to the nearest integer multiple of specified significance `factor`.",a:"Rounds number up to nearest multiple of a factor.",m:[2,2],p:[{name:"value",detail:"The value to round up to the nearest integer multiple of `factor`.",example:"23.25",require:"m",repeat:"n",type:"rangeNumber"},{name:"factor",detail:"The number to whose multiples `value` will be rounded.",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ATAN",t:0,d:"Returns the inverse tangent of a value, in radians.",a:"Inverse tangent of a value, in radians.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse tangent.",example:"0",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ASINH",t:0,d:"Returns the inverse hyperbolic sine of a number.",a:"Inverse hyperbolic sine of a number.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic sine.",example:"0.9",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ABS",t:0,d:"Returns the absolute value of a number.",a:"Absolute value of a number.",m:[1,1],p:[{name:"value",detail:"The number of which to return the absolute value.",example:"-2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ACOS",t:0,d:"Returns the inverse cosine of a value, in radians.",a:"Inverse cosine of a value, in radians.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse cosine. Must be between `-1` and `1`, inclusive.",example:"0",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ACOSH",t:0,d:"Returns the inverse hyperbolic cosine of a number.",a:"Inverse hyperbolic cosine of a number.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic cosine. Must be greater than or equal to `1`.",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MULTINOMIAL",t:0,d:"Returns the factorial of the sum of values divided by the product of the values' factorials.",a:"Multinomial distribution function.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider.",example:"1",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"Additional values or ranges to consider.",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"ATANH",t:0,d:"Returns the inverse hyperbolic tangent of a number.",a:"Inverse hyperbolic tangent of a number.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse hyperbolic tangent. Must be between -1 and 1, exclusive.",example:"0.9",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ATAN2",t:0,d:"Returns the angle between the x-axis and a line segment from the origin (0,0) to specified coordinate pair (`x`,`y`), in radians.",a:"Arctangent of a value.",m:[2,2],p:[{name:"x",detail:"The x coordinate of the endpoint of the line segment for which to calculate the angle from the x-axis.",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"y",detail:"The y coordinate of the endpoint of the line segment for which to calculate the angle from the x-axis.",example:"3",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"COUNTBLANK",t:1,d:"Returns the number of empty values in a list of values and ranges.",a:"Number of empty values.",m:[1,1],p:[{name:"value1",detail:"The first value or range in which to count the number of blanks.",example:"A2:C100",require:"m",repeat:"n",type:"range"}]},{n:"COSH",t:0,d:"Returns the hyperbolic cosine of any real number.",a:"Hyperbolic cosine of any real number.",m:[1,1],p:[{name:"value",detail:"Any real value to calculate the hyperbolic cosine of.",example:"A2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"INT",t:0,d:"Rounds a number down to the nearest integer that is less than or equal to it.",a:"Rounds number down to nearest integer.",m:[1,1],p:[{name:"value",detail:"The value to round down to the nearest integer.",example:"99.44",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ISEVEN",t:0,d:"Checks whether the provided value is even.",a:"Whether the provided value is even.",m:[1,1],p:[{name:"value",detail:"The value to be verified as even.",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ISODD",t:0,d:"Checks whether the provided value is odd.",a:"Whether the provided value is odd.",m:[1,1],p:[{name:"value",detail:"The value to be verified as odd.",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"LCM",t:0,d:"Returns the least Common multiple of one or more integers.",a:"Least Common multiple of one or more integers.",m:[1,255],p:[{name:"value1",detail:"The first value or range whose factors to consider in a calculation to find the least Common multiple.",example:"A2:A5",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"Additional values or ranges whose factors to consider to find the least Common multiple.",example:"3",require:"o",repeat:"y",type:"rangeAll"}]},{n:"LN",t:0,d:"Returns the logarithm of a number, base e (Euler's number).",a:"The logarithm of a number, base e (euler's number).",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the logarithm, base e.",example:"100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"LOG",t:0,d:"Returns the logarithm of a number with respect to a base.",a:"The logarithm of a number with respect to a base.",m:[1,2],p:[{name:"value",detail:"The value for which to calculate the logarithm.",example:"128",require:"m",repeat:"n",type:"rangeNumber"},{name:"base",detail:"The base to use for calculation of the logarithm.",example:"2",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"LOG10",t:0,d:"Returns the logarithm of a number, base 10.",a:"The logarithm of a number, base 10.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the logarithm, base 10.",example:"100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MOD",t:0,d:"Returns the result of the modulo operator, the remainder after a division operation.",a:"Modulo (remainder) operator.",m:[2,2],p:[{name:"dividend",detail:"The number to be divided to find the remainder.",example:"10",require:"m",repeat:"n",type:"rangeNumber"},{name:"divisor",detail:"The number to divide by.",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MROUND",t:0,d:"Rounds one number to the nearest integer multiple of another.",a:"Rounds a number to the nearest integer multiple.",m:[2,2],p:[{name:"value",detail:"The number to round to the nearest integer multiple of another.",example:"21",require:"m",repeat:"n",type:"rangeNumber"},{name:"factor",detail:"The number to whose multiples `value` will be rounded.",example:"14",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ODD",t:0,d:"Rounds a number up to the nearest odd integer.",a:"Rounds a number up to the nearest odd integer.",m:[1,1],p:[{name:"value",detail:"The value to round to the next greatest odd number.",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SUMSQ",t:0,d:"Returns the sum of the squares of a series of numbers and/or cells.",a:"Sum of squares.",m:[1,255],p:[{name:"value1",detail:"The first number or range whose squares to add together.",example:"A2:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"Additional numbers or ranges whose squares to add to the square(s) of `value1`.",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"COMBIN",t:0,d:"Returns the number of ways to choose some number of objects from a pool of a given size of objects.",a:"Number of combinations from a set of objects.",m:[2,2],p:[{name:"n",detail:"The size of the pool of objects to choose from.",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"k",detail:"The number of objects to choose.",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SUM",t:0,d:"Returns the sum of a series of numbers and/or cells.",a:"Sum of a series of numbers and/or cells.",m:[1,255],p:[{name:"value1",detail:"The first number or range to add together.",example:"A2:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"Additional numbers or ranges to add to `value1`.",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"SUBTOTAL",t:0,d:"Returns a subtotal for a vertical range of cells using a specified aggregation function.",a:"Subtotal for a range using a specific function.",m:[2,256],p:[{name:"function_code",detail:"The function to use in subtotal aggregation.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"range1",detail:"The first range over which to calculate a subtotal.",example:"A2:A5",require:"m",repeat:"n",type:"range"},{name:"range2",detail:"Additional ranges over which to calculate subtotals.",example:"B2:B8",require:"o",repeat:"y",type:"range"}]},{n:"ASIN",t:0,d:"Returns the inverse sine of a value, in radians.",a:"Inverse sine of a value, in radians.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse sine. Must be between `-1` and `1`, inclusive.",example:"0",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"COUNTIF",t:1,d:"Returns a conditional count across a range.",a:"A conditional count across a range.",m:[2,2],p:[{name:"range",detail:"The range that is tested against `criterion`.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criterion",detail:"The pattern or test to apply to `range`.",example:'">20"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"RADIANS",t:0,d:"Converts an angle value in degrees to radians.",a:"Converts an angle value in degrees to radians.",m:[1,1],p:[{name:"angle",detail:"The angle to convert from degrees to radians.",example:"180",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"RAND",t:0,d:"Returns a random number between 0 inclusive and 1 exclusive.",a:"A random number between 0 inclusive and 1 exclusive.",m:[0,0],p:[]},{n:"COUNTUNIQUE",t:0,d:"Counts the number of unique values in a list of specified values and ranges.",a:"Counts number of unique values in a range.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider for uniqueness.",example:"A1:C100",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"Additional values or ranges to consider for uniqueness.",example:"1",require:"o",repeat:"n",type:"rangeAll"}]},{n:"DEGREES",t:0,d:"Converts an angle value in radians to degrees.",a:"Converts an angle value in radians to degrees.",m:[1,1],p:[{name:"angle",detail:"The angle to convert from radians to degrees.",example:"PI()",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ERFC",t:9,d:"Returns the complementary Gauss error function of a value.",a:"Complementary gauss error function of a value.",m:[1,1],p:[{name:"z",detail:"The number for which to calculate the complementary Gauss error function.",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"EVEN",t:0,d:"Rounds a number up to the nearest even integer.",a:"Rounds a number up to the nearest even integer.",m:[1,1],p:[{name:"value",detail:"The value to round to the next greatest even number.",example:"3",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"EXP",t:0,d:"Returns Euler's number, e (~2.718) raised to a power.",a:"Euler's number, e (~2.718) raised to a power.",m:[1,1],p:[{name:"exponent",detail:"The exponent to raise e to.",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"FACT",t:0,d:"Returns the factorial of a number.",a:"Factorial of a number.",m:[1,1],p:[{name:"value",detail:"The number or reference to a number whose factorial will be calculated and returned.",example:"3",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"FACTDOUBLE",t:0,d:'Returns the "double factorial" of a number.',a:'"double factorial" of a number.',m:[1,1],p:[{name:"value",detail:"The number or reference to a number whose double factorial will be calculated and returned.",example:"6",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"PI",t:0,d:"Returns the value of Pi to 14 decimal places.",a:"The number pi.",m:[0,0],p:[]},{n:"FLOOR",t:0,d:"Rounds a number down to the nearest integer multiple of specified significance `factor`.",a:"Rounds number down to nearest multiple of a factor.",m:[2,2],p:[{name:"value",detail:"The value to round down to the nearest integer multiple of `factor`.",example:"23.25",require:"m",repeat:"n",type:"rangeNumber"},{name:"factor",detail:"The number to whose multiples `value` will be rounded.",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"GCD",t:0,d:"Returns the greatest Common divisor of one or more integers.",a:"Greatest Common divisor of one or more integers.",m:[1,255],p:[{name:"value1",detail:"The first value or range whose factors to consider in a calculation to find the greatest Common divisor.",example:"A2:A5",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"Additional values or ranges whose factors to consider to find the greatest Common divisor.",example:"96",require:"o",repeat:"y",type:"rangeAll"}]},{n:"RANDBETWEEN",t:0,d:"Returns a uniformly random integer between two values, inclusive.",a:"Random integer between two values, inclusive.",m:[2,2],p:[{name:"low",detail:"The low end of the random range.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"high",detail:"The high end of the random range.",example:"10",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ROUND",t:0,d:"Rounds a number to a certain number of decimal places according to standard rules.",a:"Rounds a number according to standard rules.",m:[2,2],p:[{name:"value",detail:"The value to round to `places` number of places.",example:"99.44",require:"m",repeat:"n",type:"rangeNumber"},{name:"places",detail:"The number of decimal places to which to round.",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ROUNDDOWN",t:0,d:"Rounds a number to a certain number of decimal places, always rounding down to the next valid increment.",a:"Rounds down a number.",m:[2,2],p:[{name:"value",detail:"The value to round to `places` number of places, always rounding down.",example:"99.44",require:"m",repeat:"n",type:"rangeNumber"},{name:"places",detail:"The number of decimal places to which to round.",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ROUNDUP",t:0,d:"Rounds a number to a certain number of decimal places, always rounding up to the next valid increment.",a:"Rounds up a number.",m:[2,2],p:[{name:"value",detail:"The value to round to `places` number of places, always rounding up.",example:"99.44",require:"m",repeat:"n",type:"rangeNumber"},{name:"places",detail:"The number of decimal places to which to round.",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SERIESSUM",t:0,d:"Given parameters `x`, `n`, `m`, and `a`, returns the power series sum a",a:"Sum of a power series.",m:[4,4],p:[{name:"x",detail:"The input to the power series. Varies depending on the type of approximation, may be angle, exponent, or some other value.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"n",detail:"The initial power to which to raise `x` in the power series.",example:"0",require:"m",repeat:"n",type:"rangeNumber"},{name:"m",detail:"The additive increment by which to increase `x`.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"a",detail:"The array or range containing the coefficients of the power series.",example:"{FACT(0)",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SIGN",t:0,d:"Given an input number, returns `-1` if it is negative, `1` if positive, and `0` if it is zero.",a:"Sign of a provided number (+/-/0).",m:[1,1],p:[{name:"value",detail:"The value whose sign will be evaluated.",example:"-42",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SIN",t:0,d:"Returns the sine of an angle provided in radians.",a:"Sine of an angle provided in radians.",m:[1,1],p:[{name:"angle",detail:"The angle to find the sine of, in radians.",example:"PI()",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SINH",t:0,d:"Returns the hyperbolic sine of any real number.",a:"Hyperbolic sine of any real number.",m:[1,1],p:[{name:"value",detail:"Any real value to calculate the hyperbolic sine of.",example:"A2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SQRT",t:0,d:"Returns the positive square root of a positive number.",a:"Positive square root of a positive number.",m:[1,1],p:[{name:"value",detail:"The number for which to calculate the positive square root.",example:"9",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SQRTPI",t:0,d:"Returns the positive square root of the product of Pi and the given positive number.",a:"Square root of the product of pi and number.",m:[1,1],p:[{name:"value",detail:"The number which will be multiplied by Pi and have the product's square root returned",example:"9",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"GAMMALN",t:1,d:"Returns the logarithm of a specified Gamma function, base e (Euler's number).",a:"Logarithm of gamma function.",m:[1,1],p:[{name:"value",detail:"The input to the Gamma function. The natural logarithm of Gamma(`value`) will be returned.",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"COS",t:0,d:"Returns the cosine of an angle provided in radians.",a:"Cosine of an angle provided in radians.",m:[1,1],p:[{name:"angle",detail:"The angle to find the cosine of, in radians.",example:"PI()",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TRUNC",t:0,d:"Truncates a number to a certain number of significant digits by omitting less significant digits.",a:"Truncates a number.",m:[1,2],p:[{name:"value",detail:"The value to be truncated.",example:"3.141592654",require:"m",repeat:"n",type:"rangeNumber"},{name:"places",detail:"The number of significant digits to the right of the decimal point to retain.",example:"2",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"QUOTIENT",t:0,d:"Returns one number divided by another.",a:"One number divided by another.",m:[2,2],p:[{name:"dividend",detail:"The number to be divided.",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"divisor",detail:"The number to divide by.",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"POWER",t:0,d:"Returns a number raised to a power.",a:"A number raised to a power.",m:[2,2],p:[{name:"base",detail:"The number to raise to the `exponent` power.",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"exponent",detail:"The exponent to raise `base` to.",example:"0.5",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SUMIFS",t:0,d:"Returns the sum of a range depending on multiple criteria.",a:"Sums a range depending on multiple criteria.",m:[3,257],p:[{name:"sum_range",detail:"The range to sum.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criteria_range1",detail:"The range to check against criterion1.",example:" B1:B10",require:"m",repeat:"n",type:"range"},{name:"criterion1",detail:"The pattern or test to apply to criteria_range1.",example:' ">20"',require:"m",repeat:"n",type:"rangeAll"},{name:"criteria_range2",detail:"Additional ranges to check.",example:" C1:C10",require:"o",repeat:"y",type:"rangeAll"}]},{n:"COUNTIFS",t:1,d:"Returns the count of a range depending on multiple criteria.",a:"Count values depending on multiple criteria.",m:[2,256],p:[{name:"criteria_range1",detail:"The range to check against `criterion1`.",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"criterion1",detail:"The pattern or test to apply to `criteria_range1`.",example:' ">20"',require:"m",repeat:"n",type:"rangeAll"},{name:"criteria_range2",detail:"Additional ranges to check.",example:" B1:B10",require:"o",repeat:"y",type:"rangeAll"}]},{n:"PRODUCT",t:0,d:"Returns the result of multiplying a series of numbers together.",a:"Result of multiplying a series of numbers together.",m:[1,255],p:[{name:"factor1",detail:"The first number or range to calculate for the product.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"factor2",detail:"More numbers or ranges to calculate for the product.",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"HARMEAN",t:1,d:"Calculates the harmonic mean of a dataset.",a:"The harmonic mean of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"HYPGEOMDIST",t:1,d:"Calculates the probability of drawing a certain number of successes in a certain number of tries given a population of a certain size containing a certain number of successes, without replacement of draws.",a:"Hypergeometric distribution probability.",m:[5,5],p:[{name:"num_successes",detail:"The desired number of successes.",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"num_draws",detail:"The number of permitted draws.",example:"12",require:"m",repeat:"n",type:"rangeNumber"},{name:"successes_in_pop",detail:"The total number of successes in the population.",example:"20",require:"m",repeat:"n",type:"rangeNumber"},{name:"pop_size",detail:"The total size of the population",example:"40",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"Determine the logical value of the function form. \n\nIf cumulative is TRUE(), HYPGEOM.DIST returns the cumulative distribution function;\n\nif FALSE(), it returns the probability density function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"INTERCEPT",t:1,d:"Calculates the y-value at which the line resulting from linear regression of a dataset will intersect the y-axis (x=0).",a:"Y-intercept of line derived via linear regression.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"KURT",t:1,d:'Calculates the kurtosis of a dataset, which describes the shape, and in particular the "peakedness" of that dataset.',a:"Kurtosis of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the dataset.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"Additional values or ranges to include in the dataset.",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"LARGE",t:1,d:"Returns the nth largest element from a data set, where n is user-defined.",a:"Nth largest element from a data set.",m:[2,2],p:[{name:"data",detail:"Array or range containing the dataset to consider.",example:"A2:B100",require:"m",repeat:"n",type:"rangeNumber"},{name:"n",detail:"The rank from largest to smallest of the element to return.",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"STDEVA",t:1,d:"Calculates the standard deviation based on a sample, setting text to the value `0`.",a:"Standard deviation of sample (text as 0).",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"STDEVP",t:1,d:"Calculates the standard deviation based on an entire population.",a:"Standard deviation of an entire population.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"GEOMEAN",t:1,d:"Calculates the geometric mean of a dataset.",a:"The geometric mean of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"RANK_EQ",t:1,d:"Returns the rank of a specified value in a dataset. If there is more than one entry of the same value in the dataset, the top rank of the entries will be returned.",a:"Top rank of a specified value in a dataset.",m:[2,3],p:[{name:"value",detail:"The value whose rank will be determined.",example:"A10",require:"m",repeat:"n",type:"rangeNumber"},{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"is_ascending",detail:"Whether to consider the values in `data` in descending or ascending order. If omitted, the default is descending (FALSE).",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"RANK_AVG",t:1,d:"Returns the rank of a specified value in a dataset. If there is more than one entry of the same value in the dataset, the average rank of the entries will be returned.",a:"Average rank of a specified value in a dataset.",m:[2,3],p:[{name:"value",detail:"The value whose rank will be determined.",example:"A10",require:"m",repeat:"n",type:"rangeNumber"},{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"is_ascending",detail:"Whether to consider the values in `data` in descending or ascending order. If omitted, the default is descending (FALSE).",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"PERCENTRANK_EXC",t:1,d:"Returns the percentage rank (percentile) from 0 to 1 exclusive of a specified value in a dataset.",a:"Percentage rank (percentile) from 0 to 1 exclusive.",m:[2,3],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"value",detail:"The value whose percentage rank will be determined.",example:"A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"significant_digits",detail:"The number of significant figures to use in the calculation. Default is 3.",example:"4",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"PERCENTRANK_INC",t:1,d:"Returns the percentage rank (percentile) from 0 to 1 inclusive of a specified value in a dataset.",a:"Percentage rank (percentile) from 0 to 1 inclusive.",m:[2,3],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A1:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"value",detail:"The value whose percentage rank will be determined.",example:" A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"significant_digits",detail:"The number of significant figures to use in the calculation. Default is 3.",example:"4",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"FORECAST",t:1,d:"Calculates the expected y-value for a specified x based on a linear regression of a dataset.",a:"Expected y-value based of linear regression.",m:[3,3],p:[{name:"x",detail:"The value on the x-axis to forecast.",example:"A1",require:"m",repeat:"n",type:"rangeNumber"},{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"FISHERINV",t:1,d:"Returns the inverse Fisher transformation of a specified value.",a:"Inverse fisher transformation of a specified value.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the inverse Fisher transformation.",example:"0.962",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"FISHER",t:1,d:"Returns the Fisher transformation of a specified value.",a:"Fisher transformation of a specified value.",m:[1,1],p:[{name:"value",detail:"The value for which to calculate the Fisher transformation.",example:"0.962",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MODE_SNGL",t:1,d:"Returns the most commonly occurring value in a dataset.",a:"Most commonly occurring value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating mode.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating mode.",example:"B2:B100",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"WEIBULL_DIST",t:1,d:"Returns the value of the Weibull distribution function (or Weibull cumulative distribution function) for a specified shape and scale.",a:"Weibull distribution function.",m:[4,4],p:[{name:"x",detail:"The input to the Weibull distribution function.",example:"2.4",require:"m",repeat:"n",type:"rangeNumber"},{name:"shape",detail:"The shape parameter of the Weibull distribution function.",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"scale",detail:"The scale parameter of the Weibull distribution function.",example:"3",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"Whether to use the cumulative distribution function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"COUNT",t:1,d:"Returns the number of numeric values in a dataset.",a:"The number of numeric values in dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when counting.",example:"A2:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"Additional values or ranges to consider when counting.",example:"B2:B100",require:"o",repeat:"y",type:"rangeAll"}]},{n:"COUNTA",t:1,d:"Returns the number of values in a dataset.",a:"The number of values in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when counting.",example:"A2:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"Additional values or ranges to consider when counting.",example:"B2:B100",require:"o",repeat:"y",type:"rangeAll"}]},{n:"AVEDEV",t:1,d:"Calculates the average of the magnitudes of deviations of data from a dataset's mean.",a:"Average magnitude of deviations from mean.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"AVERAGE",t:1,d:"Returns the numerical average value in a dataset, ignoring text.",a:"Numerical average value in a dataset, ignoring text.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the average value.",example:"A2:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"Additional values or ranges to consider when calculating the average value.",example:"B2:B100",require:"o",repeat:"y",type:"rangeAll"}]},{n:"AVERAGEA",t:1,d:"Returns the numerical average value in a dataset.",a:"Numerical average value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the average value.",example:"A2:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"Additional values or ranges to consider when calculating the average value.",example:"B2:B100",require:"o",repeat:"y",type:"rangeAll"}]},{n:"BINOM_DIST",t:1,d:"Calculates the probability of drawing a certain number of successes (or a maximum number of successes) in a certain number of tries given a population of a certain size containing a certain number of successes, with replacement of draws.",a:"Binomial distribution probability.",m:[4,4],p:[{name:"num_successes",detail:"The number of successes for which to calculate the probability in `num_trials` trials.",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"num_trials",detail:"The number of independent trials.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"prob_success",detail:"The probability of success in any given trial.",example:"0.005",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"Whether to use the binomial cumulative distribution.",example:"FALSE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"BINOM_INV",t:1,d:"Calculates the smallest value for which the cumulative binomial distribution is greater than or equal to a specified criteria.",a:"Inverse cumulative binomial distribution function.",m:[3,3],p:[{name:"num_trials",detail:"The number of independent trials.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"prob_success",detail:"The probability of success in any given trial.",example:"0.005",require:"m",repeat:"n",type:"rangeNumber"},{name:"target_prob",detail:"The desired threshold probability.",example:"0.8",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"CONFIDENCE_NORM",t:1,d:"Calculates the width of half the confidence interval for a normal distribution.",a:"Confidence interval for a normal distribution.",m:[3,3],p:[{name:"alpha",detail:"One minus the desired confidence level. E.g. `0.1` for `0.9`, or 90%, confidence.",example:"0.05",require:"m",repeat:"n",type:"rangeNumber"},{name:"standard_deviation",detail:"The standard deviation of the population.",example:"1.6",require:"m",repeat:"n",type:"rangeNumber"},{name:"pop_size",detail:"The size of the population.",example:"250",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"CORREL",t:1,d:"Calculates r, the Pearson product-moment correlation coefficient of a dataset.",a:"Pearson Product-Moment Correlation Coefficient.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"COVARIANCE_P",t:1,d:"Calculates the covariance of a dataset.",a:"The covariance of a dataset.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"COVARIANCE_S",t:1,d:"Calculates the sample covariance of a dataset.",a:"The sample covariance of a dataset.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DEVSQ",t:1,d:"Calculates the sum of squares of deviations based on a sample.",a:"The sum of squares of deviations based on a sample.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"EXPON_DIST",t:1,d:"Returns the value of the exponential distribution function with a specified lambda at a specified value.",a:"Exponential distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the exponential distribution function.",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"lambda",detail:"The lambda to specify the exponential distribution function.",example:"0.5",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"Whether to use the exponential cumulative distribution.",example:"FALSE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"AVERAGEIF",t:1,d:"Returns the average of a range depending on criteria.",a:"Average of values depending on criteria.",m:[2,3],p:[{name:"criteria_range",detail:"The range to check against `criterion`.",example:"A1:A10",require:"m",repeat:"n",type:"rangeAll"},{name:"criterion",detail:"The pattern or test to apply to `criteria_range`.",example:'">20"',require:"m",repeat:"n",type:"rangeAll"},{name:"average_range",detail:"The range to average. If not included, `criteria_range` is used for the average instead.",example:"B1:B10",require:"o",repeat:"n",type:"rangeAll"}]},{n:"AVERAGEIFS",t:1,d:"Returns the average of a range depending on multiple criteria.",a:"Average of values depending on multiple criteria.",m:[2,255],p:[{name:"average_range",detail:"The range to average.",example:"A1:A10",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria_range1",detail:"The range to check against `criterion1`.",example:" B1:B10",require:"m",repeat:"n",type:"rangeAll"},{name:"criterion1",detail:"The pattern or test to apply to `criteria_range1`.",example:' ">20"',require:"m",repeat:"n",type:"rangeAll"},{name:"criteria_range2",detail:"Additional ranges to check.",example:" C1:C10",require:"m",repeat:"n",type:"rangeAll"}]},{n:"PERMUT",t:1,d:"Returns the number of ways to choose some number of objects from a pool of a given size of objects, considering order.",a:"Number of permutations from a number of objects.",m:[2,2],p:[{name:"n",detail:"The size of the pool of objects to choose from.",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"k",detail:"The number of objects to choose.",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TRIMMEAN",t:1,d:"Calculates the mean of a dataset excluding some proportion of data from the high and low ends of the dataset.",a:"Mean of a dataset excluding high/low ends.",m:[2,2],p:[{name:"data",detail:"Array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"exclude_proportion",detail:"The proportion of the dataset to exclude, from the extremities of the set.",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"PERCENTILE_EXC",t:1,d:"Returns the value at a given percentile of a dataset exclusive of 0 and 1.",a:"Value at a given percentile of a dataset exclusive of 0 and 1.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"percentile",detail:"The percentile, exclusive of 0 and 1, whose value within 'data' will be calculated and returned.",example:"0.25",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"PERCENTILE_INC",t:1,d:"Returns the value at a given percentile of a dataset.",a:"Value at a given percentile of a dataset.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"percentile",detail:"The percentile whose value within `data` will be calculated and returned.`",example:"0.25",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"PEARSON",t:1,d:"Calculates r, the Pearson product-moment correlation coefficient of a dataset.",a:"Pearson Product-Moment Correlation Coefficient.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"NORM_S_INV",t:1,d:"Returns the value of the inverse standard normal distribution function for a specified value.",a:"Inverse standard normal distribution function.",m:[1,1],p:[{name:"x",detail:"The input to the inverse standard normal distribution function.",example:"0.75",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"NORM_S_DIST",t:1,d:"Returns the value of the standard normal cumulative distribution function for a specified value.",a:"Standard normal cumulative distribution function.",m:[2,2],p:[{name:"x",detail:"The input to the standard normal cumulative distribution function.",example:"2.4",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"Determine the logical value of the function form. \n\nIf TRUE(), it returns the cumulative distribution function;\n\nIf it is FALSE(), it returns the probability density function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"NORM_INV",t:1,d:"Returns the value of the inverse normal distribution function for a specified value, mean, and standard deviation.",a:"Inverse normal distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the inverse normal distribution function.",example:"0.75",require:"m",repeat:"n",type:"rangeNumber"},{name:"mean",detail:"The mean (mu) of the normal distribution function.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the normal distribution function.",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"NORM_DIST",t:1,d:"Returns the value of the normal distribution function (or normal cumulative distribution function) for a specified value, mean, and standard deviation.",a:"Normal distribution function.",m:[4,4],p:[{name:"x",detail:"The input to the normal distribution function.",example:"2.4",require:"m",repeat:"n",type:"rangeNumber"},{name:"mean",detail:"The mean (mu) of the normal distribution function.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the normal distribution function.",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"Whether to use the normal cumulative distribution function rather than the distribution function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"NEGBINOM_DIST",t:1,d:"Calculates the probability of drawing a certain number of failures before a certain number of successes given a probability of success in independent trials.",a:"Negative binomial distribution probability.",m:[4,4],p:[{name:"num_failures",detail:"The number of failures to model.",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"num_successes",detail:"The number of successes to model.",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"prob_success",detail:"The probability of success in any given trial.",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"Determine the logical value of the function form. \n\nIf TRUE(), it returns the cumulative distribution function;\n\nIf it is FALSE(), it returns the probability density function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"MINA",t:1,d:"Returns the minimum numeric value in a dataset.",a:"Minimum numeric value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the minimum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the minimum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"MIN",t:1,d:"Returns the minimum value in a numeric dataset.",a:"Minimum value in a numeric dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the minimum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the minimum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"MEDIAN",t:1,d:"Returns the median value in a numeric dataset.",a:"Median value in a numeric dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the median value.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the median value.",example:"B2:B100",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"MAXA",t:1,d:"Returns the maximum numeric value in a dataset.",a:"Maximum numeric value in a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the maximum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the maximum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"MAX",t:1,d:"Returns the maximum value in a numeric dataset.",a:"Maximum value in a numeric dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range to consider when calculating the maximum value.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"Additional values or ranges to consider when calculating the maximum value.",example:"B2:B100",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"LOGNORM_INV",t:1,d:"Returns the value of the inverse log-normal cumulative distribution with given mean and standard deviation at a specified value.",a:"Inverse log-normal cumulative distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the inverse log-normal cumulative distribution function.",example:"0.4",require:"m",repeat:"n",type:"rangeNumber"},{name:"mean",detail:"The mean (mu) of the inverse log-normal cumulative distribution function.",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the inverse log-normal cumulative distribution function.",example:"6",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"LOGNORM_DIST",t:1,d:"Returns the value of the log-normal cumulative distribution with given mean and standard deviation at a specified value.",a:"Log-normal cumulative distribution probability.",m:[4,4],p:[{name:"x",detail:"The input to the log-normal cumulative distribution function.",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"mean",detail:"The mean (mu) of the log-normal cumulative distribution function.",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"standard_deviation",detail:"The standard deviation (sigma) of the log-normal cumulative distribution function.",example:"6",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"Determine the logical value of the function form. \n\nIf TRUE(), it returns the cumulative distribution function;\n\nIf it is FALSE(), it returns the probability density function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"Z_TEST",t:1,d:"Returns the one-tailed p-value of a Z-test with standard distribution.",a:"One-tailed p-value of a z-test.",m:[2,3],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"value",detail:"The test statistic to use in the Z-test.",example:"B2",require:"m",repeat:"n",type:"rangeNumber"},{name:"standard_deviation",detail:"The standard deviation to assume for the Z-test. If this is not provided, the standard deviation of the data will be used.",example:"3",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"PROB",t:1,d:"Given a set of values and corresponding probabilities, calculates the probability that a value chosen at random falls between two limits.",a:"Probability values lie in a range.",m:[3,4],p:[{name:"data",detail:"Array or range containing the dataset to consider.",example:"A3:A6",require:"m",repeat:"n",type:"range"},{name:"probabilities",detail:"Array or range containing probabilities corresponding to `data`.",example:"2",require:"m",repeat:"n",type:"range"},{name:"low_limit",detail:"The lower bound on the value range for which to calculate the probability.",example:"3",require:"m",repeat:"n",type:"rangeNumber"},{name:"high_limit",detail:"The upper bound on the value range for which to calculate the probability.",example:"4",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"QUARTILE_EXC",t:1,d:"Returns a value nearest to a specified quartile of a dataset exclusive of 0 and 4.",a:"Value nearest to a specific quartile of a dataset exclusive of 0 and 4.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"quartile_number",detail:"Which quartile to return.",example:"3",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"QUARTILE_INC",t:1,d:"Returns a value nearest to a specified quartile of a dataset.",a:"Value nearest to a specific quartile of a dataset.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"quartile_number",detail:"Which quartile value to return.",example:"3",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"POISSON_DIST",t:1,d:"Returns the value of the Poisson distribution function (or Poisson cumulative distribution function) for a specified value and mean.",a:"Poisson distribution function.",m:[3,3],p:[{name:"x",detail:"The input to the Poisson distribution function.",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"mean",detail:"The mean (mu) of the Poisson distribution function.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"Whether to use the Poisson cumulative distribution function rather than the distribution function.",example:"FALSE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"RSQ",t:1,d:"Calculates the square of r, the Pearson product-moment correlation coefficient of a dataset.",a:"Square of the correlation coefficient.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"T_DIST",t:1,d:"Calculates the left tail probability for a Student's t-distribution with a given input (x).",a:"The left-tailed Student's t-distribution",m:[3,3],p:[{name:"x",detail:"The input to the t-distribution function.",example:"A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"30",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"If cumulative is TRUE, T.DIST returns the cumulative distribution function; if FALSE, it returns the probability density function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"T_DIST_2T",t:1,d:"Calculates the probability for two tailed Student's t-distribution with a given input (x).",a:"The two tailed Student's t-distribution",m:[2,2],p:[{name:"x",detail:"The input to the t-distribution function.",example:"A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"30",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"T_DIST_RT",t:1,d:"Calculates the right tail probability for a Student's t-distribution with a given input (x).",a:"The right-tailed Student's t-distribution",m:[2,2],p:[{name:"x",detail:"The input to the t-distribution function.",example:"A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"30",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"T_INV",t:1,d:"Calculates the negative inverse of the one-tailed TDIST function.",a:"T.INV",m:[2,2],p:[{name:"probability",detail:"The probability associated with the two-tailed t-distribution.",example:"0.35",require:"m",repeat:"n",type:"rangeNumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"T_INV_2T",t:1,d:"Calculates the inverse of the two-tailed TDIST function.",a:"T.INV.2T",m:[2,2],p:[{name:"probability",detail:"The probability associated with the two-tailed t-distribution.",example:"0.35",require:"m",repeat:"n",type:"rangeNumber"},{name:"degrees_freedom",detail:"The number of degrees of freedom.",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"T_TEST",t:1,d:"t-test. Returns the probability associated with Student's t-test. Determines whether two samples are likely to have come from the same two underlying populations that have the same mean.",a:"Returns the probability associated with t-test.",m:[4,4],p:[{name:"range1",detail:"The first sample of data or group of cells to consider for the t-test.",example:"A1:A4",require:"m",repeat:"n",type:"rangeNumber"},{name:"range2",detail:"The second sample of data or group of cells to consider for the t-test.",example:"B1:B4",require:"m",repeat:"n",type:"rangeNumber"},{name:"tails",detail:"Specifies the number of distribution tails.",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"type",detail:"Specifies the type of t-test.",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"F_DIST",t:1,d:"Calculates the left-tailed F probability distribution (degree of diversity) for two data sets with given input x. Alternately called Fisher-Snedecor distribution or Snedecor's F distribution.",a:"F probability distribution (left-tailed).",m:[4,4],p:[{name:"x",detail:"The input to the F probability distribution function. The value at which to evaluate the function.",example:"15.35",require:"m",repeat:"n",type:"rangeNumber"},{name:"degrees_freedom1",detail:"The numerator of the number of degrees of freedom.",example:"7",require:"m",repeat:"n",type:"rangeNumber"},{name:"degrees_freedom2",detail:"The denominator of the number of degrees of freedom.",example:"6",require:"m",repeat:"n",type:"rangeNumber"},{name:"cumulative",detail:"Logical value that determines the form of the function.",example:"TRUE()",require:"m",repeat:"n",type:"rangeAll"}]},{n:"F_DIST_RT",t:1,d:"Calculates the right-tailed F probability distribution (degree of diversity) for two data sets with given input x. Alternately called Fisher-Snedecor distribution or Snedecor's F distribution.",a:"F probability distribution.",m:[3,3],p:[{name:"x",detail:"The input to the F probability distribution function. The value at which to evaluate the function.",example:"15.35",require:"m",repeat:"n",type:"rangeNumber"},{name:"degrees_freedom1",detail:"The numerator of the number of degrees of freedom.",example:"7",require:"m",repeat:"n",type:"rangeNumber"},{name:"degrees_freedom2",detail:"The denominator of the number of degrees of freedom.",example:"6",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"VAR_P",t:1,d:"Calculates the variance based on an entire population.",a:"Variance of entire population.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"VAR_S",t:1,d:"Calculates the variance based on a sample.",a:"Variance.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"VARA",t:1,d:"Calculates the variance based on a sample, setting text to the value `0`.",a:"Variance of sample (text as 0).",m:[1,255],p:[{name:"value1",detail:"The first value or range of the sample.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"Additional values or ranges to include in the sample.",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"VARPA",t:1,d:"Calculates the variance based on an entire population, setting text to the value `0`.",a:"Variance of entire population (text as 0).",m:[1,255],p:[{name:"value1",detail:"The first value or range of the population.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"Additional values or ranges to include in the population.",example:"2",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"STEYX",t:1,d:"Calculates the standard error of the predicted y-value for each x in the regression of a dataset.",a:"Standard error of predicted y-values in regression.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"STANDARDIZE",t:1,d:"Calculates the normalized equivalent of a random variable given mean and standard deviation of the distribution.",a:"Normalized equivalent of a random variable.",m:[3,3],p:[{name:"value",detail:"The value of the random variable to normalize.",example:"96",require:"m",repeat:"n",type:"rangeNumber"},{name:"mean",detail:"The mean of the distribution.",example:"80",require:"m",repeat:"n",type:"rangeNumber"},{name:"standard_deviation",detail:"The standard deviation of the distribution.",example:"6.7",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SMALL",t:1,d:"Returns the nth smallest element from a data set, where n is user-defined.",a:"Nth smallest element in a data set.",m:[2,2],p:[{name:"data",detail:"The array or range containing the dataset to consider.",example:"A2:B100",require:"m",repeat:"n",type:"range"},{name:"n",detail:"The rank from smallest to largest of the element to return.",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SLOPE",t:1,d:"Calculates the slope of the line resulting from linear regression of a dataset.",a:"Slope of line from linear regression of data.",m:[2,2],p:[{name:"data_y",detail:"The range representing the array or matrix of dependent data.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"data_x",detail:"The range representing the array or matrix of independent data.",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SKEW",t:1,d:"Calculates the skewness of a dataset, which describes the symmetry of that dataset about the mean.",a:"Skewness of a dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the dataset.",example:"1",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"Additional values or ranges to include in the dataset.",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"SKEW_P",t:1,d:"Calculates the skewness of a dataset, which describes the symmetry of that dataset about the mean. This assumes the dataset is for the population.",a:"Skewness of a population's dataset.",m:[1,255],p:[{name:"value1",detail:"The first value or range of the dataset.",example:"1",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"Additional values or ranges to include in the dataset.",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"VLOOKUP",t:2,d:"Vertical lookup. Searches down the first column of a range for a key and returns the value of a specified cell in the row found.",a:"Vertical lookup.",m:[3,4],p:[{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.',example:"10003",require:"m",repeat:"n",type:"rangeAll"},{name:"range",detail:"The range to consider for the search. The first column in the range is searched for the key specified in `search_key`.",example:"A2:B26",require:"m",repeat:"n",type:"rangeAll"},{name:"index",detail:"The column index of the value to be returned, where the first column in `range` is numbered 1.",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"is_sorted",detail:"Indicates whether the column to be searched (the first column of the specified range) is sorted, in which case the closest match for `search_key` will be returned.",example:"FALSE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"HLOOKUP",t:2,d:"Horizontal lookup. Searches across the first row of a range for a key and returns the value of a specified cell in the column found.",a:"Horizontal lookup",m:[3,4],p:[{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.',example:"10003",require:"m",repeat:"n",type:"rangeAll"},{name:"range",detail:"The range to consider for the search. The first row in the range is searched for the key specified in `search_key`.",example:"A2:Z6",require:"m",repeat:"n",type:"rangeAll"},{name:"index",detail:"The row index of the value to be returned, where the first row in `range` is numbered 1.",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"is_sorted",detail:"Indicates whether the row to be searched (the first row of the specified range) is sorted.",example:"FALSE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"LOOKUP",t:2,d:"Looks through a sorted row or column for a key and returns the value of the cell in a result range located in the same position as the search row or column.",a:"Look up a value.",m:[2,3],p:[{name:"search_key",detail:'The value to search for in the row or column. For example, `42`, `"Cats"`, or `I24`.',example:"10003",require:"m",repeat:"n",type:"rangeAll"},{name:"search_range|search_result_array",detail:"One method of using this function is to provide a single sorted row or column `search_range` to look through for the `search_key` with a second argument `result_range`. The other way is to combine these two arguments into one `search_result_array` where the first row or column is searched and a value is returned from the last row or column in the array. If `search_key` is not found, a non-exact match may be returned.",example:"A1:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"result_range",detail:"The range from which to return a result. The value returned corresponds to the location where `search_key` is found in `search_range`. This range must be only a single row or column and should not be used if using the `search_result_array` method.",example:"B1:B100",require:"o",repeat:"n",type:"rangeAll"}]},{n:"ADDRESS",t:2,d:"Returns a cell reference as a string.",a:"Cell reference as a string.",m:[2,5],p:[{name:"row",detail:"The row number of the cell reference",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"column",detail:"The column number (not name) of the cell reference. `A` is column number `1`.",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"absolute_relative_mode",detail:"An indicator of whether the reference is row/column absolute. `1` is row and column absolute (e.g. $A$1), `2` is row absolute and column relative (e.g. A$1), `3` is row relative and column absolute (e.g. $A1), and `4` is row and column relative (e.g. A1).",example:"4",require:"o",repeat:"n",type:"rangeNumber"},{name:"use_a1_notation",detail:"A boolean indicating whether to use `A1` style notation (TRUE) or `R1C1` style notation (FALSE).",example:"FALSE()",require:"o",repeat:"n",type:"rangeAll"},{name:"sheet",detail:"Text indicating the name of the sheet into which the address points.",example:'"Sheet2"',require:"o",repeat:"n",type:"rangeAll"}]},{n:"INDIRECT",t:2,d:"Returns a cell reference specified by a string.",a:"A cell reference specified by a string.",m:[1,2],p:[{name:"cell_reference_as_string",detail:"A cell reference, written as a string with surrounding quotation marks.",example:'"Sheet2!"&B10',require:"m",repeat:"n",type:"rangeAll"},{name:"is_A1_notation",detail:"Indicates if the cell reference is in A1 notation (TRUE) or R1C1 notation (FALSE).",example:"FALSE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"ROW",t:2,d:"Returns the row number of a specified cell.",a:"Row number of a specified cell.",m:[0,1],p:[{name:"cell_reference",detail:"The cell whose row number will be returned.",example:"A9",require:"o",repeat:"n",type:"rangeAll"}]},{n:"ROWS",t:2,d:"Returns the number of rows in a specified array or range.",a:"Number of rows in a specified array or range.",m:[1,1],p:[{name:"range",detail:"The range whose row count will be returned.",example:"A9:A62",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"COLUMN",t:2,d:"Returns the column number of a specified cell, with `A=1`.",a:"Column number of a specified cell.",m:[0,1],p:[{name:"cell_reference",detail:"The cell whose column number will be returned. Column `A` corresponds to `1`.",example:"A9",require:"o",repeat:"n",type:"rangeAll"}]},{n:"COLUMNS",t:2,d:"Returns the number of columns in a specified array or range.",a:"Number of columns in a specified array or range.",m:[1,1],p:[{name:"range",detail:"The range whose column count will be returned.",example:"A9:W62",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"OFFSET",t:2,d:"Returns a range reference shifted a specified number of rows and columns from a starting cell reference.",a:"A range reference offset relative to a cell.",m:[3,5],p:[{name:"cell_reference",detail:"The starting point from which to count the offset rows and columns.",example:"A2",require:"m",repeat:"n",type:"range"},{name:"offset_rows",detail:"The number of rows to offset by.",example:"3",require:"m",repeat:"n",type:"rangeNumber"},{name:"offset_columns",detail:"The number of columns to offset by.",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"height",detail:"The height of the range to return starting at the offset target.",example:"2",require:"o",repeat:"n",type:"rangeNumber"},{name:"width",detail:"The width of the range to return starting at the offset target.",example:"2",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"MATCH",t:2,d:"Returns the relative position of an item in a range that matches a specified value.",a:"Position of item in range that matches value.",m:[2,3],p:[{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.',example:'"Sunday"',require:"m",repeat:"n",type:"rangeAll"},{name:"range",detail:"The one-dimensional array to be searched.",example:"A2:A9",require:"m",repeat:"n",type:"range"},{name:"search_type",detail:"The search method. `1` (default) finds the largest value less than or equal to `search_key` when `range` is sorted in ascending order. `0` finds the exact value when `range` is unsorted. `-1` finds the smallest value greater than or equal to `search_key` when `range` is sorted in descending order.",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"INDEX",t:2,d:"Returns the content of a cell, specified by row and column offset.",a:"Content of cell specified by row and column offset.",m:[2,3],p:[{name:"reference",detail:"The array of cells to be offset into.",example:"A1:C20",require:"m",repeat:"n",type:"range"},{name:"row",detail:"The number of offset rows.",example:"5",require:"m",repeat:"n",type:"rangeNumber"},{name:"column",detail:"The number of offset columns.",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"GETPIVOTDATA",t:2,d:"Extracts an aggregated value from a pivot table that corresponds to the specified row and column headings.",a:"Extracts an aggregated value from a pivot table that corresponds to the specified row and column headings.",m:[2,254],p:[{name:"value_name",detail:"The name of the value in the pivot table for which you want to get data.",example:'"SUM of number of units"',require:"m",repeat:"n",type:"rangeAll"},{name:"any_pivot_table_cell",detail:"Any reference to a cell in the desired pivot table (top corner recommended).",example:"'Pivot table'!A1",require:"m",repeat:"n",type:"rangeAll"},{name:"original_column",detail:"The name of the column in the original data set (not the pivot table).",example:'"division"',require:"o",repeat:"y",type:"rangeAll"},{name:"pivot_item",detail:"The name of the row or column shown in the pivot table corresponding to *original_column* that you want to retrieve.",example:'"east"',require:"o",repeat:"y",type:"rangeAll"}]},{n:"CHOOSE",t:2,d:"Returns an element from a list of choices based on index.",a:"An element from a list of choices based on index.",m:[2,255],p:[{name:"index",detail:"Which choice (of the up to 30 provided) to return.",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"choice1",detail:"A potential value to return. Required. May be a reference to a cell or an individual value.",example:'"A"',require:"m",repeat:"n",type:"rangeAll"},{name:"choice2",detail:"Additional values among which to choose.",example:'"B"',require:"o",repeat:"y",type:"rangeAll"}]},{n:"HYPERLINK",t:2,d:"Creates a hyperlink inside a cell.",a:"Creates a hyperlink inside a cell.",p:[{name:"url",detail:"The full URL of the link location enclosed in quotation marks, or a reference to a cell containing such a URL.",example:'"http://www.universheet.com/"',require:"m",repeat:"n",type:"rangeAll"},{name:"link_label",detail:"The text to display in the cell as the link, enclosed in quotation marks, or a reference to a cell containing such a label.",example:'"universheet"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"TIME",t:6,d:"Converts a provided hour, minute, and second into a time.",a:"Converts hour/minute/second into a time.",m:[3,3],p:[{name:"hour",detail:"The hour component of the time.",example:"11",require:"m",repeat:"n",type:"rangeNumber"},{name:"minute",detail:"The minute component of the time.",example:"40",require:"m",repeat:"n",type:"rangeNumber"},{name:"second",detail:"The second component of the time.",example:"59",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TIMEVALUE",t:6,d:"Returns the fraction of a 24-hour day the time represents.",a:"Converts a time string into its serial number representation.",m:[1,1],p:[{name:"time_string",detail:"The string that holds the time representation.",example:'"2:15 PM"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"EOMONTH",t:6,d:"Returns a date on the last day of a month that falls a specified number of months before or after another date.",a:"Last day of a month before or after a date.",m:[2,2],p:[{name:"start_date",detail:"The date from which to calculate the result.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"months",detail:"The number of months before (negative) or after (positive) 'start_date' to consider.",example:"7",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"EDATE",t:6,d:"Returns a date a specified number of months before or after another date.",a:"Date a number of months before/after another date.",m:[2,2],p:[{name:"start_date",detail:"The date from which to calculate the result.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"months",detail:"The number of months before (negative) or after (positive) 'start_date' to calculate.",example:"7",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SECOND",t:6,d:"Returns the second component of a specific time, in numeric format.",a:"Second component of a specific time.",m:[1,1],p:[{name:"time",detail:"The time from which to calculate the second component",example:"TIME(11",require:"m",repeat:"n",type:"rangeAll"}]},{n:"MINUTE",t:6,d:"Returns the minute component of a specific time, in numeric format.",a:"Minute component of a specific time.",m:[1,1],p:[{name:"time",detail:"The time from which to calculate the minute component.",example:"TIME(11",require:"m",repeat:"n",type:"rangeAll"}]},{n:"HOUR",t:6,d:"Returns the hour component of a specific time, in numeric format.",a:"Hour component of a specific time.",m:[1,1],p:[{name:"time",detail:"The time from which to calculate the hour component.",example:"TIME(11",require:"m",repeat:"n",type:"rangeAll"}]},{n:"NOW",t:6,d:"Returns the current date and time as a date value.",a:"Current date and time as a date value.",m:[0,0],p:[]},{n:"NETWORKDAYS",t:6,d:"Returns the number of net working days between two provided days.",a:"Net working days between two provided days.",m:[2,3],p:[{name:"start_date",detail:"The start date of the period from which to calculate the number of net working days.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"end_date",detail:"The end date of the period from which to calculate the number of net working days.",example:"7",require:"m",repeat:"n",type:"rangeAll"},{name:"holidays",detail:"A range or array constant containing the date serial numbers to consider holidays.",example:"16)",require:"o",repeat:"n",type:"rangeAll"}]},{n:"NETWORKDAYS_INTL",t:6,d:"Returns the number of net working days between two provided days excluding specified weekend days and holidays.",a:"Net working days between two dates (specifying weekends).",m:[2,4],p:[{name:"start_date",detail:"The start date of the period from which to calculate the number of net working days.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"end_date",detail:"The end date of the period from which to calculate the number of net working days.",example:"7",require:"m",repeat:"n",type:"rangeAll"},{name:"weekend",detail:"A number or string representing which days of the week are considered weekends.",example:"16)",require:"o",repeat:"n",type:"rangeAll"},{name:"holidays",detail:"A range or array constant containing the dates to consider as holidays.",example:"DATE(1969",require:"o",repeat:"n",type:"rangeAll"}]},{n:"ISOWEEKNUM",t:6,d:"Returns a number representing the ISO week of the year where the provided date falls.",a:"ISO week number of the year.",m:[1,1],p:[{name:"date",detail:"The date for which to determine the ISO week number. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"}]},{n:"WEEKNUM",t:6,d:"Returns a number representing the week of the year where the provided date falls.",a:"Week number of the year.",m:[1,2],p:[{name:"date",detail:"The date for which to determine the week number. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"type",detail:"A number representing the day that a week starts on. Sunday = 1.",example:"7",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"WEEKDAY",t:6,d:"Returns a number representing the day of the week of the date provided.",a:"Day of the week of the date provided (as number).",m:[1,2],p:[{name:"date",detail:"The date for which to determine the day of the week. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"type",detail:"A number indicating which numbering system to use to represent weekdays. By default, counts starting with Sunday = 1.",example:"7",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DAY",t:6,d:"Returns the day of the month that a specific date falls on, in numeric format.",a:"Day of the month that a specific date falls on.",m:[1,1],p:[{name:"date",detail:"The date from which to extract the day.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"}]},{n:"DAYS",t:6,d:"Returns the number of days between two dates.",a:"Number of days between two dates.",m:[2,2],p:[{name:"end_date",detail:"The end of the date range.",example:"2011-3-15",require:"m",repeat:"n",type:"rangeAll"},{name:"start_date",detail:"The start of the date range.",example:"2011-2-1",require:"m",repeat:"n",type:"rangeAll"}]},{n:"DAYS360",t:6,d:"Returns the difference between two days based on the 360 day year used in some financial interest calculations.",a:"Days between two dates on a 360-day year.",m:[2,3],p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"7",require:"m",repeat:"n",type:"rangeAll"},{name:"method",detail:"An indicator of what day count method to use.",example:"FALSE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"DATE",t:6,d:"Converts a provided year, month, and day into a date.",a:"Converts year/month/day into a date.",m:[3,3],p:[{name:"year",detail:"The year component of the date.",example:"1969",require:"m",repeat:"n",type:"rangeNumber"},{name:"month",detail:"The month component of the date.",example:"7",require:"m",repeat:"n",type:"rangeNumber"},{name:"day",detail:"The day component of the date.",example:"20",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DATEVALUE",t:6,d:"Converts a provided date string in a known format to a date value.",a:"Converts a date string to a date value.",m:[1,1],p:[{name:"date_string",detail:"The string representing the date.",example:'"1969-7-20"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"DATEDIF",t:6,d:"Calculates the number of days, months, or years between two dates.",a:"Date Difference.",m:[3,3],p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"7",require:"m",repeat:"n",type:"rangeAll"},{name:"unit",detail:'A string abbreviation for unit of time. For example, "M" for month. Accepted values are "Y","M","D","MD","YM","YD".',example:"16)",require:"m",repeat:"n",type:"rangeAll"}]},{n:"WORKDAY",t:6,d:"Calculates the date after a number of working days from a specified start date.",a:"Number of working days from start date.",m:[2,3],p:[{name:"start_date",detail:"The date from which to begin counting.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"num_days",detail:"The number of working days to advance from `start_date`. If negative, counts backwards.",example:"7",require:"m",repeat:"n",type:"rangeNumber"},{name:"holidays",detail:"A range or array constant containing the dates to consider holidays.",example:"16)",require:"o",repeat:"n",type:"rangeAll"}]},{n:"WORKDAY_INTL",t:6,d:"Calculates the date after a specified number of workdays excluding specified weekend days and holidays.",a:"Date after a number of workdays (specifying weekends).",m:[2,4],p:[{name:"start_date",detail:"The date from which to begin counting.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"num_days",detail:"The number of working days to advance from `start_date`. If negative, counts backwards.",example:"7",require:"m",repeat:"n",type:"rangeNumber"},{name:"weekend",detail:"A number or string representing which days of the week are considered weekends.",example:"16)",require:"o",repeat:"n",type:"rangeAll"},{name:"holidays",detail:"A range or array constant containing the dates to consider holidays.",example:"DATE(1969",require:"o",repeat:"n",type:"rangeAll"}]},{n:"YEAR",t:6,d:"Returns the year specified by a given date.",a:"Year specified by a given date.",m:[1,1],p:[{name:"date",detail:"The date from which to extract the year.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"}]},{n:"YEARFRAC",t:6,d:"Returns the number of years, including fractional years, between two dates using a specified day count convention.",a:"Exact number of years between two dates.",m:[2,3],p:[{name:"start_date",detail:"The start date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"end_date",detail:"The end date to consider in the calculation. Must be a reference to a cell containing a date, a function returning a date type, or a number.",example:"7",require:"m",repeat:"n",type:"rangeAll"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"16)",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"TODAY",t:6,d:"Returns the current date as a date value.",a:"Current date as a date value.",m:[0,0],p:[]},{n:"MONTH",t:6,d:"Returns the month of the year a specific date falls in, in numeric format.",a:"Month of the year a specific date falls in.",m:[1,1],p:[{name:"date",detail:"The date from which to extract the month.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"}]},{n:"EFFECT",t:8,d:"Calculates the annual effective interest rate given the nominal rate and number of compounding periods per year.",a:"Annual effective interest rate.",m:[2,2],p:[{name:"nominal_rate",detail:"The nominal interest rate per year.",example:"0.99",require:"m",repeat:"n",type:"rangeNumber"},{name:"periods_per_year",detail:"The number of compounding periods per year.",example:"12",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DOLLAR",t:12,d:"Formats a number into the currency specific to your spreadsheet Locale.",a:"Formats a number as currency specific to your spreadsheet Locale.",m:[1,2],p:[{name:"number",detail:"The value to be formatted.",example:"1.2351",require:"m",repeat:"n",type:"rangeNumber"},{name:"number_of_places",detail:"The number of decimal places to display.",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DOLLARDE",t:8,d:"Converts a price quotation given as a decimal fraction into a decimal value.",a:"Converts a decimal fraction to decimal value.",m:[2,2],p:[{name:"fractional_price",detail:"The price quotation given using fractional decimal conventions.",example:"100.10",require:"m",repeat:"n",type:"rangeNumber"},{name:"unit",detail:"The units of the fraction, e.g. `8` for 1/8ths or `32` for 1/32nds.",example:"32",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DOLLARFR",t:8,d:"Converts a price quotation given as a decimal value into a decimal fraction.",a:"Converts a decimal value to decimal fraction.",m:[2,2],p:[{name:"decimal_price",detail:"The price quotation given as a decimal value.",example:"100.125",require:"m",repeat:"n",type:"rangeNumber"},{name:"unit",detail:"The units of the desired fraction, e.g. `8` for 1/8ths or `32` for 1/32nds.",example:"32",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DB",t:8,d:"Calculates the depreciation of an asset for a specified period using the arithmetic declining balance method.",a:"Depreciation via declining balance method.",m:[4,5],p:[{name:"cost",detail:"The initial cost of the asset.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"50",require:"m",repeat:"n",type:"rangeNumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangeNumber"},{name:"period",detail:"The single period within `life` for which to calculate depreciation.",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"month",detail:"The number of months in the first year of depreciation.",example:"10",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DDB",t:8,d:"Calculates the depreciation of an asset for a specified period using the double-declining balance method.",a:"Depreciation via double-declining balance method.",m:[4,5],p:[{name:"cost",detail:"The initial cost of the asset.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"50",require:"m",repeat:"n",type:"rangeNumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangeNumber"},{name:"period",detail:"The single period within `life` for which to calculate depreciation.",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"factor",detail:"The factor by which depreciation decreases.",example:"2.25",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"RATE",t:8,d:"Calculates the interest rate of an annuity investment based on constant-amount periodic payments and the assumption of a constant interest rate.",a:"Interest rate of an annuity investment.",m:[3,6],p:[{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangeNumber"},{name:"payment_per_period",detail:"The amount per period to be paid.",example:"-100",require:"m",repeat:"n",type:"rangeNumber"},{name:"present_value",detail:"The current value of the annuity.",example:"400",require:"m",repeat:"n",type:"rangeNumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"0",require:"o",repeat:"n",type:"rangeNumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"o",repeat:"n",type:"rangeNumber"},{name:"rate_guess",detail:"An estimate for what the interest rate will be.",example:"0.1",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"CUMPRINC",t:8,d:"Calculates the cumulative principal paid over a range of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Cumulative principal paid over a set of periods.",m:[6,6],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangeNumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangeNumber"},{name:"present_value",detail:"The current value of the annuity.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"first_period",detail:"The number of the payment period to begin the cumulative calculation.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"last_period",detail:"The number of the payment period to end the cumulative calculation.",example:"5",require:"m",repeat:"n",type:"rangeNumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"COUPNUM",t:8,d:"Calculates the number of coupons, or interest payments, between the settlement date and the maturity date of the investment.",a:"Number of coupons between settlement and maturity.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"02",require:"m",repeat:"n",type:"rangeAll"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"SYD",t:8,d:"Calculates the depreciation of an asset for a specified period using the sum of years digits method.",a:"Depreciation via sum of years digits method.",m:[4,4],p:[{name:"cost",detail:"The initial cost of the asset.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"50",require:"m",repeat:"n",type:"rangeNumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangeNumber"},{name:"period",detail:"The single period within `life` for which to calculate depreciation.",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TBILLEQ",t:8,d:"Calculates the equivalent annualized rate of return of a US Treasury Bill based on discount rate.",a:"Equivalent rate of return for a Treasury bill.",m:[3,3],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"1",require:"m",repeat:"n",type:"rangeAll"},{name:"discount",detail:"The discount rate of the bill at time of purchase.",example:"2)",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TBILLYIELD",t:8,d:"Calculates the yield of a US Treasury Bill based on price.",a:"The yield of a us treasury bill based on price.",m:[3,3],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"95",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TBILLPRICE",t:8,d:"Calculates the price of a US Treasury Bill based on discount rate.",a:"Price of US treasury bill.",m:[3,3],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"discount",detail:"The discount rate of the bill at time of purchase.",example:"0.09",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"PV",t:8,d:"Calculates the present value of an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Present value of an annuity investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangeNumber"},{name:"payment_amount",detail:"The amount per period to be paid.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"D2",require:"o",repeat:"n",type:"rangeNumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"ACCRINT",t:8,d:"Calculates the accrued interest of a security that has periodic payments.",a:"Accrued interest of security with periodic payments.",m:[6,8],p:[{name:"issue",detail:"The date the security was initially issued.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"first_payment",detail:"The first date interest will be paid.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"rate",detail:"The annualized rate of interest.",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"10000",require:"m",repeat:"n",type:"rangeNumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangeNumber"},{name:"calc_method",detail:"[Optional-defaults to TRUE()] - A logical value that specifies the method used to calculate the total accrued interest when the settlement date is later than the first interest accrual date. \n\nIf the value is TRUE, the total accrued interest from the issue date to the settlement date is returned. \n\nIf the value is FALSE, return the accrued interest from the first interest accrual date to the settlement date.",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"ACCRINTM",t:8,d:"Calculates the accrued interest of a security that pays interest at maturity.",a:"Accrued interest of security paying at maturity.",m:[4,5],p:[{name:"issue",detail:"The date the security was initially issued.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity date of the security.",example:"DATE(1969",require:"m",repeat:"n",type:"rangeAll"},{name:"rate",detail:"The annualized rate of interest.",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"1000",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"COUPDAYBS",t:8,d:"Calculates the number of days from the first coupon, or interest payment, until settlement.",a:"Number of days from first coupon to settlement.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"COUPDAYS",t:8,d:"Calculates the number of days in the coupon, or interest payment, period that contains the specified settlement date.",a:"Days in coupon period containing settlement date.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"COUPDAYSNC",t:8,d:"Calculates the number of days from the settlement date until the next coupon, or interest payment.",a:"Days from settlement until next coupon.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"COUPNCD",t:8,d:"Calculates next coupon, or interest payment, date after the settlement date.",a:"Next coupon date after the settlement date.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"01)",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"DATE(2019",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"COUPPCD",t:8,d:"Calculates last coupon, or interest payment, date before the settlement date.",a:"Last coupon date before settlement date.",m:[3,4],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"01)",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"DATE(2019",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"FV",t:8,d:"Calculates the future value of an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Future value of an annuity investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangeNumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangeNumber"},{name:"payment_amount",detail:"The amount per period to be paid.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"present_value",detail:"The current value of the annuity.",example:"400",require:"m",repeat:"n",type:"rangeNumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"FVSCHEDULE",t:8,d:"Calculates the future value of some principal based on a specified series of potentially varying interest rates.",a:"Future value of principal from series of rates.",m:[2,2],p:[{name:"principal",detail:"The amount of initial capital or value to compound against.",example:"10000",require:"m",repeat:"n",type:"rangeNumber"},{name:"rate_schedule",detail:"A series of interest rates to compound against the `principal`.",example:"A2:A100",require:"m",repeat:"n",type:"range"}]},{n:"YIELD",t:8,d:"Calculates the annual yield of a security paying periodic interest, such as a US Treasury Bond, based on price.",a:"Annual yield of a security paying periodic interest.",m:[6,7],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"rate",detail:"The annualized rate of interest.",example:"0.057",require:"m",repeat:"n",type:"rangeNumber"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"95",require:"m",repeat:"n",type:"rangeNumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"YIELDDISC",t:8,d:"Calculates the annual yield of a discount (non-interest-bearing) security, based on price.",a:"Annual yield of a discount security.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"95",require:"m",repeat:"n",type:"rangeNumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"NOMINAL",t:8,d:"Calculates the annual nominal interest rate given the effective rate and number of compounding periods per year.",a:"Annual nominal interest rate.",m:[2,2],p:[{name:"effective_rate",detail:"The effective interest rate per year.",example:"0.85",require:"m",repeat:"n",type:"rangeNumber"},{name:"periods_per_year",detail:"The number of compounding periods per year.",example:"12",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"XIRR",t:8,d:"Calculates the internal rate of return of an investment based on a specified series of potentially irregularly spaced cash flows.",a:"Internal rate of return given non-periodic cashflows.",m:[2,3],p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment.",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"cashflow_dates",detail:"An array or range with dates corresponding to the cash flows in `cashflow_amounts`.",example:"C2:C25",require:"m",repeat:"n",type:"range"},{name:"rate_guess",detail:"An estimate for what the internal rate of return will be.",example:"250",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"MIRR",t:8,d:"Calculates the modified internal rate of return on an investment based on a series of periodic cash flows and the difference between the interest rate paid on financing versus the return received on reinvested income.",a:"Modified internal rate of return.",m:[3,3],p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment.",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"financing_rate",detail:"The interest rate paid on funds invested.",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"},{name:"reinvestment_return_rate",detail:"The return (as a percentage) earned on reinvestment of income received from the investment.",example:"0.12",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"IRR",t:8,d:"Calculates the internal rate of return on an investment based on a series of periodic cash flows.",a:"Internal rate of return given periodic cashflows.",m:[1,2],p:[{name:"cashflow_amounts",detail:"An array or range containing the income or payments associated with the investment.",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"rate_guess",detail:"An estimate for what the internal rate of return will be.",example:"200",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"NPV",t:8,d:"Calculates the net present value of an investment based on a series of periodic cash flows and a discount rate.",a:"The net present value of an investment based on a series of periodic cash flows and a discount rate.",m:[2,255],p:[{name:"discount",detail:"The discount rate of the investment over one period.",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"},{name:"cashflow1",detail:"The first future cash flow.",example:"200",require:"m",repeat:"n",type:"rangeAll"},{name:"cashflow2",detail:"Additional future cash flows.",example:"250",require:"o",repeat:"y",type:"rangeAll"}]},{n:"XNPV",t:8,d:"Calculates the net present value of an investment based on a specified series of potentially irregularly spaced cash flows and a discount rate.",a:"Net present value given non-periodic cashflows.",m:[3,3],p:[{name:"discount",detail:"The discount rate of the investment over one period.",example:"A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"cashflow_amounts",detail:"A range of cells containing the income or payments associated with the investment.",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"cashflow_dates",detail:"A range of cells with dates corresponding to the cash flows in `cashflow_amounts`.",example:"C2:C25",require:"m",repeat:"n",type:"range"}]},{n:"CUMIPMT",t:8,d:"Calculates the cumulative interest over a range of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Cumulative interest paid over a set of periods.",m:[6,6],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangeNumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangeNumber"},{name:"present_value",detail:"The current value of the annuity.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"first_period",detail:"The number of the payment period to begin the cumulative calculation.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"last_period",detail:"The number of the payment period to end the cumulative calculation.",example:"5",require:"m",repeat:"n",type:"rangeNumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"PMT",t:8,d:"Calculates the periodic payment for an annuity investment based on constant-amount periodic payments and a constant interest rate.",a:"Periodic payment for an annuity investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"0.08",require:"m",repeat:"n",type:"rangeNumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangeNumber"},{name:"present_value",detail:"The current value of the annuity.",example:" 100000",require:"m",repeat:"n",type:"rangeNumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"D2",require:"m",repeat:"n",type:"rangeNumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"IPMT",t:8,d:"Calculates the payment on interest for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Payment on interest for an investment.",m:[4,6],p:[{name:"rate",detail:"The interest rate.",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"},{name:"period",detail:"The amortization period, in terms of number of periods.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"12",require:"m",repeat:"n",type:"rangeNumber"},{name:"present_value",detail:"The current value of the annuity.",example:"80000",require:"m",repeat:"n",type:"rangeNumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"E2",require:"m",repeat:"n",type:"rangeNumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"1",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"PPMT",t:8,d:"Calculates the payment on the principal of an investment based on constant-amount periodic payments and a constant interest rate.",a:"Payment on the principal of an investment.",m:[4,6],p:[{name:"rate",detail:"The interest rate.",example:"0.1",require:"m",repeat:"n",type:"rangeNumber"},{name:"period",detail:"The amortization period, in terms of number of periods.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"number_of_periods",detail:"The number of payments to be made.",example:"3*12",require:"m",repeat:"n",type:"rangeNumber"},{name:"present_value",detail:"The current value of the annuity.",example:"100000",require:"m",repeat:"n",type:"rangeNumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"0",require:"o",repeat:"n",type:"rangeNumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"INTRATE",t:8,d:"Calculates the effective interest rate generated when an investment is purchased at one price and sold at another with no interest or dividends generated by the investment itself.",a:"Calculates effective interest rate.",m:[4,5],p:[{name:"buy_date",detail:"The date of purchase of the investment.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"sell_date",detail:"The date of sale of the investment.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"buy_price",detail:"The price at which the investment was purchased.",example:"100000",require:"m",repeat:"n",type:"rangeNumber"},{name:"sell_price",detail:"The price at which the investment was sold.",example:"101200",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"PRICE",t:8,d:"Calculates the price of a security paying periodic interest, such as a US Treasury Bond, based on expected yield.",a:"Price of a security paying periodic interest.",m:[6,7],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"rate",detail:"The annualized rate of interest.",example:"0.057",require:"m",repeat:"n",type:"rangeNumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.065",require:"m",repeat:"n",type:"rangeNumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"PRICEDISC",t:8,d:"Calculates the price of a discount (non-interest-bearing) security, based on expected yield.",a:"Price of a discount security.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"discount",detail:"The discount rate of the security at time of purchase.",example:"0.0525",require:"m",repeat:"n",type:"rangeNumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"PRICEMAT",t:8,d:"Calculates the price of a security paying interest at maturity, based on expected yield.",a:"Price of security paying interest at maturity.",m:[5,6],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"issue",detail:"The date the security was initially issued.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"rate",detail:"The annualized rate of interest.",example:"0.061",require:"m",repeat:"n",type:"rangeNumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.061",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"RECEIVED",t:8,d:"Calculates the amount received at maturity for an investment in fixed-income securities purchased on a given date.",a:"Amount received at maturity for a security.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"investment",detail:"The amount invested (irrespective of face value of each security).",example:"10000000",require:"m",repeat:"n",type:"rangeNumber"},{name:"discount",detail:"The discount rate of the security invested in.",example:"0.0575",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DISC",t:8,d:"Calculates the discount rate of a security based on price.",a:"The discount rate of a security based on price.",m:[4,5],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"price",detail:"The price at which the security is bought per 100 face value.",example:"97.975",require:"m",repeat:"n",type:"rangeNumber"},{name:"redemption",detail:"The redemption amount per 100 face value, or par.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"12",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"NPER",t:8,d:"Calculates the number of payment periods for an investment based on constant-amount periodic payments and a constant interest rate.",a:"Number of payment periods for an investment.",m:[3,5],p:[{name:"rate",detail:"The interest rate.",example:"0.12",require:"m",repeat:"n",type:"rangeNumber"},{name:"payment_amount",detail:"The amount of each payment made.",example:"500",require:"m",repeat:"n",type:"rangeNumber"},{name:"present_value",detail:"The current value of the annuity.",example:"40000",require:"m",repeat:"n",type:"rangeNumber"},{name:"future_value",detail:"The future value remaining after the final payment has been made.",example:"0",require:"o",repeat:"n",type:"rangeNumber"},{name:"end_or_beginning",detail:"Whether payments are due at the end (`0`) or beginning (`1`) of each period.",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"SLN",t:8,d:"Calculates the depreciation of an asset for one period using the straight-line method.",a:"Depreciation of asset using the straight-line method.",m:[3,3],p:[{name:"cost",detail:"The initial cost of the asset.",example:"300000",require:"m",repeat:"n",type:"rangeNumber"},{name:"salvage",detail:"The value of the asset at the end of depreciation.",example:"75000",require:"m",repeat:"n",type:"rangeNumber"},{name:"life",detail:"The number of periods over which the asset is depreciated.",example:"10",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DURATION",t:8,d:"Calculates the number of compounding periods required for an investment of a specified present value appreciating at a given rate to reach a target value.",a:"Number of periods for an investment to reach a value.",m:[5,6],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"rate",detail:"The annualized rate of interest.",example:"0.08",require:"m",repeat:"n",type:"rangeNumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.09",require:"m",repeat:"n",type:"rangeNumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"MDURATION",t:8,d:"Calculates the modified Macaulay duration of a security paying periodic interest, such as a US Treasury Bond, based on expected yield.",a:"Modified Macaulay duration.",m:[5,6],p:[{name:"settlement",detail:"The settlement date of the security, the date after issuance when the security is delivered to the buyer.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"maturity",detail:"The maturity or end date of the security, when it can be redeemed at face, or par value.",example:"DATE(2010",require:"m",repeat:"n",type:"rangeAll"},{name:"rate",detail:"The annualized rate of interest.",example:"0.08",require:"m",repeat:"n",type:"rangeNumber"},{name:"yield",detail:"The expected annual yield of the security.",example:"0.09",require:"m",repeat:"n",type:"rangeNumber"},{name:"frequency",detail:"The number of interest or coupon payments per year (1, 2, or 4).",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"day_count_convention",detail:"An indicator of what day count method to use.",example:"0",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"BIN2DEC",t:9,d:"Converts a signed binary number to decimal format.",a:"Converts a signed binary number to decimal format.",m:[1,1],p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to decimal, provided as a string.",example:"101",require:"m",repeat:"n",type:"rangeAll"}]},{n:"BIN2HEX",t:9,d:"Converts a signed binary number to signed hexadecimal format.",a:"Converts a binary number to hexadecimal.",m:[1,2],p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to signed hexademical, provided as a string.",example:"101",require:"m",repeat:"n",type:"rangeAll"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"BIN2OCT",t:9,d:"Converts a signed binary number to signed octal format.",a:"Converts a binary number to octal.",m:[1,2],p:[{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to signed octal, provided as a string.",example:"101",require:"m",repeat:"n",type:"rangeAll"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DEC2BIN",t:9,d:"Converts a decimal number to signed binary format.",a:"Converts a decimal number to signed binary format.",m:[1,2],p:[{name:"decimal_number",detail:"The decimal value to be converted to signed binary, provided as a string.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DEC2HEX",t:9,d:"Converts a decimal number to signed hexadecimal format.",a:"Converts a decimal number to hexadecimal.",m:[1,2],p:[{name:"decimal_number",detail:"The decimal value to be converted to signed hexadecimal, provided as a string.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DEC2OCT",t:9,d:"Converts a decimal number to signed octal format.",a:"Converts a decimal number to signed octal format.",m:[1,2],p:[{name:"decimal_number",detail:"The decimal value to be converted to signed octal, provided as a string.",example:"100",require:"m",repeat:"n",type:"rangeNumber"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"HEX2BIN",t:9,d:"Converts a signed hexadecimal number to signed binary format.",a:"Converts a hexadecimal number to binary.",m:[1,2],p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to signed binary, provided as a string.",example:'"f3"',require:"m",repeat:"n",type:"rangeAll"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"HEX2DEC",t:9,d:"Converts a signed hexadecimal number to decimal format.",a:"Converts a hexadecimal number to decimal.",m:[1,1],p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to decimal, provided as a string.",example:'"f3"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"HEX2OCT",t:9,d:"Converts a signed hexadecimal number to signed octal format.",a:"Converts a hexadecimal number to octal.",m:[1,2],p:[{name:"signed_hexadecimal_number",detail:"The signed 40-bit hexadecimal value to be converted to signed octal, provided as a string.",example:'"f3"',require:"m",repeat:"n",type:"rangeAll"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"OCT2BIN",t:9,d:"Converts a signed octal number to signed binary format.",a:"Converts an octal number to binary.",m:[1,2],p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to signed binary, provided as a string.",example:"37",require:"m",repeat:"n",type:"rangeAll"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"OCT2DEC",t:9,d:"Converts a signed octal number to decimal format.",a:"Converts a signed octal number to decimal format.",m:[1,1],p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to decimal, provided as a string.",example:"37",require:"m",repeat:"n",type:"rangeAll"}]},{n:"OCT2HEX",t:9,d:"Converts a signed octal number to signed hexadecimal format.",a:"Converts an octal number to hexadecimal.",m:[1,2],p:[{name:"signed_octal_number",detail:"The signed 30-bit octal value to be converted to signed hexadecimal, provided as a string.",example:"37",require:"m",repeat:"n",type:"rangeAll"},{name:"significant_digits",detail:"The number of significant digits to ensure in the result.",example:"8",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"COMPLEX",t:9,d:"Creates a complex number given real and imaginary coefficients.",a:"Creates a complex number.",m:[2,3],p:[{name:"real_part",detail:"The real coefficient.",example:"3",require:"m",repeat:"n",type:"rangeNumber"},{name:"imaginary_part",detail:"The imaginary coefficient.",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"suffix",detail:"The suffix for the imaginary coefficient, can only be 'i' or 'j'. If omitted, 'i' will be used.",example:'"j"',require:"o",repeat:"n",type:"rangestring"}]},{n:"IMREAL",t:9,d:"Returns the real coefficient of a complex number.",a:"The real coefficient of a complex number.",m:[1,1],p:[{name:"complex_number",detail:"The complex number, in the a+bi or a+bj format.",example:'"4+5i"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"IMAGINARY",t:9,d:"Returns the imaginary coefficient of a complex number.",a:"The imaginary coefficient of a complex number.",m:[1,1],p:[{name:"complex_number",detail:"The complex number, in the a+bi or a+bj format.",example:'"4+5i"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"IMCONJUGATE",t:9,d:"Returns the complex conjugate of a number.",a:"The complex conjugate of a number.",m:[1,1],p:[{name:"number",detail:"The complex number to calculate the conjugate for.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"IMABS",t:9,d:"Returns absolute value (or modulus) of a complex number.",a:"The absolute value of a complex number.",m:[1,1],p:[{name:"number",detail:"The complex number to calculate the absolute value of.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"DELTA",t:9,d:"Compare two numeric values, returning 1 if they're equal.",a:"Compare two numeric values.",m:[1,2],p:[{name:"number1",detail:"The first number to compare.",example:"2",require:"m",repeat:"n",type:"rangeNumber"},{name:"number2",detail:"The second number to compare.",example:"1",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"IMSUM",t:9,d:"Returns the sum of a series of complex numbers.",a:"Sum of a series of complex numbers.",m:[1,255],p:[{name:"value1",detail:"The first complex number or range to add together.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"Additional complex numbers or ranges to add to `value1`.",example:'"5-3i"',require:"o",repeat:"y",type:"rangeAll"}]},{n:"IMSUB",t:9,d:"Returns the difference between two complex numbers.",a:"The difference between two complex numbers.",m:[2,2],p:[{name:"first_number",detail:"The complex number to subtract second_number from.",example:'"6+5i"',require:"m",repeat:"n",type:"rangeAll"},{name:"second_number",detail:"The complex number to subtract from first_number.",example:'"2+3i"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"IMPRODUCT",t:9,d:"Returns the result of multiplying a series of complex numbers together.",a:"Result of multiplying a series of complex numbers together.",m:[1,255],p:[{name:"factor1",detail:"The first number or range to calculate for the product.",example:'"3+4i"',require:"m",repeat:"n",type:"rangeAll"},{name:"factor2",detail:"Additional complex numbers or ranges to calculate for the product.",example:'"5-3i"',require:"o",repeat:"y",type:"rangeAll"}]},{n:"IMDIV",t:9,d:"Returns one complex number divided by another.",a:"One complex number divided by another.",m:[2,2],p:[{name:"dividend",detail:"The complex number to be divided.",example:'"11+16i"',require:"m",repeat:"n",type:"rangeAll"},{name:"divisor",detail:"The complex number to divide by.",example:'"3+2i"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"NOT",t:10,d:"Returns the opposite of a logical value - `NOT(TRUE)` returns `FALSE`; `NOT(FALSE)` returns `TRUE`.",a:"Returns opposite of provided logical value.",m:[1,1],p:[{name:"logical_expression",detail:"An expression or reference to a cell holding an expression that represents some logical value.",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"TRUE",t:10,d:"Returns the logical value `TRUE`.",a:"Logical value `true`.",m:[0,0],p:[]},{n:"FALSE",t:10,d:"Returns the logical value `FALSE`.",a:"Logical value `false`.",m:[0,0],p:[]},{n:"AND",t:10,d:"Returns true if all of the provided arguments are logically true, and false if any of the provided arguments are logically false.",a:"Logical `and` operator.",m:[1,255],p:[{name:"logical_expression1",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`, or an expression that can be coerced to a logical value.",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeAll"},{name:"logical_expression2",detail:"More expressions that represent logical values.",example:'A3 = "bar"',require:"o",repeat:"y",type:"rangeAll"}]},{n:"IFERROR",t:10,d:"Returns the first argument if it is not an error value, otherwise returns the second argument if present, or a blank if the second argument is absent.",a:"Value if it is not an error, otherwise 2nd argument.",m:[2,2],p:[{name:"value",detail:"The value to return if `value` itself is not an error.",example:"A1",require:"m",repeat:"n",type:"rangeAll"},{name:"value_if_error",detail:"The value the function returns if `value` is an error.",example:'"Error in cell A1"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"IF",t:10,d:"Returns one value if a logical expression is `TRUE` and another if it is `FALSE`.",a:"Returns value depending on logical expression.",m:[2,3],p:[{name:"logical_expression",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`.",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeAll"},{name:"value_if_true",detail:"The value the function returns if `logical_expression` is `TRUE`.",example:'"A2 is foo"',require:"m",repeat:"n",type:"rangeAll"},{name:"value_if_false",detail:"The value the function returns if `logical_expression` is `FALSE`.",example:'"A2 was false"',require:"o",repeat:"n",type:"rangeAll"}]},{n:"OR",t:10,d:"Returns true if any of the provided arguments are logically true, and false if all of the provided arguments are logically false.",a:"Logical `or` operator.",m:[1,255],p:[{name:"logical_expression1",detail:"An expression or reference to a cell containing an expression that represents some logical value, i.e. `TRUE` or `FALSE`, or an expression that can be coerced to a logical value.",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeAll"},{name:"logical_expression2",detail:"More expressions that evaluate to logical values.",example:' A3 = "bar"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"NE",t:11,d:"Returns `TRUE` if two specified values are not equal and `FALSE` otherwise. Equivalent to the `!=` operator.",a:"Not equal.",m:[2,2],p:[{name:"value1",detail:"The first value.",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"The value to test against `value1` for inequality.",example:"A3",require:"m",repeat:"n",type:"rangeAll"}]},{n:"EQ",t:11,d:"Returns `TRUE` if two specified values are equal and `FALSE` otherwise. Equivalent to the `==` operator.",a:"Equal.",m:[2,2],p:[{name:"value1",detail:"The first value.",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"The value to test against `value1` for equality.",example:"A3",require:"m",repeat:"n",type:"rangeAll"}]},{n:"GT",t:11,d:"Returns `TRUE` if the first argument is strictly greater than the second, and `FALSE` otherwise. Equivalent to the `>` operator.",a:"Strictly greater than.",m:[2,2],p:[{name:"value1",detail:"The value to test as being greater than `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeAll"}]},{n:"GTE",t:11,d:"Returns `TRUE` if the first argument is greater than or equal to the second, and `FALSE` otherwise. Equivalent to the `>=` operator.",a:"Greater than or equal to.",m:[2,2],p:[{name:"value1",detail:"The value to test as being greater than or equal to `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeAll"}]},{n:"LT",t:11,d:"Returns `TRUE` if the first argument is strictly less than the second, and `FALSE` otherwise. Equivalent to the `<` operator.",a:"Less than.",m:[2,2],p:[{name:"value1",detail:"The value to test as being less than `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeAll"}]},{n:"LTE",t:11,d:"Returns `TRUE` if the first argument is less than or equal to the second, and `FALSE` otherwise. Equivalent to the `<=` operator.",a:"Less than or equal to.",m:[2,2],p:[{name:"value1",detail:"The value to test as being less than or equal to `value2`.",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"The second value.",example:"A3",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ADD",t:11,d:"Returns the sum of two numbers. Equivalent to the `+` operator.",a:"Sum of two numbers",m:[2,2],p:[{name:"value1",detail:"The first addend.",example:"A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"The second addend.",example:"A3",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MINUS",t:11,d:"Returns the difference of two numbers. Equivalent to the `-` operator.",a:"Difference of two numbers",m:[2,2],p:[{name:"value1",detail:"The minuend, or number to be subtracted from.",example:"A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"value2",detail:"The subtrahend, or number to subtract from `value1`.",example:"A3",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MULTIPLY",t:11,d:"Returns the product of two numbers. Equivalent to the `*` operator.",a:"Product of two numbers",m:[2,2],p:[{name:"factor1",detail:"The first multiplicand.",example:"A2",require:"m",repeat:"n",type:"rangeNumber"},{name:"factor2",detail:"The second multiplicand.",example:"B2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DIVIDE",t:11,d:"Returns one number divided by another. Equivalent to the `/` operator.",a:"One number divided by another",m:[2,2],p:[{name:"dividend",detail:"The number to be divided.",example:"4",require:"m",repeat:"n",type:"rangeNumber"},{name:"divisor",detail:"The number to divide by.",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"CONCAT",t:11,d:"Returns the concatenation of two values. Equivalent to the `&` operator.",a:"Concatenation of two values",m:[2,2],p:[{name:"value1",detail:"The value to which `value2` will be appended.",example:'"de"',require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"The value to append to `value1`.",example:'"mystify"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"UNARY_PERCENT",t:11,d:"Returns a value interpreted as a percentage; that is, `UNARY_PERCENT(100)` equals `1`.",a:"Value interpreted as a percentage.",m:[1,1],p:[{name:"percentage",detail:"The value to interpret as a percentage.",example:"A2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"CONCATENATE",t:12,d:"Appends strings to one another.",a:"Appends strings to one another.",m:[1,255],p:[{name:"string1",detail:"The initial string.",example:'"Super"',require:"m",repeat:"n",type:"rangeAll"},{name:"string2",detail:"More strings to append in sequence.",example:'"calla"',require:"o",repeat:"y",type:"rangeAll"}]},{n:"CODE",t:12,d:"Returns the numeric Unicode map value of the first character in the string provided.",a:"Numeric unicode map value of character.",m:[1,1],p:[{name:"string",detail:"The string whose first character's Unicode map value will be returned.",example:'"a"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"CHAR",t:12,d:"Convert a number into a character according to the current Unicode table.",a:"Gets character associated with number.",m:[1,1],p:[{name:"table_number",detail:"The number of the character to look up from the current Unicode table in decimal format.",example:"97",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"ARABIC",t:12,d:"Computes the value of a Roman numeral.",a:"Computes the value of a roman numeral.",m:[1,1],p:[{name:"roman_numeral",detail:"The Roman numeral to format, whose value must be between 1 and 3999, inclusive.",example:'"XIV"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"ROMAN",t:12,d:"Formats a number in Roman numerals.",a:"Formats a number in Roman numerals.",m:[1,1],p:[{name:"number",detail:"The number to format, between 1 and 3999, inclusive.",example:"499",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"REGEXEXTRACT",t:12,d:"Extracts matching substrings according to a regular expression.",a:"Extracts matching substrings with regular expression.",m:[2,2],p:[{name:"text",detail:"The input text.",example:'"Needle in a haystack"',require:"m",repeat:"n",type:"rangeAll"},{name:"regular_expression",detail:"The first part of `text` that matches this expression will be returned.",example:'".e{2}dle"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"REGEXMATCH",t:12,d:"Whether a piece of text matches a regular expression.",a:"Whether a piece of text matches regular expression.",m:[2,2],p:[{name:"text",detail:"The text to be tested against the regular expression.",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeAll"},{name:"regular_expression",detail:"The regular expression to test the text against.",example:'"S.r"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"REGEXREPLACE",t:12,d:"Replaces part of a text string with a different text string using regular expressions.",a:"Replaces text with regular expressions.",m:[3,3],p:[{name:"text",detail:"The text, a part of which will be replaced.",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeAll"},{name:"regular_expression",detail:"The regular expression.  All matching instances in `text` will be replaced.",example:'"S.*d"',require:"m",repeat:"n",type:"rangeAll"},{name:"replacement",detail:"The text which will be inserted into the original text.",example:'"Bed"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"T",t:12,d:"Returns string arguments as text, or the empty string if the value is not text.",a:"String arguments as text.",m:[1,1],p:[{name:"value",detail:"The argument to be converted to text.",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"FIXED",t:12,d:"Formats a number with a fixed number of decimal places.",a:"Formats number with fixed number of decimal places.",m:[1,3],p:[{name:"number",detail:"The number to format.",example:"3.141592653",require:"m",repeat:"n",type:"rangeNumber"},{name:"number_of_places",detail:"The number of decimal places to display in the result.",example:"2",require:"o",repeat:"n",type:"rangeNumber"},{name:"suppress_separator",detail:"Whether or not to suppress the thousands separator used in some locales (e.g. `1,000` becomes `1000`). Separators will be present if this value is 0 or omitted, and absent otherwise.",example:"FALSE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"FIND",t:12,d:"Returns the position at which a string is first found within text where the capitalization of letters matters. Returns `#VALUE!` if the string is not found.",a:"First position of string found in text, case-sensitive.",m:[2,3],p:[{name:"search_for",detail:"The string to look for within `text_to_search`.",example:'"n"',require:"m",repeat:"n",type:"rangeAll"},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`.",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search.",example:"14",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"FINDB",t:12,d:"Returns the position at which a string is first found within text counting each double-character as 2.",a:"Position at which a string is first found within text (binary).",m:[2,3],p:[{name:"search_for",detail:"The string to look for within `text_to_search`.",example:'"new"',require:"m",repeat:"n",type:"rangeAll"},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`.",example:'"new year"',require:"m",repeat:"n",type:"rangeAll"},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search.",example:"2",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"JOIN",t:12,d:"Concatenates the elements of one or more one-dimensional arrays using a specified delimiter.",a:"Concatenates elements of arrays with delimiter.",m:[2,255],p:[{name:"delimiter",detail:"The character or string to place between each concatenated value.",example:'" and-a "',require:"m",repeat:"n",type:"rangeAll"},{name:"value_or_array1",detail:"The value or values to be appended using `delimiter`.",example:"{1",require:"m",repeat:"n",type:"rangeAll"},{name:"value_or_array2",detail:"More values to be appended using `delimiter`.",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"LEFT",t:12,d:"Returns a substring from the beginning of a specified string.",a:"Substring from beginning of specified string.",m:[1,2],p:[{name:"string",detail:"The string from which the left portion will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"number_of_characters",detail:"The number of characters to return from the left side of `string`.",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"RIGHT",t:12,d:"Returns a substring from the end of a specified string.",a:"A substring from the end of a specified string.",m:[1,2],p:[{name:"string",detail:"The string from which the right portion will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"number_of_characters",detail:"The number of characters to return from the right side of `string`.",example:"2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MID",t:12,d:"Returns a segment of a string.",a:"A segment of a string.",m:[3,3],p:[{name:"string",detail:"The string to extract a segment from.",example:'"get this"',require:"m",repeat:"n",type:"rangeAll"},{name:"starting_at",detail:"The index from the left of `string` from which to begin extracting. The first character in `string` has the index 1.",example:"5",require:"m",repeat:"n",type:"rangeNumber"},{name:"extract_length",detail:"The length of the segment to extract.",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"LEN",t:12,d:"Returns the length of a string.",a:"Length of a string.",m:[1,1],p:[{name:"text",detail:"The string whose length will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"LENB",t:12,d:"Returns the length of a string in bytes.",a:"Length of a string in bytes.",m:[1,1],p:[{name:"text",detail:"The string whose length will be returned.",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"LOWER",t:12,d:"Converts a specified string to lowercase.",a:"Converts a specified string to lowercase.",m:[1,1],p:[{name:"text",detail:"The string to convert to lowercase.",example:'"LOREM IPSUM"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"UPPER",t:12,d:"Converts a specified string to uppercase.",a:"Converts a specified string to uppercase.",m:[1,1],p:[{name:"text",detail:"The string to convert to uppercase.",example:'"lorem ipsum"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"EXACT",t:12,d:"Tests whether two strings are identical.",a:"Tests whether two strings are identical.",m:[2,2],p:[{name:"string1",detail:"The first string to compare",example:"A1",require:"m",repeat:"n",type:"rangeAll"},{name:"string2",detail:"The second string to compare",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"REPLACE",t:12,d:"Replaces part of a text string with a different text string.",a:"Replaces part of a text string with different text.",m:[4,4],p:[{name:"text",detail:"The text, a part of which will be replaced.",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeAll"},{name:"position",detail:"The position where the replacement will begin (starting from 1).",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"length",detail:"The number of characters in the text to be replaced.",example:"6",require:"m",repeat:"n",type:"rangeNumber"},{name:"new_text",detail:"The text which will be inserted into the original text.",example:'"Bed"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"REPT",t:12,d:"Returns specified text repeated a number of times.",a:"Specified text repeated a number of times.",m:[2,2],p:[{name:"text_to_repeat",detail:"The character or string to repeat.",example:'"ha"',require:"m",repeat:"n",type:"rangeAll"},{name:"number_of_repetitions",detail:"The number of times `text_to_repeat` should appear in the value returned.",example:"4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SEARCH",t:12,d:"Returns the position at which a string is first found within text and ignores capitalization of letters. Returns `#VALUE!` if the string is not found.",a:"First position of string found in text, ignoring case.",m:[2,3],p:[{name:"search_for",detail:"The string to look for within `text_to_search`.",example:'"n"',require:"m",repeat:"n",type:"rangeAll"},{name:"text_to_search",detail:"The text to search for the first occurrence of `search_for`.",example:"A2",require:"m",repeat:"n",type:"rangeAll"},{name:"starting_at",detail:"The character within `text_to_search` at which to start the search.",example:"14",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SUBSTITUTE",t:12,d:"Replaces existing text with new text in a string.",a:"Replaces existing text with new text in a string.",m:[3,4],p:[{name:"text_to_search",detail:"The text within which to search and replace.",example:'"search for it"',require:"m",repeat:"n",type:"rangeAll"},{name:"search_for",detail:"The string to search for within `text_to_search`.",example:'"search for"',require:"m",repeat:"n",type:"rangeAll"},{name:"replace_with",detail:"The string that will replace `search_for`.",example:'"Google"',require:"m",repeat:"n",type:"rangeAll"},{name:"occurrence_number",detail:"The instance of `search_for` within `text_to_search` to replace with `replace_with`. By default, all occurrences of `search_for` are replaced; however, if `occurrence_number` is specified, only the indicated instance of `search_for` is replaced.",example:"3",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"CLEAN",t:12,d:"Returns the text with the non-printable ASCII characters removed.",a:"Removes non-printable characters from a piece of text.",m:[1,1],p:[{name:"text",detail:"The text whose non-printable characters are to be removed.",example:'"AF"&CHAR(31)',require:"m",repeat:"n",type:"rangeAll"}]},{n:"TEXT",t:12,d:"Converts a number into text according to a specified format.",a:"Formats a number into text.",m:[2,2],p:[{name:"number",detail:"The number, date, or time to format.",example:"1.23",require:"m",repeat:"n",type:"rangeNumber"},{name:"format",detail:"The pattern by which to format the number, enclosed in quotation marks.",example:'"$0.00"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"TRIM",t:12,d:"Removes leading, trailing, and repeated spaces in text.",a:"Removes space characters.",m:[1,1],p:[{name:"text",detail:"The text or reference to a cell containing text to be trimmed.",example:'" lorem ipsum"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"VALUE",t:12,d:"Converts a string in any of the date, time or number formats that Google Sheets understands into a number.",a:"Converts a date/time/number string into a number.",m:[1,1],p:[{name:"text",detail:"The string containing the value to be converted.",example:'"123"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"PROPER",t:12,d:"Capitalizes each word in a specified string.",a:"Capitalizes each word in a specified string.",m:[1,1],p:[{name:"text_to_capitalize",detail:"The text which will be returned with the first letter of each word in uppercase and all other letters in lowercase.",example:'"united states"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"CONVERT",t:13,d:"Converts a numeric value to a different unit of measure.",a:"Unit conversion for numbers.",m:[3,3],p:[{name:"value",detail:"The numeric value in `start_unit` to convert to `end_unit`.",example:"5.1",require:"m",repeat:"n",type:"rangeNumber"},{name:"start_unit",detail:"The starting unit, the unit currently assigned to `value`.",example:'"g"',require:"m",repeat:"n",type:"rangeAll"},{name:"end_unit",detail:"The unit of measure into which to convert the argument, `value`.",example:'"kg"',require:"m",repeat:"n",type:"rangeAll"}]},{n:"SUMX2MY2",t:14,d:"Calculates the sum of the differences of the squares of values in two arrays.",a:"Sum of the differences of squares.",m:[2,2],p:[{name:"array_x",detail:"The array or range of values whose squares will be reduced by the squares of corresponding entries in `array_y` and added together.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"array_y",detail:"The array or range of values whose squares will be subtracted from the squares of corresponding entries in `array_x` and added together.",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SUMX2PY2",t:14,d:"Calculates the sum of the sums of the squares of values in two arrays.",a:"Sum of the sums of squares.",m:[2,2],p:[{name:"array_x",detail:"The array or range of values whose squares will be added to the squares of corresponding entries in `array_y` and added together.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"array_y",detail:"The array or range of values whose squares will be added to the squares of corresponding entries in `array_x` and added together.",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SUMXMY2",t:14,d:"Calculates the sum of the squares of differences of values in two arrays.",a:"Sum of the squares of differences.",m:[2,2],p:[{name:"array_x",detail:"The array or range of values that will be reduced by corresponding entries in `array_y`, squared, and added together.",example:"A2:A100",require:"m",repeat:"n",type:"rangeNumber"},{name:"array_y",detail:"The array or range of values that will be subtracted from corresponding entries in `array_x`, the result squared, and all such results added together.",example:"B2:B100",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TRANSPOSE",t:14,d:"Transposes the rows and columns of an array or range of cells.",a:"Transposes the rows and columns of an array.",m:[1,1],p:[{name:"array_or_range",detail:"The array or range whose rows and columns will be swapped.",example:"{1,2}",require:"m",repeat:"n",type:"range"}]},{n:"TREND",t:14,d:"Given partial data about a linear trend, fits an ideal linear trend using the least squares method and/or predicts further values.",a:"Fits points to linear trend derived via least-squares.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal linear trend.",example:"B2:B10",require:"m",repeat:"n",type:"rangeNumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangeNumber"},{name:"new_data_x",detail:"The data points to return the `y` values for on the ideal curve fit.",example:"A11:A13",require:"o",repeat:"n",type:"rangeNumber"},{name:"b",detail:"Given a general linear form of `y = m*x+b` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `0` and only calculates the `m` values if `FALSE`, i.e. forces the curve fit to pass through the origin.",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"FREQUENCY",t:14,d:"Calculates the frequency distribution of a one-column array into specified classes.",a:"The frequency distribution of array.",m:[2,2],p:[{name:"data",detail:"The array or range containing the values to be counted.",example:"A2:A40",require:"m",repeat:"n",type:"rangeNumber"},{name:"classes",detail:"The array or range containing the set of classes.",example:"B2:B5",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"GROWTH",t:14,d:"Given partial data about an exponential growth trend, fits an ideal exponential growth trend and/or predicts further values.",a:"Fits points to exponential growth trend.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal exponential growth curve.",example:"B2:B10",require:"m",repeat:"n",type:"rangeNumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangeNumber"},{name:"new_data_x",detail:"The data points to return the `y` values for on the ideal curve fit.",example:"A11:A13",require:"o",repeat:"n",type:"rangeNumber"},{name:"b",detail:"Given a general exponential form of `y = b*m^x` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `1` and only calculates the `m` values if `FALSE`.",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"LINEST",t:14,d:"Given partial data about a linear trend, calculates various parameters about the ideal linear trend using the least-squares method.",a:"Best-fit linear trend via least-squares.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal linear trend.",example:"B2:B10",require:"m",repeat:"n",type:"rangeNumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangeNumber"},{name:"calculate_b",detail:"Given a linear form of `y = m*x+b`, calculates the y-intercept (`b`) if `TRUE`. Otherwise, forces `b` to be `0` and only calculates the `m` values if `FALSE`, i.e. forces the curve fit to pass through the origin.",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"},{name:"verbose",detail:"A flag specifying whether to return additional regression statistics or only the linear coefficients and the y-intercept (default).",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"LOGEST",t:14,d:"Given partial data about an exponential growth curve, calculates various parameters about the best fit ideal exponential growth curve.",a:"Best-fit exponential growth curve.",m:[1,4],p:[{name:"known_data_y",detail:"The array or range containing dependent (y) values that are already known, used to curve fit an ideal exponential growth curve.",example:"B2:B10",require:"m",repeat:"n",type:"rangeNumber"},{name:"known_data_x",detail:"The values of the independent variable(s) corresponding with `known_data_y`.",example:"A2:A10",require:"o",repeat:"n",type:"rangeNumber"},{name:"b",detail:"Given a general exponential form of `y = b*m^x` for a curve fit, calculates `b` if `TRUE` or forces `b` to be `1` and only calculates the `m` values if `FALSE`.",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"},{name:"verbose",detail:"A flag specifying whether to return additional regression statistics or only the calculated coefficient and exponents.",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"MDETERM",t:14,d:"Returns the matrix determinant of a square matrix specified as an array or range.",a:"Matrix determinant of a square matrix.",m:[1,1],p:[{name:"square_matrix",detail:"An array or range with an equal number of rows and columns representing a matrix whose determinant will be calculated.",example:"A1:D4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MINVERSE",t:14,d:"Returns the multiplicative inverse of a square matrix specified as an array or range.",a:"Multiplicative inverse of square matrix.",m:[1,1],p:[{name:"square_matrix",detail:"An array or range with an equal number of rows and columns representing a matrix whose multiplicative inverse will be calculated.",example:"A1:D4",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"MMULT",t:14,d:"Calculates the matrix product of two matrices specified as arrays or ranges.",a:"The matrix product of two matrices.",m:[2,2],p:[{name:"matrix1",detail:"The first matrix in the matrix multiplication operation, represented as an array or range.",example:"A1:B3",require:"m",repeat:"n",type:"rangeNumber"},{name:"matrix2",detail:"The second matrix in the matrix multiplication operation, represented as an array or range.",example:"C1:F2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"SUMPRODUCT",t:14,d:"Calculates the sum of the products of corresponding entries in two equal-sized arrays or ranges.",a:"Sum of products of elements in two arrays.",m:[1,255],p:[{name:"array1",detail:"The first array or range whose entries will be multiplied with corresponding entries in the second such array or range.",example:"A2:C5",require:"m",repeat:"n",type:"rangeNumber"},{name:"array2",detail:"The second array or range whose entries will be multiplied with corresponding entries in the first such array or range.",example:"D2:F5",require:"o",repeat:"y",type:"rangeNumber"}]},{n:"ISFORMULA",t:15,d:"Checks whether a value is a formula.",a:"Whether a value is a formula.",m:[1,1],p:[{name:"cell",detail:"The cell to be verified as containing a formula.",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"CELL",t:15,d:"Returns the requested information about the specified cell.",a:"Gets information about a cell.",m:[2,2],p:[{name:"info_type",detail:"The type of information requested (see article for available types)",example:'"type"',require:"m",repeat:"n",type:"rangeAll"},{name:"reference",detail:"The reference to the cell.",example:"C2",require:"m",repeat:"n",type:"range"}]},{n:"NA",t:15,d:'Returns the "value not available" error, `#N/A`.',a:"The `#N/A` error.",m:[0,0],p:[]},{n:"ERROR_TYPE",t:15,d:"Returns a number corresponding to the error value in a different cell.",a:"Error value of cell (as number).",m:[1,1],p:[{name:"reference",detail:"The cell to find the error number for although you can also provide the error value directly.",example:"A3",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ISBLANK",t:15,d:"Checks whether the referenced cell is empty.",a:"Whether the referenced cell is empty.",m:[1,1],p:[{name:"value",detail:"Reference to the cell that will be checked for emptiness.",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISERR",t:15,d:"Checks whether a value is an error other than `#N/A`.",a:"Whether a value is an error other than `#n/a`.",m:[1,1],p:[{name:"value",detail:"The value to be verified as an error type other than `#N/A`.",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ISERROR",t:15,d:"Checks whether a value is an error.",a:"Whether a value is an error.",m:[1,1],p:[{name:"value",detail:"The value to be verified as an error type.",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ISLOGICAL",t:15,d:"Checks whether a value is `TRUE` or `FALSE`.",a:"Whether a value is `true` or `false`.",m:[1,1],p:[{name:"value",detail:"The value to be verified as a logical `TRUE` or `FALSE`.",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ISNA",t:15,d:"Checks whether a value is the error `#N/A`.",a:"Whether a value is the error `#n/a`.",m:[1,1],p:[{name:"value",detail:"The value to be compared with the error value `#N/A`.",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ISNONTEXT",t:15,d:"Checks whether a value is non-textual.",a:"Whether a value is non-textual.",m:[1,1],p:[{name:"value",detail:"The value to be checked.",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ISNUMBER",t:15,d:"Checks whether a value is a number.",a:"Whether a value is a number.",m:[1,1],p:[{name:"value",detail:"The value to be verified as a number.",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ISREF",t:15,d:"Checks whether a value is a valid cell reference.",a:"Whether a value is a valid cell reference.",m:[1,1],p:[{name:"value",detail:"The value to be verified as a cell reference.",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISTEXT",t:15,d:"Checks whether a value is text.",a:"Whether a value is text.",m:[1,1],p:[{name:"value",detail:"The value to be verified as text.",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"TYPE",t:15,d:"Returns a number associated with the type of data passed into the function.",a:"Get the type of a value.",m:[1,1],p:[{name:"value",detail:"The value whose type is to be determined.",example:"C4",require:"m",repeat:"n",type:"rangeAll"}]},{n:"N",t:15,d:"Returns the argument provided as a number. Text is converted to 0 and errors are returned as-is.",a:"Argument provided as a number.",m:[1,1],p:[{name:"value",detail:"The argument to be converted to a number.",example:"A2",require:"m",repeat:"n",type:"rangeAll"}]},{n:"TO_DATE",t:16,d:"Converts a provided number to a date.",a:"Converts a provided number to a date.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a date.",example:"25405",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TO_PURE_NUMBER",t:16,d:"Converts a provided date/time, percentage, currency or other formatted numeric value to a pure number without formatting.",a:"Converts any numeric value to a pure number.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a pure number.",example:"50%",require:"m",repeat:"n",type:"rangeAll"}]},{n:"TO_TEXT",t:16,d:"Converts a provided numeric value to a text value.",a:"Converts a provided numeric value to a text value.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to text.",example:"24",require:"m",repeat:"n",type:"rangeAll"}]},{n:"TO_DOLLARS",t:16,d:"Converts a provided number to a dollar value.",a:"Converts a provided number to a dollar value.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a dollar value.",example:"A2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"TO_PERCENT",t:16,d:"Converts a provided number to a percentage.",a:"Converts a provided number to a percentage.",m:[1,1],p:[{name:"value",detail:"The argument or reference to a cell to be converted to a percentage.",example:"A2",require:"m",repeat:"n",type:"rangeNumber"}]},{n:"DGET",t:17,d:"Returns a single value from a database table-like array or range using a SQL-like query.",a:"Single value from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMAX",t:17,d:"Returns the maximum value selected from a database table-like array or range using a SQL-like query.",a:"Maximum of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMIN",t:17,d:"Returns the minimum value selected from a database table-like array or range using a SQL-like query.",a:"Minimum of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DAVERAGE",t:17,d:"Returns the average of a set of values selected from a database table-like array or range using a SQL-like query.",a:"Average of a set of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNT",t:17,d:"Counts numeric values selected from a database table-like array or range using a SQL-like query.",a:"Counts values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNTA",t:17,d:"Counts values, including text, selected from a database table-like array or range using a SQL-like query.",a:"Counts values and text from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DPRODUCT",t:17,d:"Returns the product of values selected from a database table-like array or range using a SQL-like query.",a:"Product of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEV",t:17,d:"Returns the standard deviation of a population sample selected from a database table-like array or range using a SQL-like query.",a:"Standard deviation of population sample from table.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEVP",t:17,d:"Returns the standard deviation of an entire population selected from a database table-like array or range using a SQL-like query.",a:"Standard deviation of entire population from table.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSUM",t:17,d:"Returns the sum of values selected from a database table-like array or range using a SQL-like query.",a:"Sum of values from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVAR",t:17,d:"Returns the variance of a population sample selected from a database table-like array or range using a SQL-like query.",a:"Variance of population sample from table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVARP",t:17,d:"Returns the variance of an entire population selected from a database table-like array or range using a SQL-like query.",a:"Variance of a population from a table-like range.",m:[3,3],p:[{name:"database",detail:"The array or range containing the data to consider, structured in such a way that the first row contains the labels for each column's values.",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"Indicates which column in `database` contains the values to be extracted and operated on.",example:"G2",require:"m",repeat:"n",type:"rangeAll"},{name:"criteria",detail:"An array or range containing zero or more criteria to filter the `database` values by before operating.",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"AGE_BY_IDCARD",t:"3",d:"Calculate the age based on the Chinese ID number. Support 15 or 18",a:"Get age based on ID number.",m:[1,2],p:[{name:"ID number",example:"A1",detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeAll"},{name:"Deadline",example:'"2017-10-01"',detail:"The deadline or range of age calculation. The default is the current day.",require:"o",repeat:"n",type:"rangedatetime"}]},{n:"SEX_BY_IDCARD",t:"3",d:"Calculate gender based on Chinese ID number. Support 15 or 18",a:"Get gender based on ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeAll"}]},{n:"BIRTHDAY_BY_IDCARD",t:"3",d:"Calculate the birthday based on the Chinese ID number. Support 15 or 18",a:"Get the birthday based on the ID number.",m:[1,2],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeAll"},{name:"Birthday format",example:"0",detail:"Date type, default:0:[1900/01/01], 1:[1900-01-01], 2:[1900年1月1日]",require:"o",repeat:"n",type:"rangeAll"}]},{n:"PROVINCE_BY_IDCARD",t:"3",d:"Calculate the province of birthplace based on the Chinese ID number. Support 15 or 18",a:"Get the province of birthplace based on the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeAll"}]},{n:"CITY_BY_IDCARD",t:"3",d:"Calculate the city of birthplace based on the Chinese ID number. Support 15 or 18",a:"Get the city of birthplace based on the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeAll"}]},{n:"STAR_BY_IDCARD",t:"3",d:"Calculate the constellation based on the Chinese ID number. Support 15 or 18",a:"Get the constellation based on the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ANIMAL_BY_IDCARD",t:"3",d:"Calculate the zodiac (rat, ox, tiger, rabbit...) based on the Chinese ID number. Support 15 or 18",a:"Get the zodiac according to the ID number.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeAll"}]},{n:"ISIDCARD",t:"3",d:"Verify that the format of the ID card is correct. Support 15 or 18",a:"Verify the correctness of the ID card format.",m:[1,1],p:[{name:"ID number",example:'"31033519900101XXXX"',detail:"15-digit or 18-digit ID number or range.",require:"m",repeat:"n",type:"rangeAll"}]},{n:"DM_TEXT_CUTWORD",t:"4",d:"Text segmentation. Split a series of words into a series of individual words",a:"Chinese text segmentation.",m:[1,2],p:[{name:"Text",example:'"I came to Beijing Tsinghua University"',detail:"Any text that needs word segmentation.",require:"m",repeat:"n",type:"rangeAll"},{name:"Word segmentation mode",example:"0",detail:"The default is 0[precision mode], 1[full mode], 2[search engine mode].",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DM_TEXT_TFIDF",t:"4",d:"Use tf-idf algorithm for keyword extraction. Identify keywords from a series of text",a:"tf-idf keyword recognition.",m:[1,3],p:[{name:"Text",example:'"I came to Beijing Tsinghua University"',detail:"Any text that needs word segmentation.",require:"m",repeat:"n",type:"rangeAll"},{name:"Number of keywords",example:"20",detail:"The number of keywords returned by the algorithm, the default is 20",require:"o",repeat:"n",type:"rangeNumber"},{name:"Corpus",example:"1",detail:"Select a corpus in a specific field, the default is 0[General], 1[Finance], 2[Medical]",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DM_TEXT_TEXTRANK",t:"4",d:"Use TextRank algorithm to extract keywords. Identify keywords from a series of text",a:"TextRank keyword recognition.",m:[1,3],p:[{name:"Text",example:'"I came to Beijing Tsinghua University"',detail:"Any text that needs word segmentation.",require:"m",repeat:"n",type:"rangeAll"},{name:"Number of keywords",example:"20",detail:"The number of keywords returned by the algorithm, the default is 20",require:"o",repeat:"n",type:"rangeNumber"},{name:"Corpus",example:"1",detail:"Select a corpus in a specific field, the default is 0[General], 1[Finance], 2[Medical]",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DATA_CN_STOCK_CLOSE",t:"5",d:"According to the stock code and date, return the corresponding stock closing price of A shares.",a:"Returns the closing price of stock.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeAll"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DATA_CN_STOCK_OPEN",t:"5",d:"According to the stock code and date, return the opening price of stock.",a:"Return the opening price of a shares.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeAll"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DATA_CN_STOCK_MAX",t:"5",d:"According to the stock code and date, return the highest price of stock.",a:"Return the highest price of stock.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeAll"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DATA_CN_STOCK_MIN",t:"5",d:"According to the stock code and date, return the lowest price of stock.",a:"Returns the lowest price of stock.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeAll"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DATA_CN_STOCK_VOLUMN",t:"5",d:"According to the stock code and date, return the corresponding stock trading volume of A shares.",a:"Returns the corresponding stock trading volume of A shares.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeAll"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"DATA_CN_STOCK_AMOUNT",t:"5",d:"According to the stock code and date, return the corresponding stock turnover of A shares.",a:"Returns the corresponding stock turnover of A shares.",m:[1,3],p:[{name:"Stock code",example:'"000001"',detail:"6-digit stock code, required.",require:"m",repeat:"n",type:"rangeAll"},{name:"Date",example:"2015-01-08",detail:"The trading day of the stock, the default is the latest trading day",require:"o",repeat:"n",type:"rangedate"},{name:"Reversion and exclusion",example:"0",detail:"Select the ex right restoration type of the stock, default to 0 [former reversion], 1 [original price], 2 [post reversion]",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"ISDATE",t:"6",d:"Returns whether a value is a date.",a:"Whether a value is a date.",m:[1,1],p:[{name:"value",example:'"1990-01-01"',detail:"The value to be verified as a date.",require:"m",repeat:"n",type:"rangeAll"}]},{n:"LINESPLINES",t:"3",d:"Generate sparklines embedded in the cell to describe the continuous trend of data",a:"Generate sparklines line chart",m:[1,8],p:[{name:"Range",example:"A1:A20",detail:"Range，Values can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeAll"},{name:"Line color",example:"#2ec7c9",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9",require:"o",repeat:"n",type:"rangeAll"},{name:"Line thickness",example:"1",detail:"Line thickness of the line graph, the default is 1px",require:"o",repeat:"n",type:"rangeAll"},{name:"Auxiliary line",example:"avg",detail:"A horizontal line, which can be min, max, avg, median, range or custom value, default 0 none",require:"o",repeat:"n",type:"rangeAll"},{name:"Auxiliary line color",example:"#000",detail:"Color setting of auxiliary line, same as line color configuration, default #000",require:"o",repeat:"n",type:"rangeAll"},{name:"Maximum mark",example:"#fc5c5c",detail:"Identifies the maximum value of the line graph, the same line color configuration, default 0 does not display",require:"o",repeat:"n",type:"rangeAll"},{name:"Minimum mark",example:"#fc5c5c",detail:"Identify the minimum value of the line graph, the same line color configuration, default 0 does not display",require:"o",repeat:"n",type:"rangeAll"},{name:"Mark size",example:"1.5",detail:"The maximum and minimum mark size settings, the default is 1.5",require:"o",repeat:"n",type:"rangeAll"}]},{n:"AREASPLINES",t:"3",d:"Generate sparklines embedded in the cell area chart, generally used to describe the continuous cumulative value trend of the data",a:"Generate sparklines area chart",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"Range，Values can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeAll"},{name:"Line color",example:"#2ec7c9",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9",require:"o",repeat:"n",type:"rangeAll"},{name:"Fill color",example:"#CCF3F4",detail:"Form an area chart, the same line color configuration, default 0 does not display",require:"o",repeat:"n",type:"rangeAll"},{name:"Line thickness",example:"1",detail:"Line thickness of the line graph, the default is 1px",require:"o",repeat:"n",type:"rangeAll"},{name:"Auxiliary line",example:"avg",detail:"A horizontal line, which can be min, max, avg, median, range or custom value, default 0 none",require:"o",repeat:"n",type:"rangeAll"},{name:"Auxiliary line color",example:"#000",detail:"Color setting of auxiliary line, same as line color configuration, default #000",require:"o",repeat:"n",type:"rangeAll"}]},{n:"COLUMNSPLINES",t:"3",d:"Generate sparklines embedded in the vertical histogram of cells, generally used to describe the size of discrete data",a:"Generate sparklines vertical histogram",m:[1,6],p:[{name:"Range",example:"A1:A20",detail:"Range，Values can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeAll"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeAll"},{name:"Bar color",example:"#fc5c5c",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c",require:"o",repeat:"n",type:"rangeAll"},{name:"Negative bar color",example:"#97b552",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552",require:"o",repeat:"n",type:"rangeAll"},{name:"Max",example:"100",detail:"The maximum value of the bar chart, used to standardize the length of the bar chart, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeAll"},{name:"Color palette",example:"#97b552",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty",require:"o",repeat:"y",type:"rangeAll"}]},{n:"STACKCOLUMNSPLINES",t:"3",d:"Generate sparklines, a cumulative vertical histogram embedded in a cell, generally used to describe the numerical size of multiple dimensions of discrete data",a:"Generate sparklines cumulative vertical histogram",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"Range，Values can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeAll"},{name:"Stack by column",example:"1",detail:"If you need to stack by row, set this item to false or 0, the default is 1",require:"o",repeat:"n",type:"rangeAll"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeAll"},{name:"Max",example:"100",detail:"The maximum value of the cumulative bar, used to regulate the length of the bar, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeAll"},{name:"Color palette",example:"#97b552",detail:"The color palette can individually set the bar color of each dimension, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeAll"}]},{n:"BARSPLINES",t:"3",d:"Generate sparklines embedded in the cell, generally used to describe the size of discrete data",a:"Generate sparklines horizontal bar graph",m:[1,6],p:[{name:"Range",example:"A1:A20",detail:"Range，Values can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeAll"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeAll"},{name:"Bar color",example:"#fc5c5c",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c",require:"o",repeat:"n",type:"rangeAll"},{name:"Negative bar color",example:"#97b552",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552",require:"o",repeat:"n",type:"rangeAll"},{name:"Max",example:"100",detail:"The maximum value of the bar chart, used to standardize the length of the bar chart, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeAll"},{name:"Color palette",example:"#97b552",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty",require:"o",repeat:"y",type:"rangeAll"}]},{n:"STACKBARSPLINES",t:"3",d:"Generate sparklines, a cumulative horizontal bar graph embedded in a cell, which is generally used to describe the numerical size of multiple dimensions of discrete data",a:"Generate sparklines cumulative horizontal bar graph",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"Range，Values can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeAll"},{name:"Stack by column",example:"1",detail:"If you need to stack by row, set this item to false or 0, the default is 1",require:"o",repeat:"n",type:"rangeAll"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeAll"},{name:"Max",example:"100",detail:"The maximum value of the cumulative bar, used to regulate the length of the bar, the default is to automatically calculate false, auto, null",require:"o",repeat:"n",type:"rangeAll"},{name:"Color palette",example:"#97b552",detail:"The color palette can individually set the bar color of each dimension, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeAll"}]},{n:"DISCRETESPLINES",t:"3",d:"Generate sparklines embedded in the cell, generally used to describe the trend of discrete data",a:"Generate sparklines discrete graph",m:[1,4],p:[{name:"Range",example:"A1:A20",detail:"Range，Values can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeAll"},{name:"Segmentation threshold",example:"1",detail:"Discrete graph column color distinction, for example: if the value is 0, blue is greater than 0, red is less than 0, and the default is 0",require:"o",repeat:"n",type:"rangeAll"},{name:"Above threshold color",example:"#2ec7c9",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #2ec7c9",require:"o",repeat:"n",type:"rangeAll"},{name:"Below threshold color",example:"#fc5c5c",detail:"The color setting of the bar below the threshold, the same as the color above the threshold, default #fc5c5c",require:"o",repeat:"n",type:"rangeAll"}]},{n:"TRISTATESPLINES",t:"3",d:"Generate sparklines, a three-state graph embedded in the cell, which is generally used to describe the trend of three situations, such as winning, losing, or drawing.",a:"Generate sparklines three-state graph",m:[1,6],p:[{name:"Range",example:"A1:A20",detail:"Range，Values can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeAll"},{name:"Bar interval",example:"1",detail:"The distance between bars, the default is 1",require:"o",repeat:"n",type:"rangeAll"},{name:"Bar color",example:"#fc5c5c",detail:"The line color of the line graph can be range A1, color table index value or specific color value. Set it to 0 or false to not display it. It supports regx, rgb, rgba, etc. Default #fc5c5c",require:"o",repeat:"n",type:"rangeAll"},{name:"Negative bar color",example:"#97b552",detail:"Negative bar color setting, representing the color of negative value, same as the bar color configuration, default #97b552",require:"o",repeat:"n",type:"rangeAll"},{name:"Zero value bar color",example:"#999",detail:"Zero value bar color setting, representing 0 value color, the same color configuration of the bar, default #999",require:"o",repeat:"n",type:"rangeAll"},{name:"Color palette",example:"#97b552",detail:"The color palette can set the color of each bar individually, multiple settings can be set, and two formats are supported: 1 color such as #000, which means that the color of the first bar is black; 2 value range: color, such as -2:# 000 indicates that the bar with a value of -2 is black, 0:5:#000 indicates that the bar with a value of 0-5 is black, and the default is empty",require:"o",repeat:"y",type:"rangeAll"}]},{n:"PIESPLINES",t:"3",d:"Generate sparklines pie chart embedded in the cell, generally used to describe the proportion of data",a:"Generate sparklines pie chart",m:[1,5],p:[{name:"Range",example:"A1:A20",detail:"Range，Values can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeAll"},{name:"Rotation angle",example:"0",detail:"The rotation angle of the pie chart, the default is 0",require:"o",repeat:"n",type:"rangeAll"},{name:"border",example:"0",detail:"Pie chart border size, default is none 0",require:"o",repeat:"n",type:"rangeAll"},{name:"Border color",example:"#000",detail:"The border color of the pie chart, the default is #000",require:"o",repeat:"n",type:"rangeAll"},{name:"Color palette",example:"#97b552",detail:"The color of the slice can be set in the palette, which can be set to the range of A1:A10, etc. The default is #2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeAll"}]},{n:"BOXSPLINES",t:"3",d:"Generate sparklines embedded in the cell box plot, generally used to describe the statistical distribution of the data set",a:"Generate sparklines box plot",m:[1,4],p:[{name:"Range",example:"A1:A20",detail:"Range，Values can be calculated effectively, such as A1:A20, {1,2,3,4,5}, etc.",require:"m",repeat:"n",type:"rangeAll"},{name:"Outlier ratio",example:"1.5",detail:"The threshold range of outliers, if it is 0 or false, it will not be displayed, the default is 1.5 times",require:"o",repeat:"n",type:"rangeAll"},{name:"Target value",example:"10",detail:"The target value setting on the box plot, the default is false and does not display",require:"o",repeat:"n",type:"rangeAll"},{name:"Point size",example:"1.5",detail:"The radius of the target point and outlier is set, the default is 1.5",require:"o",repeat:"n",type:"rangeAll"}]},{n:"BULLETSPLINES",t:"3",d:"Generate sparklines embedded in the cell, generally used to describe the task achievement rate",a:"Generating sparklines bullets",m:[2,3],p:[{name:"Target",example:"10",detail:"The numerical value can be calculated effectively for the achieved target value, such as A1, 100, etc.",require:"m",repeat:"n",type:"rangeAll"},{name:"achieved",example:"8",detail:"Only when the value is completed can the value be calculated effectively, such as A1, 100, etc.",require:"m",repeat:"n",type:"rangeAll"},{name:"Contrast",example:"12",detail:"Comparative values, such as excess, minimum, and bottom line for awards, can be effectively calculated, such as A1, 100, etc. You can set up to 9 comparison values",require:"o",repeat:"y",type:"rangeAll"}]},{n:"COMPOSESPLINES",t:"3",d:"Support multiple types of pictures in the same cell, each parameter represents a sparklines diagram",a:"Combine sparklines graphs into one cell",m:[1,1],p:[{name:"config",example:"PIESPLINES(A1:A20)",detail:"Sparklines chart settings, such as A1:A20, a completed pie chart, line chart settings, etc.",require:"m",repeat:"y",type:"rangeAll"}]},{n:"SORT",t:"14",d:"Sorts the rows of a given array or range by the values in one or more columns.",a:"Sorts rows of range by specified column.",m:[1,4],p:[{name:"range",detail:"The data to be sorted.",example:"A2:A17",require:"m",repeat:"n",type:"rangeNumber"},{name:"sort_column",detail:"The index of the column in `range` or a range outside of `range` containing the values by which to sort.",example:"1",require:"o",repeat:"n",type:"rangeNumber"},{name:"is_ascending",detail:"`TRUE` or `FALSE` indicating whether to sort `sort_column` in ascending order. `FALSE` sorts in descending order.",example:"-1",require:"o",repeat:"n",type:"rangeNumber"},{name:"sort_column2",detail:"Additional columns.",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"FILTER",t:"14",d:"Returns a filtered version of the source range, returning only rows or columns which meet the specified conditions.",a:"Filters a range based off provided conditions.",m:[2,3],p:[{name:"range",detail:"The data to be filtered.",example:"A5:D20",require:"m",repeat:"n",type:"range"},{name:"condition1",detail:"A column or row containing true or false values corresponding to the first column or row of `range`, or an array formula evaluating to true or false.",example:"1",require:"m",repeat:"n",type:"range"},{name:"condition2",detail:"Additional rows or columns containing boolean values `TRUE` or `FALSE` indicating whether the corresponding row or column in `range` should pass through `FILTER`. Can also contain array formula expressions which evaluate to such rows or columns. All conditions must be of the same type (row or column). Mixing row conditions and column conditions is not permitted.",example:'""',require:"o",repeat:"n",type:"rangeAll"}]},{n:"UNIQUE",t:"14",d:"Returns unique rows in the provided source range, discarding duplicates. Rows are returned in the order in which they first appear in the source range.",a:"Unique rows in the provided source range.",m:[1,3],p:[{name:"range",detail:"The data to filter by unique entries.",example:"A2:B26",require:"m",repeat:"n",type:"rangeNumber"},{name:"by_col",detail:"[Option] - Logical value, indicating how to compare; by row = FALSE() or omitted; by column = TRUE().",example:"TRUE()",require:"o",repeat:"n",type:"rangeAll"},{name:"occurs_once",detail:"[Option] - Logical value, only one occurrence in the unique value is returned = TRUE(); including all unique values = FALSE() or omitted.",example:"FALSE()",require:"o",repeat:"n",type:"rangeAll"}]},{n:"RANDARRAY",t:"14",d:"Returns a grid of random numbers between 0 inclusive and 1 exclusive. The grid size will match the provided rows and columns arguments. If neither rows nor columns are provided, then the grid will be size 1 x 1.",a:"Returns a grid of random numbers.",m:[0,2],p:[{name:"rows",detail:"The number of rows to populate with a random number.",example:"1",require:"o",repeat:"n",type:"rangeNumber"},{name:"columns",detail:"The number of columns to populate with a random number.",example:"1",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"SEQUENCE",t:"14",d:"Returns a grid of sequential numbers starting at a specified start value and  increasing by a specified step size. By default, the sequence starts at and  increases by 1.",a:"Returns a grid of sequential numbers.",m:[1,4],p:[{name:"rows",detail:"The number of rows in the function's resulting grid.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"columns",detail:"The number of columns in the function's resulting grid. If omitted, the result grid will have 1 column.",example:"1",require:"o",repeat:"n",type:"rangeNumber"},{name:"start",detail:"The number, at which to start the sequence. If omitted, the sequence will start at 1.",example:"1",require:"o",repeat:"n",type:"rangeNumber"},{name:"step",detail:"The amount each value in the sequence will differ by. If omitted, each value will differ by 1.",example:"1",require:"o",repeat:"n",type:"rangeNumber"}]},{n:"EVALUATE",t:"3",d:"Evaluate a formula or expression expressed in words and return the result",a:"Evaluate according to literal formula or expression.",m:[1,1],p:[{name:"expression",example:'"A1+5*2^2"',detail:"Formula or expression",require:"m",repeat:"n",type:"rangeAll"}]},{n:"REMOTE",t:"5",d:"Calls a function on a remote server",a:"Calls a function on a remote back end server/API.",m:[1,1],p:[{name:"remote_expression",example:"SUM(A1:A10000000)",detail:"Formula",require:"m",repeat:"n",type:"string"}]}]};var w0="univer-rich-text-editor-container",T0="univer-rich-text-editor",C0="univer-formula-text-color",E0="univer-formula-text-string";const A0=["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0","#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"];class S0{constructor(e){this.functionHTMLIndex=0,this.functionRangeIndex=[],this.operator="===|!==|<>|<=|>=|=|+|-|>|<|/|*|%|&|^",this.operatorjson=this.covertOperatorjson(),this.rangestart=!1,this.rangedrag_column_start=!1,this.rangedrag_row_start=!1,this.functionlistPosition={},this.editor=e}covertOperatorjson(){let e=this.operator.split("|"),t={};for(let n=0;n<e.length;n++)t[e[n].toString()]=1;return t}getFormula(){return this.formula||[]}getInputValue(){return this.editor.innerHTML}setInputValue(e){this.editor.innerHTML=this.xssDeal(e)}getHelpFormula(){return[this.funcName,this.paramindex]}getFunctionlistPosition(){return this.functionlistPosition}functionInputHandler(e,t){let n=this,r=e,a=r.innerHTML,i=r.textContent||"",o=this.xssDeal;setTimeout((()=>{var e,s;let l=r.textContent||"";if(l=o(l),n.funcName=null,l.length>0&&"="===l.substr(0,1)&&(229!==t||1===l.length)){l=n.functionHTMLGenerate(l),a=n.functionHTMLGenerate(i);let t=window.getSelection();if(t)if((null==t?void 0:t.anchorNode)instanceof HTMLElement&&(null==(e=t.anchorNode)?void 0:e.matches("div"))){let e=wZ("span",r).length;n.functionRangeIndex=[e-1,wZ("span",r)[e-1].textContent.length]}else n.functionRangeIndex=[(c=null==(s=t.anchorNode)?void 0:s.parentNode,[...c.parentNode.children].indexOf(c)),t.anchorOffset];else{let e=document.selection.createRange();n.functionRangeIndex=e}r.innerHTML=l,n.functionRange(r,l,a),n.canceFunctionrangeSelected(),n.rangestart=!1,n.rangedrag_column_start=!1,n.rangedrag_row_start=!1;const o=n.getrangeseleciton();n.helpFunctionExe(r,o)}else i.substr(0,1);var c}),1)}xssDeal(e){return"string"!=typeof e?e:e.replace(/<script>/g,"&lt;script&gt;").replace(/<\/script>/,"&lt;/script&gt;")}findrangeindex(e,t){let n=/<span.*?>/g,r=e.replace(n,""),a=t.replace(n,""),i=r.split("</span>"),o=a.split("</span>");i.pop(),o.pop();let s=this.functionRangeIndex;o.length>i.length?i.length:o.length;let l=o.length,c=i.length;if(l===c){let e=s[0],t=o[e],n=i[e];if(null==t)return o.length<=e?s=[o.length-1,o.length-1]:i.length<=e&&(s=[i.length-1,i.length-1]),s;if(t.length===n.length)return null!==o[e+1]&&null!==i[e+1]&&o[e+1].length<i[e+1].length&&(s[0]+=1,s[1]=1),s;if(t.length>n.length)return null!==t&&null!==i[e+1]&&'"'===i[e+1].substr(0,1)&&(t.indexOf("{")>-1||t.indexOf("}")>-1)&&(s[0]+=1,s[1]=1),s;if(t.length<n.length)return s[1]>n.length&&(s[1]=n.length),s}else{if(l>c){let e=s[0],t=o[e],n=i[e];if(null==n)if(i[e-1].indexOf("{")>-1){s[0]-=1;let t=i[e-1].search("{");s[1]+=t}else s[0]=0,s[1]=0;else{if(t.length===n.length)return null===i[e+1]||'"'!==i[e+1].substr(0,1)&&"{"!==i[e+1].substr(0,1)&&"}"!==i[e+1].substr(0,1)?null!==t&&t.length>2&&'"'===t.substr(0,1)&&'"'===t.substr(t.length-1,1)||(null!==i[e]&&'")'===i[e]||null!==i[e]&&'"}'===i[e]||null!==i[e]&&"{)"===i[e]?s[1]=1:s[1]=n.length):(s[0]+=1,s[1]=1),s;if(t.length>n.length)return null===i[e+1]||'"'!==i[e+1].substr(0,1)&&"{"!==i[e+1].substr(0,1)&&"}"!==i[e+1].substr(0,1)||(s[0]+=1,s[1]=1),s;if(t.length<n.length)return s}return s}if(l<c){let e=s[0],t=o[e],n=i[e];if(null==t)s[0]=i.length-1,s[1]=null!==n?n.length:1;else{if(t.length===n.length)return null===o[e+1]||'"'!==o[e+1].substr(0,1)&&"{"!==o[e+1].substr(0,1)&&"}"!==o[e+1].substr(0,1)?null===i[e+1]||'"'!==i[e+1].substr(0,1)||"{"!==i[e+1].substr(0,1)&&"}"!==i[e+1].substr(0,1)?null!==n&&'"'===n.substr(0,1)&&'"'===n.substr(n.length-1,1)&&'"'===t.substr(0,1)&&")"===t.substr(t.length-1,1)||null!==n&&"{"===n.substr(0,1)&&"}"===n.substr(n.length-1,1)&&"{"===t.substr(0,1)&&")"===t.substr(t.length-1,1)?s[1]=n.length:(s[0]=s[0]+c-l,i.length>o.length?s[1]=i[e+1].length:s[1]=1):(s[0]+=1,s[1]=1):s[1]=n.length,s;if(t.length>n.length)return null!==t&&'"'===t.substr(0,1)?s[1]=n.length:null!==i[e+1]&&/{.*?}/.test(i[e+1])?(s[0]+=1,s[1]=i[e+1].length):null!==t&&'"'===i[e+1].substr(0,1)&&(t.indexOf("{")>-1||t.indexOf("}")>-1)?(s[0]+=1,s[1]=1):(s[0]=s[0]+c-l-1,s[1]=i[e-1].length),s;if(t.length<n.length)return s}return s}}return null}setCaretPosition(e,t,n){try{let r=e,a=document.createRange(),i=window.getSelection();a.setStart(r.childNodes[t],n),a.collapse(!0),null==i||i.removeAllRanges(),null==i||i.addRange(a),r.focus()}catch(e){}}functionRange(e,t,n){let r=this,a=window.getSelection(),i=r.findrangeindex(t,n);if(null==i&&a)a.selectAllChildren(e[0]),a.collapseToEnd();else if(null!==i){let t=wZ("span",e);r.setCaretPosition(Array.isArray(t)?t[i[0]]:t,0,i[1])}}functionHTMLGenerate(e){return 0===e.length||"="!==e.substr(0,1)?e:(this.functionHTMLIndex=0,`<span dir="auto" class="${C0}">=</span>${this.functionHTML(e)}`)}functionHTML(e){let t=this;if(null==t.operatorjson){let e=t.operator.split("|"),n={};for(let t=0;t<e.length;t++)n[e[t].toString()]=1;t.operatorjson=n}"="===e.substr(0,1)&&(e=e.substr(1));let n=e.split(""),r=0,a="",i="",o={bracket:0,comma:0,squote:0,dquote:0,braces:0};for(;r<n.length;){let e=n[r];if("("===e&&0===o.squote&&0===o.dquote&&0===o.braces)o.bracket+=1,a.length>0?i+=`<span dir="auto" class="universheet-formula-text-func">${a}</span><span dir="auto" class="universheet-formula-text-lpar">(</span>`:i+='<span dir="auto" class="universheet-formula-text-lpar">(</span>',a="";else if(")"===e&&0===o.squote&&0===o.dquote&&0===o.braces)o.bracket-=1,i+=`${t.functionHTML(a)}<span dir="auto" class="universheet-formula-text-rpar">)</span>`,a="";else if("{"===e&&0===o.squote&&0===o.dquote)a+="{",o.braces+=1;else if("}"===e&&0===o.squote&&0===o.dquote)a+="}",o.braces-=1;else if('"'===e&&0===o.squote)o.dquote>0?(a.length>0?i+=`${a}"</span>`:i+='"</span>',o.dquote-=1,a=""):(o.dquote+=1,a.length>0?i+=`${t.functionHTML(a)}<span dir="auto" class="${E0}">"`:i+=`<span dir="auto" class="${E0}">"`,a="");else if("'"===e&&0===o.dquote)a+="'",o.squote=0===o.squote?1:0;else if(","===e&&0===o.squote&&0===o.dquote&&0===o.braces)i+=`${t.functionHTML(a)}<span dir="auto" class="universheet-formula-text-comma">,</span>`,a="";else if("&"===e&&0===o.squote&&0===o.dquote&&0===o.braces)a.length>0?(i+=`${t.functionHTML(a)}<span dir="auto" class="universheet-formula-text-calc">&</span>`,a=""):i+='<span dir="auto" class="universheet-formula-text-calc">&</span>';else if(e in t.operatorjson&&0===o.squote&&0===o.dquote&&0===o.braces){let o="";r+1<n.length&&(o=n[r+1]);let s=r-1,l=null;if(s>=0)do{l=n[s--]}while(s>=0&&" "===l);e+o in t.operatorjson?(a.length>0?(i+=`${t.functionHTML(a)}<span dir="auto" class="universheet-formula-text-calc">${e}${o}</span>`,a=""):i+=`<span dir="auto" class="universheet-formula-text-calc">${e}${o}</span>`,r++):/[^0-9]/.test(o)||"-"!==e||"("!==l&&null!=l&&","!==l&&" "!==l&&!(l in t.operatorjson)?a.length>0?(i+=`${t.functionHTML(a)}<span dir="auto" class="universheet-formula-text-calc">${e}</span>`,a=""):i+=`<span dir="auto" class="universheet-formula-text-calc">${e}</span>`:a+=e}else a+=e;if(r===n.length-1)if(t.iscelldata(a.trim()))i+=`<span class="universheet-formula-functionrange-cell" rangeindex="${t.functionHTMLIndex}" dir="auto" style="color:${A0[t.functionHTMLIndex]};">${a}</span>`,t.functionHTMLIndex++;else if(o.dquote>0)i+=`${a}</span>`;else if(-1===a.indexOf("</span>")&&a.length>0){let e=/{.*?}/;if(e.test(a.trim())){let t=e.exec(a)[0],n=a.search(e),r="";n>0&&(r+=`<span dir="auto" class="${C0}">${a.substr(0,n)}</span>`),r+=`<span dir="auto" style="color:#959a05" class="universheet-formula-text-array">${t}</span>`,n+t.length<a.length&&(r+=`<span dir="auto" class="${C0}">${a.substr(n+t.length,a.length)}</span>`),i+=r}else i+=`<span dir="auto" class="${C0}">${a}</span>`}r++}return i}canceFunctionrangeSelected(){}iscelldata(e){let t,n=e.split("!");t=n.length>1?n[1]:n[0];let r=/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g,a=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+))))$/g;if(-1===t.indexOf(":")){let e=parseInt(t.replace(/[^0-9]/g,""))-1,n=_a.ABCatNum(t.replace(/[^A-Za-z]/g,""));return!(Number.isNaN(e)||Number.isNaN(n)||!t.toString().match(r))||!!Number.isNaN(e)&&(Number.isNaN(n),!1)}a=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g,t=t.split(":");let i=[],o=[];return i[0]=parseInt(t[0].replace(/[^0-9]/g,""))-1,i[1]=parseInt(t[1].replace(/[^0-9]/g,""))-1,!(i[0]>i[1])&&(o[0]=_a.ABCatNum(t[0].replace(/[^A-Za-z]/g,"")),o[1]=_a.ABCatNum(t[1].replace(/[^A-Za-z]/g,"")),!(o[0]>o[1])&&!(!t[0].toString().match(a)||!t[1].toString().match(a)))}getrangeseleciton(){var e,t;let n=window.getSelection(),r=n.anchorNode,a=n.anchorOffset,i=null==r?void 0:r.parentElement.querySelectorAll("span");if("SPAN"===(null==(e=null==r?void 0:r.parentNode)?void 0:e.nodeName)&&0!==a){let e=r.textContent.trim();if(0===e.length&&r.parentNode.previousSibling){let t=r.parentNode.previousSibling;return e=t.textContent.trim(),e.substring(e.length-1,1),t}return e.substring(a-1,1),r.parentNode}if(r.parentElement.className===T0){let e=null==(t=r.textContent)?void 0:t.trim();if(0===e.length&&r.parentElement.querySelectorAll("span").length>1){let t=null==r?void 0:r.parentElement.querySelectorAll("span");const n=t[""+(t.length-2)].textContent;return e=n&&n.trim()||"",t[i.length-1]}return r.parentElement.querySelectorAll("span")[i.length-1]}return null}searchFunction(e){this.formula=[];let t=x0.zh,n=this.getrangeseleciton();if(this.searchFunctionCell=n,null==n||null==e)return;let r=e.innerHTML,a=n.textContent.toUpperCase();if(!/^[a-zA-Z]|[a-zA-Z_]+$/.test(a)||"="!==r.substr(0,1))return;let i={f:[],s:[],t:[]},o=0;for(let e=0;e<t.length;e++){let n=t[e],r=n.n;if(r===a?(i.f.unshift(n),o++):r.substr(0,a.length)===a?(i.s.unshift(n),o++):r.indexOf(a)>-1&&(i.t.unshift(n),o++),o>=10)break}let s=i.t.concat(i.s.concat(i.f));this.formula=s}helpFunctionExe(e,t){let n=this;let r=x0.zh;if(0===document.querySelectorAll("#universheet-formula-help-c").length)for(let e=0;e<r.length;e++)n.functionlistPosition[r[e].n]=e;if(!t)return;let a=t,i=e.querySelectorAll("span"),o=[].indexOf.call(t.parentNode.querySelectorAll(t.tagName),t),s=o;if(null==a)return;let l=null,c=null;if(i[`${s}`].className===T0)l=i[`${s}`].textContent;else{let e=null,t=[-1,-1];for(;--s>0;)if(e=i[`${s}`],"universheet-formula-text-func"===e.className||e.textContent.trim().toUpperCase()in n.functionlistPosition){l=e.textContent,c=null;let n=!0;for(let r=s;r<=o;r++)if(c||(c=0),!(r>=t[0]&&r<=t[1])){if(e=i[`${r}`],"universheet-formula-text-rpar"===e.className){t=[s,r],l=null,n=!1;break}"universheet-formula-text-comma"===e.className&&c++}if(n)break}}null!=l&&(this.funcName=l,this.paramindex=c)}searchFunctionEnter(e){let t=e,n=this.searchFunctionCell;n.innerText=t;const r=document.createElement("span");r.dir="auto",r.className="universheet-formula-text-color",r.innerText="(",function(e,t){let n=t.parentNode;n.lastChild===t?n.appendChild(e):n.insertBefore(e,t.nextSibling)}(r,n),this.setCaretPosition(r,0,1)}}class D0{constructor(e){this.inlineStyleAffectAttribute={bl:1,it:1,ff:1,cl:1,un:1,fs:1,fc:1,bg:1},this.inlineStyleAffectCssName={"font-weight":1,"font-style":1,"font-family":1,"text-decoration":1,"border-bottom":1,"font-size":1,color:1,background:1},this.univerToCssName={bl:"font-weight",it:"font-style",ff:"font-family",fs:"font-size",fc:"color",bg:"background",cl:"text-decoration",un:"border-bottom"},this.editor=e}updateFormat(e,t){if(e in this.inlineStyleAffectAttribute){"="!==this.editor.textContent.substr(0,1)&&this.updateInlineStringFormat(e,t)}}updateInlineStringFormat(e,t){var n;let r,a=window.getSelection();if("None"===(null==a?void 0:a.type)||(r=null==a?void 0:a.getRangeAt(0)),!r)return;let i=this.editor,o=r.endContainer,s=r.startContainer,l=r.endOffset,c=r.startOffset;if(i)if(s===o){let r,a=s.parentNode,o=!1,u=a.innerHTML;"<span"!==i.innerHTML.substr(0,5)&&(o=!0);let h="",d="",p="",m=0,_=c,g=l,f=u.length;h=u.substring(m,_),d=u.substring(_,g),p=u.substring(g,f);let y="";if(""!==h){let e=a.style.cssText;if(o){let t=a.closest(`.${w0}`);null!=t&&(e=this.extendCssText(t.style.cssText,e))}y+=`<span style='${e}'>${h}</span>`}if(""!==d){let n=this.getCssText(a.style.cssText,e,t);if(o){let e=a.closest(`.${w0}`);null!=e&&(n=this.extendCssText(e.style.cssText,n))}y+=`<span style='${n}'>${d}</span>`}if(""!==p){let e=a.style.cssText;if(o){let t=a.closest(`.${w0}`);null!=t&&(e=this.extendCssText(t.style.cssText,e))}y+=`<span style='${e}'>${p}</span>`}if("SPAN"===s.parentNode.tagName){r=wZ("span",i).indexOf(a);let e=null==(n=a.parentElement)?void 0:n.innerHTML,t=a.outerHTML.replace("\\","");const o=null==e?void 0:e.replace(t,y);a.parentElement.innerHTML=o}else r=0,a.innerHTML=y;let v=0;v=m===_?r:r+1,function(e){var t,n;if(window.getSelection){let r=document.createRange(),a=e.firstChild;a&&(r.setStart(a,0),r.setEnd(a,a.length),r.startContainer&&CZ(r.startContainer)&&(null==(t=window.getSelection())||t.removeAllRanges(),null==(n=window.getSelection())||n.addRange(r)))}}(i.querySelectorAll("span")[v])}else if("SPAN"===s.parentNode.tagName&&"SPAN"===o.parentNode.tagName){let n,r,a=s.parentNode,u=o.parentNode;n=wZ("span",i).indexOf(a),r=wZ("span",i).indexOf(u);let h=a.innerHTML,d=u.innerHTML,p="",m="",_="",g="",f=0,y=c,v=l,b=d.length;p=h.substring(f,y),m=h.substring(y,h.length),_=d.substring(0,v),g=d.substring(v,b);let x=Array.prototype.slice.call(i.querySelectorAll("span"));x.slice(n,r+1);let w,T,C="";for(let e=0;e<n;e++){let t=x[`${e}`],n=t.innerHTML;C+=`<span style='${t.style.cssText}'>${n}</span>`}if(""!==p&&(C+=`<span style='${a.style.cssText}'>${p}</span>`),""!==m){C+=`<span style='${this.getCssText(a.style.cssText,e,t)}'>${m}</span>`}if(n<r)for(let a=n+1;a<r;a++){let n=x[`${a}`],r=n.innerHTML;C+=`<span style='${this.getCssText(n.style.cssText,e,t)}'>${r}</span>`}if(""!==_){C+=`<span style='${this.getCssText(u.style.cssText,e,t)}'>${_}</span>`}""!==g&&(C+=`<span style='${u.style.cssText}'>${g}</span>`);for(let e=r+1;e<x.length;e++){let t=x[`${e}`],n=t.innerHTML;C+=`<span style='${t.style.cssText}'>${n}</span>`}i.innerHTML=C,f===y?(w=n,T=r):(w=n+1,T=r+1),x=i.querySelectorAll("span"),function(e,t){var n,r;if(window.getSelection){let a=document.createRange(),i=e.firstChild,o=t.firstChild;i&&o&&(a.setStart(i,0),a.setEnd(o,o.length),a.startContainer&&CZ(a.startContainer)&&(null==(n=window.getSelection())||n.removeAllRanges(),null==(r=window.getSelection())||r.addRange(a)))}}(x[`${w}`],x[`${T}`])}}extendCssText(e,t,n=!0){let r=e.split(";"),a=t.split(";"),i="",o={};for(let e=0;e<r.length;e++){let t=r[e],s=!0;t=t.toLowerCase();let l=EZ(t.substr(0,t.indexOf(":")));if("font-size"===l)continue;let c=EZ(t.substr(t.indexOf(":")+1));if(!n||l in this.inlineStyleAffectCssName){for(let e=0;e<a.length;e++){let t=a[e];t=t.toLowerCase();let n=EZ(t.substr(0,t.indexOf(":"))),r=EZ(t.substr(t.indexOf(":")+1));l!==n||(i+=`${n}:${r};`,s=!1)}s&&(i+=`${l}:${c};`),o[l]=1}}for(let e=0;e<a.length;e++){let t=a[e];t=t.toLowerCase();let r=EZ(t.substr(0,t.indexOf(":"))),s=EZ(t.substr(t.indexOf(":")+1));n&&!(r in this.inlineStyleAffectCssName)||(r in o||(i+=`${r}:${s};`))}return i}getCssText(e,t,n){let r={};if(r[t]=n,"un"===t){let t=this.getClassWithcss(e,"color");""===t&&(t="#000000");let n=this.getClassWithcss(e,"font-size"),a=parseInt(n);""===n&&(a=11),r._fontSize=a,r._color=t}let a=this.getFontStyleByCell(r,void 0,void 0,!1),i=EZ(a&&a.substr(0,a.indexOf(":"))),o=EZ(a&&a.substr(a.indexOf(":")+1));return o=o.substr(0,o.length-1),e=this.removeClassWidthCss(e,t),e=this.upsetClassWithCss(e,i,o)}getClassWithcss(e,t){let n=e.split(";");if(null==t||0===t.length)return e;if(e.indexOf(t)>-1)for(let e=0;e<n.length;e++){let r=n[e];r=r.toLowerCase();let a=EZ(r.substr(0,r.indexOf(":"))),i=EZ(r.substr(r.indexOf(":")+1));if(a===t)return i}return""}removeClassWidthCss(e,t){let n=e.split(";"),r="",a=t;if(null==t||0===t.length)return e;if(t in this.univerToCssName&&(t=this.univerToCssName[t]),e.indexOf(t)>-1)for(let e=0;e<n.length;e++){let i=n[e];i=i.toLowerCase();let o=EZ(i.substr(0,i.indexOf(":"))),s=EZ(i.substr(i.indexOf(":")+1));o===t||"cl"===a&&"lucky-strike"===o||"un"===a&&"lucky-underline"===o||o.length>0&&(r+=`${o}:${s};`)}else r=e;return r}upsetClassWithCss(e,t,n){let r=e.split(";"),a="";if(null==t||0===t.length)return e;if(e.indexOf(t)>-1)for(let e=0;e<r.length;e++){let i=r[e];i=i.toLowerCase();let o=EZ(i.substr(0,i.indexOf(":"))),s=EZ(i.substr(i.indexOf(":")+1));o===t?a+=`${o}:${n};`:o.length>0&&(a+=`${o}:${s};`)}else t.length>0&&(a=e+=`${t}:${n};`);return a}getFontStyleByCell(e,t,n,r=!0){if(null==e)return"";let a="";for(let i in e){let o=e[i];if(r&&(o=this.checkstatusByCell(e,i)),"bl"===i&&"0"!==o&&(a+="font-weight: bold;"),"it"===i&&"0"!==o&&(a+="font-style:italic;"),"ff"===i){a+=`font-family: ${o};`}if("fs"===i&&"10"!==o&&(a+=`font-size: ${o}pt;`),("fc"===i&&"#000000"!==o||null!=t||null!=n&&null!=n.textColor)&&(null!=n&&null!=n.textColor?a+=`color: ${n.textColor};`:a+=null!=t?`color: ${t[0]};`:`color: ${o};`),"bg"===i&&"#ffffff"!==o&&"#fff"!==o&&(a+=`background: ${o};`),"cl"===i&&"0"!==o&&(a+="text-decoration: line-through;"),"un"===i&&("1"===o||"3"===o)){let t=e._color;null==t&&(t=e.fc);let n=e._fontSize||11;null==n&&(n=e.fs||11),a+=`border-bottom: ${Math.floor(n/9)}px solid ${t};`}}return a}checkstatusByCell(e,t){let n;return t in{bl:1,it:1,ff:1,cl:1,un:1}?null==n?n="0":(n=n[t],null==n&&(n="0")):"fc"===t?null==n?n="#000000":(n=n[t],null==n&&(n="#000000"),n.indexOf("rgba")>-1&&(n=Ha.rgbColorToHexValue(n))):"bg"===t?null==n?n=null:(n=n[t],null==n?n=null:n.toString().indexOf("rgba")>-1&&(n=Ha.rgbColorToHexValue(n))):"bs"===t.substr(0,2)?null==n?n="none":(n=n[t],null==n&&(n="none")):"bc"===t.substr(0,2)?null==n?n="#000000":(n=n[t],null==n&&(n="#000000")):"ht"===t?(null==n?n="1":(n=n[t],null==n&&(n="1")),-1===["0","1","2"].indexOf(n.toString())&&(n="1")):"vt"===t?(null==n?n="0":(n=n[t],null==n&&(n="0")),-1===["0","1","2"].indexOf(n.toString())&&(n="0")):"ct"===t?null==n?n=null:(n=n[t],null==n&&(n=null)):"fs"===t?null==n?n="10":(n=n[t],null==n&&(n="10")):"tb"===t||"tr"===t?null==n?n="0":(n=n[t],null==n&&(n="0")):"rt"===t&&(null==n?n=null:(n=n[t],null==n&&(n=null))),n}}var R0={searchFunction:"univer-search-function",formulaDetail:"univer-formula-detail",searchFunctionActive:"univer-search-function-active",helpFunction:"univer-help-function",helpFunctionTitle:"univer-help-function-title",helpFunctionContent:"univer-help-function-content",helpFunctionContentParams:"univer-help-function-content-params",helpFunctionContentTitle:"univer-help-function-content-title",helpFunctionContentDetail:"univer-help-function-content-detail",helpFunctionActive:"univer-help-function-active"};class N0 extends bZ{initialize(){this.state={activeIndex:0,lang:"",locale:[],formula:{}}}componentWillMount(){this.setLocale()}componentDidMount(){}componentWillUpdate(e){this.setFun(e)}setFun(e){const t=e.funName,n=this.state.locale.filter((e=>e.n===t));this.setState({formula:n[0],activeIndex:e.paramIndex})}setLocale(){const e=this.context.locale.options.currentLocale,t=x0[`${e}`].filter((e=>e.n===this.props.funName));this.setState({lang:e,locale:x0[`${e}`],formula:t[0]})}render(){return rm("div",{className:R0.helpFunction},rm("div",{class:R0.helpFunctionTitle},rm(O0,{title:this.state.formula.n,value:this.state.formula.p,type:"name",active:this.state.activeIndex})),rm("div",{className:R0.helpFunctionContent},rm("div",null,"示例"),rm(O0,{title:this.state.formula.n,value:this.state.formula.p,type:"example",active:this.state.activeIndex}),rm(M0,{title:"摘要",value:this.state.formula.d}),rm(im,null,this.state.formula.p.map(((e,t)=>rm(M0,{className:this.state.activeIndex===t?R0.helpFunctionActive:"",title:e.name,value:e.detail,active:this.state.activeIndex}))))))}}const M0=e=>rm("div",{className:`${R0.helpFunctionContentParams} ${e.className}`},rm("div",{className:R0.helpFunctionContentTitle},e.title),rm("div",{className:R0.helpFunctionContentDetail},e.value)),O0=e=>rm("div",null,rm("span",null,e.title,"("),e.value.map(((t,n)=>rm("span",{className:e.active===n?R0.helpFunctionActive:""},t[`${e.type}`],","))),rm("span",null,")"));class k0 extends bZ{initialize(){this.state={lang:"",locale:[],formulaValue:"",functionList:[],selectIndex:0}}componentWillMount(){var e;this.setLocale(),this._localeObserver=null==(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))?void 0:e.add((()=>{this.setLocale()}))}componentDidMount(){this.setState({functionList:this.state.locale})}componentWillUpdate(e){}setLocale(){const e=this.context.locale.options.currentLocale;this.setState({lang:e,locale:x0[`${e}`]})}onKeyDown(e){}createLi(){return this.props.value.map(((e,t)=>rm("li",{className:this.props.active===t?R0.searchFunctionActive:""},rm("div",{className:R0.formulaName},e.n),rm("div",{className:R0.formulaDetail},e.a))))}render(){return rm("ul",{className:R0.searchFunction,onKeyDown:this.onKeyDown.bind(this)},this.createLi())}}class I0 extends bZ{constructor(){super(...arguments),this.container={current:null},this.ref={current:null},this.hooks=new Map}initialize(e){this.state={searchActive:!1,formula:[],funIndex:0,helpFormulaActive:!1,formulaName:"",paramIndex:0}}setValue(e){this.cellInputHandler.setInputValue(e)}getValue(){return this.cellInputHandler.getInputValue()}show(){this.container.current.style.display="block"}hide(){this.container.current.style.display="none"}onKeyDown(e){var t;e.ctrlKey,e.altKey,e.shiftKey;let n=e.keyCode;const r=this.hooks.get("onKeyDown");if(r&&r(e),n===Ca.ENTER&&(null==(t=this.ref.current)||t.blur(),e.preventDefault()),!(n>=112&&n<=123||n<=46||144===n||108===n||e.ctrlKey||e.altKey||e.shiftKey&&(37===n||38===n||39===n||40===n||n===Ca.WIN||n===Ca.WIN_R||n===Ca.MENU))||8===n||32===n||46===n||e.ctrlKey&&86===n){const e=this.ref.current;this.cellInputHandler.functionInputHandler(e,n)}if(n===Ca.UP){let e=this.state.funIndex;0!==e&&e--,this.setState({funIndex:e})}else if(n===Ca.DOWN){let e=this.state.funIndex;10!==e&&e++,this.setState({funIndex:e})}}onKeyUp(e){let t=e.keyCode;if(!(t>=112&&t<=123||t<=46||144===t||108===t||e.ctrlKey||e.altKey||e.shiftKey&&(37===t||38===t||39===t||40===t||t===Ca.WIN||t===Ca.WIN_R||t===Ca.MENU))||8===t||32===t||46===t||e.ctrlKey&&86===t){this.cellInputHandler.searchFunction(this.ref.current);const e=this.cellInputHandler.getFormula();let t=this.cellInputHandler.getHelpFormula();e[0]?this.setState({formula:e,searchActive:!0,helpFormulaActive:!1}):t[0]?this.setState({formulaName:t[0].toUpperCase(),paramIndex:t[1],helpFormulaActive:!0,searchActive:!1}):this.setState({formula:e,searchActive:!1,helpFormulaActive:!1})}const n=this.cellInputHandler.getInputValue();n.length>0&&"="===n.substr(0,1)&&(229!==t||1===n.length)&&13===t&&(e.preventDefault(),e.stopPropagation(),this.state.searchActive&&(this.cellInputHandler.searchFunctionEnter(this.state.formula[this.state.funIndex].n),this.setState({formulaName:this.state.formula[this.state.funIndex].n,paramIndex:0,helpFormulaActive:!0,searchActive:!1})))}componentWillMount(){}componentDidMount(){var e;this.cellTextStyle=new D0(this.ref.current),this.cellInputHandler=new S0(this.ref.current),null==(e=this._context.getObserverManager().getObserver("onRichTextDidMountObservable"))||e.notifyObservers(this)}componentWillUnmount(){}render(e,t){const{style:n,className:r,onClick:a,text:i}=e;return rm("div",{className:`${w0} ${r}`,style:n,ref:this.container},rm("div",{ref:this.ref,className:T0,onClick:a,onKeyDown:this.onKeyDown.bind(this),onKeyUp:this.onKeyUp.bind(this),dangerouslySetInnerHTML:{__html:i||""},contentEditable:!0}),this.state.searchActive&&!this.state.helpFormulaActive?rm(k0,{value:this.state.formula,active:this.state.funIndex}):null,!this.state.searchActive&&this.state.helpFormulaActive?rm(N0,{funName:this.state.formulaName,paramIndex:this.state.paramIndex}):null)}}class P0{constructor(e){this._plugin=e,this._initialize()}_initialize(){var e,t,n,r,a,i,o;null==(e=this._plugin.getObserver("onSheetContainerDidMountObservable"))||e.add((e=>{var t;this.initRegisterComponent(),this._sheetContainer=e,this.initRegisterComponent(),null==(t=this._plugin.getObserver("onRichTextDidMountObservable"))||t.add((e=>{this.richTextEle=AZ(e.container),this.richTextEditEle=wZ("div",this.richTextEle),this.richText=e,this.richTextEditEle.focus(),this.richTextEditEle.tabIndex=1,this.hideEditContainer(),this._handleKeyboardAction()}))})),null==(t=this._plugin.context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","core"))||t.add((()=>{})),null==(n=this._plugin.context.getObserverManager().getObserver("onSheetRenderDidMountObservable","core"))||n.add((e=>{const t=this._plugin.getMainComponent();t.onDblclickObserver.add((e=>{this.enterEditMode()})),t.onPointerDownObserver.add((e=>{this.exitEditMode(),e.preventDefault()}))})),null==(r=this._plugin.getObserver("onSpreadsheetKeyDownObservable"))||r.add((e=>{if(!e.ctrlKey&&function(e){return-1===Ho.indexOf(e)}(e.key))this.handleEnter();else switch(e.key){case"Enter":this.isEditMode?(this.exitEditMode(),this._plugin.getSelectionManager().move(wa.BOTTOM)):this.enterEditMode();break;case"Space":this.isEditMode||this.enterEditMode();break;case"ArrowUp":this.isEditMode||this._plugin.getSelectionManager().move(wa.TOP);break;case"ArrowDown":this.isEditMode||this._plugin.getSelectionManager().move(wa.BOTTOM);break;case"ArrowLeft":this.isEditMode||this._plugin.getSelectionManager().move(wa.LEFT);break;case"ArrowRight":this.isEditMode||this._plugin.getSelectionManager().move(wa.RIGHT);break;case"Tab":this.isEditMode||this._plugin.getSelectionManager().move(wa.RIGHT),e.preventDefault()}})),null==(a=this._plugin.getObserver("onSpreadsheetKeyCompositionStartObservable"))||a.add((e=>{this.isEditMode||this.enterEditMode()})),null==(i=this._plugin.getObserver("onSpreadsheetKeyCompositionUpdateObservable"))||i.add((e=>{})),null==(o=this._plugin.getObserver("onSpreadsheetKeyCompositionEndObservable"))||o.add((e=>{})),this._cellEditExtensionManager=new cQ}initRegisterComponent(){this._plugin.registerModal(ti.SPREADSHEET+I0.name,I0)}_handleKeyboardAction(){this.richTextEditEle.addEventListener("keydown",(e=>{var t;let n=e;n.deviceType=Al.Keyboard,n.inputIndex=e.keyCode,n.previousState=0,n.currentState=1,null==(t=this._plugin.getObserver("onSpreadsheetKeyDownObservable"))||t.notifyObservers(n)})),this.richTextEditEle.addEventListener("keyup",(e=>{var t;let n=e;n.deviceType=Al.Keyboard,n.inputIndex=e.keyCode,n.previousState=1,n.currentState=0,null==(t=this._plugin.getObserver("onSpreadsheetKeyUpObservable"))||t.notifyObservers(n)})),this.richTextEditEle.addEventListener("copy",(e=>{var t;let n=e;n.deviceType=Al.Keyboard,n.inputIndex=e.keyCode,n.previousState=1,n.currentState=0,null==(t=this._plugin.getObserver("onSpreadsheetKeyCopyObservable"))||t.notifyObservers(n)})),this.richTextEditEle.addEventListener("paste",(e=>{var t;let n=e;n.deviceType=Al.Keyboard,n.inputIndex=e.keyCode,n.previousState=1,n.currentState=0,null==(t=this._plugin.getObserver("onSpreadsheetKeyPasteObservable"))||t.notifyObservers(n)})),this.richTextEditEle.addEventListener("cut",(e=>{var t;let n=e;n.deviceType=Al.Keyboard,n.inputIndex=e.keyCode,n.previousState=1,n.currentState=0,null==(t=this._plugin.getObserver("onSpreadsheetKeyCutObservable"))||t.notifyObservers(n)})),this.richTextEditEle.addEventListener("compositionstart",(e=>{var t;let n=e;n.deviceType=Al.Keyboard,n.inputIndex=e.keyCode,n.previousState=1,n.currentState=0,null==(t=this._plugin.getObserver("onSpreadsheetKeyCompositionStartObservable"))||t.notifyObservers(n)})),this.richTextEditEle.addEventListener("compositionupdate",(e=>{var t;let n=e;n.deviceType=Al.Keyboard,n.inputIndex=e.keyCode,n.previousState=1,n.currentState=0,null==(t=this._plugin.getObserver("onSpreadsheetKeyCompositionUpdateObservable"))||t.notifyObservers(n)})),this.richTextEditEle.addEventListener("compositionend",(e=>{var t;let n=e;n.deviceType=Al.Keyboard,n.inputIndex=e.keyCode,n.previousState=1,n.currentState=0,null==(t=this._plugin.getObserver("onSpreadsheetKeyCompositionEndObservable"))||t.notifyObservers(n)}))}hideEditContainer(){this.richTextEle.style.top="-10000px"}enterEditMode(){var e,t,n,r;if(this.focusEditEle(),this.isEditMode)return;this.isEditMode=!0;const a=this._plugin.getSelectionManager().getCurrentModel();if(!a)return!1;let i,o,s,l;if(a.isMerged){const e=a.mergeInfo;i=e.startX,o=e.endX,s=e.startY,l=e.endY}else i=a.startX,o=a.endX,s=a.startY,l=a.endY;const c=(null==(t=null==(e=this._plugin.getMainScene())?void 0:e.getViewport(tQ.VIEW_TOP))?void 0:t.actualScrollX)||0,u=(null==(r=null==(n=this._plugin.getMainScene())?void 0:n.getViewport(tQ.VIEW_LEFT))?void 0:r.actualScrollY)||0;this.richTextEle.style.left=i-c+"px",this.richTextEle.style.top=s-u+"px",this.richTextEle.style.minWidth=o-i+"px",this.richTextEle.style.minHeight=l-s+"px";const h=AZ(this._sheetContainer.contentRef).getBoundingClientRect();this.richTextEle.style.maxWidth=`${h.width-i+c}px`,this.richTextEle.style.maxHeight=`${h.height-s+u}px`;let d=this.getSelectionValue();const p=this._cellEditExtensionManager.handle({row:a.row,column:a.column,value:d});p&&(d=p.value),this.richText.setValue(d);const m=this.getSelectionStyle();this.richTextEditEle.style.cssText="",m&&(this.richTextEditEle.style.cssText=KZ(m,!0)),this.setCurrentEditRangeData()}exitEditMode(){if(this.focusEditEle(),!this.isEditMode)return;this.isEditMode=!1;const e=function(e){var t;let n=e.childNodes;if(0===n.length)return e.textContent;if("DIV"===n[0].nodeName&&(n=n[0].childNodes),1===n.length&&"#text"===n[0].nodeName)return n[0].textContent;const r={},a=[];let i=0;for(let e=0;e<n.length;e++){let o,s=n[`${e}`];"#text"===s.nodeName?(o=null!=(t=s.textContent)?t:"",s=s.parentElement):o=s.innerText;let l=$Z(s);jZ(o).forEach((e=>{i=+e.length;let t=SZ(6);r[t]={eId:t,st:0,ed:e.length-1,et:0,tr:{ct:e,ts:l}},a.push({elementId:t,paragraphElementType:0})}))}const o=SZ(6);return{documentId:SZ(6),body:{blockElements:{[o]:{blockId:o,st:0,ed:i,blockType:0,paragraph:{elements:r,elementOrder:a}},b:{blockId:"b",st:0,ed:0,blockType:Ps.SECTION_BREAK,sectionBreak:{columnProperties:[],columnSeparatorType:1,sectionType:0}}},blockElementOrder:[o,"b"]},documentStyle:{}}}(this.richTextEditEle),t=this.richTextEditEle.innerText;let n={};"string"==typeof e?(n.v=e,n.m=e):"object"==typeof e&&(n.p=e,n.v=t,n.m=t);const r=$Z(this.richTextEditEle);_a.isPlainObject(r)&&(n.s=r),this.setCurrentEditRangeValue(n),this.hideEditContainer()}focusEditEle(){setTimeout((()=>{this.richTextEditEle.focus()}),1)}setCurrentEditRangeData(){const e=this._plugin.getSelectionManager().getCurrentModel();e&&(this.currentEditRangeData={startRow:e.row,startColumn:e.column,endRow:e.row,endColumn:e.column})}getCurrentEditRangeData(){return this.currentEditRangeData}setCurrentEditRangeValue(e){const{startRow:t,startColumn:n,endRow:r,endColumn:a}=this.currentEditRangeData;this._plugin.getContext().getWorkBook().getActiveSheet().getRange(t,n,r,a).setRangeData(e)}getSelectionValue(){const e=this._plugin.getSelectionManager().getActiveRange();if(!e)return"";const t=e&&e.getDisplayValue();return"string"==typeof t?t:"object"==typeof t&&null!==t?function(e){var t;let n="";if(null==(t=e.body)?void 0:t.blockElements)for(let t in e.body.blockElements){const r=e.body.blockElements[t];if((r.blockType===Ps.PARAGRAPH||r.blockType===Ps.SECTION_BREAK)&&r.blockType===Ps.PARAGRAPH)for(let e in r.paragraph){const t=r.paragraph[e];for(let e in t){const r=t[e];if(r.et===qs.TEXT_RUN){let e=`display:inline-block;${KZ(r.tr.ts)}`;n+=`<span id='${r.eId}' ${e.length?`style="${e}"`:""} >${r.tr.ct}</span>`}}}}return n}(t):""}getSelectionStyle(){var e;return null==(e=this._plugin.getSelectionManager().getActiveRange())?void 0:e.getTextStyle()}setSelectionValue(e){const t=this._plugin.getSelectionManager().getActiveRange();t&&("string"==typeof e&&t.setValue(e),"object"==typeof e&&t.setRangeData({p:e}))}handleEnter(){this.enterEditMode()}handleBackSpace(){}handleDirection(e){}}class L0{constructor(e){this._master=e}}class B0{_initialize(){const e=this._master.getPlugin().getContext().getWorkBook();this._countBar.setState({onChange:t=>{e.getActiveSheet().setZoomRatio(_a.numberFixed(t/100,2))}})}_totalRangeList(e){let t=e.getRangeList(),n=[],r=this._master.getPlugin().getContext().getWorkBook().getActiveSheet().getCellMatrix(),a=0,i=0,o=0;for(let e=0;e<t.length;e++){let a=t[e];for(let e=a.startRow;e<=a.endRow;e++)for(let t=a.startColumn;t<=a.endColumn;t++){if(n.includes(`${e}${t}`))continue;const a=r.getValue(e,t);if(a){let e=parseFloat(a.v);isNaN(e)||(o+=1,i+=e)}n.push(`${e}${t}`)}}o>0&&(a=i/o),this._countBar.setState({content:`平均数：${_a.numberFixed(a,2)} 计数：${_a.numberFixed(i,2)} 数量：${o}`})}_initializeSelectedObserver(){var e;const t=this._master.getPlugin(),n=t.getSelectionManager();null==(e=t.getObserver("onChangeSelectionObserver"))||e.add((()=>{const e=n.getActiveRangeList();e&&this._totalRangeList(e)}))}constructor(e){this._master=e;const t=e.getPlugin().getContext();t.getObserverManager().requiredObserver("onCountBarDidMountObservable").add((e=>{this._countBar=e,this._initialize()})),t.getContextObserver("onAfterChangeActiveSheetObservable").add((()=>{const e=t.getWorkBook().getActiveSheet().getZoomRatio();this._countBar.setZoom(Math.trunc(100*e))})),t.getContextObserver("onSheetRenderDidMountObservable").add((()=>{this._initializeSelectedObserver()})),t.getContextObserver("onZoomRatioSheetObservable").add((e=>{this._countBar.setZoom(Math.trunc(100*e.zoomRatio))}))}}class F0{constructor(e){this._plugin=e,this._uiController=new B0(this),this._apiController=new L0(this)}getPlugin(){return this._plugin}getUIController(){return this._uiController}getAPIController(){return this._apiController}}class H0{constructor(e){this._plugin=e;const t=e.getContext().getWorkBook().getConfig().name;this._infoBarModel=new gQ(t),this._infoList={back:{locale:"info.return"},update:{locale:"info.detailUpdate"},save:{locale:"info.detailSave"},rename:{locale:"info.tips"},sheet:{label:t,onBlur:e=>{this.setSheetName(e)}}},this._initialize()}_initialize(){const e=this._plugin.context;e.getObserverManager().requiredObserver("onInfoBarDidMountObservable",ti.SPREADSHEET).add((e=>{this._infoBar=e,this.resetInfoList(this._infoList)})),e.getContextObserver("onAfterChangeUILocaleObservable").add((()=>{this.resetInfoList(this._infoList)}))}resetInfoList(e){const t=this._plugin.context.getLocale();for(let n in e)e[n].locale&&(e[n].label=t.get(e[n].locale));this._infoBar.setInfoList(e)}setSheetName(e){const t=e.target.value;this._infoBarModel.setName(t)}}class q0{constructor(e){this.insertRow=(...e)=>{e[1].ref.hideSelect();const t=this._getSelections();if(1===(null==t?void 0:t.length)){const e=this._plugin.getContext().getWorkBook().getActiveSheet();null==e||e.insertRowBefore(t[0].startRow,t[0].endRow-t[0].startRow+1)}},this.deleteRow=(...e)=>{e[1].ref.hideSelect();const t=this._getSelections();if(1===(null==t?void 0:t.length)){const e=this._plugin.getContext().getWorkBook().getActiveSheet();null==e||e.deleteRows(t[0].startRow,t[0].endRow-t[0].startRow+1)}},this.insertColumn=(...e)=>{e[1].ref.hideSelect();const t=this._getSelections();if(1===(null==t?void 0:t.length)){this._plugin.getContext().getWorkBook().getActiveSheet().insertColumnBefore(t[0].startColumn,t[0].endColumn-t[0].startColumn+1)}},this.deleteColumn=(...e)=>{e[1].ref.hideSelect();const t=this._getSelections();if(1===(null==t?void 0:t.length)){this._plugin.getContext().getWorkBook().getActiveSheet().deleteColumns(t[0].startColumn,t[0].endColumn-t[0].startColumn+1)}},this.clear=(...e)=>{e[1].ref.hideSelect();const t=this._getSelections();if(1===(null==t?void 0:t.length)){this._plugin.getContext().getWorkBook().getActiveSheet().getRange(t[0]).clear()}},this.deleteCellLeft=(...e)=>{e[1].ref.hideSelect(),e[1].ref.getParent().hideSelect();const t=this._getSelections();if(1===(null==t?void 0:t.length)){this._plugin.getContext().getWorkBook().getActiveSheet().getRange(t[0]).deleteCells(0)}},this.deleteCellTop=(...e)=>{e[1].ref.hideSelect(),e[1].ref.getParent().hideSelect();const t=this._getSelections();if(1===(null==t?void 0:t.length)){this._plugin.getContext().getWorkBook().getActiveSheet().getRange(t[0]).deleteCells(1)}},this.addItem=e=>{e instanceof Array?this._menuList.push(...e):this._menuList.push(e),this._RightMenu.setMenuList(this.resetMenuList(this._menuList))},this._plugin=e,this.initRegisterComponent(),this._menuList=[{locale:["rightClick.insert","rightClick.row"],onClick:this.insertRow},{locale:["rightClick.insert","rightClick.column"],onClick:this.insertColumn},{hide:!0,customLabel:{name:gJ.name,props:{prefixLocale:["rightClick.to","rightClick.top","rightClick.add"],suffixLocale:"rightClick.row"}}},{hide:!0,customLabel:{name:gJ.name,props:{prefixLocale:["rightClick.to","rightClick.bottom","rightClick.add"],suffixLocale:"rightClick.row"}}},{hide:!0,customLabel:{name:gJ.name,props:{prefixLocale:["rightClick.to","rightClick.left","rightClick.add"],suffixLocale:"rightClick.column"}}},{hide:!0,customLabel:{name:gJ.name,props:{prefixLocale:["rightClick.to","rightClick.right","rightClick.add"],suffixLocale:"rightClick.column"}}},{locale:["rightClick.deleteSelected","rightClick.row"],onClick:this.deleteRow},{locale:["rightClick.deleteSelected","rightClick.column"],onClick:this.deleteColumn},{hide:!0,locale:["rightClick.hideSelected","rightClick.row"]},{hide:!0,locale:["rightClick.showHide","rightClick.row"]},{hide:!0,customLabel:{name:gJ.name,props:{prefixLocale:["rightClick.row","rightClick.height"],suffix:"px"}}},{hide:!0,locale:["rightClick.hideSelected","rightClick.column"]},{hide:!0,locale:["rightClick.showHide","rightClick.column"]},{hide:!0,customLabel:{name:gJ.name,props:{prefixLocale:["rightClick.column","rightClick.width"],suffix:"px"}}},{customLabel:{name:fJ.name,props:{locale:"rightClick.deleteCell"}},border:!0,children:[{locale:["rightClick.moveLeft"],className:dJ,onClick:(...e)=>this.deleteCellLeft(...e)},{locale:["rightClick.moveUp"],className:dJ,onClick:(...e)=>this.deleteCellTop(...e)}]},{locale:["rightClick.clearContent"],onClick:(...e)=>this.clear(...e),border:!0},{customLabel:{name:fJ.name,props:{locale:"rightClick.matrix"}},hide:!0,children:[{customLabel:{name:_J.name,props:{prefixLocale:"rightClick.flip",buttonsLocale:["rightClick.upAndDown","rightClick.leftAndRight"]}}},{customLabel:{name:_J.name,props:{prefixLocale:"rightClick.flip",buttonsLocale:["rightClick.clockwise","rightClick.counterclockwise"]}}},{locale:["rightClick.transpose"]},{customLabel:{name:yJ.name,props:{prefixLocale:"rightClick.matrixCalculation",options:[{locale:"rightClick.plus"},{locale:"rightClick.minus"},{locale:"rightClick.multiply"},{locale:"rightClick.divided"},{locale:"rightClick.power"},{locale:"rightClick.root"},{locale:"rightClick.log"}]}}},{customLabel:{name:_J.name,props:{prefixLocale:"rightClick.delete0",buttonsLocale:["rightClick.byRow","rightClick.byCol"]}}},{customLabel:{name:_J.name,props:{prefixLocale:"rightClick.removeDuplicate",buttonsLocale:["rightClick.byRow","rightClick.byCol"]}}}]},{locale:["rightClick.sortSelection"],hide:!0},{locale:["rightClick.filterSelection"],hide:!0},{locale:["rightClick.chartGeneration"],hide:!0},{locale:["toolbar.insertImage"],hide:!0},{locale:["toolbar.insertLink"],hide:!0},{locale:["toolbar.dataValidation"],hide:!0},{locale:["toolbar.cellFormat"],hide:!0}],this._rightMenuModel=new fQ,this._initialize()}_initialize(){const e=this._plugin.getContext();e.getObserverManager().requiredObserver("onRightMenuDidMountObservable",ti.SPREADSHEET).add((e=>{this._RightMenu=e,this._RightMenu.setMenuList(this.resetMenuList(this._menuList))})),e.getContextObserver("onAfterChangeUILocaleObservable").add((()=>{this._RightMenu.setMenuList(this.resetMenuList(this._menuList))})),e.getContextObserver("onSheetRenderDidMountObservable").add((()=>{const e=this._plugin.getContentRef().current;e&&this._plugin.getMainComponent().onPointerDownObserver.add((t=>{2===t.button&&(e.oncontextmenu=()=>!1,this._RightMenu.handleContextMenu(t))}))}))}initRegisterComponent(){this._plugin.registerComponent(gJ.name,gJ),this._plugin.registerComponent(_J.name,_J),this._plugin.registerComponent(yJ.name,yJ),this._plugin.registerComponent(fJ.name,fJ)}resetLabel(e){const t=this._plugin.context.getLocale();let n="";return e instanceof Array?e.forEach((e=>{e.includes(".")?n+=t.get(e):n+=e})):e.includes(".")?n=t.get(e):n+=e,n}findLocale(e){for(let t in e)if("locale"===t)e.label=this.resetLabel(e[t]);else if(t.endsWith("Locale")){const n=t.indexOf("Locale");e[t.slice(0,n)]=this.resetLabel(e[t])}else"[object Object]"!==Object.prototype.toString.call(e[t])||e[t].$$typeof||this.findLocale(e[t]);return e}resetMenuList(e){for(let t=0;t<e.length;t++){let n=e[t];n=this.findLocale(n),n.children&&(n.children=this.resetMenuList(n.children))}return e}_getSelections(){var e;const t=null==(e=this._plugin)?void 0:e.getSelectionManager().getCurrentControls();return null==t?void 0:t.map((e=>{const t=e.model;return{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn}}))}}class U0{constructor(e){this._plugin=e,this._initialize()}_initialize(){ps.getCommandObservers().add((({actions:e})=>{var t,n;const r=e[0].getWorkSheet();if(r.getConfig().status===ka.TRUE)try{const e=null==(t=this._plugin)?void 0:t.getCanvasView();e&&e.updateToSheet(r),null==(n=this._plugin)||n.getMainComponent().makeDirty(!0)}catch(e){console.info(e)}}))}}class V0 extends bZ{initialize(){var e;const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=t.getComponentRender(),this.state={color:null!=(e=this.props.color)?e:"#000"}}componentDidMount(){var e;null==(e=this._context.getObserverManager().getObserver("onLineColorDidMountObservable"))||e.notifyObservers(this)}setColor(e){this.setState({color:e})}render(){const e=this.Render.renderFunction("RightIcon"),{color:t}=this.state,{label:n}=this.props;return rm("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},rm("span",{style:{display:"inline-block",borderBottom:`3px solid ${t}`}},n),rm(e,null))}}const W0=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],z0=[{locale:"fontFamily.TimesNewRoman",style:{"font-family":"Times New Roman"},value:"Times New Roman",selected:!0},{locale:"fontFamily.Arial",style:{"font-family":"Arial"},value:"Arial"},{locale:"fontFamily.Tahoma",style:{"font-family":"Tahoma"},value:"Tahoma"},{locale:"fontFamily.Verdana",style:{"font-family":"Verdana"},value:"Verdana"},{locale:"fontFamily.MicrosoftAccorblack",style:{"font-family":"微软雅黑"},value:"微软雅黑"},{locale:"fontFamily.SimSun",style:{"font-family":"宋体"},value:"宋体"},{locale:"fontFamily.SimHei",style:{"font-family":"黑体"},value:"黑体"},{locale:"fontFamily.Kaiti",style:{"font-family":"楷体"},value:"楷体"},{locale:"fontFamily.FangSong",style:{"font-family":"仿宋"},value:"仿宋"},{locale:"fontFamily.NSimSun",style:{"font-family":"新宋体"},value:"新宋体"},{locale:"fontFamily.STXinwei",style:{"font-family":"华文新魏"},value:"华文新魏"},{locale:"fontFamily.STXingkai",style:{"font-family":"华文行楷"},value:"华文行楷"},{locale:"fontFamily.STLiti",style:{"font-family":"华文隶书"},value:"华文隶书"},{locale:"fontFamily.HanaleiFill",style:{"font-family":"HanaleiFill"},value:"HanaleiFill"},{locale:"fontFamily.Anton",style:{"font-family":"Anton"},value:"Anton"},{locale:"fontFamily.Pacifico",style:{"font-family":"Pacifico"},value:"Pacifico"}],Y0=[{locale:"borderLine.borderTop",customSuffix:{name:"TopBorderIcon"},value:"top"},{locale:"borderLine.borderBottom",customSuffix:{name:"BottomBorderIcon"},value:"bottom"},{locale:"borderLine.borderLeft",customSuffix:{name:"LeftBorderIcon"},value:"left"},{locale:"borderLine.borderRight",customSuffix:{name:"RightBorderIcon"},value:"right",border:!0},{locale:"borderLine.borderNone",customSuffix:{name:"NoneBorderIcon"},value:"none"},{locale:"borderLine.borderAll",customSuffix:{name:"FullBorderIcon"},value:"all",selected:!0},{locale:"borderLine.borderOutside",customSuffix:{name:"OuterBorderIcon"},value:"outside"},{locale:"borderLine.borderInside",customSuffix:{name:"InnerBorderIcon"},value:"inside"},{locale:"borderLine.borderHorizontal",customSuffix:{name:"StripingBorderIcon"},value:"horizontal"},{locale:"borderLine.borderVertical",customSuffix:{name:"VerticalBorderIcon"},value:"vertical"}],G0=[{locale:"merge.all",value:"all"},{locale:"merge.vertical",value:"vertical"},{locale:"merge.horizontal",value:"horizontal"},{locale:"merge.cancel",value:"cancel"}],X0=[{locale:"align.left",customSuffix:{name:"LeftAlignIcon"},value:1},{locale:"align.center",customSuffix:{name:"CenterAlignIcon"},value:2},{locale:"align.right",customSuffix:{name:"RightAlignIcon"},value:3}],$0=[{locale:"align.top",customSuffix:{name:"TopVerticalIcon"},value:1},{locale:"align.middle",customSuffix:{name:"CenterVerticalIcon"},value:2},{locale:"align.bottom",customSuffix:{name:"BottomVerticalIcon"},value:3}],j0=[{locale:"textWrap.overflow",customSuffix:{name:"OverflowIcon"},value:1},{locale:"textWrap.wrap",customSuffix:{name:"BrIcon"},value:3},{locale:"textWrap.clip",customSuffix:{name:"CutIcon"},value:2}],K0=[{locale:"textRotate.none",customSuffix:{name:"TextRotateIcon"},value:0},{locale:"textRotate.angleUp",customSuffix:{name:"TextRotateAngleUpIcon"},value:-45},{locale:"textRotate.angleDown",customSuffix:{name:"TextRotateAngleDownIcon"},value:45},{locale:"textRotate.vertical",customSuffix:{name:"TextRotateVerticalIcon"},value:"v"},{locale:"textRotate.rotationUp",customSuffix:{name:"TextRotateRotationUpIcon"},value:-90},{locale:"textRotate.rotationDown",customSuffix:{name:"TextRotateRotationDownIcon"},value:90}];class Z0{constructor(e){this._plugin=e;const t=this._plugin.getPluginName();this.initRegisterComponent();const n="auto"===this._plugin.config.layout?_a.deepClone(y0.toolBarConfig):_a.deepMerge(y0.toolBarConfig,this._plugin.config.layout.toolBarConfig);this._borderInfo={color:"#000",width:"1"},this._toolList=[{toolbarType:1,tooltipLocale:"toolbar.undo",customLabel:{name:"ForwardIcon"},show:n.undoRedo,onClick:()=>{this.setUndo()}},{toolbarType:1,tooltipLocale:"toolbar.redo",customLabel:{name:"BackIcon"},show:n.undoRedo,onClick:()=>{this.setRedo()}},{type:0,tooltipLocale:"toolbar.font",className:JJ,show:n.font,border:!0,onClick:e=>{var t;null==(t=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))||t.notifyObservers(e)},children:z0},{type:1,tooltipLocale:"toolbar.fontSize",label:String(Ka.fs),show:n.fontSize,onClick:e=>{var t;null==(t=this._plugin.getObserver("onAfterChangeFontSizeObservable"))||t.notifyObservers(e)},onKeyUp:e=>{var t;null==(t=this._plugin.getObserver("onAfterChangeFontSizeObservable"))||t.notifyObservers(e)},children:W0},{toolbarType:1,tooltipLocale:"toolbar.bold",customLabel:{name:"BoldIcon"},show:n.bold,onClick:e=>{var t;null==(t=this._plugin.getObserver("onAfterChangeFontWeightObservable"))||t.notifyObservers(e)}},{toolbarType:1,tooltipLocale:"toolbar.italic",customLabel:{name:"ItalicIcon"},show:n.italic,onClick:e=>{var t;null==(t=this._plugin.getObserver("onAfterChangeFontItalicObservable"))||t.notifyObservers(e)}},{toolbarType:1,tooltipLocale:"toolbar.strikethrough",customLabel:{name:"DeleteLineIcon"},show:n.strikethrough,onClick:e=>{var t;null==(t=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))||t.notifyObservers(e)}},{toolbarType:1,tooltipLocale:"toolbar.underline",customLabel:{name:"UnderLineIcon"},show:n.underline,onClick:e=>{var t;null==(t=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))||t.notifyObservers(e)}},{type:2,tooltipLocale:"toolbar.textColor.main",customLabel:{name:"TextColorIcon"},show:n.textColor,onClick:e=>{var t;null==(t=this._plugin.getObserver("onAfterChangeFontColorObservable"))||t.notifyObservers(e)}},{type:2,tooltipLocale:"toolbar.fillColor.main",customLabel:{name:"FillColorIcon"},show:n.fillColor,onClick:e=>{var t;null==(t=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))||t.notifyObservers(e)}},{type:3,display:1,show:n.border,tooltipLocale:"toolbar.border.main",onClick:e=>{},children:[...Y0,{customLabel:{name:t+V0.name,props:{locale:"borderLine.borderColor"}},unSelectable:!0,className:e0,children:[{customLabel:{name:t+cx.name,props:{onClick:(e,t)=>this.handleLineColor(e,t)}},className:t0,onClick:this.handleLineColor}]}]},{type:5,tooltipLocale:"toolbar.mergeCell.main",customLabel:{name:"MergeIcon"},show:n.mergeCell,onClick:e=>{this.setMerge(e)},children:G0},{type:3,tooltipLocale:"toolbar.horizontalAlignMode.main",display:1,show:n.horizontalAlignMode,onClick:e=>{this.setHorizontalAlignment(e)},children:X0},{type:3,tooltipLocale:"toolbar.verticalAlignMode.main",display:1,show:n.verticalAlignMode,onClick:e=>{this.setVerticalAlignment(e)},children:$0},{type:3,tooltipLocale:"toolbar.textWrapMode.main",display:1,show:n.textWrapMode,onClick:e=>{this.setWrapStrategy(e)},children:j0},{type:3,tooltipLocale:"toolbar.textRotateMode.main",display:1,show:n.textRotateMode,onClick:e=>{this.setTextRotation(e)},children:K0}],this._toolBarModel=new yQ,this._toolBarModel.config=n,this._toolBarModel.toolList=this._toolList,this.init()}init(){var e,t,n,r,a,i,o,s,l,c,u,h;null==(e=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))||e.add((e=>{this._plugin.getCellEditorControl().isEditMode?this._plugin.getCellEditorControl().richText.cellTextStyle.updateFormat("ff",e):this.setFontFamily(e)})),null==(t=this._plugin.getObserver("onAfterChangeFontSizeObservable"))||t.add((e=>{this._plugin.getCellEditorControl().isEditMode?this._plugin.getCellEditorControl().richText.cellTextStyle.updateFormat("fs",e):this.setFontSize(e)})),null==(n=this._plugin.getObserver("onAfterChangeFontWeightObservable"))||n.add((e=>{this._plugin.getCellEditorControl().isEditMode?this._plugin.getCellEditorControl().richText.cellTextStyle.updateFormat("bl",e?"1":"0"):this.setFontWeight(e)})),null==(r=this._plugin.getObserver("onAfterChangeFontItalicObservable"))||r.add((e=>{this._plugin.getCellEditorControl().isEditMode?this._plugin.getCellEditorControl().richText.cellTextStyle.updateFormat("it",e?"1":"0"):this.setFontStyle(e)})),null==(a=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))||a.add((e=>{this._plugin.getCellEditorControl().isEditMode?this._plugin.getCellEditorControl().richText.cellTextStyle.updateFormat("cl",e?"1":"0"):this.setStrikeThrough(e)})),null==(i=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))||i.add((e=>{this._plugin.getCellEditorControl().isEditMode?this._plugin.getCellEditorControl().richText.cellTextStyle.updateFormat("un",e?"1":"0"):this.setUnderline(e)})),null==(o=this._plugin.getObserver("onAfterChangeFontColorObservable"))||o.add((e=>{this._plugin.getCellEditorControl().isEditMode?this._plugin.getCellEditorControl().richText.cellTextStyle.updateFormat("fc",e):this.setFontColor(e)})),null==(s=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))||s.add((e=>{this._plugin.getCellEditorControl().isEditMode?this._plugin.getCellEditorControl().richText.cellTextStyle.updateFormat("bg",e):this.setBackground(e)})),null==(l=this._plugin.getObserver("onToolBarDidMountObservable"))||l.add((e=>{this._toolBarComponent=e,this.resetToolBarList()})),null==(c=this._plugin.getObserver("onLineColorDidMountObservable"))||c.add((e=>{this._lineColor=e})),null==(u=this._plugin.context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","core"))||u.add((()=>{this.resetToolBarList()})),null==(h=this._plugin.getObserver("onChangeSelectionObserver"))||h.add((e=>{const t=e.model.currentCell;if(t){let e;if(t.isMerged){const n=t.mergeInfo;e={startRow:n.startRow,endRow:n.endRow,startColumn:n.startColumn,endColumn:n.endColumn}}else{const{row:n,column:r}=t;e={startRow:n,endRow:n,startColumn:r,endColumn:r}}this._plugin.getWorkbook().getActiveSheet().getRange(e).getObjectValue({isIncludeStyle:!0})}}))}initRegisterComponent(){const e=this._plugin.context.getPluginManager().getPluginByName("ComponentSheet"),t=this._plugin.getPluginName();this.Render=e.getComponentRender();const n={ForwardIcon:this.Render.renderFunction("ForwardIcon"),BackIcon:this.Render.renderFunction("BackIcon"),BoldIcon:this.Render.renderFunction("BoldIcon"),ItalicIcon:this.Render.renderFunction("ItalicIcon"),DeleteLineIcon:this.Render.renderFunction("DeleteLineIcon"),UnderLineIcon:this.Render.renderFunction("UnderLineIcon"),TextColorIcon:this.Render.renderFunction("TextColorIcon"),FillColorIcon:this.Render.renderFunction("FillColorIcon"),MergeIcon:this.Render.renderFunction("MergeIcon"),TopBorderIcon:this.Render.renderFunction("TopBorderIcon"),BottomBorderIcon:this.Render.renderFunction("BottomBorderIcon"),LeftBorderIcon:this.Render.renderFunction("LeftBorderIcon"),RightBorderIcon:this.Render.renderFunction("RightBorderIcon"),NoneBorderIcon:this.Render.renderFunction("NoneBorderIcon"),FullBorderIcon:this.Render.renderFunction("FullBorderIcon"),OuterBorderIcon:this.Render.renderFunction("OuterBorderIcon"),InnerBorderIcon:this.Render.renderFunction("InnerBorderIcon"),StripingBorderIcon:this.Render.renderFunction("StripingBorderIcon"),VerticalBorderIcon:this.Render.renderFunction("VerticalBorderIcon"),LeftAlignIcon:this.Render.renderFunction("LeftAlignIcon"),CenterAlignIcon:this.Render.renderFunction("CenterAlignIcon"),RightAlignIcon:this.Render.renderFunction("RightAlignIcon"),TopVerticalIcon:this.Render.renderFunction("TopVerticalIcon"),CenterVerticalIcon:this.Render.renderFunction("CenterVerticalIcon"),BottomVerticalIcon:this.Render.renderFunction("BottomVerticalIcon"),OverflowIcon:this.Render.renderFunction("OverflowIcon"),BrIcon:this.Render.renderFunction("BrIcon"),CutIcon:this.Render.renderFunction("CutIcon"),TextRotateIcon:this.Render.renderFunction("TextRotateIcon"),TextRotateAngleUpIcon:this.Render.renderFunction("TextRotateAngleUpIcon"),TextRotateAngleDownIcon:this.Render.renderFunction("TextRotateAngleDownIcon"),TextRotateVerticalIcon:this.Render.renderFunction("TextRotateVerticalIcon"),TextRotateRotationUpIcon:this.Render.renderFunction("TextRotateRotationUpIcon"),TextRotateRotationDownIcon:this.Render.renderFunction("TextRotateRotationDownIcon")};this._plugin.registerComponent(t+V0.name,V0),this._plugin.registerComponent(t+cx.name,cx);for(let e in n)this._plugin.registerComponent(e,n[e])}resetLocale(e){var t,n;const r=this._plugin.context.getLocale();for(let a=0;a<e.length;a++){const i=e[a];i.tooltipLocale&&(i.tooltip=r.get(i.tooltipLocale)),i.locale&&(i.label=r.get(i.locale)),i.suffixLocale&&(i.suffix=r.get(i.suffixLocale)),(null==(n=null==(t=i.customLabel)?void 0:t.props)?void 0:n.locale)&&(i.customLabel.props.label=r.get(i.customLabel.props.locale)),i.children&&(i.children=this.resetLocale(i.children))}return e}resetToolBarList(){const e=this.resetLocale(this._toolList);this._toolBarComponent.setToolBar(e)}setRedo(){this._plugin.getContext().getCommandManager().redo()}setUndo(){this._plugin.getContext().getCommandManager().undo()}setFontColor(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setFontColor(e)}setBackground(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setBackground(e)}setFontSize(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setFontSize(e)}setFontFamily(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setFontFamily(e)}setFontWeight(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setFontWeight(e)}setFontStyle(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setFontStyle(e)}setStrikeThrough(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setStrikeThrough(e)}setUnderline(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setUnderline(e)}setMerge(e){const t=this._plugin.getSelectionManager().getActiveRange();switch(e){case"all":null==t||t.merge();break;case"vertical":null==t||t.mergeVertically();break;case"horizontal":null==t||t.mergeAcross();break;case"cancel":null==t||t.breakApart()}this._plugin.getCanvasView().updateToSheet(this._plugin.getContext().getWorkBook().getActiveSheet())}setHorizontalAlignment(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setHorizontalAlignment(e)}setVerticalAlignment(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setVerticalAlignment(e)}setWrapStrategy(e){var t;null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setWrapStrategy(e)}setTextRotation(e){var t,n;"v"===e?null==(t=this._plugin.getSelectionManager().getActiveRangeList())||t.setVerticalText(1):null==(n=this._plugin.getSelectionManager().getActiveRangeList())||n.setTextRotation(e)}setBorder(e,t,n){const r=this._plugin.getSelectionManager().getCurrentControls();r&&r.length>0&&(null==r||r.forEach((r=>{const a=r.model,i={startRow:a.startRow,startColumn:a.startColumn,endRow:a.endRow,endColumn:a.endColumn};this._plugin.getContext().getWorkBook().getActiveSheet().getRange(i).setBorderByType(e,t,n)})),this._plugin.getCanvasView().updateToSheet(this._plugin.getContext().getWorkBook().getActiveSheet()))}handleLineColor(e,t){t.stopPropagation(),this._lineColor.setColor(e),this._borderInfo.color=e}addToolButton(e){this._toolList.findIndex((t=>t.name===e.name))>-1||(this._toolList.push(e),this.resetToolBarList())}}class Q0{constructor(e){this._plugin=e,this._ModalGroup=[],this.init()}init(){var e;null==(e=this._plugin.getObserver("onModalGroupDidMountObservable"))||e.add((e=>{this._ModalGroupComponent=e}))}addModal(e,t){var n;this._ModalGroup.findIndex((t=>t===e))<0&&(this._plugin.registerComponent(e,t),this._ModalGroup.push(e),null==(n=this._ModalGroupComponent)||n.setModalGroup(this._ModalGroup))}}class J0 extends Ts{constructor(e={}){super(ti.SPREADSHEET),this._config=_a.commonExtend(aQ,e)}register(e){let t=AZ(this.getContentRef());this._canvasEngine=e,e.setContainer(t),window.onresize=()=>{e.resize()}}initialize(e){var t;this.context=e,null==(t=this.getObserver("onSheetContainerDidMountObservable"))||t.add((()=>{this._initializeRender(e)})),e.getLocale().load({en:JZ,zh:QZ});const n=e.getWorkBook().getConfig(),r=this._initContainer(this._config.container),a={skin:n.skin||"default",layout:this._config.layout,container:r,context:e,getSplitLeftRef:e=>{this._splitLeftRef=e},getContentRef:e=>{this._contentRef=e},addButton:e=>{this._addButtonFunc=e},addSider:e=>{this._addSiderFunc=e},addMain:e=>{this._addMainFunc=e},showSiderByName:e=>{this._showSiderByNameFunc=e},showMainByName:e=>{this._showMainByNameFunc=e},onDidMount:()=>{}};this._componentList=new Map,this._modalGroupController=new Q0(this),this._rightMenuControl=new q0(this),this._toolBarControl=new Z0(this),this._infoBarControl=new H0(this),this._cellEditorControl=new P0(this),this._antLineController=new b0(this),this._countBarController=new F0(this),this._sheetContainerController=new U0(this),Em(rm(v0,{config:a}),r)}_initContainer(e){let t=null;if("string"==typeof e){const n=document.getElementById(e);null==n?(t=document.createElement("div"),t.id=e):t=n}else(n=e)instanceof Element||n instanceof HTMLDocument?t=e:(t=document.createElement("div"),t.id="universheet");var n;return t}_initSelection(){}onMounted(e){var t;(t=this).pushToObserve("onAfterChangeFontFamilyObservable"),t.pushToObserve("onAfterChangeFontSizeObservable"),t.pushToObserve("onAfterChangeFontWeightObservable"),t.pushToObserve("onAfterChangeFontItalicObservable"),t.pushToObserve("onAfterChangeFontStrikethroughObservable"),t.pushToObserve("onAfterChangeFontUnderlineObservable"),t.pushToObserve("onAfterChangeFontBackgroundObservable"),t.pushToObserve("onAfterChangeFontColorObservable"),t.pushToObserve("onDragAndDropStartObserver"),t.pushToObserve("onDragAndDroppingObserver"),t.pushToObserve("onDragAndDropEndEndObserver"),t.pushToObserve("onFillStartObserver"),t.pushToObserve("onFillingObserver"),t.pushToObserve("onFillEndObserver"),t.pushToObserve("onChangeSelectionObserver"),t.pushToObserve("onChangeCurrentSheetObserver"),t.pushToObserve("onToolBarDidMountObservable"),t.pushToObserve("onModalGroupDidMountObservable"),t.pushToObserve("onRichTextDidMountObservable"),t.pushToObserve("onFormulaBarDidMountObservable"),t.pushToObserve("onLineColorDidMountObservable"),t.pushToObserve("onSheetBarDidMountObservable"),t.pushToObserve("onCountBarDidMountObservable"),t.pushToObserve("onInfoBarDidMountObservable"),t.pushToObserve("onRightMenuDidMountObservable"),t.pushToObserve("onSheetContainerDidMountObservable"),t.pushToObserve("onSpreadsheetKeyDownObservable"),t.pushToObserve("onSpreadsheetKeyUpObservable"),t.pushToObserve("onSpreadsheetKeyCopyObservable"),t.pushToObserve("onSpreadsheetKeyPasteObservable"),t.pushToObserve("onSpreadsheetKeyCutObservable"),t.pushToObserve("onSpreadsheetKeyCompositionStartObservable"),t.pushToObserve("onSpreadsheetKeyCompositionUpdateObservable"),t.pushToObserve("onSpreadsheetKeyCompositionEndObservable"),this.initialize(e)}get config(){return this._config}_initializeRender(e){var t,n;const r=null==(t=this.getPluginByName(ti.BASE_RENDER))?void 0:t.getEngine();this.register(r),this._canvasView=new AQ(r,this),null==(n=this.context.getContextObserver("onSheetRenderDidMountObservable"))||n.notifyObservers()}onDestroy(){var e;super.onDestroy(),(e=this).deleteObserve("onAfterChangeFontFamilyObservable"),e.deleteObserve("onAfterChangeFontSizeObservable"),e.deleteObserve("onAfterChangeFontWeightObservable"),e.deleteObserve("onAfterChangeFontItalicObservable"),e.deleteObserve("onAfterChangeFontStrikethroughObservable"),e.deleteObserve("onAfterChangeFontUnderlineObservable"),e.deleteObserve("onAfterChangeFontBackgroundObservable"),e.deleteObserve("onAfterChangeFontColorObservable"),e.deleteObserve("onDragAndDropStartObserver"),e.deleteObserve("onDragAndDroppingObserver"),e.deleteObserve("onDragAndDropEndEndObserver"),e.deleteObserve("onFillStartObserver"),e.deleteObserve("onFillingObserver"),e.deleteObserve("onFillEndObserver"),e.deleteObserve("onChangeSelectionObserver"),e.deleteObserve("onToolBarDidMountObservable"),e.deleteObserve("onModalGroupDidMountObservable"),e.deleteObserve("onRichTextDidMountObservable"),e.deleteObserve("onFormulaBarDidMountObservable"),e.deleteObserve("onChangeCurrentSheetObserver"),e.deleteObserve("onSheetContainerDidMountObservable"),e.deleteObserve("onSpreadsheetKeyDownObservable"),e.deleteObserve("onSpreadsheetKeyUpObservable"),e.deleteObserve("onSpreadsheetKeyCopyObservable"),e.deleteObserve("onSpreadsheetKeyPasteObservable"),e.deleteObserve("onSpreadsheetKeyCutObservable"),e.deleteObserve("onSpreadsheetKeyCompositionStartObservable"),e.deleteObserve("onSpreadsheetKeyCompositionUpdateObservable"),e.deleteObserve("onSpreadsheetKeyCompositionEndObservable")}getSplitLeftRef(){return this._splitLeftRef}getContentRef(){return this._contentRef}addButton(e){this._addButtonFunc(e)}getCanvasEngine(){return this._canvasEngine}getCanvasView(){return this._canvasView}getMainScene(){return this._canvasEngine.getScene(tQ.MAIN_SCENE)}getSheetView(){return this.getCanvasView().getSheetView()}getSelectionManager(){var e;return null==(e=this.getSheetView())?void 0:e.getSelectionManager()}getCurrentControls(){var e;return null==(e=this.getSelectionManager())?void 0:e.getCurrentControls()}getSelectionShape(){return this._canvasEngine}getMainComponent(){return this.getSheetView().getSpreadsheet()}getLeftTopComponent(){return this.getSheetView().getSpreadsheetLeftTopPlaceholder()}getRowComponent(){return this.getSheetView().getSpreadsheetRowTitle()}getColumnComponent(){return this.getSheetView().getSpreadsheetColumnTitle()}getSpreadsheetSkeleton(){return this.getSheetView().getSpreadsheetSkeleton()}getWorkbook(){return this.context.getWorkBook()}getRightMenuControl(){return this._rightMenuControl}getToolBarControl(){return this._toolBarControl}getInfoBarControl(){return this._infoBarControl}getSheetBarControl(){return this._sheetBarControl}getCellEditorControl(){return this._cellEditorControl}addSider(e){return this._addSiderFunc(e)}addMain(e){return this._addMainFunc(e)}showSiderByName(e,t){return this._showSiderByNameFunc(e,t)}showMainByName(e,t){return this._showMainByNameFunc(e,t)}addRightMenu(e){this._rightMenuControl.addItem(e)}addToolButton(e){this._toolBarControl.addToolButton(e)}registerComponent(e,t,n){this._componentList.set(e,t)}getRegisterComponent(e){return this._componentList.get(e)}registerModal(e,t){this._modalGroupController.addModal(e,t)}}class e1{constructor(){this._initialize()}_initialize(){Yp.id=_a.generateRandomId();const e=Os.newInstance(Yp);e.installPlugin(new ju),e.installPlugin(new OK);let t=new J0({container:"univer-demo",layout:{innerRight:!1,outerLeft:!1,infoBar:!1,formulaBar:!1,toolBar:!1,sheetBar:!1,countBar:!1}});e.installPlugin(t)}}class t1 extends t().PureComponent{componentDidMount(){new e1}componentWillUnmount(){this.setState=()=>!1}render(){return t().createElement("div",{id:"univer-demo",style:{width:"300px",height:"100px"}})}}function n1(){return n1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n1.apply(this,arguments)}class r1 extends t().PureComponent{constructor(e){super(e),this.state={progress:0},e.uploader&&(e.uploader.onProgress=this.handleProgress.bind(this)),this.handleImagePreview=this.handleImagePreview.bind(this),this.handleFormButtonClick=this.handleFormButtonClick.bind(this),this.handleContextClick=this.handleContextClick.bind(this),this.handleCancelUpload=this.handleCancelUpload.bind(this),this.handleQuoteClick=this.handleQuoteClick.bind(this),this.formatterContext={formatMessage:e.intl.formatMessage.bind(e.intl),viewportWidth:e.viewportWidth,authorizeURL:e.tinode.authorizeURL.bind(e.tinode),onImagePreview:this.handleImagePreview,onFormButtonClick:this.handleFormButtonClick,onQuoteClick:this.handleQuoteClick}}handleImagePreview(e){e.preventDefault(),this.props.onImagePreview({url:e.target.src,filename:e.target.title,width:e.target.dataset.width,height:e.target.dataset.height,size:e.target.dataset.size,type:e.target.dataset.mime})}handleFormButtonClick(e){e.preventDefault();const t={seq:this.props.seq,resp:{}};e.target.dataset.name&&(t.resp[e.target.dataset.name]=e.target.dataset.val?e.target.dataset.val:void 0===e.target.dataset.val?1:""+e.target.dataset.val),"url"==e.target.dataset.act&&(t.ref=wn(e.target.dataset.ref)||"about:blank");const n=e.target.dataset.title||"unknown";this.props.onFormResponse(e.target.dataset.act,n,t)}handleContextClick(e){e.preventDefault(),e.stopPropagation();const t=[];this.props.received==$t.Tinode.MESSAGE_STATUS_FAILED&&t.push("menu_item_send_retry"),this.props.userIsWriter&&this.props.received>$t.Tinode.MESSAGE_STATUS_FAILED&&this.props.received<$t.Tinode.MESSAGE_STATUS_DEL_RANGE&&t.push("menu_item_reply"),t.push("menu_item_forward"),this.props.showContextMenu({seq:this.props.seq,content:this.props.content,userFrom:this.props.userFrom,userName:this.props.userName,y:e.pageY,x:e.pageX,pickReply:this.props.pickReply},t)}handleProgress(e){this.setState({progress:e})}handleCancelUpload(){this.props.onCancelUpload(this.props.seq,this.props.uploader)}handleQuoteClick(e){e.preventDefault(),e.stopPropagation();const t=this.props.replyToSeq;t&&this.props.onQuoteClick(t)}render(){const e=this.props.sequence+" "+(this.props.response?"left":"right"),n="single"==this.props.sequence||"last"==this.props.sequence?"bubble tip":"bubble",r=this.props.userAvatar||!0,a=this.props.isGroup&&this.props.response&&("single"==this.props.sequence||"last"==this.props.sequence);let o=this.props.content;const s=[];if("table"===o)s.push(t().createElement(t1,{key:(new Date).getTime()}));else if(this.props.mimeType==$t.Drafty.getContentType()&&$t.Drafty.isValid(o)){$t.Drafty.attachments(o,((e,n)=>{"application/json"!=e.mime&&s.push(t().createElement(Xr,{tinode:this.props.tinode,downloadUrl:$t.Drafty.getDownloadUrl(e),filename:e.name,uploading:$t.Drafty.isProcessing(e),mimetype:e.mime,size:$t.Drafty.getEntitySize(e),progress:this.state.progress,onCancelUpload:this.handleCancelUpload,onError:this.props.onError,key:n}))}),this);const e=$t.Drafty.format(o,Xn,this.formatterContext);o=t().createElement(t().Fragment,null,e)}else this.props.deleted?o=t().createElement(t().Fragment,null,t().createElement("i",{className:"material-icons gray"},"block")," ",t().createElement("i",{className:"gray"},t().createElement(i.FormattedMessage,{id:"deleted_content",defaultMessage:[{type:0,value:"content deleted"}]}))):"string"!=typeof o&&(o=t().createElement(t().Fragment,null,t().createElement("i",{className:"material-icons gray"},"warning_amber")," ",t().createElement("i",{className:"gray"},t().createElement(i.FormattedMessage,{id:"invalid_content",defaultMessage:[{type:0,value:"invalid content"}]}))));return t().createElement("li",{ref:this.props.innerRef,className:e},this.props.isGroup&&this.props.response?t().createElement("div",{className:"avatar-box"},a?t().createElement(Sn,{tinode:this.props.tinode,topic:this.props.userFrom,title:this.props.userName,avatar:r}):null):null,t().createElement("div",null,t().createElement("div",{className:n},t().createElement("div",{className:"content-meta"},t().createElement("div",{className:"message-content"},o,s),this.props.timestamp?t().createElement(Kr,{timestamp:this.props.timestamp,received:this.props.received}):null),this.props.showContextMenu?t().createElement("span",{className:"menuTrigger"},t().createElement("a",{href:"#",onClick:this.handleContextClick},t().createElement("i",{className:"material-icons"},"expand_more"))):null),a?t().createElement("div",{className:"author"},this.props.userName||t().createElement("i",null,t().createElement(i.FormattedMessage,{id:"user_not_found",defaultMessage:[{type:0,value:"Not found"}]}))):null))}}const a1=(0,i.injectIntl)(r1),i1=t().forwardRef(((e,n)=>t().createElement(a1,n1({innerRef:n},e))));var o1=n(27),s1=n.n(o1);const l1=100,c1="audio/webm";class u1 extends t().PureComponent{constructor(e){super(e),this.state={enabled:!0,audioRecord:null,recording:!0,paused:!1,duration:"0:00",blobUrl:null,preview:null},this.visualize=this.visualize.bind(this),this.initMediaRecording=this.initMediaRecording.bind(this),this.initCanvas=this.initCanvas.bind(this),this.getRecording=this.getRecording.bind(this),this.cleanUp=this.cleanUp.bind(this),this.handleResume=this.handleResume.bind(this),this.handlePause=this.handlePause.bind(this),this.handleDelete=this.handleDelete.bind(this),this.handleDone=this.handleDone.bind(this),this.durationMillis=0,this.startedOn=null,this.viewBuffer=[],this.canvasRef=t().createRef()}componentDidMount(){this.stream=null,this.mediaRecorder=null,this.audioContext=null,this.audioInput=null,this.analyser=null,this.audioChunks=[];try{navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(this.initMediaRecording,this.props.onError)}catch(e){this.props.onError(e)}}componentWillUnmount(){this.startedOn=null,this.stream&&this.cleanUp()}visualize(){this.initCanvas();const e=new Uint8Array(this.analyser.frequencyBinCount),t=this.canvasWidth,n=this.canvasHeight,r=t/10|0,a=l1*r;this.canvasContext.lineWidth=6,this.canvasContext.strokeStyle="#BBBD";let i=0,o=0,s=0;const l=()=>{if(!this.startedOn)return;window.requestAnimationFrame(l);const c=this.durationMillis+(Date.now()-this.startedOn);this.setState({duration:_n(c/1e3)}),c>6e5&&(this.startedOn=null,this.mediaRecorder.pause(),this.durationMillis+=Date.now()-this.startedOn,this.setState({enabled:!1,recording:!1,duration:_n(this.durationMillis/1e3)})),this.analyser.getByteTimeDomainData(e);let u=0;for(const t of e)u+=(t-127)**2;o+=Math.sqrt(u/e.length),s++;let h=c/l1|0;const d=a>c?0:(c-l1*h)/l1*10;i!=h&&(i=h,this.viewBuffer.push(o/s),o=0,s=0,this.viewBuffer.length>r&&this.viewBuffer.shift()),this.canvasContext.clearRect(0,0,t,n),this.canvasContext.beginPath();for(let e=0;e<this.viewBuffer.length;e++){let t=10*e-d,r=Math.min(this.viewBuffer[e]/64,.9)*n;this.canvasContext.moveTo(t,.5*(n-r)),this.canvasContext.lineTo(t,.5*n+.5*r)}this.canvasContext.stroke()};l()}handlePause(e){e.preventDefault(),this.mediaRecorder.pause(),this.mediaRecorder.requestData(),this.durationMillis+=Date.now()-this.startedOn,this.startedOn=null,this.setState({recording:!1})}handleResume(e){e.preventDefault(),this.state.enabled&&(this.startedOn=Date.now(),this.mediaRecorder.resume(),this.setState({recording:!0},this.visualize))}handleDelete(e){e.preventDefault(),this.durationMillis=0,this.startedOn=null,this.mediaRecorder.stop(),this.cleanUp(),this.setState({recording:!1})}handleDone(e){e.preventDefault(),this.setState({recording:!1}),this.startedOn&&(this.durationMillis+=Date.now()-this.startedOn,this.startedOn=null),this.mediaRecorder&&this.mediaRecorder.stop()}initCanvas(){this.canvasRef.current.width=2*this.canvasRef.current.offsetWidth,this.canvasRef.current.height=2*this.canvasRef.current.offsetHeight,this.canvasContext=this.canvasRef.current.getContext("2d"),this.canvasContext.lineCap="round",this.canvasContext.translate(.5,.5),this.canvasWidth=this.canvasRef.current.width,this.canvasHeight=this.canvasRef.current.height}initMediaRecording(e){this.stream=e,this.mediaRecorder=new MediaRecorder(e,{mimeType:c1}),this.audioContext=new AudioContext,this.audioInput=this.audioContext.createMediaStreamSource(e),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=256,this.audioInput.connect(this.analyser),this.mediaRecorder.onstop=e=>{this.durationMillis>2e3?this.getRecording(this.mediaRecorder.mimeType,this.durationMillis).then((e=>this.props.onFinished(e.url,e.preview,this.durationMillis))):this.props.onDeleted(),this.cleanUp()},this.mediaRecorder.ondataavailable=e=>{e.data.size>0&&this.audioChunks.push(e.data),"inactive"!=this.mediaRecorder.state&&this.getRecording(this.mediaRecorder.mimeType).then((e=>{this.setState({blobUrl:e.url,preview:e.preview})}))},this.durationMillis=0,this.startedOn=Date.now(),this.mediaRecorder.start(),this.visualize()}getRecording(e,t){let n=new Blob(this.audioChunks,{type:e||c1});return(t>0?s1()(n,t,{logger:!1}):Promise.resolve(n)).then((e=>(n=e,e.arrayBuffer()))).then((e=>this.audioContext.decodeAudioData(e))).then((e=>this.createPreview(e))).then((e=>({url:window.URL.createObjectURL(n),preview:Ln(e)})))}createPreview(e){const t=e.getChannelData(0),n=Math.min(t.length,96),r=t.length/n|0,a=Math.max(1,r/10|0);let i=[],o=-1;for(let e=0;e<n;e++){let n=0,s=0;for(let i=0;i<r;i+=a)n+=t[r*e+i]**2,s++;const l=Math.sqrt(n/s);i.push(l),o=Math.max(o,l)}return o>0&&(i=i.map((e=>100*e/o|0))),i}cleanUp(){this.audioInput.disconnect(),this.stream.getTracks().forEach((e=>e.stop()))}render(){const e="material-icons "+(this.state.enabled?"red":"gray");return t().createElement("div",{className:"audio"},t().createElement("a",{href:"#",onClick:this.handleDelete,title:"Delete"},t().createElement("i",{className:"material-icons gray"},"delete_outline")),this.state.recording?t().createElement("canvas",{ref:this.canvasRef}):t().createElement(Hn,{src:this.state.blobUrl,preview:this.state.preview,duration:this.durationMillis,short:!0}),t().createElement("div",{className:"duration"},this.state.duration),this.state.recording?t().createElement("a",{href:"#",onClick:this.handlePause,title:"Pause"},t().createElement("i",{className:"material-icons"},"pause_circle_outline")):t().createElement("a",{href:"#",onClick:this.handleResume,title:"Resume"},t().createElement("i",{className:e},"radio_button_checked")),t().createElement("a",{href:"#",onClick:this.handleDone,title:"Send"},t().createElement("i",{className:"material-icons"},"send")))}}const h1=(0,i.defineMessages)({messaging_disabled:{id:"messaging_disabled_prompt",defaultMessage:[{type:0,value:"Messaging disabled"}]},type_new_message:{id:"new_message_prompt",defaultMessage:[{type:0,value:"New message"}]},add_image_caption:{id:"image_caption_prompt",defaultMessage:[{type:0,value:"Image caption"}]},file_attachment_too_large:{id:"file_attachment_too_large",defaultMessage:[{type:0,value:"The file size "},{type:1,value:"size"},{type:0,value:" exceeds the "},{type:1,value:"limit"},{type:0,value:" limit."}]},cannot_initiate_upload:{id:"cannot_initiate_file_upload",defaultMessage:[{type:0,value:"Cannot initiate file upload."}]}});class d1 extends t().PureComponent{constructor(e){super(e),this.state={quote:null,message:"",audioRec:!1,audioAvailable:!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia),keypressTimestamp:(new Date).getTime()-en-1},this.handlePasteEvent=this.handlePasteEvent.bind(this),this.handleAttachImage=this.handleAttachImage.bind(this),this.handleAttachFile=this.handleAttachFile.bind(this),this.handleAttachAudio=this.handleAttachAudio.bind(this),this.handleSend=this.handleSend.bind(this),this.handleKeyPress=this.handleKeyPress.bind(this),this.handleMessageTyping=this.handleMessageTyping.bind(this),this.handleQuoteClick=this.handleQuoteClick.bind(this),this.formatReply=this.formatReply.bind(this)}componentDidMount(){this.messageEditArea&&this.messageEditArea.addEventListener("paste",this.handlePasteEvent,!1),this.setState({quote:this.formatReply()})}componentWillUnmount(){this.messageEditArea&&this.messageEditArea.removeEventListener("paste",this.handlePasteEvent,!1)}componentDidUpdate(e){this.messageEditArea&&this.messageEditArea.focus(),e.topicName!=this.props.topicName&&this.setState({message:"",audioRec:!1,quote:null}),e.reply!=this.props.reply&&this.setState({quote:this.formatReply()})}formatReply(){return this.props.reply?$t.Drafty.format(this.props.reply.content,Qn,{formatMessage:this.props.intl.formatMessage.bind(this.props.intl),authorizeURL:this.props.tinode.authorizeURL.bind(this.props.tinode)}):null}handlePasteEvent(e){this.props.disabled||function(e,t,n,r){const a=(e.clipboardData||e.originalEvent.clipboardData||{}).items;if(!a||!a.length)return!1;for(let e in a){const i=a[e];if("file"===i.kind){const e=i.getAsFile();if(!e){console.error("Failed to get file object from pasted file item",i.kind,i.type),r("Failed to get file object from pasted file item");continue}return e.type&&"image"==e.type.split("/")[0]?t(e):n(e),!0}}return!1}(e,(e=>{this.props.onAttachImage(e)}),(e=>{this.props.onAttachFile(e)}),this.props.onError)&&e.preventDefault()}handleAttachImage(e){e.target.files&&e.target.files.length>0&&this.props.onAttachImage(e.target.files[0]),e.target.value=""}handleAttachTable(){this.props.onSendMessage("table"),this.setState({message:""})}handleAttachFile(e){e.target.files&&e.target.files.length>0&&this.props.onAttachFile(e.target.files[0]),e.target.value=""}handleAttachAudio(e,t,n){this.setState({audioRec:!1}),this.props.onAttachAudio(e,t,n)}handleSend(e){e.preventDefault();const t=this.state.message.trim();(t||this.props.acceptBlank||this.props.noInput)&&(this.props.onSendMessage(t),this.setState({message:""}))}handleKeyPress(e){if(this.state.audioRec)return e.preventDefault(),void e.stopPropagation();"Enter"===e.key&&(e.shiftKey||(e.preventDefault(),e.stopPropagation(),this.handleSend(e)))}handleMessageTyping(e){const t={message:e.target.value};if(this.props.onKeyPress){const e=(new Date).getTime();e-this.state.keypressTimestamp>en&&(this.props.onKeyPress(),t.keypressTimestamp=e)}this.setState(t)}handleQuoteClick(e){if(e.preventDefault(),e.stopPropagation(),this.props.reply&&this.props.onQuoteClick){const e=this.props.reply.seq;this.props.onQuoteClick(e)}}render(){const{formatMessage:e}=this.props.intl,n=this.props.disabled?e(h1.messaging_disabled):this.props.messagePrompt?e(h1[this.props.messagePrompt]):e(h1.type_new_message),r=this.state.quote?t().createElement("div",{id:"reply-quote-preview"},t().createElement("div",{className:"cancel"},t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.props.onCancelReply()}},t().createElement("i",{className:"material-icons gray"},"close"))),this.state.quote):null,a=this.state.audioAvailable&&this.props.onAttachAudio;return t().createElement("div",{id:"send-message-wrapper"},this.props.noInput?null:r,t().createElement("div",{id:"send-message-panel"},this.props.disabled?t().createElement("div",{id:"writing-disabled"},n):t().createElement(t().Fragment,null,this.props.onAttachFile&&!this.state.audioRec?t().createElement(t().Fragment,null,t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.attachImage.click()},title:"Add image"},t().createElement("i",{className:"material-icons secondary"},"photo")),t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.attachFile.click()},title:"Attach file"},t().createElement("i",{className:"material-icons secondary"},"attach_file")),t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.handleAttachTable()},title:"Add table"},t().createElement("i",{className:"material-icons secondary"},"table"))):null,this.props.noInput?r||t().createElement("div",{className:"hr thin"}):this.state.audioRec?t().createElement(u1,{onDeleted:e=>this.setState({audioRec:!1}),onFinished:this.handleAttachAudio}):t().createElement("textarea",{id:"sendMessage",placeholder:n,value:this.state.message,onChange:this.handleMessageTyping,onKeyPress:this.handleKeyPress,ref:e=>{this.messageEditArea=e},autoFocus:!0}),this.state.message||!a?t().createElement("a",{href:"#",onClick:this.handleSend,title:"Send"},t().createElement("i",{className:"material-icons"},"send")):this.state.audioRec?null:t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.setState({audioRec:!0})},title:"Voice"},t().createElement("i",{className:"material-icons"},"mic")),t().createElement("input",{type:"file",ref:e=>{this.attachFile=e},onChange:this.handleAttachFile,style:{display:"none"}}),t().createElement("input",{type:"file",ref:e=>{this.attachImage=e},accept:"image/*",onChange:this.handleAttachImage,style:{display:"none"}}))))}}const p1=(0,i.injectIntl)(d1);class m1 extends t().PureComponent{constructor(e){super(e),this.handleSendDoc=this.handleSendDoc.bind(this)}handleSendDoc(e){this.props.onClose(),this.props.onSendMessage(this.props.content.file)}render(){return this.props.content?t().createElement("div",{id:"image-preview"},t().createElement("div",{id:"image-preview-caption-panel"},t().createElement("span",null,this.props.content.name),t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.props.onClose()}},t().createElement("i",{className:"material-icons gray"},"close"))),t().createElement("div",{id:"image-preview-container"},t().createElement("div",{className:"flex-column narrow"},t().createElement("i",{className:"material-icons gray"},function(e){const t={default:"insert_drive_file",image:"image",text:"description",video:"theaters"};return t[e]||t[(e||"").split("/")[0]]||t.default}(this.props.content.type)),t().createElement("div",null,t().createElement("b",null,t().createElement(i.FormattedMessage,{id:"label_file_name",defaultMessage:[{type:0,value:"File name:"}]}))," ",fn(this.props.content.name,24)||"-"),t().createElement("div",null,t().createElement("b",null,t().createElement(i.FormattedMessage,{id:"label_content_type",defaultMessage:[{type:0,value:"Content type:"}]}))," ",this.props.content.type||"application/octet-stream"),t().createElement("div",null,t().createElement("b",null,t().createElement(i.FormattedMessage,{id:"label_size",defaultMessage:[{type:0,value:"Size:"}]}))," ",gn(this.props.content.size)))),t().createElement(p1,{noInput:!0,tinode:this.props.tinode,reply:this.props.reply,onCancelReply:this.props.onCancelReply,onSendMessage:this.handleSendDoc,onError:this.props.onError})):null}}class _1 extends t().Component{constructor(e){super(e)}render(){const e=[],n=(this.props.subscribers||[]).length,r=Math.min(4,n);return(this.props.subscribers||[]).some((n=>(e.push(t().createElement("div",{className:"avatar-box",key:n.user},t().createElement(Sn,{tinode:this.props.tinode,topic:n.user,avatar:Mn(n.public?n.public.photo:null)||!0,title:n.public?n.public.fn:null}))),e.length==r))),t().createElement("div",{id:"topic-users"},e," ",n>r?t().createElement("span",null,t().createElement(i.FormattedMessage,{id:"more_online_members",defaultMessage:[{type:0,value:"+"},{type:1,value:"overflow"},{type:0,value:" more"}],values:{overflow:n-r}})):null)}}class g1 extends t().PureComponent{constructor(e){super(e),this.state={width:0,height:0},this.handleSendImage=this.handleSendImage.bind(this)}assignWidth(e){if(e&&!this.state.width){const t=e.getBoundingClientRect();this.setState({width:0|t.width,height:0|t.height})}}handleSendImage(e){this.props.onClose(),this.props.onSendMessage(e,this.props.content.blob)}render(){if(!this.props.content)return null;const e=On(this.props.content.width,this.props.content.height,this.state.width,this.state.height,!1),n=e?{width:e.dstWidth+"px",height:e.dstHeight+"px"}:this.props.content.width>this.props.content.height?{width:"100%"}:{height:"100%"};n.maxWidth="100%",n.maxHeight="100%";const r=Math.max((this.state.width/nn/1.5|0)-2,12),a=fn(this.props.content.name,r)||"-",o=this.props.content.width||"-",s=this.props.content.height||"-";return t().createElement("div",{id:"image-preview"},t().createElement("div",{id:"image-preview-caption-panel"},this.props.onSendMessage?t().createElement("span",null,a):t().createElement("a",{href:this.props.content.url,download:!0},t().createElement("i",{className:"material-icons"},"file_download")," ",t().createElement(i.FormattedMessage,{id:"download_action",defaultMessage:[{type:0,value:"download"}]})),t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.props.onClose()}},t().createElement("i",{className:"material-icons gray"},"close"))),t().createElement("div",{id:"image-preview-container",ref:e=>this.assignWidth(e)},t().createElement("img",{src:this.props.content.url,style:n,className:"image-preview",alt:this.props.content.name})),this.props.onSendMessage?t().createElement(p1,{messagePrompt:"add_image_caption",acceptBlank:!0,tinode:this.props.tinode,reply:this.props.reply,onCancelReply:this.props.onCancelReply,onSendMessage:this.handleSendImage,onError:this.props.onError}):t().createElement("div",{id:"image-preview-footer"},t().createElement("div",null,t().createElement("div",null,t().createElement("b",null,t().createElement(i.FormattedMessage,{id:"label_file_name",defaultMessage:[{type:0,value:"File name:"}]}))),t().createElement("div",null,t().createElement("span",{title:this.props.content.name},a))),t().createElement("div",null,t().createElement("div",null,t().createElement("b",null,t().createElement(i.FormattedMessage,{id:"label_content_type",defaultMessage:[{type:0,value:"Content type:"}]}))),t().createElement("div",null,this.props.content.type)),t().createElement("div",null,t().createElement("div",null,t().createElement("b",null,t().createElement(i.FormattedMessage,{id:"label_size",defaultMessage:[{type:0,value:"Size:"}]}))),t().createElement("div",null,o," × ",s," px; ",gn(this.props.content.size)))))}}class f1 extends t().PureComponent{constructor(e){super(e),this.handleButtonAction=this.handleButtonAction.bind(this)}handleButtonAction(e,t){e.preventDefault(),this.props.onAction(t)}render(){return t().createElement("div",{className:"accept-invite-panel"},t().createElement("div",{className:"title"},t().createElement(i.FormattedMessage,{id:"chat_invitation",defaultMessage:[{type:0,value:"You are invited to start a new chat. What would you like to do?"}]})),t().createElement("div",{className:"footer"},t().createElement("button",{className:"primary",onClick:e=>{this.handleButtonAction(e,"accept")}},t().createElement(i.FormattedMessage,{id:"chat_invitation_accept",defaultMessage:[{type:0,value:"Accept"}]})),t().createElement("button",{className:"secondary",onClick:e=>{this.handleButtonAction(e,"delete")}},t().createElement(i.FormattedMessage,{id:"chat_invitation_ignore",defaultMessage:[{type:0,value:"Ignore"}]})),t().createElement("button",{className:"secondary",onClick:e=>{this.handleButtonAction(e,"block")}},t().createElement(i.FormattedMessage,{id:"chat_invitation_block",defaultMessage:[{type:0,value:"Block"}]}))))}}class y1 extends t().PureComponent{render(){const e=Zt+" ("+$t.Tinode.getLibrary()+")";return t().createElement("div",{id:"dummy-view"},t().createElement("div",null,t().createElement("a",{href:"https://github.com/tinode/chat/"},t().createElement("img",{id:"logo",alt:"logo",src:"img/logo.svg"}),t().createElement("h2",null,"Tinode Web")),t().createElement("p",null,t().createElement(i.FormattedMessage,{id:"label_client",defaultMessage:[{type:0,value:"Client:"}]})," ",e),t().createElement("p",null,t().createElement(i.FormattedMessage,{id:"label_server",defaultMessage:[{type:0,value:"Server:"}]})," ",this.props.serverVersion," (",this.props.serverAddress,")")))}}class v1 extends t().PureComponent{constructor(e){super(e)}render(){let e=null,n="bubble";return this.props.deleted?(e=t().createElement(t().Fragment,null,t().createElement("i",{className:"material-icons gray"},"block")," ",t().createElement("i",{className:"gray"},t().createElement(i.FormattedMessage,{id:"deleted_content",defaultMessage:[{type:0,value:"content deleted"}]}))),n+=" deleted"):this.props.date&&(e=t().createElement(t().Fragment,null,this.props.date),n+=" date"),e?t().createElement("li",{className:"meta"},t().createElement("div",{className:n},t().createElement("div",{className:"message-content"},e))):t().createElement(t().Fragment,null,null)}}class b1{static parseUrlHash(e){const t=e.split("?",2),n={};let r=[];return t[0]&&(r=t[0].replace("#","").split("/")),t[1]&&t[1].split("&").forEach((e=>{const t=e.indexOf("=");t>0&&(n[e.slice(0,t)]=decodeURIComponent(e.slice(t+1)))})),{path:r,params:n}}static navigateTo(e){window.location.hash=e}static composeUrlHash(e,t){let n=e.join("/");const r=[];for(const e in t)t.hasOwnProperty(e)&&r.push(e+"="+encodeURIComponent(t[e]));return r.length>0&&(n+="?"+r.join("&")),n}static addUrlParam(e,t,n){const r=b1.parseUrlHash(e);return r.params[t]=n,b1.composeUrlHash(r.path,r.params)}static removeUrlParam(e,t){const n=b1.parseUrlHash(e);return delete n.params[t],b1.composeUrlHash(n.path,n.params)}static setUrlSidePanel(e,t){const n=b1.parseUrlHash(e);return n.path[0]=t,b1.composeUrlHash(n.path,n.params)}static setUrlInfoPanel(e,t){const n=b1.parseUrlHash(e);return t?n.params.info=t:delete n.params.info,b1.composeUrlHash(n.path,n.params)}static setUrlTopic(e,t){const n=b1.parseUrlHash(e);return n.path[1]=t,delete n.params.info,b1.composeUrlHash(n.path,n.params)}}const x1=(0,i.defineMessages)({online_now:{id:"online_now",defaultMessage:[{type:0,value:"online now"}]},last_seen:{id:"last_seen_timestamp",defaultMessage:[{type:0,value:"Last seen"}]},not_found:{id:"title_not_found",defaultMessage:[{type:0,value:"Not found"}]},channel:{id:"channel",defaultMessage:[{type:0,value:"channel"}]},file_attachment_too_large:{id:"file_attachment_too_large",defaultMessage:[{type:0,value:"The file size "},{type:1,value:"size"},{type:0,value:" exceeds the "},{type:1,value:"limit"},{type:0,value:" limit."}]},invalid_content:{id:"invalid_content",defaultMessage:[{type:0,value:"invalid content"}]}});function w1(e){if(e){const t=e.getExcessive()||"";return e.isJoiner("given")&&(t.includes("R")||t.includes("W"))}return!1}function T1(e){if(e){const t=e.getMissing()||"";return e.isJoiner("want")&&(t.includes("R")||t.includes("W"))}return!1}function C1(e){return 1==e||3==e}class E1 extends t().Component{constructor(e){super(e),this.state=E1.getDerivedStateFromProps(e,{}),this.leave=this.leave.bind(this),this.sendMessage=this.sendMessage.bind(this),this.retrySend=this.retrySend.bind(this),this.sendImageAttachment=this.sendImageAttachment.bind(this),this.sendFileAttachment=this.sendFileAttachment.bind(this),this.sendAudioAttachment=this.sendAudioAttachment.bind(this),this.sendKeyPress=this.sendKeyPress.bind(this),this.subscribe=this.subscribe.bind(this),this.handleScrollReference=this.handleScrollReference.bind(this),this.handleScrollEvent=this.handleScrollEvent.bind(this),this.handleDescChange=this.handleDescChange.bind(this),this.handleSubsUpdated=this.handleSubsUpdated.bind(this),this.handleMessageUpdate=this.handleMessageUpdate.bind(this),this.handleAllMessagesReceived=this.handleAllMessagesReceived.bind(this),this.handleInfoReceipt=this.handleInfoReceipt.bind(this),this.handleImagePostview=this.handleImagePostview.bind(this),this.handleClosePreview=this.handleClosePreview.bind(this),this.handleFormResponse=this.handleFormResponse.bind(this),this.handleContextClick=this.handleContextClick.bind(this),this.handleShowMessageContextMenu=this.handleShowMessageContextMenu.bind(this),this.handleNewChatAcceptance=this.handleNewChatAcceptance.bind(this),this.handleEnablePeer=this.handleEnablePeer.bind(this),this.handleAttachFile=this.handleAttachFile.bind(this),this.handleAttachImage=this.handleAttachImage.bind(this),this.handleCancelUpload=this.handleCancelUpload.bind(this),this.postReadNotification=this.postReadNotification.bind(this),this.clearNotificationQueue=this.clearNotificationQueue.bind(this),this.goToLatestMessage=this.goToLatestMessage.bind(this),this.handlePickReply=this.handlePickReply.bind(this),this.handleCancelReply=this.handleCancelReply.bind(this),this.handleQuoteClick=this.handleQuoteClick.bind(this),this.handleCallHangup=this.handleCallHangup.bind(this),this.chatMessageRefs={},this.getOrCreateMessageRef=this.getOrCreateMessageRef.bind(this),this.readNotificationQueue=[],this.readNotificationTimer=null,this.keyPressTimer=null}getOrCreateMessageRef(e){if(this.chatMessageRefs.hasOwnProperty(e))return this.chatMessageRefs[e];const n=t().createRef();return this.chatMessageRefs[e]=n,n}componentDidMount(){this.messagesScroller&&this.messagesScroller.addEventListener("scroll",this.handleScrollEvent)}componentWillUnmount(){this.messagesScroller&&this.messagesScroller.removeEventListener("scroll",this.handleScrollEvent),this.clearNotificationQueue()}componentDidUpdate(e,t){!this.messagesScroller||t.topic==this.state.topic&&t.messageCount==this.state.messageCount||this.state.scrollPosition<100&&(this.messagesScroller.scrollTop=this.messagesScroller.scrollHeight-this.state.scrollPosition-this.messagesScroller.offsetHeight);const n=this.props.tinode?this.props.tinode.getTopic(this.state.topic):void 0;this.state.topic!=t.topic&&(t.topic&&!$t.Tinode.isNewGroupTopicName(t.topic)&&(this.leave(t.topic),t.rtcPanel&&this.handleCallHangup(t.topic,e.callSeq)),n&&(n.onData=this.handleMessageUpdate,n.onAllMessagesReceived=this.handleAllMessagesReceived,n.onInfo=this.handleInfoReceipt,n.onMetaDesc=this.handleDescChange,n.onSubsUpdated=this.handleSubsUpdated,n.onPres=this.handleSubsUpdated)),this.props.applicationVisible?this.postReadNotification(0):this.clearNotificationQueue(),!n||this.state.topic==t.topic&&e.ready||(n._new&&n.isP2PType()?n.getMeta(n.startMetaQuery().withDesc().build()):this.subscribe(n))}static getDerivedStateFromProps(e,t){let n={};if(e.topic)if(e.topic!=t.topic){const r=e.tinode.getTopic(e.topic);if(n={topic:e.topic,docPreview:null,imagePreview:null,imagePostview:null,rtcPanel:null,typingIndicator:!1,scrollPosition:0,fetchingMessages:!1,showGoToLastButton:!1,deleted:r._deleted},e.forwardMessage&&(n.reply={content:e.forwardMessage.preview,seq:null}),r){const a=[];e.connected&&r.subscribers((t=>{t.online&&t.user!=e.myUserId&&a.push(t)})),Object.assign(n,{onlineSubs:a}),r.public?Object.assign(n,{title:r.public.fn,avatar:Mn(r.public.photo)}):Object.assign(n,{title:"",avatar:null});const i=r.p2pPeerDesc();i?Object.assign(n,{peerMessagingDisabled:T1(i.acs)}):t.peerMessagingDisabled&&Object.assign(n,{peerMessagingDisabled:!1}),Object.assign(n,{messageCount:r.messageCount(),latestClearId:r.maxClearId(),channel:r.isChannelType()}),e.callTopic==r.name&&C1(e.callState)&&(n.rtcPanel=e.callTopic)}else Object.assign(n,{messageCount:0,latestClearId:-1,onlineSubs:[],title:"",avatar:null,peerMessagingDisabled:!1,channel:!1})}else e.callTopic==t.topic&&!t.rtcPanel&&C1(e.callState)&&(n.rtcPanel=e.callTopic);else n={messageCount:0,latestClearId:-1,onlineSubs:[],topic:null,title:"",avatar:null,isVerified:!1,isStaff:!1,isDangerous:!1,deleted:!1,docPreview:null,imagePreview:null,imagePostview:null,rtcPanel:null,typingIndicator:!1,scrollPosition:0,fetchingMessages:!1,peerMessagingDisabled:!1,channel:!1,reply:null,showGoToLastButton:!1};return e.acs?(e.acs.isWriter()!=t.isWriter&&(n.isWriter=!t.isWriter),e.acs.isReader()!=t.isReader&&(n.isReader=!t.isReader),!e.acs.isReader("given")!=t.readingBlocked&&(n.readingBlocked=!t.readingBlocked),e.acs.isSharer()!=t.isSharer&&(n.isSharer=!t.isSharer)):(t.isWriter&&(n.isWriter=!1),t.isReader&&(n.isReader=!1),t.readingBlocked||(t.readingBlocked=!0),t.isSharer&&(n.isSharer=!1)),w1(e.acs)==!t.unconformed&&(n.unconfirmed=!t.unconformed),!e.connected&&t.onlineSubs&&t.onlineSubs.length>0&&(n.onlineSubs=[]),n}subscribe(e){if(e.isSubscribed()||!this.props.ready)return;const t=this.props.newTopicParams&&this.props.newTopicParams._topicName==this.props.topic;let n=e.startMetaQuery().withLaterDesc().withLaterSub();(this.state.isReader||t)&&(n=n.withLaterData(24),this.state.isReader&&(n=n.withLaterDel()),this.setState({fetchingMessages:!0}));const r=t?this.props.newTopicParams:void 0;e.subscribe(n.build(),r).then((t=>{if(303==t.code)return void b1.navigateTo(b1.setUrlTopic("",t.params.topic));this.state.topic!=t.topic&&this.setState({topic:t.topic}),this.props.onNewTopicCreated(this.props.topic,t.topic);let n=[];e.queuedMessages((t=>{t._sending||(t.head&&t.head.webrtc?n.push(t.seq):e.isSubscribed()&&this.retrySend(t))})),n.length>0&&e.delMessagesList(n,!0)})).catch((e=>{console.error("Failed subscription to",this.state.topic,e),this.props.onError(e.message,"err");const t=E1.getDerivedStateFromProps({},{});t.title=this.props.intl.formatMessage(x1.not_found),this.setState(t)}))}leave(e){if(!e||!this.props.tinode.isTopicCached(e))return;const t=this.props.tinode.getTopic(e);t&&t.isSubscribed()&&t.leave(!1).catch((()=>{})).finally((()=>{this.setState({fetchingMessages:!1}),t.onData=void 0,t.onAllMessagesReceived=void 0,t.onInfo=void 0,t.onMetaDesc=void 0,t.onSubsUpdated=void 0,t.onPres=void 0}))}handleScrollReference(e){e&&(e.addEventListener("scroll",this.handleScrollEvent),this.messagesScroller=e,this.messagesScroller.scrollTop=this.messagesScroller.scrollHeight-this.state.scrollPosition)}handleScrollEvent(e){const t=e.target.scrollHeight-e.target.scrollTop-e.target.offsetHeight;if(this.setState({scrollPosition:t,showGoToLastButton:t>100&&t<this.state.scrollPosition}),!this.state.fetchingMessages&&e.target.scrollTop<=0){const e=this.props.tinode.getTopic(this.state.topic);e&&e.isSubscribed()&&e.msgHasMoreMessages()&&this.setState({fetchingMessages:!0},(()=>{e.getMessagesPage(24).catch((e=>this.props.onError(e.message,"err"))).finally((()=>this.setState({fetchingMessages:!1})))}))}}goToLatestMessage(){this.setState({scrollPosition:0}),this.messagesScroller&&(this.messagesScroller.scrollTop=this.messagesScroller.scrollHeight)}handleDescChange(e){e.public?this.setState({title:e.public.fn,avatar:Mn(e.public.photo)}):this.setState({title:"",avatar:null}),e.acs&&this.setState({isWriter:e.acs.isWriter(),isReader:e.acs.isReader(),readingBlocked:!e.acs.isReader("given"),unconfirmed:w1(e.acs)})}postReadNotification(e){if(!this.props.applicationVisible)return;this.readNotificationTimer||(this.readNotificationTimer=setInterval((e=>{if(0==this.readNotificationQueue.length)return clearInterval(this.readNotificationTimer),void(this.readNotificationTimer=null);let t=-1;for(;this.readNotificationQueue.length>0;){const e=this.readNotificationQueue[0];if(e.topicName!=this.state.topic){this.readNotificationQueue.shift();continue}const n=new Date;if(!(e.sendAt<=n))break;this.readNotificationQueue.shift(),t=Math.max(t,e.seq)}if(t>=0){const e=this.props.tinode.getTopic(this.state.topic);e&&e.noteRead(t)}}),300));const t=new Date;this.readNotificationQueue.push({topicName:this.state.topic,seq:e,sendAt:t.setMilliseconds(t.getMilliseconds()+1500)})}clearNotificationQueue(){this.readNotificationQueue=[],this.readNotificationTimer&&(clearInterval(this.readNotificationTimer),this.readNotificationTimer=null)}handleSubsUpdated(){if(this.state.topic){const e=[],t=this.props.tinode.getTopic(this.state.topic);t.subscribers((t=>{t.online&&t.user!=this.props.myUserId&&e.push(t)}));const n={onlineSubs:e},r=t.p2pPeerDesc();r?Object.assign(n,{peerMessagingDisabled:T1(r.acs)}):this.state.peerMessagingDisabled&&Object.assign(n,{peerMessagingDisabled:!1}),this.setState(n)}}handleMessageUpdate(e){const t=this.props.tinode.getTopic(this.state.topic);if(!e)return void this.setState({latestClearId:t.maxClearId()});clearTimeout(this.keyPressTimer),this.setState({messageCount:t.messageCount(),typingIndicator:!1},(n=>{t.isNewMessage(e.seq)&&(this.state.scrollPosition>100?this.setState({showGoToLastButton:!0}):this.goToLatestMessage())}));t.msgStatus(e,!0)>=$t.Tinode.MESSAGE_STATUS_SENT&&e.from!=this.props.myUserId&&this.postReadNotification(e.seq)}handleAllMessagesReceived(e){this.setState({fetchingMessages:!1}),e>0&&this.postReadNotification(0)}handleInfoReceipt(e){switch(e.what){case"kp":clearTimeout(this.keyPressTimer),this.keyPressTimer=setTimeout((()=>{this.setState({typingIndicator:!1})}),4e3),this.state.typingIndicator||this.setState({typingIndicator:!0});break;case"read":case"recv":this.forceUpdate();break;default:console.info("Other change in topic: ",e.what)}}handleImagePostview(e){this.setState({imagePostview:e})}handleClosePreview(){this.state.imagePreview&&this.state.imagePreview.url&&URL.revokeObjectURL(this.state.imagePreview.url),this.setState({imagePostview:null,imagePreview:null,docPreview:null})}handleFormResponse(e,t,n){if("pub"==e)this.sendMessage($t.Drafty.attachJSON($t.Drafty.parse(t),n));else if("url"==e){const e=new URL(n.ref),t=e.searchParams;for(let e in n.resp)n.resp.hasOwnProperty(e)&&t.set(e,n.resp[e]);["name","seq"].map((e=>{n[e]&&t.set(e,n[e])})),t.set("uid",this.props.myUserId),t.set("topic",this.state.topic),e.search=t,window.open(e,"_blank")}else console.info("Unknown action in form",e)}handleContextClick(e){e.preventDefault(),e.stopPropagation(),this.props.showContextMenu({topicName:this.state.topic,y:e.pageY,x:e.pageX})}handleShowMessageContextMenu(e,t){"chan"==e.userFrom&&(e.userFrom=this.state.topic,e.userName=this.state.title),e.topicName=this.state.topic;const n=t||[],r=this.props.tinode.getTopic(e.topicName);if(r){r.isChannelType()||n.push("message_delete");const e=r.getAccessMode();e&&e.isDeleter()&&n.push("message_delete_hard")}this.props.showContextMenu(e,n)}handleNewChatAcceptance(e){this.props.onNewChat(this.state.topic,e)}handleEnablePeer(e){e.preventDefault(),this.props.onChangePermissions(this.state.topic,tn,this.state.topic)}sendKeyPress(){const e=this.props.tinode.getTopic(this.state.topic);e.isSubscribed()&&e.noteKeyPress()}sendMessage(e,t,n){let r;this.props.forwardMessage?(e=this.props.forwardMessage.msg,r=this.props.forwardMessage.head,this.handleCancelReply()):this.state.reply&&this.state.reply.content&&(r={reply:""+this.state.reply.seq},"string"==typeof e&&(e=$t.Drafty.parse(e)),e=$t.Drafty.append($t.Drafty.sanitizeEntities(this.state.reply.content),e),this.handleCancelReply()),this.props.sendMessage(e,t,n,r)}retrySend(e){this.props.sendMessage(e.content,void 0,void 0,e.head).then((()=>{this.props.tinode.getTopic(this.state.topic).delMessagesList([e.seq],!0)}))}sendFileAttachment(e){const t=.75*this.props.tinode.getServerParam("maxMessageSize",an)-1024|0;if(e.size>t){const t=this.props.tinode.getLargeFileHelper();if(!t)return void this.props.onError(this.props.intl.formatMessage(x1.cannot_initiate_upload));const n=t.upload(e),r=$t.Drafty.attachFile(null,{mime:e.type,filename:e.name,size:e.size,urlPromise:n});this.sendMessage(r,n,t)}else(function(e){return new Promise(((t,n)=>{const r=new FileReader;r.onerror=e=>{n(r.error)},r.onload=()=>{t({mime:e.type,bits:r.result.split(",")[1],name:e.name})},r.readAsDataURL(e)}))})(e).then((e=>this.sendMessage($t.Drafty.attachFile(null,{mime:e.mime,data:e.bits,filename:e.name})))).catch((e=>this.props.onError(e)))}handleAttachFile(e){const t=this.props.tinode.getServerParam("maxFileUploadSize",on);e.size>t?this.props.onError(this.props.intl.formatMessage(x1.file_attachment_too_large,{size:gn(e.size),limit:gn(t)}),"err"):this.setState({docPreview:{file:e,name:e.name,size:e.size,type:e.type}})}handleCallHangup(e,t){this.props.onVideoCallClosed(),this.setState({rtcPanel:null}),this.props.onCallHangup(e,t)}sendImageAttachment(e,t){const n=this.state.imagePreview.mime,r=this.state.imagePreview.width,a=this.state.imagePreview.height,i=this.state.imagePreview.name,o=.75*this.props.tinode.getServerParam("maxMessageSize",an)-1024|0;if(t.size>o){const o=this.props.tinode.getLargeFileHelper();if(!o)return void this.props.onError(this.props.intl.formatMessage(x1.cannot_initiate_upload));const s=o.upload(t);In(t,64,64,-1,!1).then((e=>Pn(e.blob))).then((l=>{let c=$t.Drafty.insertImage(null,0,{mime:n,_tempPreview:l.bits,width:r,height:a,filename:i,size:t.size,urlPromise:s});e&&(c=$t.Drafty.appendLineBreak(c),c=$t.Drafty.append(c,$t.Drafty.parse(e))),this.sendMessage(c,s,o)})).catch((e=>{this.props.onError(e,"err")}))}else Pn(t).then((n=>{let o=$t.Drafty.insertImage(null,0,{mime:n.mime,preview:n.bits,width:r,height:a,filename:i,size:t.size});e&&(o=$t.Drafty.appendLineBreak(o),o=$t.Drafty.append(o,$t.Drafty.parse(e))),this.sendMessage(o)}))}handleAttachImage(e){In(e,1024,1024,this.props.tinode.getServerParam("maxFileUploadSize",on),!1).then((e=>{this.setState({imagePreview:{url:URL.createObjectURL(e.blob),blob:e.blob,name:e.name,width:e.width,height:e.height,size:e.blob.size,mime:e.mime}})})).catch((e=>{this.props.onError(e,"err")}))}sendAudioAttachment(e,t,n){fetch(e).then((e=>e.blob())).then((e=>{const r=.75*this.props.tinode.getServerParam("maxMessageSize",an)-1024;if(e.size>r){const r=this.props.tinode.getLargeFileHelper();if(!r)return void this.props.onError(this.props.intl.formatMessage(x1.cannot_initiate_upload));const a=r.upload(e),i=$t.Drafty.appendAudio(null,{mime:e.type,size:e.size,duration:n,preview:t,urlPromise:a});this.sendMessage(i,a,r)}else Pn(e).then((r=>{this.sendMessage($t.Drafty.appendAudio(null,{mime:r.mime,size:e.size,data:r.bits,duration:n,preview:t}))}))})).catch((e=>{this.props.onError(e)}))}handleCancelUpload(e,t){const n=this.props.tinode.getTopic(this.state.topic).findMessage(e);n&&(n._cancelled=!0),t.cancel()}handlePickReply(e,t,n,r){this.setState({reply:null}),e&&t&&(t="string"==typeof t?$t.Drafty.init(t):t,t=$t.Drafty.isValid(t)?$t.Drafty.replyContent(t,30):$t.Drafty.append($t.Drafty.init("⚠ "),$t.Drafty.wrapInto(this.props.intl.formatMessage(x1.invalid_content),"EM")),this.setState({reply:{content:$t.Drafty.quote(r,n,t),seq:e}}),this.props.onCancelForwardMessage())}handleCancelReply(){this.setState({reply:null}),this.props.onCancelForwardMessage()}handleQuoteClick(e){const t=this.getOrCreateMessageRef(e);t&&t.current?(t.current.scrollIntoView({block:"center",behavior:"smooth"}),t.current.classList.add("flash"),setTimeout((()=>{t.current.classList.remove("flash")}),1e3)):console.error("Unresolved message ref",e)}render(){const{formatMessage:e}=this.props.intl;let n;if(this.props.hideSelf)n=null;else if(this.state.topic){let r;if(this.state.imagePreview)r=t().createElement(g1,{content:this.state.imagePreview,tinode:this.props.tinode,reply:this.state.reply,onCancelReply:this.handleCancelReply,onClose:this.handleClosePreview,onSendMessage:this.sendImageAttachment});else if(this.state.imagePostview)r=t().createElement(g1,{content:this.state.imagePostview,onClose:this.handleClosePreview});else if(this.state.docPreview)r=t().createElement(m1,{content:this.state.docPreview,tinode:this.props.tinode,reply:this.state.reply,onCancelReply:this.handleCancelReply,onClose:this.handleClosePreview,onSendMessage:this.sendFileAttachment});else if(this.state.rtcPanel)r=t().createElement(Gr,{topic:this.state.topic,seq:this.props.callSeq,callState:this.props.callState,tinode:this.props.tinode,title:this.state.title,avatar:this.state.avatar||!0,onError:this.props.onError,onHangup:this.handleCallHangup,onInvite:this.props.onCallInvite,onSendOffer:this.props.onCallSendOffer,onIceCandidate:this.props.onCallIceCandidate,onSendAnswer:this.props.onCallSendAnswer});else{const n=this.props.tinode.getTopic(this.state.topic),a=n.isChannelType(),o=n.isGroupType()&&!a,s=[];n.trusted&&(n.trusted.verified&&s.push({icon:"verified",color:"badge-inv"}),n.trusted.staff&&s.push({icon:"staff",color:"badge-inv"}),n.trusted.danger&&s.push({icon:"dangerous",color:"badge-inv"}));const l=[];let c=null,u=null,h=null;const d=new Intl.DateTimeFormat(this.props.intl.locale);n.messages(((e,r,a,i)=>{let s=a?a.from||"chan":null,p="single",m=e.from||"chan";m==c?p=m==s?"middle":"last":m==s&&(p="first"),c=m;const _=!(m==this.props.myUserId),g=n.msgStatus(e,!0);let f,y,v=m;const b=n.userDesc(m);b&&b.public&&(f=b.public.fn,y=Mn(b.public.photo)),h=o?"chat-box group":"chat-box";const x=this.getOrCreateMessageRef(e.seq);let w=e.head?parseInt(e.head.reply):null;if(w&&!isNaN(w)||(w=null),e.hi)l.push(t().createElement(v1,{deleted:!0,key:e.seq}));else{const n=new Date(e.ts);u&&u.toDateString()==n.toDateString()||(l.push(t().createElement(v1,{date:d.format(e.ts),locale:this.props.intl.locale,key:"date-"+e.seq})),u=n),l.push(t().createElement(i1,{tinode:this.props.tinode,content:e.content,mimeType:e.head&&e.head.mime,timestamp:e.ts,response:_,seq:e.seq,isGroup:o,isChan:this.state.channel,userFrom:v,userName:f,userAvatar:y,sequence:p,received:g,uploader:e._uploader,viewportWidth:this.props.viewportWidth,showContextMenu:this.handleShowMessageContextMenu,onImagePreview:this.handleImagePostview,onFormResponse:this.handleFormResponse,onError:this.props.onError,onCancelUpload:this.handleCancelUpload,pickReply:this.handlePickReply,replyToSeq:w,onQuoteClick:this.handleQuoteClick,ref:x,userIsWriter:this.state.isWriter,key:e.seq}))}}));let p=null;if(a)p=e(x1.channel);else{const t=this.props.tinode.getMeTopic().getContact(this.state.topic);t&&$t.Tinode.isP2PTopicName(t.topic)&&(t.online?p=e(x1.online_now):t.seen&&(p=e(x1.last_seen)+": "+function(e,t){t=t||window.navigator.userLanguage||window.navigator.language;const n=new Date;return e.getFullYear()==n.getFullYear()?e.getMonth()==n.getMonth()&&e.getDate()==n.getDate()?e.toLocaleTimeString(t,{hour12:!1,hour:"2-digit",minute:"2-digit"}):e.toLocaleDateString(t,{hour12:!1,month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):e.toLocaleDateString(t,{year:"numeric",month:"short",day:"numeric"})}(t.seen.when,this.props.intl.locale)))}const m=this.state.avatar||!0,_=this.state.deleted?null:this.props.online?"online"+(this.state.typingIndicator?" typing":""):"offline",g="panel-title"+(this.state.deleted?" deleted":"");r=t().createElement(t().Fragment,null,t().createElement("div",{id:"topic-caption-panel",className:"caption-panel"},this.props.displayMobile?t().createElement("a",{href:"#",id:"hide-message-view",onClick:e=>{e.preventDefault(),this.props.onHideMessagesView()}},t().createElement("i",{className:"material-icons"},"arrow_back")):null,t().createElement("div",{className:"avatar-box"},t().createElement(Sn,{tinode:this.props.tinode,avatar:m,topic:this.state.topic,title:this.state.title,deleted:this.state.deleted}),a?null:t().createElement("span",{className:_})),t().createElement("div",{id:"topic-title-group"},t().createElement("div",{id:"topic-title",className:g},this.state.title||t().createElement("i",null,t().createElement(i.FormattedMessage,{id:"unnamed_topic",defaultMessage:[{type:0,value:"Unnamed"}]})),t().createElement(mn,{badges:s})),t().createElement("div",{id:"topic-last-seen"},p)),o?t().createElement(_1,{tinode:this.props.tinode,subscribers:this.state.onlineSubs}):t().createElement("div",{id:"topic-users"}),t().createElement("div",null,t().createElement("a",{href:"#",onClick:this.handleContextClick},t().createElement("i",{className:"material-icons"},"more_vert")))),this.props.displayMobile?t().createElement(vr,{level:this.props.errorLevel,text:this.props.errorText,onClearError:this.props.onError}):null,t().createElement(_r,{show:this.state.fetchingMessages}),t().createElement("div",{id:"messages-container"},t().createElement("button",{className:"action-button"+(this.state.showGoToLastButton?"":" hidden"),onClick:this.goToLatestMessage},t().createElement("i",{className:"material-icons"},"arrow_downward")),t().createElement("div",{id:"messages-panel",ref:this.handleScrollReference},t().createElement("ul",{id:"scroller",className:h},l)),this.state.isReader?null:t().createElement("div",{id:"write-only-background"},this.state.readingBlocked?t().createElement("div",{id:"write-only-note"},t().createElement(i.FormattedMessage,{id:"messages_not_readable",defaultMessage:[{type:0,value:"no access to messages"}]})):null)),this.state.peerMessagingDisabled&&!this.state.unconfirmed?t().createElement("div",{id:"peer-messaging-disabled-note"},t().createElement("i",{className:"material-icons secondary"},"block")," ",t().createElement(i.FormattedMessage,{id:"peers_messaging_disabled",defaultMessage:[{type:0,value:"Peer's messaging is disabled."}]})," ",t().createElement("a",{href:"#",onClick:this.handleEnablePeer},t().createElement(i.FormattedMessage,{id:"enable_peers_messaging",defaultMessage:[{type:0,value:"Enable"}]})),"."):null,this.state.unconfirmed?t().createElement(f1,{onAction:this.handleNewChatAcceptance}):t().createElement(p1,{tinode:this.props.tinode,topicName:this.state.topic,noInput:!!this.props.forwardMessage,disabled:!this.state.isWriter||this.state.deleted,onKeyPress:this.sendKeyPress,onSendMessage:this.sendMessage,onAttachFile:this.props.forwardMessage?null:this.handleAttachFile,onAttachImage:this.props.forwardMessage?null:this.handleAttachImage,onAttachAudio:this.props.forwardMessage?null:this.sendAudioAttachment,onError:this.props.onError,reply:this.state.reply,onQuoteClick:this.handleQuoteClick,onCancelReply:this.handleCancelReply}))}n=t().createElement("div",{id:"topic-view"},r)}else n=t().createElement(y1,{serverVersion:this.props.serverVersion,serverAddress:this.props.serverAddress});return n}}const A1=(0,i.injectIntl)(E1);class S1 extends t().PureComponent{render(){return t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.props.onBack()}},t().createElement("i",{className:"material-icons"},"arrow_back"))}}class D1 extends t().PureComponent{render(){return t().createElement("div",null,t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.props.onNewTopic()}},t().createElement("i",{className:"material-icons"},"chat"))," ",t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.props.onSettings()}},t().createElement("i",{className:"material-icons"},"settings")))}}class R1 extends t().PureComponent{render(){return t().createElement("div",null,t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.props.onSignUp()}},t().createElement("i",{className:"material-icons"},"person_add"))," ",t().createElement("a",{href:"#",onClick:e=>{e.preventDefault(),this.props.onSettings()}},t().createElement("i",{className:"material-icons"},"settings")))}}class N1 extends t().PureComponent{render(){const e=[];this.props.trustedBadges&&this.props.trustedBadges.map((t=>{e.push({icon:t,color:"badge-inv"})}));let n=null;return this.props.tinode&&(n=this.props.tinode.authorizeURL(Tn(this.props.avatar,"image"))),t().createElement("div",{id:"side-caption-panel",className:"caption-panel"},this.props.onCancel?t().createElement(S1,{onBack:this.props.onCancel}):null,n?t().createElement("div",{id:"self-avatar",className:"avatar-box"},t().createElement(Sn,{tinode:this.props.tinode,avatar:n,topic:this.props.myUserId,title:this.props.title})):null,t().createElement("div",{id:"sidepanel-title",className:"panel-title"},this.props.title,t().createElement(mn,{badges:e})),"login"===this.props.state?t().createElement(R1,{onSignUp:this.props.onSignUp,onSettings:this.props.onSettings}):"contacts"===this.props.state?t().createElement(D1,{onNewTopic:this.props.onNewTopic,onSettings:this.props.onSettings}):null)}}function M1(e,t){return e&&e.substring(0,t)}class O1 extends t().Component{constructor(e){super(e);const t=this.props.tinode.getMeTopic();this.state={fullName:M1(t.public?t.public.fn:void 0,ln),description:M1(t.public?t.public.note:void 0,cn),avatar:Mn(t.public?t.public.photo:null)}}render(){return t().createElement("div",{className:"scrollable-panel"},t().createElement("div",{className:"panel-form-column"},t().createElement("a",{href:"#",className:"flat-button float-right",onClick:e=>{e.preventDefault(),this.props.onNavigate("general")}},t().createElement("i",{className:"material-icons"},"edit")," ",t().createElement(i.FormattedMessage,{id:"button_edit",defaultMessage:[{type:0,value:"Edit"}]})),t().createElement("center",null,t().createElement(gr,{tinode:this.props.tinode,avatar:this.state.avatar,readOnly:!0,uid:this.props.myUserId,title:this.state.fullName})),t().createElement("div",{className:"group"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_your_name",defaultMessage:[{type:0,value:"Your name"}]})),t().createElement("div",{className:"large ellipsized"},this.state.fullName)),t().createElement("div",{className:"group"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_user_id",defaultMessage:[{type:0,value:"ID:"}]}))," ",t().createElement("tt",null,this.props.myUserId)),t().createElement("div",{className:"group"},t().createElement(hr,{trustedBadges:this.props.trustedBadges})),this.state.description?t().createElement("div",{className:"group"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_description",defaultMessage:[{type:0,value:"Description"}]})),t().createElement("div",null,this.state.description)):null),t().createElement("div",{className:"hr"}),t().createElement("div",{className:"panel-form-column"},t().createElement("a",{href:"#",className:"flat-button",onClick:e=>{e.preventDefault(),this.props.onNavigate("notif")}},t().createElement("i",{className:"material-icons"},"notifications")," ",t().createElement(i.FormattedMessage,{id:"sidepanel_title_acc_notifications",defaultMessage:[{type:0,value:"Notifications"}]})),t().createElement("a",{href:"#",className:"flat-button",onClick:e=>{e.preventDefault(),this.props.onNavigate("security")}},t().createElement("i",{className:"material-icons"},"security")," ",t().createElement(i.FormattedMessage,{id:"button_security",defaultMessage:[{type:0,value:"Security"}]})),t().createElement("a",{href:"#",className:"flat-button",onClick:e=>{e.preventDefault(),this.props.onNavigate("support")}},t().createElement("i",{className:"material-icons"},"contact_support")," ",t().createElement(i.FormattedMessage,{id:"sidepanel_title_acc_support",defaultMessage:[{type:0,value:"Support"}]}))))}}const k1=(0,i.defineMessages)({archived_contacts_title:{id:"archived_contacts",defaultMessage:[{type:0,value:"Archived contacts ("},{type:1,value:"count"},{type:0,value:")"}]}});class I1 extends t().Component{constructor(e){super(e),this.handleAction=this.handleAction.bind(this),this.state=I1.deriveStateFromProps(e)}static deriveStateFromProps(e){const t=[];let n=0,r=0;return e.chatList.map((a=>{const i=a.acs&&!a.acs.isJoiner();i&&e.blocked&&t.push(a),i||e.blocked||(a.private&&a.private.arch?e.archive?t.push(a):r++:e.archive||(t.push(a),n+=a.unread>0?1:0))})),t.sort(((e,t)=>(t.touched||0)-(e.touched||0))),r>0&&t.push({action:"archive",title:k1.archived_contacts_title,values:{count:r}}),{contactList:t,unreadThreads:n}}componentDidUpdate(e,t){if(e.chatList!=this.props.chatList||e.archive!=this.props.archive||e.blocked!=this.props.blocked){const e=I1.deriveStateFromProps(this.props);this.setState(e),e.unreadThreads!=t.unreadThreads&&vn(e.unreadThreads)}}handleAction(e){this.props.onShowArchive()}render(){return t().createElement(i.FormattedMessage,{id:"contacts_not_found",defaultMessage:[{type:0,value:"You have no chats"},{type:0,value:"<br/>"},{type:0,value:"¯∖_(ツ)_/¯"}]},(e=>t().createElement(ir,{tinode:this.props.tinode,connected:this.props.connected,contacts:this.state.contactList,emptyListMessage:e,topicSelected:this.props.topicSelected,myUserId:this.props.myUserId,showOnline:!0,showUnread:!0,onTopicSelected:this.props.onTopicSelected,showContextMenu:this.props.showContextMenu,onAction:this.handleAction})))}}class P1{static setObject(e,t){localStorage.setItem(e,JSON.stringify(t))}static getObject(e){const t=localStorage.getItem(e);return t&&JSON.parse(t)}static updateObject(e,t){const n=this.getObject(e);this.setObject(e,Object.assign(n||{},t))}static removeItem(e){localStorage.removeItem(e)}}class L1 extends t().PureComponent{constructor(e){super(e),this.state={login:"",password:"",email:"",fn:"",imageUrl:null,uploadUrl:null,newAvatar:null,newAvatarMime:null,errorCleared:!1,buttonDisabled:!1,saveToken:P1.getObject("keep-logged-in")},this.handleLoginChange=this.handleLoginChange.bind(this),this.handlePasswordChange=this.handlePasswordChange.bind(this),this.handleEmailChange=this.handleEmailChange.bind(this),this.handleFnChange=this.handleFnChange.bind(this),this.handleImageChanged=this.handleImageChanged.bind(this),this.handleToggleSaveToken=this.handleToggleSaveToken.bind(this),this.handleAvatarCropped=this.handleAvatarCropped.bind(this),this.handleAvatarCropCancel=this.handleAvatarCropCancel.bind(this),this.uploadAvatar=this.uploadAvatar.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}handleLoginChange(e){this.setState({login:e.target.value})}handlePasswordChange(e){this.setState({password:e})}handleEmailChange(e){this.setState({email:e.target.value})}handleFnChange(e){this.setState({fn:e.target.value})}handleImageChanged(e,t){this.setState({newAvatar:t,newAvatarMime:e})}handleToggleSaveToken(){P1.setObject("keep-logged-in",!this.state.saveToken),this.setState({saveToken:!this.state.saveToken})}handleSubmit(e){e.preventDefault(),this.setState({errorCleared:!1}),this.props.onCreateAccount(this.state.login.trim(),this.state.password.trim(),bn(this.state.fn.trim().substring(0,ln),this.state.uploadUrl),{meth:"email",val:this.state.email})}handleAvatarCropped(e,t,n,r){const a=t?URL.createObjectURL(t):null;this.setState({avatar:a,newAvatar:null,newAvatarMime:null}),t&&this.uploadAvatar(e,t,n,r)}handleAvatarCropCancel(){this.setState({newAvatar:null,newAvatarMime:null})}uploadAvatar(e,t,n,r){const a=e=>{let{mime:t,blob:n}=e;if(this.setState({imageUrl:URL.createObjectURL(n),buttonDisabled:!0}),n.size>4096){this.props.tinode.getLargeFileHelper().upload(n,"newacc").then((e=>this.setState({uploadUrl:e}))).catch((e=>this.props.onError(e.message,"err"))).finally((e=>this.setState({buttonDisabled:!1})))}else Pn(n).then((e=>this.setState({uploadUrl:Mn({data:e.bits,type:t})}))).finally((e=>this.setState({buttonDisabled:!1})))};n>rn||r>rn||n!=r?In(t,rn,rn,on,!0).then((e=>a(e))).catch((e=>this.props.onError(e.message,"err"))):a({mime:e,blob:t,width:n,height:r})}render(){if(this.state.newAvatar)return t().createElement(Rr,{avatar:this.state.newAvatar,mime:this.state.newAvatarMime,onSubmit:this.handleAvatarCropped,onCancel:this.handleAvatarCropCancel,onError:this.props.onError});let e="primary";return this.props.disabled&&(e+=" disabled"),t().createElement("form",{className:"panel-form-column",onSubmit:this.handleSubmit},t().createElement("div",{className:"panel-form-row"},t().createElement("div",{className:"panel-form-column"},t().createElement(i.FormattedMessage,{id:"login_prompt",defaultMessage:[{type:0,value:"Login"}]},(e=>t().createElement("input",{type:"text",placeholder:e,autoComplete:"user-name",value:this.state.login,onChange:this.handleLoginChange,required:!0,autoFocus:!0}))),t().createElement(i.FormattedMessage,{id:"password_prompt",defaultMessage:[{type:0,value:"Password"}]},(e=>t().createElement(Nr,{placeholder:e,autoComplete:"new-password",value:this.state.password,onFinished:this.handlePasswordChange,required:!0})))),t().createElement(gr,{tinode:this.props.tinode,avatar:this.state.imageUrl,onImageUpdated:this.handleImageChanged,onError:this.props.onError})),t().createElement("div",{className:"panel-form-row"},t().createElement(i.FormattedMessage,{id:"full_name_prompt",defaultMessage:[{type:0,value:"Full name, e.g. John Doe"}]},(e=>t().createElement("input",{type:"text",placeholder:e,autoComplete:"name",value:this.state.fn,onChange:this.handleFnChange,required:!0})))),t().createElement("div",{className:"panel-form-row"},t().createElement(i.FormattedMessage,{id:"email_prompt",defaultMessage:[{type:0,value:"Email, e.g. jdoe@example.com"}]},(e=>t().createElement("input",{type:"email",placeholder:e,autoComplete:"email",value:this.state.email,onChange:this.handleEmailChange,required:!0})))),t().createElement("div",{className:"panel-form-row"},t().createElement(fr,{id:"save-token",name:"save-token",checked:this.state.saveToken,onChange:this.handleToggleSaveToken}),t().createElement(i.FormattedMessage,{id:"stay_logged_in",defaultMessage:[{type:0,value:"Stay logged in"}]},(e=>t().createElement("label",{htmlFor:"save-token"}," ",e)))),t().createElement("div",{className:"dialog-buttons"},t().createElement("button",{className:e,type:"submit",disabled:this.state.buttonDisabled},t().createElement(i.FormattedMessage,{id:"button_sign_up",defaultMessage:[{type:0,value:"Sign up"}]}))))}}class B1 extends t().PureComponent{constructor(e){super(e),this.handleCheckboxClick=this.handleCheckboxClick.bind(this)}handleCheckboxClick(e,t){"sound"==e?this.props.onToggleMessageSounds(t):"alert"==e?this.props.onTogglePushNotifications(t):"incognito"==e&&this.props.onToggleIncognitoMode(t)}render(){return t().createElement("div",{className:"scrollable-panel"},t().createElement("div",{className:"panel-form-row"},t().createElement("label",{htmlFor:"message-sound"},t().createElement(i.FormattedMessage,{id:"label_message_sound",defaultMessage:[{type:0,value:"Message sound:"}]})),t().createElement(fr,{name:"sound",id:"message-sound",checked:this.props.messageSounds,onChange:this.handleCheckboxClick})),t().createElement("div",{className:"panel-form-row"},t().createElement("label",{htmlFor:"desktop-alerts"},this.props.desktopAlertsEnabled?t().createElement(i.FormattedMessage,{id:"label_push_notifications",defaultMessage:[{type:0,value:"Notification alerts:"}]}):t().createElement(i.FormattedMessage,{id:"label_push_notifications_disabled",defaultMessage:[{type:0,value:"Notification alerts (requires HTTPS):"}]})),t().createElement(fr,{name:"alert",id:"desktop-alerts",checked:this.props.desktopAlerts,onChange:this.props.desktopAlertsEnabled?this.handleCheckboxClick:null})),t().createElement("div",{className:"panel-form-row"},t().createElement("label",{htmlFor:"incognito-mode"},t().createElement(i.FormattedMessage,{id:"label_incognito_mode",defaultMessage:[{type:0,value:"Incognito mode:"}]})),t().createElement(fr,{name:"incognito",id:"incognito-mode",checked:this.props.incognitoMode,onChange:this.handleCheckboxClick})))}}const F1=(0,i.defineMessages)({delete_account:{id:"delete_account",defaultMessage:[{type:0,value:"Delete account"}]},delete_account_warning:{id:"delete_account_warning",defaultMessage:[{type:0,value:"Are you sure you want to delete your account? It cannot be undone."}]}});class H1 extends t().Component{constructor(e){super(e);const t=this.props.tinode.getMeTopic();let n=0;t.contacts((e=>{e.acs&&!e.acs.isJoiner()&&n++}));const r=t.getDefaultAccess();this.state={auth:r?r.auth:null,anon:r?r.anon:null,showPermissionEditorFor:void 0,blockedCount:n},this.handlePasswordUpdate=this.handlePasswordUpdate.bind(this),this.handleLaunchPermissionsEditor=this.handleLaunchPermissionsEditor.bind(this),this.handleHidePermissionsEditor=this.handleHidePermissionsEditor.bind(this),this.handlePermissionsChanged=this.handlePermissionsChanged.bind(this),this.handleDeleteAccount=this.handleDeleteAccount.bind(this)}handlePasswordUpdate(e){this.setState({password:e}),this.props.onUpdatePassword(e)}handleLaunchPermissionsEditor(e){this.setState({showPermissionEditorFor:e,editedPermissions:this.state[e]})}handleHidePermissionsEditor(){this.setState({showPermissionEditorFor:void 0})}handlePermissionsChanged(e){let t={};t[this.state.showPermissionEditorFor]=e,this.props.onUpdateAccountDesc("me",void 0,void 0,t);let n={showPermissionEditorFor:void 0};n[this.state.showPermissionEditorFor]=e,this.setState(n)}handleDeleteAccount(e){e.preventDefault();const{formatMessage:t}=this.props.intl;this.props.onShowAlert(t(F1.delete_account),t(F1.delete_account_warning),(()=>{this.props.onDeleteAccount()}),null,!0,null)}render(){return t().createElement(t().Fragment,null,this.state.showPermissionEditorFor?t().createElement(Sr,{mode:this.state.editedPermissions,skip:"O",onSubmit:this.handlePermissionsChanged,onCancel:this.handleHidePermissionsEditor}):t().createElement("div",{className:"scrollable-panel"},t().createElement("div",{className:"panel-form-column"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_password",defaultMessage:[{type:0,value:"Password"}]})),t().createElement("div",null,t().createElement(i.FormattedMessage,{id:"password_unchanged_prompt",defaultMessage:[{type:0,value:"Unchanged"}]},(e=>t().createElement(Mr,{placeholder:e,type:"password",onFinished:this.handlePasswordUpdate}))))),t().createElement("div",{className:"hr"}),t().createElement("div",{className:"panel-form-column"},t().createElement("a",{href:"#",className:"danger flat-button",onClick:e=>{e.preventDefault(),this.props.onLogout()}},t().createElement("i",{className:"material-icons"},"exit_to_app"),"  ",t().createElement(i.FormattedMessage,{id:"button_logout",defaultMessage:[{type:0,value:"Logout"}]})),t().createElement("a",{href:"#",className:"danger flat-button",onClick:e=>{this.handleDeleteAccount(e)}},t().createElement("i",{className:"material-icons"},"delete"),"  ",t().createElement(i.FormattedMessage,{id:"button_delete_account",defaultMessage:[{type:0,value:"Delete account"}]}))),t().createElement("div",{className:"hr"}),t().createElement("div",{className:"panel-form-column"},t().createElement("div",null,t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_default_access_mode",defaultMessage:[{type:0,value:"Default access mode:"}]}))),t().createElement("div",{className:"quoted"},t().createElement("div",null,"Auth: ",t().createElement("tt",{className:"clickable",onClick:this.handleLaunchPermissionsEditor.bind(this,"auth")},this.state.auth)),t().createElement("div",null,"Anon: ",t().createElement("tt",{className:"clickable",onClick:this.handleLaunchPermissionsEditor.bind(this,"anon")},this.state.anon)))),this.state.blockedCount>0?t().createElement(t().Fragment,null,t().createElement("div",{className:"hr"}),t().createElement("div",{className:"panel-form-row"},t().createElement("i",{className:"material-icons"},"block")," ",t().createElement("a",{href:"#",className:"gray",onClick:e=>{e.preventDefault(),this.props.onShowBlocked()}},t().createElement(i.FormattedMessage,{id:"blocked_contacts_link",defaultMessage:[{type:0,value:"Blocked contacts ("},{type:1,value:"count"},{type:0,value:")"}],values:{count:this.state.blockedCount}})))):null))}}const q1=(0,i.injectIntl)(H1);class U1 extends t().PureComponent{render(){return t().createElement("div",{className:"scrollable-panel"},t().createElement("div",{className:"panel-form-column"},t().createElement("a",{href:"mailto:support@tinode.co",className:"flat-button",target:"_blank"},t().createElement("i",{className:"material-icons"},"email"),"  ",t().createElement(i.FormattedMessage,{id:"link_contact_us",defaultMessage:[{type:0,value:"Contact Us"}]})),t().createElement("a",{href:"https://tinode.co/terms.html",className:"flat-button",target:"_blank"},t().createElement("i",{className:"material-icons"},"description"),"  ",t().createElement(i.FormattedMessage,{id:"link_terms_of_service",defaultMessage:[{type:0,value:"Terms of Service"}]})),t().createElement("a",{href:"https://tinode.co/privacy.html",className:"flat-button",target:"_blank"},t().createElement("i",{className:"material-icons"},"policy"),"  ",t().createElement(i.FormattedMessage,{id:"link_privacy_policy",defaultMessage:[{type:0,value:"Privacy Policy"}]}))),t().createElement("div",{className:"hr"}),t().createElement("div",{className:"panel-form-column"},t().createElement("div",{className:"panel-form-row"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_client",defaultMessage:[{type:0,value:"Client:"}]})),Zt),t().createElement("div",{className:"panel-form-row"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_sdk",defaultMessage:[{type:0,value:"SDK:"}]})),$t.Tinode.getLibrary()),t().createElement("div",{className:"panel-form-row"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_server",defaultMessage:[{type:0,value:"Server:"}]})),this.props.serverVersion),t().createElement("div",{className:"panel-form-row"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_server_address",defaultMessage:[{type:0,value:"Server address:"}]})),this.props.serverAddress)))}}class V1 extends t().Component{constructor(e){super(e),this.state={login:e.login,password:"",hostName:e.serverAddress,saveToken:e.persist},this.handleLoginChange=this.handleLoginChange.bind(this),this.handlePasswordChange=this.handlePasswordChange.bind(this),this.handleToggleSaveToken=this.handleToggleSaveToken.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}handleLoginChange(e){this.setState({login:e.target.value})}handlePasswordChange(e){this.setState({password:e.target.value})}handleToggleSaveToken(){this.props.onPersistenceChange(!this.state.saveToken),this.setState({saveToken:!this.state.saveToken})}handleSubmit(e){e.preventDefault(),this.props.onLogin(this.state.login.trim(),this.state.password.trim())}render(){let e="primary";return this.props.disabled&&(e+=" disabled"),t().createElement("form",{id:"login-form",onSubmit:this.handleSubmit},t().createElement(i.FormattedMessage,{id:"login_prompt",defaultMessage:[{type:0,value:"Login"}]},(e=>t().createElement("input",{type:"text",id:"inputLogin",placeholder:e,autoComplete:"username",autoCorrect:"off",autoCapitalize:"none",value:this.state.login,onChange:this.handleLoginChange,required:!0,autoFocus:!0}))),t().createElement(i.FormattedMessage,{id:"password_prompt",defaultMessage:[{type:0,value:"Password"}]},(e=>t().createElement(Nr,{type:"password",id:"inputPassword",placeholder:e,autoComplete:"current-password",value:this.state.password,onChange:this.handlePasswordChange,required:!0}))),t().createElement("div",{className:"panel-form-row"},t().createElement(fr,{id:"save-token",name:"save-token",checked:this.state.saveToken,onChange:this.handleToggleSaveToken}),t().createElement("label",{htmlFor:"save-token"}," ",t().createElement(i.FormattedMessage,{id:"stay_logged_in",defaultMessage:[{type:0,value:"Stay logged in"}]})),t().createElement("a",{href:"#reset"},t().createElement(i.FormattedMessage,{id:"forgot_password_link",defaultMessage:[{type:0,value:"Forgot password?"}]}))),t().createElement("div",{className:"dialog-buttons"},t().createElement("button",{className:e,type:"submit"},t().createElement(i.FormattedMessage,{id:"button_sign_in",defaultMessage:[{type:0,value:"Sign in"}]}))))}}const W1=(0,i.defineMessages)({invalid_id:{id:"error_invalid_id",defaultMessage:[{type:0,value:"Invalid ID"}]}});class z1 extends t().PureComponent{constructor(e){super(e),this.state={groupId:""},this.handleChange=this.handleChange.bind(this),this.handleKeyPress=this.handleKeyPress.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}handleChange(e){this.setState({groupId:e.target.value})}handleKeyPress(e){"Enter"===e.key&&this.handleSubmit(e)}handleSubmit(e){if(e.preventDefault(),this.state.groupId){const e=this.state.groupId.trim(),t=e.substr(0,3);e.length>3&&["usr","grp","chn"].includes(t)?this.props.onSubmit(e):this.props.onError(this.props.intl.formatMessage(W1.invalid_id),"err")}}render(){return t().createElement("div",{className:"panel-form"},t().createElement("div",{className:"panel-form-row"},t().createElement(i.FormattedMessage,{id:"group_user_id_prompt",defaultMessage:[{type:0,value:"Group or User ID"}]},(e=>t().createElement("input",{type:"text",placeholder:e,value:this.state.groupId,onChange:this.handleChange,onKeyPress:this.handleKeyPress,required:!0,autoFocus:!0})))),t().createElement("div",{className:"dialog-buttons"},t().createElement("button",{className:"primary",onClick:this.handleSubmit},t().createElement(i.FormattedMessage,{id:"button_subscribe",defaultMessage:[{type:0,value:"Subscribe"}]}))))}}const Y1=(0,i.injectIntl)(z1);class G1 extends t().PureComponent{constructor(e){super(e),this.fullName=t().createRef(),this.state={fullName:"",private:"",description:"",imageDataUrl:null,tags:[],isChannel:!1},this.handleFieldEdit=this.handleFieldEdit.bind(this),this.handleImageChanged=this.handleImageChanged.bind(this),this.handleTagsChanged=this.handleTagsChanged.bind(this),this.handleChannelToggle=this.handleChannelToggle.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}componentDidMount(){}handleFieldEdit(e,t){this.setState({[e]:t.target.value||""})}handleImageChanged(e,t){this.setState({imageDataUrl:t})}handleTagsChanged(e){this.setState({tags:e})}handleChannelToggle(){this.setState({isChannel:!this.state.isChannel})}handleSubmit(e){e.preventDefault();const t=this.state.fullName.trim().substring(0,ln),n=this.state.private.trim().substring(0,ln),r=this.state.description.trim().substring(0,cn);t&&this.props.onSubmit(t,r,this.state.imageDataUrl,n,this.state.tags,this.state.isChannel)}render(){let e="primary";return this.props.disabled&&(e+=" disabled"),t().createElement("form",{className:"panel-form",onSubmit:this.handleSubmit},t().createElement("div",{className:"panel-form-column"},t().createElement("center",null,t().createElement(gr,{tinode:this.props.tinode,onError:this.props.onError,onImageUpdated:this.handleImageChanged})),t().createElement("div",{className:"group"},t().createElement("label",{className:"small",htmlFor:"new-topic-fn"},t().createElement(i.FormattedMessage,{id:"label_topic_name",defaultMessage:[{type:0,value:"Name"}]})),t().createElement(i.FormattedMessage,{id:"topic_name_editing_placeholder",defaultMessage:[{type:0,value:"Freeform name of the group"}]},(e=>t().createElement("input",{type:"text",id:"new-topic-fn",placeholder:e,ref:this.fullName,value:this.state.fullName,onChange:this.handleFieldEdit.bind(this,"fullName"),autoFocus:!0,required:!0,tabIndex:0})))),t().createElement("div",{className:"group"},t().createElement("label",{className:"small",htmlFor:"new-topic-priv"},t().createElement(i.FormattedMessage,{id:"label_private",defaultMessage:[{type:0,value:"Private comment"}]})),t().createElement(i.FormattedMessage,{id:"private_editing_placeholder",defaultMessage:[{type:0,value:"Visible to you only"}]},(e=>t().createElement("input",{type:"text",id:"new-topic-priv",placeholder:e,value:this.state.private,onChange:this.handleFieldEdit.bind(this,"private"),tabIndex:1})))),t().createElement("div",{className:"group"},t().createElement("label",{className:"small",htmlFor:"new-topic-desc"},t().createElement(i.FormattedMessage,{id:"label_description",defaultMessage:[{type:0,value:"Description"}]})),t().createElement(i.FormattedMessage,{id:"description_editing_placeholder",defaultMessage:[{type:0,value:"Description (optional)"}]},(e=>t().createElement("input",{type:"text",id:"new-topic-desc",placeholder:e,value:this.state.description,onChange:this.handleFieldEdit.bind(this,"description"),tabIndex:2}))))),t().createElement("div",{className:"panel-form-row"},t().createElement(fr,{checked:this.state.isChannel,tabIndex:3,onChange:this.handleChannelToggle})," ",t().createElement("label",{onClick:this.handleChannelToggle},t().createElement(i.FormattedMessage,{id:"channel_prompt",defaultMessage:[{type:0,value:"This is a channel"}]}))),t().createElement(i.FormattedMessage,{id:"title_tag_manager",defaultMessage:[{type:0,value:"Tags (search & discovery)"}]},(e=>t().createElement(Or,{tinode:this.props.tinode,tags:this.state.tags,activated:!0,onTagsChanged:this.handleTagsChanged,tabIndex:4,title:e}))),t().createElement("div",{className:"dialog-buttons"},t().createElement("button",{className:e},t().createElement(i.FormattedMessage,{id:"button_create",defaultMessage:[{type:0,value:"Create"}]}))))}}const X1=(0,i.defineMessages)({search_for_contacts:{id:"search_for_contacts",defaultMessage:[{type:0,value:"Use search to find contacts"}]},search_no_results:{id:"search_no_results",defaultMessage:[{type:0,value:"Search returned no results"}]},search_placeholder:{id:"search_placeholder",defaultMessage:[{type:0,value:"List like email:alice@example.com, tel:17025550003..."}]}});class $1 extends t().Component{constructor(e){super(e),this.state={tabSelected:"find",searchQuery:null},this.handleTabClick=this.handleTabClick.bind(this),this.handleSearchContacts=this.handleSearchContacts.bind(this),this.handleSearchResultSelected=this.handleSearchResultSelected.bind(this),this.handleNewGroupSubmit=this.handleNewGroupSubmit.bind(this),this.handleGroupByID=this.handleGroupByID.bind(this)}componentDidMount(){this.props.onInitFind()}handleTabClick(e){e.preventDefault(),b1.navigateTo(b1.addUrlParam(window.location.hash,"tab",e.currentTarget.dataset.id)),this.setState({tabSelected:e.currentTarget.dataset.id})}handleSearchContacts(e){this.props.onSearchContacts(e),this.setState({searchQuery:$t.Tinode.isNullValue(e)?null:e})}handleSearchResultSelected(e){"find"==this.state.tabSelected&&(b1.navigateTo(b1.removeUrlParam(window.location.hash,"tab")),this.props.onCreateTopic(e))}handleNewGroupSubmit(e,t,n,r,a,i){b1.navigateTo(b1.removeUrlParam(window.location.hash,"tab")),this.props.onCreateTopic(void 0,{public:bn(e,n,null,t),private:r,tags:a},i)}handleGroupByID(e){b1.navigateTo(b1.removeUrlParam(window.location.hash,"tab")),this.props.onCreateTopic(e)}render(){const{formatMessage:e}=this.props.intl,n=e(this.state.searchQuery?X1.search_no_results:X1.search_for_contacts),r=e(X1.search_placeholder);return t().createElement("div",{className:"flex-column"},t().createElement("ul",{className:"tabbar"},t().createElement("li",{className:"find"===this.state.tabSelected?"active":null},t().createElement("a",{href:"#","data-id":"find",onClick:this.handleTabClick},t().createElement(i.FormattedMessage,{id:"tabtitle_find_user",defaultMessage:[{type:0,value:"find"}]}))),t().createElement("li",{className:"grp"===this.state.tabSelected?"active":null},t().createElement("a",{href:"#","data-id":"grp",onClick:this.handleTabClick},t().createElement(i.FormattedMessage,{id:"tabtitle_new_group",defaultMessage:[{type:0,value:"new group"}]}))),t().createElement("li",{className:"byid"===this.state.tabSelected?"active":null},t().createElement("a",{href:"#","data-id":"byid",onClick:this.handleTabClick},t().createElement(i.FormattedMessage,{id:"tabtitle_group_by_id",defaultMessage:[{type:0,value:"by id"}]})))),"grp"===this.state.tabSelected?t().createElement(G1,{tinode:this.props.tinode,onSubmit:this.handleNewGroupSubmit}):"byid"===this.state.tabSelected?t().createElement(Y1,{onSubmit:this.handleGroupByID,onError:this.props.onError}):t().createElement("div",{className:"flex-column"},t().createElement(or,{placeholder:r,onSearchContacts:this.handleSearchContacts}),t().createElement(ir,{tinode:this.props.tinode,contacts:this.props.searchResults,myUserId:this.props.myUserId,emptyListMessage:n,showOnline:!1,showUnread:!1,showContextMenu:!1,onTopicSelected:this.handleSearchResultSelected})))}}const j1=(0,i.injectIntl)($1);class K1 extends t().PureComponent{constructor(e){super(e),this.state={email:"",password:"",sent:!1},this.handleSubmit=this.handleSubmit.bind(this),this.handleEmailChange=this.handleEmailChange.bind(this),this.handlePasswordChange=this.handlePasswordChange.bind(this)}componentDidMount(){const e=b1.parseUrlHash(window.location.hash);this.setState({token:e.params.token,scheme:e.params.scheme})}handleSubmit(e){if(e.preventDefault(),this.state.token)this.props.onReset(this.state.scheme,this.state.password.trim(),this.state.token);else if(this.state.sent)this.props.onCancel();else{const e=this.state.email.trim();this.setState({email:e}),this.props.onRequest("email",e).then((()=>{this.setState({sent:!0})}))}}handleEmailChange(e){this.setState({email:e.target.value})}handlePasswordChange(e){this.setState({password:e.target.value})}render(){return t().createElement("form",{id:"password-reset-form",onSubmit:this.handleSubmit},this.state.token&&this.state.scheme?t().createElement(t().Fragment,null,t().createElement("label",{htmlFor:"new-password"},t().createElement(i.FormattedMessage,{id:"label_new_password",defaultMessage:[{type:0,value:"New password"}]})),t().createElement(i.FormattedMessage,{id:"new_password_placeholder",defaultMessage:[{type:0,value:"Enter new password"}]},(e=>t().createElement(Nr,{id:"new-password",placeholder:e,autoComplete:"new-password",value:this.state.password,required:!0,autoFocus:!0,onChange:this.handlePasswordChange})))):this.state.sent?t().createElement(t().Fragment,null,t().createElement("br",null),t().createElement("center",null,t().createElement("i",{className:"material-icons huge green"},"task_alt")),t().createElement("br",null),t().createElement("center",null,t().createElement(i.FormattedMessage,{id:"password_reset_email_sent",defaultMessage:[{type:0,value:"An email has been sent to "},{type:1,value:"email"},{type:0,value:". Follow the directions in the email to reset your password."}],values:{email:t().createElement("tt",null,this.state.email)}}))):t().createElement(t().Fragment,null,t().createElement("label",{htmlFor:"inputEmail"},t().createElement(i.FormattedMessage,{id:"label_reset_password",defaultMessage:[{type:0,value:"Send a password reset email:"}]})),t().createElement(i.FormattedMessage,{id:"credential_email_prompt",defaultMessage:[{type:0,value:"Your registration email"}]},(e=>t().createElement("input",{type:"email",id:"inputEmail",placeholder:e,autoComplete:"email",value:this.state.email,onChange:this.handleEmailChange,required:!0,autoFocus:!0})))),t().createElement("div",{className:"dialog-buttons"},t().createElement("button",{className:"primary",type:"submit"},this.state.token&&this.state.scheme?t().createElement(i.FormattedMessage,{id:"button_reset",defaultMessage:[{type:0,value:"Reset"}]}):this.state.sent?t().createElement(i.FormattedMessage,{id:"button_ok",defaultMessage:[{type:0,value:"OK"}]}):t().createElement(i.FormattedMessage,{id:"button_send_request",defaultMessage:[{type:0,value:"Send request"}]}))))}}class Z1 extends t().PureComponent{constructor(e){super(e),this.state={hostName:e.serverAddress,changed:!1},this.handleHostNameChange=this.handleHostNameChange.bind(this),this.handleEditingFinished=this.handleEditingFinished.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this)}handleHostNameChange(e){this.setState({hostName:e.target.value,changed:!0})}handleEditingFinished(){this.state.changed&&(this.setState({changed:!1}),this.props.onServerAddressChange(this.state.hostName.trim()))}handleKeyDown(e){"Enter"==e.key&&this.handleEditingFinished()}render(){var e=[];for(let n in Qt){let r=Qt[n];e.push(t().createElement("option",{key:r,value:r}))}return t().createElement("div",{className:"panel-form-row"},t().createElement("input",{type:"search",id:"host-name",placeholder:this.props.hostName,list:"known-hosts",className:"quoted",value:this.state.hostName,onChange:this.handleHostNameChange,onBlur:this.handleEditingFinished,onKeyDown:this.handleKeyDown,required:!0}),t().createElement("datalist",{id:"known-hosts"},e))}}class Q1 extends t().PureComponent{constructor(e){super(e),this.state={transport:e.transport||"def",serverAddress:e.serverAddress,secureConnection:e.secureConnection},this.handleSubmit=this.handleSubmit.bind(this),this.handleTransportSelected=this.handleTransportSelected.bind(this),this.handleServerAddressChange=this.handleServerAddressChange.bind(this),this.handleToggleSecure=this.handleToggleSecure.bind(this)}handleSubmit(e){e.preventDefault(),this.props.onUpdate({transport:this.state.transport,serverAddress:this.state.serverAddress,secureConnection:this.state.secureConnection})}handleTransportSelected(e){this.setState({transport:e.currentTarget.value})}handleServerAddressChange(e){this.setState({serverAddress:e})}handleToggleSecure(e){this.setState({secureConnection:!this.state.secureConnection})}render(){const e={def:"default",ws:"websocket",lp:"long polling"},n=[];return["def","ws","lp"].map((r=>{const a="transport-"+r,i=e[r];n.push(t().createElement("li",{key:r},t().createElement("input",{type:"radio",id:a,name:"transport-select",value:r,checked:this.state.transport===r,onChange:this.handleTransportSelected}),t().createElement("label",{htmlFor:a},i)))})),t().createElement("form",{id:"settings-form",className:"panel-form",onSubmit:this.handleSubmit},t().createElement("div",{className:"panel-form-row"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_server_to_use",defaultMessage:[{type:0,value:"Server to use:"}]}))),t().createElement(Z1,{serverAddress:this.state.serverAddress,onServerAddressChange:this.handleServerAddressChange}),t().createElement("div",{className:"panel-form-row"},t().createElement(fr,{id:"secure-connection",name:"secure-connection",checked:this.state.secureConnection,className:"quoted",onChange:this.handleToggleSecure}),t().createElement("label",{htmlFor:"secure-connection"},t().createElement(i.FormattedMessage,{id:"label_use_secure_connection",defaultMessage:[{type:0,value:"Use secure connection"}]}))),t().createElement("div",{className:"panel-form-row"},t().createElement("label",{className:"small"},t().createElement(i.FormattedMessage,{id:"label_wire_transport",defaultMessage:[{type:0,value:"Wire transport:"}]}))),t().createElement("div",{className:"panel-form-row"},t().createElement("ul",{className:"quoted"},n)),t().createElement("div",{className:"dialog-buttons"},t().createElement("button",{type:"submit",className:"primary"},t().createElement(i.FormattedMessage,{id:"button_update",defaultMessage:[{type:0,value:"Update"}]}))))}}const J1=(0,i.defineMessages)({phone:{id:"phone_dative",defaultMessage:[{type:0,value:"phone"}]},email:{id:"email_dative",defaultMessage:[{type:0,value:"email"}]}});class e6 extends t().PureComponent{constructor(e){super(e),this.state={code:e.credCode||"",codeReceived:e.credCode},this.handleChange=this.handleChange.bind(this),this.handleKeyPress=this.handleKeyPress.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.handleCancel=this.handleCancel.bind(this)}static getDerivedStateFromProps(e,t){return e.credCode!=t.codeReceived?{code:e.credCode||"",codeReceived:e.credCode}:t}componentDidMount(){this.props.credCode&&this.props.onSubmit(this.props.credMethod,this.props.credCode,this.props.credToken)}componentDidUpdate(e,t){this.state.codeReceived&&this.state.code&&this.state.code!=t.code&&this.props.onSubmit(this.props.credMethod,this.state.code,this.props.credToken)}handleChange(e){this.setState({code:e.target.value.trim()})}handleKeyPress(e){"Enter"===e.key?this.handleSubmit(e):"Escape"==e.key&&this.handleCancel(e)}handleSubmit(e){e.preventDefault(),this.state.code&&this.state.code.trim()&&this.props.onSubmit(this.props.credMethod,this.state.code.trim(),this.props.credToken)}handleCancel(e){e.preventDefault(),this.props.onCancel()}render(){const{formatMessage:e}=this.props.intl,n={email:e(J1.email),tel:e(J1.phone)}[this.props.credMethod]||this.props.credMethod;return t().createElement("div",{className:"panel-form"},t().createElement("div",{className:"panel-form-row"},t().createElement("label",{className:"small",htmlFor:"enter-confirmation-code"},t().createElement(i.FormattedMessage,{id:"enter_confirmation_code_prompt",defaultMessage:[{type:0,value:"Enter confirmation code sent to you by "},{type:1,value:"method"},{type:0,value:":"}],values:{method:n}}))),t().createElement("div",{className:"panel-form-row"},t().createElement(i.FormattedMessage,{id:"numeric_confirmation_code_prompt",defaultMessage:[{type:0,value:"Numbers only"}]},(e=>t().createElement("input",{type:"text",id:"enter-confirmation-code",placeholder:e,value:this.state.code,onChange:this.handleChange,onKeyPress:this.handleKeyPress,required:!0})))),t().createElement("div",{className:"dialog-buttons"},t().createElement("button",{className:"secondary",onClick:this.handleCancel},t().createElement(i.FormattedMessage,{id:"button_cancel",defaultMessage:[{type:0,value:"Cancel"}]})),t().createElement("button",{className:"primary",onClick:this.handleSubmit},t().createElement(i.FormattedMessage,{id:"button_confirm",defaultMessage:[{type:0,value:"Confirm"}]}))))}}const t6=(0,i.injectIntl)(e6),n6=(0,i.defineMessages)({login:{id:"sidepanel_title_login",defaultMessage:[{type:0,value:"Sign In"}]},register:{id:"sidepanel_title_register",defaultMessage:[{type:0,value:"Create Account"}]},settings:{id:"sidepanel_title_settings",defaultMessage:[{type:0,value:"Settings"}]},edit:{id:"sidepanel_title_account_settings",defaultMessage:[{type:0,value:"Account Settings"}]},general:{id:"panel_title_general",defaultMessage:[{type:0,value:"General"}]},security:{id:"panel_title_security",defaultMessage:[{type:0,value:"Security"}]},crop:{id:"panel_title_crop",defaultMessage:[{type:0,value:"Drag to Adjust"}]},notif:{id:"sidepanel_title_acc_notifications",defaultMessage:[{type:0,value:"Notifications"}]},support:{id:"sidepanel_title_acc_support",defaultMessage:[{type:0,value:"Support"}]},newtpk:{id:"sidepanel_title_newtpk",defaultMessage:[{type:0,value:"Start New Chat"}]},cred:{id:"sidepanel_title_cred",defaultMessage:[{type:0,value:"Confirm Credentials"}]},reset:{id:"sidepanel_title_reset",defaultMessage:[{type:0,value:"Reset Password"}]},archive:{id:"sidepanel_title_archive",defaultMessage:[{type:0,value:"Archived Chats"}]},blocked:{id:"sidepanel_title_blocked",defaultMessage:[{type:0,value:"Blocked Chats"}]}});class r6 extends t().PureComponent{constructor(e){super(e),this.handleNewTopic=this.handleNewTopic.bind(this)}handleNewTopic(){this.props.onNavigate("newtpk")}render(){const{formatMessage:e}=this.props.intl,n=this.props.state||(this.props.myUserId?"contacts":"login");let r,a,i,o;return"contacts"==n?(r=this.props.title,a=!this.props.avatar||this.props.avatar,i=this.props.trustedBadges):(r=e(n6[n]),a=!1,i=null),-1==["login","contacts"].indexOf(n)&&(o=this.props.onCancel),t().createElement("div",{id:"sidepanel",className:this.props.hideSelf?"nodisplay":null},t().createElement(N1,{state:n,title:r,avatar:a,tinode:this.props.tinode,trustedBadges:i,myUserId:this.props.myUserId,onSignUp:this.props.onSignUp,onSettings:this.props.onSettings,onNewTopic:this.handleNewTopic,onCancel:o}),t().createElement(vr,{level:this.props.errorLevel,text:this.props.errorText,action:this.props.errorAction,actionText:this.props.errorActionText,onClearError:this.props.onError}),t().createElement(_r,{show:this.props.loadSpinnerVisible}),"login"===n?t().createElement(V1,{login:this.props.login,disabled:this.props.loginDisabled,persist:this.props.persist,onLogin:this.props.onLoginRequest,onPersistenceChange:this.props.onPersistenceChange}):"register"===n?t().createElement(L1,{tinode:this.props.tinode,onCreateAccount:this.props.onCreateAccount,onCancel:this.props.onCancel,onError:this.props.onError}):"settings"===n?t().createElement(Q1,{transport:this.props.transport,serverAddress:this.props.serverAddress,secureConnection:this.props.secureConnection,onCancel:this.props.onCancel,onUpdate:this.props.onGlobalSettings}):"edit"===n?t().createElement(O1,{tinode:this.props.tinode,myUserId:this.props.myUserId,trustedBadges:this.props.trustedBadges,onNavigate:this.props.onNavigate}):"general"===n||"crop"===n?t().createElement(Ir,{topic:"me",tinode:this.props.tinode,myUserId:this.props.myUserId,onUpdateTopicDesc:this.props.onUpdateAccountDesc,onUpdateTags:this.props.onUpdateAccountTags,onCredAdd:this.props.onCredAdd,onCredDelete:this.props.onCredDelete,onCredConfirm:this.props.onCredConfirm,onError:this.props.onError}):"notif"===n?t().createElement(B1,{messageSounds:this.props.messageSounds,desktopAlerts:this.props.desktopAlerts,desktopAlertsEnabled:this.props.desktopAlertsEnabled,incognitoMode:this.props.incognitoMode,onTogglePushNotifications:this.props.onTogglePushNotifications,onToggleMessageSounds:this.props.onToggleMessageSounds,onToggleIncognitoMode:this.props.onToggleIncognitoMode}):"security"===n?t().createElement(q1,{tinode:this.props.tinode,onUpdateAccountDesc:this.props.onUpdateAccountDesc,onUpdatePassword:this.props.onUpdatePassword,onLogout:this.props.onLogout,onDeleteAccount:this.props.onDeleteAccount,onShowAlert:this.props.onShowAlert,onShowBlocked:this.props.onShowBlocked}):"support"===n?t().createElement(U1,{serverAddress:this.props.serverAddress,serverVersion:this.props.serverVersion}):"contacts"===n||"archive"==n||"blocked"==n?t().createElement(I1,{tinode:this.props.tinode,myUserId:this.props.myUserId,connected:this.props.connected,topicSelected:this.props.topicSelected,archive:"archive"==n,blocked:"blocked"==n,chatList:this.props.chatList,showContextMenu:this.props.showContextMenu,onTopicSelected:this.props.onTopicSelected,onShowArchive:this.props.onShowArchive}):"newtpk"===n?t().createElement(j1,{tinode:this.props.tinode,searchResults:this.props.searchResults,onInitFind:this.props.onInitFind,onSearchContacts:this.props.onSearchContacts,onCreateTopic:this.props.onCreateTopic,onError:this.props.onError}):"cred"===n?t().createElement(t6,{credCode:this.props.credCode,credMethod:this.props.credMethod,credToken:this.props.credToken,onSubmit:this.props.onValidateCredentials,onCancel:this.props.onCancel}):"reset"===n?t().createElement(K1,{onRequest:this.props.onPasswordResetRequest,onReset:this.props.onResetPassword,onCancel:this.props.onCancel}):null)}}const a6=(0,i.injectIntl)(r6);function i6(){let e=Jt;return"object"==typeof window.location&&("file:"==window.location.protocol||"localhost"==window.location.hostname?e=Qt.local:window.location.hostname&&(e=window.location.hostname+(window.location.port?":"+window.location.port:""))),e}function o6(){return"object"==typeof window.location&&"https:"==window.location.protocol}const s6=new Audio("audio/msg.m4a"),l6=(0,i.defineMessages)({reconnect_countdown:{id:"reconnect_countdown",defaultMessage:[{type:0,value:"Disconnected. Reconnecting in "},{type:1,value:"seconds"},{type:0,value:"…"}]},reconnect_now:{id:"reconnect_now",defaultMessage:[{type:0,value:"Try now"}]},push_init_failed:{id:"push_init_failed",defaultMessage:[{type:0,value:"Failed to initialize push notifications"}]},invalid_security_token:{id:"invalid_security_token",defaultMessage:[{type:0,value:"Invalid security token"}]},no_connection:{id:"no_connection",defaultMessage:[{type:0,value:"No connection"}]},code_doesnot_match:{id:"code_doesnot_match",defaultMessage:[{type:0,value:"Code does not match"}]},menu_item_info:{id:"menu_item_info",defaultMessage:[{type:0,value:"Info"}]},menu_item_video_call:{id:"menu_item_video_call",defaultMessage:[{type:0,value:"Video call"}]},cred_confirmed_successfully:{id:"cred_confirmed_successfully",defaultMessage:[{type:0,value:"Confirmed successfully"}]}});class c6 extends t().Component{constructor(e){super(e),this.selfRef=t().createRef(),this.state=this.getBlankState(),this.handleResize=this.handleResize.bind(this),this.handleHashRoute=this.handleHashRoute.bind(this),this.handleOnline=this.handleOnline.bind(this),this.checkForAppUpdate=this.checkForAppUpdate.bind(this),this.handleVisibilityEvent=this.handleVisibilityEvent.bind(this),this.handleError=this.handleError.bind(this),this.handleLoginRequest=this.handleLoginRequest.bind(this),this.handlePersistenceChange=this.handlePersistenceChange.bind(this),this.handleConnected=this.handleConnected.bind(this),this.handleAutoreconnectIteration=this.handleAutoreconnectIteration.bind(this),this.doLogin=this.doLogin.bind(this),this.handleLoginSuccessful=this.handleLoginSuccessful.bind(this),this.handleDisconnect=this.handleDisconnect.bind(this),this.tnMeMetaDesc=this.tnMeMetaDesc.bind(this),this.tnMeContactUpdate=this.tnMeContactUpdate.bind(this),this.tnMeSubsUpdated=this.tnMeSubsUpdated.bind(this),this.resetContactList=this.resetContactList.bind(this),this.tnInitFind=this.tnInitFind.bind(this),this.tnFndSubsUpdated=this.tnFndSubsUpdated.bind(this),this.handleSearchContacts=this.handleSearchContacts.bind(this),this.handleTopicSelected=this.handleTopicSelected.bind(this),this.handleHideMessagesView=this.handleHideMessagesView.bind(this),this.handleSendMessage=this.handleSendMessage.bind(this),this.handleNewChatInvitation=this.handleNewChatInvitation.bind(this),this.handleNewAccount=this.handleNewAccount.bind(this),this.handleNewAccountRequest=this.handleNewAccountRequest.bind(this),this.handleUpdatePasswordRequest=this.handleUpdatePasswordRequest.bind(this),this.handleUpdateAccountTagsRequest=this.handleUpdateAccountTagsRequest.bind(this),this.handleToggleIncognitoMode=this.handleToggleIncognitoMode.bind(this),this.handleSettings=this.handleSettings.bind(this),this.handleGlobalSettings=this.handleGlobalSettings.bind(this),this.handleShowArchive=this.handleShowArchive.bind(this),this.handleShowBlocked=this.handleShowBlocked.bind(this),this.handleToggleMessageSounds=this.handleToggleMessageSounds.bind(this),this.handleCredAdd=this.handleCredAdd.bind(this),this.handleCredDelete=this.handleCredDelete.bind(this),this.handleCredConfirm=this.handleCredConfirm.bind(this),this.initFCMessaging=this.initFCMessaging.bind(this),this.toggleFCMToken=this.toggleFCMToken.bind(this),this.handlePushMessage=this.handlePushMessage.bind(this),this.handleSidepanelCancel=this.handleSidepanelCancel.bind(this),this.handleStartTopicRequest=this.handleStartTopicRequest.bind(this),this.handleNewTopicCreated=this.handleNewTopicCreated.bind(this),this.handleTopicUpdateRequest=this.handleTopicUpdateRequest.bind(this),this.handleUnarchive=this.handleUnarchive.bind(this),this.handleChangePermissions=this.handleChangePermissions.bind(this),this.handleTagsUpdateRequest=this.handleTagsUpdateRequest.bind(this),this.handleLogout=this.handleLogout.bind(this),this.handleDeleteAccount=this.handleDeleteAccount.bind(this),this.handleDeleteTopicRequest=this.handleDeleteTopicRequest.bind(this),this.handleDeleteMessagesRequest=this.handleDeleteMessagesRequest.bind(this),this.handleLeaveUnsubRequest=this.handleLeaveUnsubRequest.bind(this),this.handleBlockTopicRequest=this.handleBlockTopicRequest.bind(this),this.handleReportTopic=this.handleReportTopic.bind(this),this.handleShowContextMenu=this.handleShowContextMenu.bind(this),this.defaultTopicContextMenu=this.defaultTopicContextMenu.bind(this),this.handleHideContextMenu=this.handleHideContextMenu.bind(this),this.handleShowAlert=this.handleShowAlert.bind(this),this.handleShowInfoView=this.handleShowInfoView.bind(this),this.handleMemberUpdateRequest=this.handleMemberUpdateRequest.bind(this),this.handleValidateCredentialsRequest=this.handleValidateCredentialsRequest.bind(this),this.handlePasswordResetRequest=this.handlePasswordResetRequest.bind(this),this.handleResetPassword=this.handleResetPassword.bind(this),this.handleContextMenuAction=this.handleContextMenuAction.bind(this),this.handleShowForwardDialog=this.handleShowForwardDialog.bind(this),this.handleHideForwardDialog=this.handleHideForwardDialog.bind(this),this.handleStartVideoCall=this.handleStartVideoCall.bind(this),this.handleInfoMessage=this.handleInfoMessage.bind(this),this.handleDataMessage=this.handleDataMessage.bind(this),this.handleCallClose=this.handleCallClose.bind(this),this.handleCallInvite=this.handleCallInvite.bind(this),this.handleCallRinging=this.handleCallRinging.bind(this),this.handleCallHangup=this.handleCallHangup.bind(this),this.handleCallSendOffer=this.handleCallSendOffer.bind(this),this.handleCallIceCandidate=this.handleCallIceCandidate.bind(this),this.handleCallSendAnswer=this.handleCallSendAnswer.bind(this),this.handleCallAcceptCall=this.handleCallAcceptCall.bind(this),this.sendMessageToTopic=this.sendMessageToTopic.bind(this),this.callTimeoutTimer=null}getBlankState(){const e=P1.getObject("settings")||{},t=!!P1.getObject("keep-logged-in");return{connected:!1,ready:!1,autoLogin:!1,transport:e.transport||null,serverAddress:e.serverAddress||i6(),secureConnection:void 0===e.secureConnection?o6():e.secureConnection,serverVersion:"no connection",messageSounds:!e.messageSoundsOff,incognitoMode:!1,desktopAlerts:t&&!!e.desktopAlerts,desktopAlertsEnabled:(o6()||"object"==typeof window.location&&"localhost"==window.location.hostname)&&"undefined"!=typeof navigator&&"undefined"!=typeof FIREBASE_INIT,firebaseToken:t?P1.getObject("firebase-token"):null,applicationVisible:!document.hidden,errorText:"",errorLevel:null,errorAction:void 0,errorActionText:null,sidePanelSelected:"login",sidePanelTitle:null,sidePanelAvatar:null,myTrustedBadges:[],loadSpinnerVisible:!1,login:"",password:"",persist:t,myUserId:null,liveConnection:navigator.onLine,topicSelected:"",topicSelectedOnline:!1,topicSelectedAcs:null,newTopicParams:null,loginDisabled:!1,displayMobile:window.innerWidth<=640,infoPanel:void 0,mobilePanel:"sidepanel",callTopic:void 0,callState:0,callShouldStart:!1,contextMenuVisible:!1,contextMenuBounds:null,contextMenuClickAt:null,contextMenuParams:null,contextMenuItems:[],forwardDialogVisible:!1,forwardMessage:null,alertVisible:!1,alertParams:{},chatList:[],searchResults:[],searchableContacts:[],credMethod:void 0,credCode:void 0,credToken:void 0,requestedTopic:void 0}}componentDidMount(){if(window.addEventListener("resize",this.handleResize),window.addEventListener("online",(e=>{this.handleOnline(!0)})),window.addEventListener("offline",(e=>{this.handleOnline(!1)})),window.addEventListener("hashchange",this.handleHashRoute),"function"==typeof BroadcastChannel){new BroadcastChannel("tinode-sw").addEventListener("message",this.handlePushMessage)}else console.warn("Your browser does not support BroadcastChannel. Some features will not be available");document.addEventListener("visibilitychange",this.handleVisibilityEvent),this.setState({viewportWidth:document.documentElement.clientWidth,viewportHeight:document.documentElement.clientHeight}),new Promise(((e,t)=>{this.tinode=c6.tnSetup(this.state.serverAddress,o6(),this.state.transport,this.props.intl.locale,this.state.persist,e),this.tinode.onConnect=this.handleConnected,this.tinode.onDisconnect=this.handleDisconnect,this.tinode.onAutoreconnectIteration=this.handleAutoreconnectIteration,this.tinode.onInfoMessage=this.handleInfoMessage,this.tinode.onDataMessage=this.handleDataMessage})).then((e=>{this.state.desktopAlertsEnabled&&this.initFCMessaging().then((e=>{this.state.desktopAlerts&&this.tinode.setDeviceToken(this.state.firebaseToken)})).catch((()=>{}));const t=b1.parseUrlHash(window.location.hash);this.resetContactList();const n=this.state.persist?P1.getObject("auth-token"):void 0;if(n&&(this.setState({autoLogin:!0}),n.expires=new Date(n.expires),this.tinode.setAuthToken(n),this.tinode.connect().catch((e=>{this.handleError(e.message,"err")}))),this.readTimer=null,this.readTimerCallback=null,["cred","reset","register"].includes(t.path[0]))this.handleHashRoute();else{this.setState({requestedTopic:t.path[1]});const e=t.params&&t.params.cred_done?b1.addUrlParam("","cred_done",t.params.cred_done):"";b1.navigateTo(e)}}))}componentWillUnmount(){window.removeEventListener("resize",this.handleResize),window.removeEventListener("hashchange",this.handleHashRoute),document.removeEventListener("visibilitychange",this.handleVisibilityEvent)}static tnSetup(e,t,n,r,a,i){const o=new $t.Tinode({appName:Zt,host:e,apiKey:"AQEAAAABAAD_rAp4DJh05a1HAwFT3A6K",transport:n,secure:t,persist:a},i);return o.setHumanLanguage(r),o.enableLogging(true,!0),o}handlePushMessage(e){this.tinode.oobNotification(e.data||{})}initFCMessaging(){const{formatMessage:e,locale:t}=this.props.intl,n=(t,n)=>{console.error(t,n),this.handleError(e(l6.push_init_failed),"err"),this.setState({desktopAlertsEnabled:!1,firebaseToken:null}),P1.updateObject("settings",{desktopAlerts:!1})};try{return this.fcm=zt(ce(FIREBASE_INIT,Zt)),navigator.serviceWorker.register("/service-worker.js").then((e=>(this.checkForAppUpdate(e),e.active.postMessage(JSON.stringify({locale:t,version:Kt})),e))).then((e=>c6.requestFCMToken(this.fcm,e))).then((e=>{const t=P1.getObject("keep-logged-in");e!=this.state.firebaseToken&&(this.tinode.setDeviceToken(e),t&&P1.setObject("firebase-token",e)),this.setState({firebaseToken:e,desktopAlerts:!0}),t&&P1.updateObject("settings",{desktopAlerts:!0}),Xt(this.fcm,(e=>{this.handlePushMessage(e)}))})).catch((e=>{throw n(e),e}))}catch(e){return n(e),Promise.reject(e)}}static requestFCMToken(e,t){return Yt(e,{serviceWorkerRegistration:t,vapidKey:FIREBASE_INIT.messagingVapidKey}).then((t=>t||Notification.requestPermission().then((t=>{if("granted"===t)return Yt(e,{serviceWorkerRegistration:reg,vapidKey:FIREBASE_INIT.messagingVapidKey}).then((e=>{if(e)return e;throw new Error("Failed to initialize notifications")}));throw new Error("No permission to send notifications: "+t)}))))}handleResize(){const e=document.documentElement.clientWidth<=640;this.setState({viewportWidth:document.documentElement.clientWidth,viewportHeight:document.documentElement.clientHeight}),this.state.displayMobile!=e&&this.setState({displayMobile:e})}checkForAppUpdate(e){e.onupdatefound=()=>{const n=e.installing;n.onstatechange=()=>{if("installed"==n.state&&navigator.serviceWorker.controller){const e=t().createElement(t().Fragment,null,t().createElement(i.FormattedMessage,{id:"update_available",defaultMessage:[{type:0,value:"Update available."}]})," ",t().createElement("a",{href:""},t().createElement(i.FormattedMessage,{id:"reload_update",defaultMessage:[{type:0,value:"Reload"}]})),".");this.handleError(e,"info")}}}}handleHashRoute(){const e=b1.parseUrlHash(window.location.hash),t={infoPanel:e.params.info,newTopicTabSelected:e.params.tab};if(e.path&&e.path.length>0){["register","settings","edit","notif","security","support","general","crop","cred","reset","newtpk","archive","blocked","contacts",""].includes(e.path[0])?t.sidePanelSelected=e.path[0]:console.warn("Unknown sidepanel view",e.path[0]);let n=e.path[1]||null;n!=this.state.topicSelected&&($t.Tinode.topicType(n)||(n=null),Object.assign(t,{topicSelected:n,topicSelectedAcs:this.tinode.getTopicAccessMode(n)}))}else Object.assign(t,{sidePanelSelected:"",topicSelected:null});e.params.method&&(t.credMethod=e.params.method),e.params.code&&(t.credCode=e.params.code),e.params.token&&(t.credToken=e.params.token),e.params.cred_done&&Object.assign(t,c6.stateForError(this.props.intl.formatMessage(l6.cred_confirmed_successfully),"info")),this.setState(t)}handleOnline(e){e?(this.handleError(),clearInterval(this.reconnectCountdown),this.tinode.reconnect()):this.handleError(this.props.intl.formatMessage(l6.no_connection),"warn"),this.setState({liveConnection:e})}handleVisibilityEvent(){this.setState({applicationVisible:!document.hidden})}static stateForError(e,t,n,r){return{errorText:e,errorLevel:t,errorAction:n,errorActionText:r,callShouldStart:!1}}handleError(e,t,n,r){this.setState(c6.stateForError(e,t,n,r))}handleLoginRequest(e,t){this.setState({loginDisabled:!0,login:e,password:t,loadSpinnerVisible:!0,autoLogin:!0}),this.handleError("",null),this.tinode.isConnected()?this.doLogin(e,t,null,{meth:this.state.credMethod,resp:this.state.credCode}):this.tinode.connect().catch((e=>{this.setState({loginDisabled:!1,autoLogin:!1,loadSpinnerVisible:!1}),this.handleError(e.message,"err")}))}handlePersistenceChange(e){e?this.tinode.initStorage().then((()=>{P1.setObject("keep-logged-in",!0),this.setState({persist:!0})})):this.tinode.clearStorage().then((()=>{P1.setObject("keep-logged-in",!1),this.setState({persist:!1})}))}handleConnected(){clearInterval(this.reconnectCountdown),this.handleError();const e=this.tinode.getServerInfo();this.setState({serverVersion:e.ver+" "+(e.build?e.build:"none")}),this.state.autoLogin&&this.doLogin(this.state.login,this.state.password,null,{meth:this.state.credMethod,resp:this.state.credCode})}handleAutoreconnectIteration(e,t){if(clearInterval(this.reconnectCountdown),e<0)return void this.handleError();if(t)return void t.then((()=>{this.handleError()})).catch((e=>{this.handleError(e.message,"err")}));const{formatMessage:n}=this.props.intl;let r=e/1e3;r|=r,this.reconnectCountdown=setInterval((()=>{const e=r>99?_n(r):r;this.handleError(n(l6.reconnect_countdown,{seconds:e}),"warn",(e=>{clearInterval(this.reconnectCountdown),this.tinode.reconnect()}),n(l6.reconnect_now)),r-=1}),1e3)}handleDisconnect(e){this.setState({connected:!1,ready:!1,topicSelectedOnline:!1,errorText:e&&e.message?e.message:"Disconnected",errorLevel:e&&e.message?"err":"warn",loginDisabled:!1,contextMenuVisible:!1,forwardDialogVisible:!1,serverVersion:"no connection"})}doLogin(e,t,n,r){if(this.tinode.isAuthenticated())return void b1.navigateTo("");let a=n||(this.tinode.getAuthToken()||{}).token;if(!(e&&t||a))return b1.navigateTo(""),void this.setState({loginDisabled:!1});r=$t.Tinode.credential(r);let i,o=this.tinode.isConnected()?Promise.resolve():this.tinode.connect();e&&t?(a=null,this.setState({password:null}),i=o.then((n=>this.tinode.loginBasic(e,t,r)))):i=o.then((e=>this.tinode.loginToken(a,r))),i.then((e=>{e.code>=300&&"validate credentials"===e.text?(this.setState({loadSpinnerVisible:!1}),r&&this.handleError(this.props.intl.formatMessage(l6.code_doesnot_match),"warn"),c6.navigateToCredentialsView(e.params)):this.handleLoginSuccessful()})).catch((e=>{this.setState({loginDisabled:!1,credMethod:void 0,credCode:void 0,loadSpinnerVisible:!1,autoLogin:!1}),this.handleError(e.message,"err"),console.warn("Login failed",e),a&&this.handleLogout(),b1.navigateTo("")}))}static navigateToCredentialsView(e){const t=b1.parseUrlHash(window.location.hash);t.path[0]="cred",t.params.method=e.cred[0],t.params.token=e.token,b1.navigateTo(b1.composeUrlHash(t.path,t.params))}handleLoginSuccessful(){this.handleError(),P1.getObject("keep-logged-in")&&P1.setObject("auth-token",this.tinode.getAuthToken());const e=this.state.requestedTopic,t=this.tinode.getMeTopic();t.onMetaDesc=this.tnMeMetaDesc,t.onContactUpdate=this.tnMeContactUpdate,t.onSubsUpdated=this.tnMeSubsUpdated,this.setState({connected:!0,credMethod:void 0,credCode:void 0,credToken:void 0,myUserId:this.tinode.getCurrentUserID(),autoLogin:!0,requestedTopic:void 0}),t.subscribe(t.startMetaQuery().withLaterSub().withDesc().withTags().withCred().build()).catch((e=>{this.tinode.disconnect(),localStorage.removeItem("auth-token"),this.handleError(e.message,"err"),b1.navigateTo("")})).finally((()=>{this.setState({loadSpinnerVisible:!1})}));let n=b1.setUrlSidePanel(window.location.hash,"contacts");e&&(n=b1.setUrlTopic(n,e)),b1.navigateTo(n)}tnMeMetaDesc(e){if(e){if(e.public&&this.setState({sidePanelTitle:e.public.fn,sidePanelAvatar:Mn(e.public.photo)}),e.trusted){const t=[];for(const[n,r]of Object.entries(e.trusted))r&&t.push(n);this.setState({myTrustedBadges:t})}e.acs&&this.setState({incognitoMode:!e.acs.isPresencer()})}}tnMeContactUpdate(e,t){if("on"==e||"off"==e)this.resetContactList(),this.state.topicSelected==t.topic&&this.setState({topicSelectedOnline:"on"==e});else if("read"==e)this.resetContactList();else if("msg"==e){const e=this.tinode.getTopic(t.topic),n=e&&e.isArchived();t.unread>0&&this.state.messageSounds&&!n&&(document.hidden||this.state.topicSelected!=t.topic)&&s6.play().catch((e=>{})),this.resetContactList()}else"recv"==e||("gone"==e||"unsub"==e?(this.state.topicSelected==t.topic&&this.handleTopicSelected(null),this.resetContactList()):"acs"==e?this.state.topicSelected==t.topic&&this.setState({topicSelectedAcs:t.acs}):"del"==e||"upd"==e||"call"==e||console.info("Unsupported (yet) presence update:",e,"in",t.topic))}tnMeSubsUpdated(e){this.resetContactList()}static prepareSearchableContacts(e,t){const n={};for(const t of e)$t.Tinode.isP2PTopicName(t.topic)&&(n[t.topic]={user:t.topic,updated:t.updated,public:t.public,private:t.private,acs:t.acs});for(const e of t)n[e.user]||(n[e.user]=e);return Object.values(n)}resetContactList(){const e={chatList:[]};this.state.ready||(e.ready=!0),this.tinode.getMeTopic().contacts((t=>{t.topic||t.user||(t.topic=t.name),e.chatList.push(t),this.state.topicSelected==t.topic&&(e.topicSelectedOnline=t.online,e.topicSelectedAcs=t.acs)}));const t=new Date(0);e.chatList.sort(((e,n)=>(e.touched||t).getTime()-(n.touched||t).getTime())),e.searchableContacts=c6.prepareSearchableContacts(e.chatList,this.state.searchResults),this.setState(e)}tnInitFind(){const e=this.tinode.getFndTopic();e.onSubsUpdated=this.tnFndSubsUpdated,e.isSubscribed()?this.tnFndSubsUpdated():e.subscribe(e.startMetaQuery().withSub().build()).catch((e=>{this.handleError(e.message,"err")}))}tnFndSubsUpdated(){const e=[];this.tinode.getFndTopic().contacts((t=>{e.push(t)})),this.setState({searchResults:e,searchableContacts:c6.prepareSearchableContacts(this.state.chatList,e)})}handleSearchContacts(e){const t=this.tinode.getFndTopic();t.setMeta({desc:{public:e}}).then((e=>t.getMeta(t.startMetaQuery().withSub().build()))).catch((e=>{this.handleError(e.message,"err")}))}handleTopicSelected(e){this.state.newTopicParams&&this.state.newTopicParams._topicName!=e&&this.setState({newTopicParams:null}),e?(this.setState({errorText:"",errorLevel:null,mobilePanel:"topic-view",infoPanel:void 0}),this.state.topicSelected!=e&&(this.setState({topicSelectedOnline:this.tinode.isTopicOnline(e),topicSelectedAcs:this.tinode.getTopicAccessMode(e),forwardMessage:null}),b1.navigateTo(b1.setUrlTopic("",e)))):(this.setState({errorText:"",errorLevel:null,mobilePanel:"sidepanel",topicSelectedOnline:!1,topicSelectedAcs:null,infoPanel:void 0,forwardMessage:null}),b1.navigateTo(b1.setUrlTopic("",null)))}handleHideMessagesView(){this.setState({mobilePanel:"sidepanel"}),b1.navigateTo(b1.setUrlTopic(window.location.hash,null))}handleSendMessage(e,t,n,r){const a=this.tinode.getTopic(this.state.topicSelected);return this.sendMessageToTopic(a,e,t,n,r)}sendMessageToTopic(e,t,n,r,a){(t=e.createMessage(t,!1))._uploader=r,a&&(t.head=Object.assign(t.head||{},a));const i=[];if(n&&i.push(n),!e.isSubscribed()){const n=e.subscribe().then((()=>{let n=[];e.queuedMessages((r=>{r._sending||r.seq==t.seq||(r.head&&r.head.webrtc?n.push(r.seq):e.isSubscribed()&&e.publishMessage(r))})),n.length>0&&e.delMessagesList(n,!0)}));i.push(n)}return e.publishDraft(t,Promise.all(i)).then((t=>(e.isArchived()&&e.archive(!1),t))).catch((e=>{this.handleError(e.message,"err")}))}handleNewChatInvitation(e,t){const n=this.tinode.getTopic(e);let r=null;switch(t){case"accept":const a=n.getAccessMode().getGiven();r=n.setMeta({sub:{mode:a}}),n.isP2PType()&&(r=r.then((t=>{n.setMeta({sub:{user:e,mode:a}})})));break;case"delete":r=n.delTopic(!0);break;case"block":const i=n.getAccessMode().updateWant("-JP").getWant();r=n.setMeta({sub:{mode:i}}).then((e=>this.handleTopicSelected(null)));break;default:console.warn("Unknown invitation action",'"'+t+'""')}null!=r&&r.catch((e=>{this.handleError(e.message,"err")}))}handleNewAccount(){this.handleError(),b1.navigateTo(b1.setUrlSidePanel(window.location.hash,"register"))}handleNewAccountRequest(e,t,n,r,a){this.handleError(),this.tinode.connect(this.state.serverAddress).then((i=>{let o;return n&&n.photo&&n.photo.ref&&(o=[n.photo.ref]),this.tinode.createAccountBasic(e,t,{public:n,tags:a,cred:$t.Tinode.credential(r),attachments:o})})).then((e=>{e.code>=300&&"validate credentials"==e.text?c6.navigateToCredentialsView(e.params):this.handleLoginSuccessful(this)})).catch((e=>{this.handleError(e.message,"err")}))}handleToggleIncognitoMode(e){this.setState({incognitoMode:null});const t=this.tinode.getMeTopic(),n=t.getAccessMode().updateWant(e?"-P":"+P").getWant();t.setMeta({sub:{mode:n}}).catch((t=>{this.setState({incognitoMode:!e}),this.handleError(t.message,"err")}))}handleUpdateAccountTagsRequest(e){this.tinode.getMeTopic().setMeta({tags:e}).catch((e=>{this.handleError(e.message,"err")}))}handleSettings(){this.handleError(),b1.navigateTo(b1.setUrlSidePanel(window.location.hash,this.state.myUserId?"edit":"settings"))}handleGlobalSettings(e){const t=e.serverAddress||this.state.serverAddress,n=e.transport||this.state.transport,r=void 0===e.secureConnection?this.state.secureConnection:e.secureConnection;this.tinode&&(this.tinode.clearStorage(),this.tinode.onDisconnect=void 0,this.tinode.disconnect()),this.tinode=c6.tnSetup(t,r,n,this.props.intl.locale,P1.getObject("keep-logged-in")),this.tinode.onConnect=this.handleConnected,this.tinode.onDisconnect=this.handleDisconnect,this.tinode.onAutoreconnectIteration=this.handleAutoreconnectIteration,this.tinode.onInfoMessage=this.handleInfoMessage,this.tinode.onDataMessage=this.handleDataMessage,this.setState({serverAddress:t,transport:n,secureConnection:r}),P1.setObject("settings",{serverAddress:t,transport:n,secureConnection:r}),b1.navigateTo(b1.setUrlSidePanel(window.location.hash,""))}handleShowArchive(){b1.navigateTo(b1.setUrlSidePanel(window.location.hash,this.state.myUserId?"archive":""))}handleShowBlocked(){b1.navigateTo(b1.setUrlSidePanel(window.location.hash,this.state.myUserId?"blocked":""))}toggleFCMToken(e){e?(this.setState({desktopAlerts:null}),this.state.firebaseToken?(this.setState({desktopAlerts:!0}),P1.getObject("keep-logged-in")&&P1.updateObject("settings",{desktopAlerts:!0})):this.initFCMessaging()):this.state.firebaseToken&&this.fcm?Gt(this.fcm).catch((e=>{console.error("Unable to delete token.",e)})).finally((()=>{P1.updateObject("settings",{desktopAlerts:!1}),localStorage.removeItem("firebase-token"),this.setState({desktopAlerts:!1,firebaseToken:null}),this.tinode.setDeviceToken(null)})):(this.setState({desktopAlerts:!1,firebaseToken:null}),P1.updateObject("settings",{desktopAlerts:!1}))}handleToggleMessageSounds(e){this.setState({messageSounds:e}),P1.updateObject("settings",{messageSoundsOff:!e})}handleCredAdd(e,t){this.tinode.getMeTopic().setMeta({cred:{meth:e,val:t}}).catch((e=>{this.handleError(e.message,"err")}))}handleCredDelete(e,t){this.tinode.getMeTopic().delCredential(e,t).catch((e=>{this.handleError(e.message,"err")}))}handleCredConfirm(e,t){c6.navigateToCredentialsView({cred:[e]})}handleSidepanelCancel(){const e=b1.parseUrlHash(window.location.hash);let t="";["security","support","general","notif"].includes(e.path[0])?t="edit":"crop"==e.path[0]?t="general":"blocked"==e.path[0]?t="security":this.state.myUserId&&(t="contacts"),e.path[0]=t,e.params&&(delete e.params.code,delete e.params.method,delete e.params.tab,delete e.params.scheme,delete e.params.token),b1.navigateTo(b1.composeUrlHash(e.path,e.params)),this.setState({errorText:"",errorLevel:null})}basicNavigator(e){b1.navigateTo(b1.setUrlSidePanel(window.location.hash,e))}infoNavigator(e){b1.navigateTo(b1.setUrlInfoPanel(window.location.hash,e))}handleStartTopicRequest(e,t,n){if(e&&this.tinode.isTopicCached(e))return void this.handleTopicSelected(e);const r={};$t.Tinode.isP2PTopicName(e)?(r.sub={mode:tn},r.desc={defacs:{auth:tn}}):(e=e||this.tinode.newGroupTopicName(n),t&&(r.desc={public:t.public,private:{comment:t.private}},r.tags=t.tags)),r._topicName=e,this.setState({newTopicParams:r},(()=>{this.handleTopicSelected(e)}))}handleNewTopicCreated(e,t){let n={};this.state.callShouldStart&&(n={callState:3,callShouldStart:!1}),this.state.topicSelected==e&&e!=t&&(n.topicSelected=t),this.setState(n,(e=>{b1.navigateTo(b1.setUrlTopic("",t))}))}handleTopicUpdateRequest(e,t,n,r){this.handleError();const a=this.tinode.getTopic(e);if(a){const e={};let i;t&&(t.photo&&(t.photo.ref&&t.photo.ref!=$t.Tinode.DEL_CHAR?i=[t.photo.ref]:t.photo.data&&t.photo.data!=$t.Tinode.DEL_CHAR||(t.photo=$t.Tinode.DEL_CHAR)),e.public=t),"string"==typeof n&&(e.private=n===$t.Tinode.DEL_CHAR?$t.Tinode.DEL_CHAR:{comment:n}),r&&(e.defacs=r),a.setMeta({desc:e,attachments:i}).catch((e=>{this.handleError(e.message,"err")}))}}handleUnarchive(e){const t=this.tinode.getTopic(e);t&&t.archive(!1).catch((e=>{this.handleError(e.message,"err")}))}handleUpdatePasswordRequest(e){this.handleError(),e&&this.tinode.updateAccountBasic(null,this.tinode.getCurrentLogin(),e).catch((e=>{this.handleError(e.message,"err")}))}handleChangePermissions(e,t,n){const r=this.tinode.getTopic(e);if(r){const e=r.getAccessMode();n?(e.updateGiven(t),t=e.getGiven()):(e.updateWant(t),t=e.getWant()),r.setMeta({sub:{user:n,mode:t}}).catch((e=>{this.handleError(e.message,"err")}))}}handleTagsUpdateRequest(e,t){const n=this.tinode.getTopic(e);n&&n.setMeta({tags:t}).catch((e=>{this.handleError(e.message,"err")}))}handleLogout(){let e;vn(0),localStorage.removeItem("auth-token"),localStorage.removeItem("firebase-token"),localStorage.removeItem("settings"),this.state.firebaseToken&&Gt(this.fcm),clearInterval(this.reconnectCountdown),this.tinode?(e=this.tinode.clearStorage(),this.tinode.onDisconnect=void 0,this.tinode.disconnect()):e=Promose.resolve(),this.setState(this.getBlankState()),e.then((()=>{this.tinode=c6.tnSetup(this.state.serverAddress,o6(),this.state.transport,this.props.intl.locale,P1.getObject("keep-logged-in"),(()=>{this.tinode.onConnect=this.handleConnected,this.tinode.onDisconnect=this.handleDisconnect,this.tinode.onAutoreconnectIteration=this.handleAutoreconnectIteration,this.tinode.onInfoMessage=this.handleInfoMessage,this.tinode.onDataMessage=this.handleDataMessage,b1.navigateTo("")}))}))}handleDeleteAccount(){this.tinode.delCurrentUser(!0).then((e=>{this.handleLogout()}))}handleDeleteTopicRequest(e){const t=this.tinode.getTopic(e);t&&t.delTopic(!0).then((e=>{b1.navigateTo(b1.setUrlTopic(window.location.hash,""))})).catch((e=>{this.handleError(e.message,"err")}))}handleDeleteMessagesRequest(e){const t=this.tinode.getTopic(e);t&&t.delMessagesAll(!0).catch((e=>{this.handleError(e.message,"err")}))}handleLeaveUnsubRequest(e){const t=this.tinode.getTopic(e);t&&t.leave(!0).then((e=>{b1.navigateTo(b1.setUrlTopic(window.location.hash,""))})).catch((e=>{this.handleError(e.message,"err")}))}handleBlockTopicRequest(e){const t=this.tinode.getTopic(e);t&&t.updateMode(null,"-JP").then((e=>{b1.navigateTo(b1.setUrlTopic(window.location.hash,""))})).catch((e=>{this.handleError(e.message,"err")}))}handleReportTopic(e){const t=this.tinode.getTopic(e);t&&(this.tinode.report("report",e),t.updateMode(null,"-JP").then((e=>{b1.navigateTo(b1.setUrlTopic(window.location.hash,""))})).catch((e=>{this.handleError(e.message,"err")})))}handleShowContextMenu(e,t){this.setState({contextMenuVisible:!0,contextMenuClickAt:{x:e.x,y:e.y},contextMenuParams:e,contextMenuItems:t||this.defaultTopicContextMenu(e.topicName),contextMenuBounds:this.selfRef.current.getBoundingClientRect()})}handleShowForwardDialog(e){"newtpk"==this.state.sidePanelSelected&&this.handleSidepanelCancel();const t="➦ "+e.userName,n="string"==typeof e.content?$t.Drafty.init(e.content):$t.Drafty.forwardedContent(e.content),r=$t.Drafty.preview(n,84,!0),a=$t.Drafty.append($t.Drafty.appendLineBreak($t.Drafty.mention(t,e.userFrom)),n),i=$t.Drafty.quote(t,e.userFrom,r),o={forwarded:e.topicName+":"+e.seq};this.setState({forwardDialogVisible:!0,forwardMessage:{head:o,msg:a,preview:i}})}defaultTopicContextMenu(e){const t=this.tinode.getTopic(e);if(t._deleted)return["topic_delete"];let n=!1,r=!1,a=!1,i=!1,o=!1,s=!1,l=!1;if(t){i=t.isSubscribed(),s=t.isArchived();const e=t.getAccessMode();e&&(n=e.isMuted(),r=!e.isJoiner(),a=!e.isJoiner("want"),o=e.isDeleter())}return l=!!this.tinode.getServerParam("iceServers"),[i?{title:this.props.intl.formatMessage(l6.menu_item_info),handler:this.handleShowInfoView}:null,i&&$t.Tinode.isP2PTopicName(e)&&l?{title:this.props.intl.formatMessage(l6.menu_item_video_call),handler:this.handleStartVideoCall}:null,i?"messages_clear":null,i&&o?"messages_clear_hard":null,n?r?null:"topic_unmute":"topic_mute",a?"topic_unblock":"topic_block",s?"topic_restore":"topic_archive","topic_delete"]}handleHideContextMenu(){this.setState({contextMenuVisible:!1,contextMenuClickAt:null,contextMenuParams:null,contextMenuBounds:null})}handleHideForwardDialog(e){this.setState({forwardDialogVisible:!1,forwardMessage:e?this.state.forwardMessage:null})}handleContextMenuAction(e,t,n){"topic_archive"==e?t&&n.topicName&&n.topicName==this.state.topicSelected&&t.then((()=>{this.handleTopicSelected(null)})):"menu_item_forward"==e&&this.handleShowForwardDialog(n)}handleShowAlert(e,t,n,r,a,i){this.setState({alertVisible:!0,alertParams:{title:e,content:t,onConfirm:n,confirm:r,onReject:a,reject:i}})}handleShowInfoView(){b1.navigateTo(b1.addUrlParam(window.location.hash,"info","info")),this.setState({infoPanel:"info"})}handleMemberUpdateRequest(e,t,n){if(!e)return;const r=this.tinode.getTopic(e);r&&(t&&t.length>0&&t.map((e=>{r.invite(e,null).catch((e=>{this.handleError(e.message,"err")}))})),n&&n.length>0&&n.map((e=>{r.delSubscription(e).catch((e=>{this.handleError(e.message,"err")}))})))}handleValidateCredentialsRequest(e,t,n){this.tinode.isAuthenticated()?this.tinode.getMeTopic().setMeta({cred:{meth:e,resp:t}}).catch((e=>{this.handleError(e.message,"err")})):(this.setState({credMethod:e,credCode:t,credToken:n}),this.doLogin(null,null,n,{meth:e,resp:t}))}handlePasswordResetRequest(e,t){return this.tinode.connect().then((()=>this.tinode.requestResetAuthSecret("basic",e,t))).catch((e=>{this.handleError(e.message,"err")}))}handleResetPassword(e,t,n){(n=function(e){if(e){e=e.replace(/-/g,"+").replace(/_/g,"/");try{e=btoa(atob(e))}catch(t){console.error("Failed to base64 re-encode string.",t),e=null}}return e}(n))?this.tinode.connect().then((()=>this.tinode.updateAccountBasic(null,null,t,{token:n}))).then((()=>{b1.navigateTo("")})).catch((e=>{this.handleError(e.message,"err")})):this.handleError(this.props.intl.formatMessage(l6.invalid_security_token),"err")}handleStartVideoCall(){this.setState({callTopic:this.state.topicSelected,callState:1})}handleCallInvite(e,t,n){switch(n){case 1:let n={webrtc:dr};this.handleSendMessage($t.Drafty.videoCall(),void 0,void 0,n).then((e=>{e.code<200||e.code>=300||!e.params||!e.params.seq?this.handleCallClose():this.setState({callSeq:e.params.seq})}));break;case 3:const r=this.tinode.getTopic(e);if(!r)return;r.videoCall("accept",t)}}handleCallRinging(e,t){const n=this.tinode.getTopic(e);n&&n.videoCall("ringing",t)}handleCallHangup(e,t){const n=this.tinode.getTopic(e);n&&n.videoCall("hang-up",t)}handleCallSendOffer(e,t,n){const r=this.tinode.getTopic(e);r&&r.videoCall("offer",t,n)}handleCallIceCandidate(e,t,n){const r=this.tinode.getTopic(e);r&&r.videoCall("ice-candidate",t,n)}handleCallSendAnswer(e,t,n){const r=this.tinode.getTopic(e);r&&r.videoCall("answer",t,n)}handleCallClose(){this.callTimeoutTimer&&clearTimeout(this.callTimeoutTimer),this.setState({callTopic:void 0,callState:0})}handleCallAcceptCall(e){const t=this.tinode.getTopic(e);t&&(t.isSubscribed()?(this.handleTopicSelected(this.state.callTopic),this.setState({callState:3})):this.setState({callShouldStart:!0},(()=>this.handleTopicSelected(this.state.callTopic))))}handleInfoMessage(e){if("call"==e.what)switch(e.event){case"accept":if($t.Tinode.isMeTopicName(e.topic)&&this.tinode.isMe(e.from))return void this.setState({callTopic:null,callState:0,callSeq:null});e.topic==this.state.callTopic&&this.setState({callState:3});break;case"hang-up":this.handleCallClose()}}handleDataMessage(e){if(e.head&&e.head.webrtc&&e.head.webrtc==dr){const t=this.tinode.getTopic(e.topic);if(t){const n=t.latestMsgVersion(e.seq)||e;n.head&&n.head.webrtc&&n.head.webrtc==dr&&e.from!=this.state.myUserId&&(0==this.state.callState?this.setState({callTopic:e.topic,callState:2,callSeq:e.seq}):this.handleCallHangup(e.topic,e.seq))}else console.warn("Received vc data message from unknown topic",e.topic)}}render(){return t().createElement("div",{id:"app-container",ref:this.selfRef},this.state.contextMenuVisible?t().createElement(dn,{tinode:this.tinode,bounds:this.state.contextMenuBounds,clickAt:this.state.contextMenuClickAt,params:this.state.contextMenuParams,items:this.state.contextMenuItems,hide:this.handleHideContextMenu,onShowAlert:this.handleShowAlert,onAction:this.handleContextMenuAction,onTopicRemoved:e=>{e==this.state.topicSelected&&this.handleTopicSelected(null)},onError:this.handleError}):null,this.state.forwardDialogVisible?t().createElement(sr,{tinode:this.tinode,contacts:this.state.chatList,topicSelected:this.state.topicSelected,myUserId:this.state.myUserId,hide:this.handleHideForwardDialog,onInitFind:this.tnInitFind,searchResults:this.state.searchResults,onSearchContacts:this.handleSearchContacts,onTopicSelected:this.handleStartTopicRequest}):null,this.state.callTopic&&2==this.state.callState?t().createElement(mr,{tinode:this.tinode,onClose:this.handleCallClose,topic:this.state.callTopic,seq:this.state.callSeq,callState:this.state.callState,onRinging:this.handleCallRinging,onAcceptCall:this.handleCallAcceptCall,onReject:this.handleCallHangup}):null,t().createElement(jt,{visible:this.state.alertVisible,title:this.state.alertParams.title,content:this.state.alertParams.content,onReject:this.state.alertParams.onReject?()=>{this.setState({alertVisible:!1})}:null,reject:this.state.alertParams.reject,onConfirm:()=>{this.setState({alertVisible:!1}),this.state.alertParams.onConfirm()},confirm:this.state.alertParams.confirm}),t().createElement(a6,{tinode:this.tinode,connected:this.state.connected,displayMobile:this.state.displayMobile,hideSelf:this.state.displayMobile&&"sidepanel"!==this.state.mobilePanel,state:this.state.sidePanelSelected,title:this.state.sidePanelTitle,avatar:this.state.sidePanelAvatar,trustedBadges:this.state.myTrustedBadges,login:this.state.login,persist:this.state.persist,myUserId:this.state.myUserId,loginDisabled:this.state.loginDisabled,loadSpinnerVisible:this.state.loadSpinnerVisible,errorText:this.state.errorText,errorLevel:this.state.errorLevel,errorAction:this.state.errorAction,errorActionText:this.state.errorActionText,topicSelected:this.state.topicSelected,chatList:this.state.chatList,credMethod:this.state.credMethod,credCode:this.state.credCode,credToken:this.state.credToken,transport:this.state.transport,messageSounds:this.state.messageSounds,desktopAlerts:this.state.desktopAlerts,desktopAlertsEnabled:this.state.desktopAlertsEnabled,incognitoMode:this.state.incognitoMode,serverAddress:this.state.serverAddress,secureConnection:this.state.secureConnection,serverVersion:this.state.serverVersion,onGlobalSettings:this.handleGlobalSettings,onSignUp:this.handleNewAccount,onSettings:this.handleSettings,onNavigate:this.basicNavigator,onLoginRequest:this.handleLoginRequest,onPersistenceChange:this.handlePersistenceChange,onCreateAccount:this.handleNewAccountRequest,onUpdateAccountDesc:this.handleTopicUpdateRequest,onUpdatePassword:this.handleUpdatePasswordRequest,onUpdateAccountTags:this.handleUpdateAccountTagsRequest,onTogglePushNotifications:this.toggleFCMToken,onToggleMessageSounds:this.handleToggleMessageSounds,onToggleIncognitoMode:this.handleToggleIncognitoMode,onCredAdd:this.handleCredAdd,onCredDelete:this.handleCredDelete,onCredConfirm:this.handleCredConfirm,onTopicSelected:this.handleTopicSelected,onCreateTopic:this.handleStartTopicRequest,onLogout:this.handleLogout,onDeleteAccount:this.handleDeleteAccount,onShowAlert:this.handleShowAlert,onCancel:this.handleSidepanelCancel,onError:this.handleError,onValidateCredentials:this.handleValidateCredentialsRequest,onPasswordResetRequest:this.handlePasswordResetRequest,onResetPassword:this.handleResetPassword,onShowArchive:this.handleShowArchive,onShowBlocked:this.handleShowBlocked,onInitFind:this.tnInitFind,searchResults:this.state.searchResults,onSearchContacts:this.handleSearchContacts,showContextMenu:this.handleShowContextMenu}),t().createElement(A1,{tinode:this.tinode,connected:this.state.connected,ready:this.state.ready,online:this.state.topicSelectedOnline,acs:this.state.topicSelectedAcs,displayMobile:this.state.displayMobile,viewportWidth:this.state.viewportWidth,viewportHeight:this.state.viewportHeight,hideSelf:this.state.displayMobile&&("topic-view"!==this.state.mobilePanel||this.state.infoPanel),topic:this.state.topicSelected,myUserId:this.state.myUserId,myUserName:this.state.sidePanelTitle,serverVersion:this.state.serverVersion,serverAddress:this.state.serverAddress,applicationVisible:this.state.applicationVisible,forwardMessage:this.state.forwardMessage,onCancelForwardMessage:this.handleHideForwardDialog,callTopic:this.state.callTopic,callSeq:this.state.callSeq,callState:this.state.callState,onCallHangup:this.handleCallHangup,onCallInvite:this.handleCallInvite,onCallSendOffer:this.handleCallSendOffer,onCallIceCandidate:this.handleCallIceCandidate,onCallSendAnswer:this.handleCallSendAnswer,errorText:this.state.errorText,errorLevel:this.state.errorLevel,errorAction:this.state.errorAction,errorActionText:this.state.errorActionText,newTopicParams:this.state.newTopicParams,onHideMessagesView:this.handleHideMessagesView,onError:this.handleError,onNewTopicCreated:this.handleNewTopicCreated,showContextMenu:this.handleShowContextMenu,onChangePermissions:this.handleChangePermissions,onNewChat:this.handleNewChatInvitation,sendMessage:this.handleSendMessage,onVideoCallClosed:this.handleCallClose}),this.state.infoPanel?t().createElement(qr,{tinode:this.tinode,connected:this.state.connected,displayMobile:this.state.displayMobile,topic:this.state.topicSelected,searchableContacts:this.state.searchableContacts,myUserId:this.state.myUserId,panel:this.state.infoPanel,errorText:this.state.errorText,errorLevel:this.state.errorLevel,errorAction:this.state.errorAction,errorActionText:this.state.errorActionText,onNavigate:this.infoNavigator,onTopicDescUpdateRequest:this.handleTopicUpdateRequest,onShowAlert:this.handleShowAlert,onChangePermissions:this.handleChangePermissions,onMemberUpdateRequest:this.handleMemberUpdateRequest,onDeleteTopic:this.handleDeleteTopicRequest,onDeleteMessages:this.handleDeleteMessagesRequest,onLeaveTopic:this.handleLeaveUnsubRequest,onBlockTopic:this.handleBlockTopicRequest,onReportTopic:this.handleReportTopic,onAddMember:this.handleManageGroupMembers,onTopicTagsUpdateRequest:this.handleTagsUpdateRequest,onTopicUnArchive:this.handleUnarchive,onInitFind:this.tnInitFind,onError:this.handleError,showContextMenu:this.handleShowContextMenu}):null)}}const u6=(0,i.injectIntl)(c6),{params:h6}=b1.parseUrlHash(window.location.hash),d6=h6&&h6.hl||navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage||"en",p6=d6.toLowerCase().split(/[-_]/)[0],m6=o[d6]?d6:o[p6]?p6:"en",_6=o[m6];document.getElementsByTagName("html")[0].setAttribute("lang",m6),a().render(t().createElement(t().StrictMode,null,t().createElement(i.IntlProvider,{locale:d6,messages:_6,textComponent:t().Fragment},t().createElement(u6,null))),document.getElementById("mountPoint"))})()})();
//# sourceMappingURL=index.prod.js.map